(window.webpackJsonp_product=window.webpackJsonp_product||[]).push([[1],{10:function(t,e,i){"use strict";i.r(e);var n=i(166),o=(i(5),i(4)),s=i.n(o),r=i(3),a=i.n(r),l=i(163);var c={configureAjax:function(){var t=this;function e(){var t=beezySettings.ApiServiceV2QueryString.split("="),e=beezySettings.ApiServiceV2QueryString.split("&"),i={};if(e.length>0)for(var n=0;n<e.length;++n)i[(t=e[n].split("="))[0]]=t[1];else i[t[0]]=t[1];return i}Function.prototype.ensurizePromise=function(){return t.ensurizePromise(this)},Function.prototype.ensurizeCallback=function(){return t.ensurizeCallback(this)},this.ensureDataPromises=this.loadData.ensurizePromise(),this.ensureDataCallbacks=this.loadData.ensurizeCallback(),this.StatusCodes={UNKNOWN_OR_CANCELED:0,OK:200,CREATED:201,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,FORBIDDEN:403,INTERNAL_SERVER_ERROR:500},this.$ajax=s.a.ajax,"SharePointApp"===beezySettings.SharePointVersion&&(this.$ajax=function(t){var i={beforeSend:function(e){"GET"!==t.type&&(e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Accept","application/json"))},type:t.type,url:t.url,data:"GET"===t.type?a.a.extend(e(),t.data):t.data,dataType:t.dataType||"json",cache:t.cache};if(n.default.isAppsCloud()||(i.xhrFields={withCredentials:!0}),void 0!==window.beezyModernEnvironment&&window.beezyModernEnvironment)return s.a.ajax(i).done(t.success).fail(t.error);if(n.default.isAppsCloud()&&window.contentLoader.contextTokenReady.promise&&window.contentLoader.contextTokenReady.promise.isPending()){var o=s.a.Deferred();return window.contentLoader.contextTokenReady.promise.then((function(e){i.data.SPAppToken=e,s.a.ajax(i).done((function(){t.success&&t.success.apply(null,arguments),o.resolve.apply(null,arguments)})).fail((function(){t.error&&t.error.apply(null,arguments),o.reject.apply(null,arguments)}))})),o}return s.a.ajax(i).done(t.success).fail(t.error)})},loadData:function(t){return void 0===this.getContent(t)||void 0!==t.cache&&!t.cache?this.$ajax(t):this.ensureDataPromises(t)},getArguments:function(t,e,i,n,o){var s,r,a,l,c={type:t,url:e,cache:!!i&&i.cache},u=beezySettings.ApiServiceV2QueryString;if(o&&(s=u,r="SPHostUrl",a=o,l=new RegExp("".concat(r,"=.*?(&|$)"),"i"),u=s.match(l)?s.replace(l,"".concat(r,"=").concat(a,"&")):s),u&&"SharePointApp"===beezySettings.SharePointVersion&&("POST"===t||"PUT"===t||"DELETE"===t)){var d=encodeURI(c.url).indexOf("?")>-1?"&":"?";c.url=c.url+d+u}return void 0!==n&&(c.dataType=n),void 0!==i&&(c.data=i),c},get:function(t,e,i){var n=this.getArguments("GET",t,e,i);return void 0===this.getContent(n)||void 0!==n.cache&&!n.cache?this.$ajax(n):this.ensureDataPromises(n)},getJSON:function(t,e){var i=this.getArguments("GET",t,e,"json");return void 0===this.getContent(i)||void 0!==i.cache&&!i.cache?this.$ajax(i):this.ensureDataPromises(i)},getJSONHeader:function(t,e,i){var n=this.getArguments("GET",t,e,"json");return n.headers=i,void 0===this.getContent(n)||void 0!==n.cache&&!n.cache?this.$ajax(n):this.ensureDataPromises(n)},post:function(t,e){var i=this.getArguments("POST",t,e);return i.contentType="application/json; charset=utf-8",this.$ajax(i)},postJSON:function(t,e){var i=this.getArguments("POST",t,"string"!=typeof e?JSON.stringify(e):e,"json");return i.contentType="application/json;charset=utf-8",this.$ajax(i)},del:function(t,e,i){var n=this.getArguments("DELETE",t,"string"!=typeof e?JSON.stringify(e):e,void 0,i);return n.contentType="application/json;charset=utf-8",this.$ajax(n)},put:function(t,e){var i=this.getArguments("PUT",t,"string"!=typeof e?JSON.stringify(e):e);return i.contentType="application/json;charset=utf-8",this.$ajax(i)},putJSON:function(t,e){var i=this.getArguments("PUT",t,JSON.stringify(e),"json");return i.contentType="application/json;charset=utf-8",this.$ajax(i)},ensurizePromise:function(t){var e=null,i=this;return function(n){var o=i.getContent(n);if(void 0!==o){var r=s.a.Deferred();return delete beezyContent[i.getModelUrl(n)],e=s.a.Deferred(),r.then((function(){e.resolve(o)})),setTimeout((function(){r.resolve()}),0),e.promise()}return e&&n.cache||(e=s.a.Deferred(),t.apply(i,arguments).then(e.resolve,e.reject)),e.promise()}},ensurizeCallback:function(t){var e=null,i=[],n=this;return function(o){e=s.a.Deferred();var r=a.a.some(i,(function(t){return t.url===o.url&&t.type===o.type&&t.data===(void 0===o.data?"":o.data)}));if("GET"===o.type&&(i=n.addCallback(o,i,e)),r&&!o.reset&&o.cache){var l;l||(l=setInterval((function(){n.checkUnresolvedCallbacks(o,i)&&n.resolveAllCallbacks(o,i),0===(i=n.removeResolvedCallbacks(i)).length&&(clearInterval(l),l=void 0)}),1e3))}else{var c=o.success;o.success&&"GET"===o.type&&delete o.success,o.cache=!1;var u=n.getContent(o);if(void 0!==u){o.success=c,delete beezyContent[n.getModelUrl(o)];var d=s.a.Deferred();return d.then((function(){i=n.resolveAllCallbacks(o,i,u)})),setTimeout((function(){d.resolve()}),0),e.promise()}e=t.apply(n,arguments),"GET"===o.type&&(o.success=c,e.then((function(t){i=n.resolveAllCallbacks(o,i,t)})))}return e.promise()}},getModelUrl:function(t){var e,i=t.url.split(beezySettings.ApiServiceV2Url).length>1?t.url.split(beezySettings.ApiServiceV2Url)[1]:t.url.split(beezySettings.AdminApiServiceV2Url).length>1?t.url.split(beezySettings.AdminApiServiceV2Url)[1]:"";if(t.data){if(s.a.browser.msie){var n=[];for(var o in t.data)Object.prototype.hasOwnProperty.call(t.data,o)&&n.push(o);e=n.length}else e=Object.keys(t.data).length;e>1&&(i=i.indexOf("?")>-1?"".concat(i,"&"):"".concat(i,"?"))}for(var r in t.data)"cache"!==r&&void 0!==t.data[r]&&(i+="".concat(r,"=").concat(t.data[r]),i+="&");return i.replace(/&\s*$/,"")},getContent:function(t){var e=this.getModelUrl(t);if("GET"===t.type&&"undefined"!=typeof beezyContent&&null!==beezyContent&&void 0!==beezyContent[e]){if(!t.reset){var i=l.default.clone(beezyContent[e]);if(s.a.isArray(i)&&t.data){var n=t.data.skip||t.data.minimum||0,o=t.data.take||t.data.maximum;o&&(i=i.splice(n,o))}return i}delete beezyContent[e]}},existInContent:function(t){var e=this.getModelUrl(t);return"GET"===t.type&&"undefined"!=typeof beezyContent&&null!==beezyContent&&void 0!==beezyContent[e]},getRequest:function(t,e){var i=t.data?JSON.stringify(t.data):"";return a.a.find(e,(function(e){return e.url===t.url&&e.type===t.type&&e.data===i}))},removeResolvedCallbacks:function(t){return a.a.each(t,(function(e){a.a.every(e.callbacksSuccess,(function(t){return t.resolved}))&&(t=a.a.without(t,e))})),t},checkUnresolvedCallbacks:function(t,e){var i=this.getRequest(t,e),n=!1,o=!1;return i&&(n=a.a.some(i.callbacksSuccess,(function(t){return t.resolved})),o=a.a.some(i.callbacksSuccess,(function(t){return!t.resolved}))),n&&o},addCallback:function(t,e,i){var n=this.getRequest(t,e);return n?n.callbacksSuccess.push({success:t.success,resolved:!1,promise:i}):e.push({data:t.data?JSON.stringify(t.data):"",url:t.url,type:t.type,callbacksSuccess:[{success:t.success,resolved:!1,promise:i}]}),e},resolveAllCallbacks:function(t,e,i){var n=[],o=[],s=this.getRequest(t,e);if(s&&(n=a.a.where(s.callbacksSuccess,{resolved:!0}),o=a.a.where(s.callbacksSuccess,{resolved:!1}),i&&(s.results=i),n&&n.length||s.results)){var r=s.results;a.a.each(o,(function(e){var i=l.default.clone(r);e.success(i),e.promise.resolve(i),e.resolved=!0,e.results=i;var n=t.url.split(beezySettings.ApiServiceV2Url).length>0?t.url.split(beezySettings.ApiServiceV2Url)[1]:"";"undefined"!=typeof beezyContent&&null!==beezyContent&&void 0!==beezyContent[n]&&delete beezyContent[n]}))}return e}};e.default=c},100:function(t,e,i){"use strict";i.r(e);i(3310),i(101),i(102),i(103),i(104)},1003:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(83),l=i(21),c=i(2023);var u=function(t){var e=t.id,i=t.children,n=t.extraClasses,s=t.role;return o.a.createElement(a.default,{id:e,role:s,extraClasses:{listitem:Object(l.unionClassNames)(c.default.list__item,n.listitem)}},i)};u.propTypes={extraClasses:r.a.shape({listitem:r.a.string}),id:r.a.string,children:r.a.node.isRequired,role:r.a.string},u.defaultProps={extraClasses:{listitem:""},id:"",role:void 0},e.default=u},1008:function(t,e,i){"use strict";e.default={"list__item--clickable":"bz-list__item--clickable--Z11Dwyl",icon:"bz-icon--Z11Dwyl","loading--position":"bz-loading--position--Z11Dwyl","tooltip__span--width":"bz-tooltip__span--width--Z11Dwyl"}},1011:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(116),l=i(12),c=i(7),u=i(64),d=i(5),h=i(30),f=[],p=a.default.extend({classes:{container:"drop bz-webpart",top:"drop-top",bottom:"drop-bottom"},dom:{classContainer:"js-beezy-drop"},init:function(t){this.relatedElement=this.options.relatedElement||Object(h.sharePointItems)().content,this.options.bound&&this.bindTo(this.options.bound),this.content=this.options.content,this.hidden=!0,this.offset=r.a.extend({top:0,left:0},this.options.offset||{}),this.showDelay=t.showDelay||c.default.dropDefaultDelayShow,this.hideDelay=void 0!==t.hideDelay?t.hideDelay:c.default.dropDefaultDelayHide,this.options.fixed?this._calculatePosition=this._calculatePositionFixed:this._calculatePosition=this._calculatePositionFlexible,this.oncontainerclick=r.a.bind(this.oncontainerclick,this),this.ondocumentkeydown=r.a.bind(this.ondocumentkeydown,this),this.ondocumentclick=r.a.bind(this.ondocumentclick,this),this.onwindowresize=r.a.bind(this.onwindowresize,this),this.options.usezIndexCss&&this.el.addClass(this.options.usezIndexCss),this.classContainer=t.classContainer||this.dom.classContainer,this.insideSidebar=this.options.insideSidebar||!1,this.insideOtherDrop=this.options.insideOtherDrop||!1,this.initializeHideAll(),this.id=f.length+1,f.push(this),this.promiseShow=o.a.Deferred(),this.promiseHide=o.a.Deferred(),this.showTimer=void 0,this.hideTimer=void 0,this.positionDefault=t.positionDefault,this.currentPosition={vertical:c.default.DropVerticalPosition.TOP,horizontal:c.default.DropPosition.RIGHT},this.classPosition=t.classPosition||"",this.notTriangule=t.notTriangule,this.relatedElements=t.relatedElements||[]},initializeHideAll:function(){var t=this;l.default.subscribe("drop","HideAllDrops",(function(){t.hideAll()}))},hideOthers:function(){var t=this;r.a.each(f,(function(e){t.id===e.id||t.insideOtherDrop||e.hidden||e.hide()}))},hideAll:function(){r.a.each(f,(function(t){t.hide()}))},hideSideBar:function(){this.insideSidebar||l.default.publish("sidebar","Hide")},_onShow:function(){this.options.usezIndexCss||this.el.css({zIndex:this.options.zIndex||0}),this.bindEvents(),this._calculatePosition()},_onHide:function(){this.unbindEvents()},getDropContainer:function(t){var e=u.default.getElementWithClass(t,this.relatedElement);return e&&e.length?e:u.default.createElementWithClass(t,this.relatedElement)},fillDrop:function(){this.getDropContainer(this.classContainer).html(this.el)},clearDrop:function(){this.getDropContainer(this.classContainer).html("")},isHiding:function(){return this.hideTimer},cancelHide:function(){clearTimeout(this.hideTimer)},isShowing:function(){return this.showTimer},cancelShow:function(){clearTimeout(this.showTimer),this.stopAnimation()},stopAnimation:function(){this.el.stop&&this.el.stop()},show:function(t){this._show(t)},_show:function(t){var e=this;t=t||!0,this.emit("show"),this._onShow(),this.showTimer=setTimeout((function(){return e.hideOthers(),e.hideSideBar(),t?e.el.css({opacity:0,visibility:"visible",display:"block"}).animate({opacity:1},{duration:300,easing:"linear",queue:!1,complete:function(){e.hidden=!1,e.promiseShow.resolve(e)}}):(e.el.css("visibility","visible"),e.el.css("display","block")),e.promiseShow}),e.showDelay)},hide:function(t){this._hide(t)},_hide:function(t){var e=this;this.promiseHide=o.a.Deferred(),t=t||!0,this.emit("hide"),this._onHide(),this.hideTimer=setTimeout((function(){return t?e.el.css({opacity:1}).animate({opacity:0},{duration:150,easing:"linear",queue:!1,complete:function(){o()(this).css("visibility","hidden"),o()(this).css("display","none"),e.hidden=!0,e.promiseHide.resolve(e)}}):(e.el.css("visibility","hidden"),e.el.css("display","none"),e.clearDrop()),e.promiseHide}),this.hideDelay)},showAnimated:function(){this.show(!0)},hideAnimated:function(){this.hide(!0)},toggleAnimated:function(){this[this.hidden?"showAnimated":"hideAnimated"]()},bindTo:function(t){this.$bound=t&&o()(t)},empty:function(){this.el.html("")},append:function(t){this.el.append(t)},inject:function(t){this.el.html(t),this.setCurrentPositionClass()},toggle:function(){this[this.hidden?"show":"hide"]()},moveTo:function(t,e){this.el.css({top:t,left:e})},render:function(){var t=this.classes;return this.el.css({position:"absolute",visibility:"hidden",top:0}).addClass(t.container).addClass(this.verticalPosition===c.default.DropVerticalPosition.BOTTOM?t.bottom:t.top),this.fillDrop(),this},bindEvents:function(){this.el.on("click",this.oncontainerclick),o()(document).on("keydown",this.ondocumentkeydown),o()(document).on("click",this.ondocumentclick),o()(window).on("resize",this.onwindowresize)},unbindEvents:function(){this.el.off("click",this.oncontainerclick),o()(document).off("keydown",this.ondocumentkeydown),o()(document).off("click",this.ondocumentclick),o()(window).off("resize",this.onwindowresize)},oncontainerclick:function(t){!this.hidden&&t.stopPropagation()},ondocumentkeydown:function(t){27===t.which&&this.hide()},ondocumentclick:function(t){var e=t.target||t.srcElement;e===this.$bound.get(0)||u.default.isDescendant(this.$bound.get(0),e)||u.default.findElementClasses(e,this.relatedElements)||this.hide()},onwindowresize:function(){this._calculatePosition()},updatePosition:function(){this._calculatePosition()},setPosition:function(t){this.position=t,this.hidden||this._calculatePosition()},setVerticalPosition:function(t){this.currentPosition.vertical!==t&&this._setVerticalPosition[t]&&this._setVerticalPosition[t](this)},setVerticalPositionClass:{TOP:function(t){t.el.removeClass(t.classes.bottom).addClass(t.classes.top)},BOTTOM:function(t){t.el.removeClass(t.classes.top).addClass(t.classes.bottom)}},setCurrentPositionClass:function(){var t=this.currentPosition.vertical.toLowerCase(),e=this.currentPosition.horizontal.toLowerCase();this.currentPositionClass&&this.el.removeClass(this.currentPositionClass),this.currentPositionClass="".concat(this.classPosition+t,"-").concat(e),this.notTriangule&&(this.currentPositionClass="".concat(this.classPosition,"no-triangle")),this.el.addClass(this.currentPositionClass)},_calculatePositionFlexible:function(){var t=this;setTimeout((function(){var e=t.getPosition();window.matchMedia("(max-width: 760px)").matches||t.currentPosition.vertical===c.default.DropVerticalPosition.BOTTOM&&e.top+t.el.outerHeight()>=t.relatedElement.height()+t.relatedElement.scrollTop()&&(t.setVerticalPositionClass[c.default.DropVerticalPosition.TOP](t),e.top-=t.$bound.outerHeight()+t.el.outerHeight()),t.moveTo(e.top,e.left)}),1)},_calculatePositionFixed:function(){var t=this.getPosition();this.moveTo(t.top,t.left)},checkVerticalPosition:function(){var t=this.positionDefault.vertical===c.default.DropVerticalPosition.TOP;if(window.matchMedia("(max-width: 760px)").matches)this.changeVerticalPosition(this.positionDefault.vertical);else{var e=this.outOfUpperBounds(),i=this.outOfLowerBounds();t?e?this.changeVerticalPosition(c.default.DropVerticalPosition.BOTTOM):this.changeVerticalPosition(this.positionDefault.vertical):i&&!e?this.changeVerticalPosition(c.default.DropVerticalPosition.TOP):this.changeVerticalPosition(this.positionDefault.vertical)}},checkHorizontalPosition:function(){var t=this.positionDefault.horizontal===c.default.DropPosition.LEFT,e=this.outOfLeftBounds(),i=this.outOfRightBounds();t?e?this.changeHorizontalPosition(c.default.DropPosition.RIGHT):this.changeHorizontalPosition(this.positionDefault.horizontal):i&&!e?this.changeHorizontalPosition(c.default.DropPosition.LEFT):this.changeHorizontalPosition(this.positionDefault.horizontal)},checkPosition:function(){this.checkVerticalPosition(),this.checkHorizontalPosition()},changeVerticalPosition:function(t){this.currentPosition.vertical=t},changeHorizontalPosition:function(t){this.currentPosition.horizontal=t},getPosition:function(){var t=this.$bound.offset(),e=0;this.checkPosition(),this.setVerticalPositionClass[this.currentPosition.vertical](this),this._hAlignment(),this._vAlignment(),e=Object(h.isSharepointModern)()?t.top+this.vAlignOffset+(d.default.isInsideSharepointContainer()?this.relatedElement.scrollTop():0)-(d.default.isInsideSharepointContainer()?h.sharePointSizes.ribbonModern.height():0):t.top+this.vAlignOffset+(d.default.isInsideSharepointContainer()?this.relatedElement.scrollTop():0)-(d.default.isInsideSharepointContainer()?h.sharePointSizes.ribbon.height():0);var i=t.left+this.hAlignOffset;if(this.offset.left&&(i+=this.offset.left),i<0){var n=this.$bound.offset().left-this.el.outerWidth()/2+this.$bound.outerWidth()/2;i=n>0?n:0}else i+this.el.outerWidth()>o()("html").width()&&(i=o()("html").width()-this.el.outerWidth());return{top:e,left:i}},_hAlignment:function(){switch(this.currentPosition.horizontal){case c.default.DropPosition.CENTER:this.hAlignOffset=this.$bound.outerWidth()/2-this.el.outerWidth()/2;break;case c.default.DropPosition.LEFT:this.hAlignOffset=this.$bound.outerWidth()-this.el.outerWidth();break;default:case c.default.DropPosition.RIGHT:this.hAlignOffset=0}},_vAlignment:function(){switch(this.currentPosition.vertical){case c.default.DropVerticalPosition.TOP:this.vAlignOffset=-this.el.outerHeight()-this.offset.top;break;default:case c.default.DropVerticalPosition.BOTTOM:this.vAlignOffset=this.$bound.outerHeight()+this.offset.top}},outOfUpperBounds:function(){return(d.default.isInsideSharepointContainer()?this.$bound.offset().top-h.sharePointSizes.ribbon.height()-c.default.dropthreshold:this.$bound.offset().top-o()(document).scrollTop()-c.default.dropthreshold)<this.el.outerHeight()},outOfLowerBounds:function(){return(d.default.isInsideSharepointContainer()?o()("html").height()-this.$bound.offset().top-c.default.dropthreshold:o()("html").height()-(this.$bound.offset().top-o()(document).scrollTop())-c.default.dropthreshold)<this.el.outerHeight()},outOfRightBounds:function(){return this.$bound.offset().left+this.el.outerWidth()>o()("html").width()},outOfLeftBounds:function(){return this.$bound.offset().left+this.$bound.outerWidth()<this.el.outerWidth()}});p.create=function(t){var e=new p({classes:{container:"popover",top:"popover--top"},offset:{top:-10},position:c.default.DropPosition.CENTER,verticalPosition:c.default.DropVerticalPosition.TOP,fixed:!0});return e.inject(t),e.render(),e},e.default=p},1018:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(26).default.extend({idAttribute:"Guid",search:function(t){return o.a.chain(this.get("Terms")).filter(this.contains(t.toUpperCase())).map(this.extendTerms,this).value()},contains:function(t){return function(e){return e.Name.toUpperCase().indexOf(t)>-1}},extendTerms:function(t){return o.a.extend(t,{termStore:this.get("Name")})}});e.default=s},1032:function(t,e,i){"use strict";var n=i(98),o=i.n(n),s=i(3),r=i.n(s),a=i(4),l=i.n(a);i(96);function c(){}var u={autoOpen:!1,draggable:!1,modal:!0,resizable:!1,closeOnEscape:!0,showCrossButton:!1};var d=function(t){var e;"object"!==o()(t)&&(t={}),this._hidden=!0,this._default=r.a.extend({},u),t.extend&&r.a.extend(this._default,t.extend),this._default.showCrossButton?function(t){t._default.open=function(){l()(".ui-button-text",t._content.parent()).remove(),l()(".ui-button-text",t._content.parent()).val("eyyyy")}}(this):(e=this)._default.open=function(){l()(".ui-dialog-titlebar-close",e._content.parent()).parent().remove(),l()(".ui-dialog-buttonpane",e._content.parent()).hide()},this._default.title=t.title||"",this.onShow=t.onShow||c,this.onHide=t.onHide||c,this.onDestroy=t.onDestroy||c,this.onClose=t.onClose||c;var i=t.dataTest||"beezy-dialog";this._content="string"==typeof t.selector?l()(t.selector):t.selector,function(t,e){r.a.isArray(t)&&0!==t.length&&(e._default.buttons={},r.a.each(t,(function(t){t.label&&"string"==typeof t.label&&(e._default.buttons[t.label]=function(){t.onClick.call(e)})}),e))}(t.buttons,this),this._content.dialog(this._default).addClass("bz-webpart").attr("data-test",i).on("dialogbeforeclose",(function(e,i){if(t.onBeforeHide){var n=l()(e.originalEvent&&e.originalEvent.target),o=n.hasClass("ui-dialog-titlebar-close")||n.hasClass("ui-icon-closethick");t.onBeforeHide(e,i,{isCloseButton:o})}})).on("dialogclose",(function(e,i){t.onClose&&(t.onClose(e,i),l()("body").removeClass("overflow-y-scroll"),l()("#s4-workspace").removeClass("height-auto"))})),this.classes={},this.classes.isDisabled="is-disabled"};d.EULA={closeOnEscape:!1},d.prototype={show:function(){var t;return l()("body").addClass("overflow-y-scroll"),l()("#s4-workspace").addClass("height-auto"),this._hidden=!1,this.onShow(this._content),this._content.dialog("open"),(t=this._content).scrollTop(0),t.children().scrollTop(0),this},hide:function(){return l()("body").removeClass("overflow-y-scroll"),l()("#s4-workspace").removeClass("height-auto"),this._hidden=!0,this.onHide(this._content),this._content.dialog("close"),this},setTitle:function(t){this._content.dialog("option","title",t)},append:function(t){this._content.parent().appendTo(t)},dispose:function(){this.hide(),this.onDestroy(this._content),this._content=null,delete this._content},onBeforeClose:function(t){this._content.dialog({beforeClose:t})},disableButton:function(){this._content.find(".js-save").addClass(this.classes.isDisabled)},enableButton:function(){this._content.find(".js-save").removeClass(this.classes.isDisabled)}},e.default=d},1033:function(t,e,i){"use strict";i.d(e,"contentTypeIds",(function(){return n})),i.d(e,"FOLDER_NAME_MAX_LENGHT",(function(){return o}));var n={activity:"0x012000064c4c5203c44be29ab61bcfd8d3e2c8",comment:"0x0100f12b86f19f7842edb8c72d5cac8d936c",extendedIdea:"0x0100BC0BF0B071F84C6AA08757218C27C8A7",blog:"0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF3900022F819C5547410BA27032227BD41ACA",page:"0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39004662A8B4CDBB4D40928ACED502A535B4",idea:"0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39004986485D18E8422280B564F9D171BF1F",question:"0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF3900A8365E1742A449B79F80A857C4C5BD49",story:"0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF3900C2A4733B39B64682A4509791899EF550",wiki:"0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39004C1F8B46085B4D22B1CDC3DE08CFFB9C007AE303C60F29468EAFAC91180B21E4AC"},o=123;e.default={APPS:"SharePointApp"}},1039:function(t,e,i){"use strict";var n=i(607),o=i(521),s=i(1487);e.default=function(t){var e=Object(o.default)(t)?t:null;if(e){var i=e.getTimezoneOffset();return-1!==Math.sign(i)?Object(n.default)(e,i):Object(s.default)(e,Math.abs(i))}return null}},105:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(14),r=i.n(s),a=i(3),l=i.n(a),c=i(1113),u=i(71),d=i(521),h=i(2291),f=i(2),p=i(195),m=i(17),g=i(523),v=i(422),b=i(49),y=i(1157),C=i(350),w=i(968),T=i(1924),x=i(8),O=i(498),S=i(46),I=i(56),A=i(63),k=i(652),P=i(15),E=i(5),_=i(51),j=i(599),D=i(189),U=i(7),M=i(88),L=void 0,N=function(t){var e=E.default.getCorporateModule();return e&&e.Url?encodeURI("".concat(E.default.getBaseSiteHost()).concat(e.Url).concat(U.default.Corporate.viewDraftUrl,"/").concat(t)):"#"};r.a.registerHelper("getSiteCollectionUrl",(function(){return E.default.getSiteCollectionUrl()})),r.a.registerHelper("getStartPageUrl",(function(){var t=E.default.startPageUrl(),e=E.default.getSiteCollectionUrl();return t&&t.length?t:e})),r.a.registerHelper("getBaseSiteCollectionUrl",(function(){return E.default.getBaseSiteCollection()})),r.a.registerHelper("getSiteUrl",(function(){return S.default.getGroupUrl()})),r.a.registerHelper("getSiteHost",(function(){return E.default.getSiteHost()})),r.a.registerHelper("getBaseSiteHost",(function(){return E.default.getBaseSiteHost()})),r.a.registerHelper("getIdeaCampaignImpact",m.default.getIdeaCampaignImpact),r.a.registerHelper("or",(function(t,e,i){return t||e?i.fn(this):i.inverse(this)})),r.a.registerHelper("and",(function(t,e,i){return t&&e?i.fn(this):i.inverse(this)})),r.a.registerHelper("andSecondFalse",(function(t,e,i){return t&&!e?i.fn(this):i.inverse(this)})),r.a.registerHelper("andnot",(function(t,e,i){return t||e?i.inverse(this):i.fn(this)})),r.a.registerHelper("ornot",(function(t,e,i){return t&&e?i.inverse(this):i.fn(this)})),r.a.registerHelper("ifnot",(function(t,e){return t?e.inverse(this):e.fn(this)})),r.a.registerHelper("escapeUrl",(function(t){return t?O.default.escapeHTML(t.replace(/&amp;/gi,"&")):""})),r.a.registerHelper("encodeQuotes",(function(t){return t?t.replace(/'/g,"%27"):""})),r.a.registerHelper("toUpperCase",(function(t){return t?t.toUpperCase():""})),r.a.registerHelper("getMegamenuUrl",(function(t){return 0===t.indexOf("http")?t:E.default.getBaseSiteCollection()+t})),r.a.registerHelper("getAbsoluteURL",p.default.getAbsoluteURL),r.a.registerHelper("datetimeToISO",D.getISODateStringFromJSON),r.a.registerHelper("datetimeToString",_.getDateStringFromJSON),r.a.registerHelper("formatDateFromPattern",(function(t){return Object(D.getFormattedDate)(Object(_.getAbsoluteDateFromJSON)(t))})),r.a.registerHelper("formatDueDateFromPattern",(function(t){return Object(D.getFormattedDate)(Object(_.getDateFromJSON)(t))})),r.a.registerHelper("i18n",(function(t){return Object(f.translate)(t)})),r.a.registerHelper("i18nTry",(function(t){return Object(f.translateTry)(t)})),r.a.registerHelper("i18n_sprintf",(function(t){return f.sprintf.apply(void 0,o()([Object(f.translate)(t)].concat([].slice.call(arguments,1))))})),r.a.registerHelper("i18n_sprintf_pattern",(function(t,e,i){return Object(f.sprintfWithPattern)(Object(f.translate)(t),[e],new RegExp("%".concat(i)))})),r.a.registerHelper("i18nOpensNewTabLiteral",(function(t){return"".concat(Object(f.translate)(t)," ").concat(U.default.A11yLiterals.opensNewTab)})),r.a.registerHelper("opensNewTabLiteral",(function(t){return"".concat(t," ").concat(U.default.A11yLiterals.opensNewTab)})),r.a.registerHelper("pluralise",f.pluralise),r.a.registerHelper("getGroupSecurity",S.default.getGroupSecurity),r.a.registerHelper("getGroupStatus",S.default.getGroupStatus),r.a.registerHelper("isActivityOwner",(function(t,e,i){var n=x.default.getCurrentGroup()||e,o=n&&n.IsCurrentUserWebAdmin,s=n&&n.IsCurrentUserSpeaker;if(!n||n.IsActive)return t===P.default.getCurrentUserId()||s||o?i.fn(this):void 0})),r.a.registerHelper("isImagesActivityOwner",(function(t,e,i){var n=x.default.getCurrentGroup()||e,o=n&&n.IsCurrentUserWebAdmin,s=n&&n.IsCurrentUserSpeaker;if((!n||n.IsActive)&&"IdeasCampaign"!==e.Type&&"KnowledgeCenter"!==e.Type&&"CorporateModule"!==e.Type)return t===P.default.getCurrentUserId()||s||o?i.fn(this):void 0})),r.a.registerHelper("canEditPublishing",(function(t,e,i,n){var o=x.default.getCurrentGroup()||e,s=o&&o.IsCurrentUserWebAdmin,r=o&&o.IsCurrentUserSpeaker;if(i===U.default.Type.WIKI){var a=l.a.find(o.Tools,(function(t){return"wiki"===t.Type}));return o.IsCurrentUserMember&&!a.ReadOnly||o.IsCurrentUserWebAdmin||x.default.isPublic()&&E.default.isPublicCommunitiesOpen()&&!a.ReadOnly?n.fn(this):void 0}if(!o||o.IsActive)return t===P.default.getCurrentUserId()||r||s?n.fn(this):void 0})),r.a.registerHelper("nicefyText",C.default.nicefyText),r.a.registerHelper("parseMentions",(function(t,e){return C.default.parseMentions(t,e,void 0,!1)})),r.a.registerHelper("parseMessage",(function(t,e,i,n,o){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];switch(n){case U.default.Type.CALENDAR:case U.default.Type.DISCUSSION:case U.default.Type.WIKI:case U.default.Type.BLOG:case U.default.Type.IDEA:case U.default.Type.QUESTION:case U.default.Type.TASK:case U.default.Type.EXTENDEDIDEA:case U.default.Type.CORPORATEPAGE:case U.default.Type.STORY:return t;default:return new r.a.SafeString(C.default.parseMessage({message:t,theMentions:e,tags:i,isSnippet:o,hasLink:s}))}})),r.a.registerHelper("commentActionLabel",(function(t){return t===U.default.Type.QUESTION||"communityQuestion"===t?Object(f.translate)("Answer"):Object(f.translate)("Comment")})),r.a.registerHelper("commentActionIcon",(function(t){return t===U.default.Type.QUESTION?"tools-check":"tools-comment"})),r.a.registerHelper("hasRole",(function(t,e,i){if(e)return w.default.isCommentOwnerModerator(t)||w.default.isCommentOwnerSpeaker(t)?i.fn(this):void 0})),r.a.registerHelper("isSpeaker",(function(t,e){return w.default.isCommentOwnerSpeaker(t)?e.fn(this):e.inverse(this)})),r.a.registerHelper("isGroupOwner",(function(t){return x.default.isGroupOwner()?t.fn(this):t.inverse(this)})),r.a.registerHelper("isCurrentUserMember",(function(t){return x.default.isGroupMember()?t.fn(this):t.inverse(this)})),r.a.registerHelper("isGroupOwnerOrBeezyAdmin",(function(t){return x.default.isGroupOwner()||P.default.isBeezyAdministrator()?t.fn(this):t.inverse(this)})),r.a.registerHelper("isCommunityCreator",(function(t){return P.default.isCommunityCreator()?t.fn(this):t.inverse(this)})),r.a.registerHelper("isActive",(function(t,e){return(x.default.getCurrentGroup()?!x.default.isGroupDisabled():!this.Group||this.Group.IsActive)?e.fn(this):e.inverse(this)})),r.a.registerHelper("comments",(function(t){return this.tools.comment?t.fn(this):""})),r.a.registerHelper("isEqual",(function(t,e,i){return t===e?i.fn(this):i.inverse(this)})),r.a.registerHelper("isNotEqual",(function(t,e,i){return t!==e?i.fn(this):i.inverse(this)})),r.a.registerHelper("isSmaller",(function(t,e,i){return t<e?i.fn(this):i.inverse(this)})),r.a.registerHelper("greater",(function(t,e,i){return t>e?i.fn(this):i.inverse(this)})),r.a.registerHelper("decodeURI",(function(t){return decodeURIComponent(t)})),r.a.registerHelper("parseURI",(function(t){return(/(https?|news)\:\/\/|mailto\:/i.test(t)?"":"http://")+t})),r.a.registerHelper("getProfileImage",(function(t,e){return t?p.default.getProfileImage(t,e):E.default.getProfileImage()})),r.a.registerHelper("getProfileBackgroundImage",(function(t,e){return p.default.getProfileImage(t,e)})),r.a.registerHelper("getProfileBackgroundImageOriginal",(function(t,e){var i=(new Date).getTime(),n=-1===t.indexOf("?")?"?":"&";return t===P.default.getBackgroundPictureUrl()||t===P.default.getPictureUrl()?"".concat(E.default.getBaseSiteCollection()).concat(t).concat(n,"cache=").concat(i).replace(/#/g,"%23"):"".concat(E.default.getBaseSiteCollection()).concat(t).concat(n,"lastUpdated=").concat(e).replace(/#/g,"%23")})),r.a.registerHelper("redirectMyProfile",(function(t){return t?E.default.getProfileUrl()+t:E.default.getProfileUrl()})),r.a.registerHelper("redirectToLogout",(function(){return"".concat(beezySettings.BaseSiteCollectionUrl,"/_layouts/closeConnection.aspx?loginasanotheruser=true")})),r.a.registerHelper("mediumImageThumbnail",(function(t){return E.default.getMediumImageThumbnail(t)})),r.a.registerHelper("sharedActivity",(function(t){return t.hasCropping?t.BackgroundImageUrl:t.ImageCroppingIds&&t.ImageCroppingIds.includes("article_header")?(e=t.BackgroundImageUrl,(n=(i=e).slice(0,-1*(i.length-i.lastIndexOf(".")))).includes("article_header")?"".concat(n,".jpg"):"".concat(n,"_article_header.jpg")):E.default.getMediumImageThumbnail(t.BackgroundImageUrl);var e,i,n})),r.a.registerHelper("imageThumbnail",(function(t){return E.default.getDefaultImageThumbnail(t)})),r.a.registerHelper("isNotNewPublishing",(function(t,e){return["story","corporatepage"].indexOf(t)>-1?e.inverse(this):e.fn(this)})),r.a.registerHelper("filterBannerText",(function(t,e,i,n,o,s,a,l){var c,u="",d="",h="";if(t||e||i||n||o||s||a){if(d=u+="".concat(Object(f.translate)("Showing")," ").concat(i?i.label.toLowerCase():Object(f.translate)("activity")," "),t){c=!0;var p="".concat(Object(f.translate)("for")," ").concat(t.label);h+=p,u+='<span class="alert__info-label"> '.concat(p," </span>")}if(e){var m="".concat(Object(f.translate)(c?"and":"for")," #").concat(e.label);h+=" ".concat(m),u+=' <span class="alert__info-label__hashtag"> '.concat(m,"</span>"),c=!0}if(s&&(c=!0,h+=s.label,u=" ".concat(Object(f.translate)("Showing results for"),' <span class="alert__info-label"> ').concat(s.label,"</span>")),a&&(c=!0,h=u=Object(f.sprintf)(Object(f.translate)('Showing %s activities containing the text "%s"'),a.type,r.a.Utils.escapeExpression(a.label))),l&&(h=u=Object(f.sprintf)(Object(f.translate)('Showing users skilled in "%s"'),e.label),c=!0),n||o){if(u+=' <span class="alert__info-label"> ',n&&o){var g="".concat(Object(f.translate)("between")," ").concat(n.label," ").concat(Object(f.translate)("and")," ").concat(o.label);h+=" ".concat(g),u+=g}else if(n){var v="".concat(Object(f.translate)("from")," ").concat(n.label);h+=" ".concat(v),u+=v}else{var b="".concat(Object(f.translate)("until")," ").concat(o.label);h+=" ".concat(b),u+=b}u+="</span>"}}return Object(M.addAssertiveMessage)(h.length?"".concat(d," ").concat(h):d),new r.a.SafeString(u)})),r.a.registerHelper("truncatedPages",(function(t,e,i,n){var o="",s=2*i+1;if(e>s+2){var r=t-i>1?t-i:1,a=i-(t-r),l=t+i+a<=e?t+i+a:e,c=l>=e-1;r>1&&c&&(r-=s-(e-r));for(var u=r;u<=l;u++)o+=n.fn(u);c||(o+=n.fn("...")),l<e&&(o+=n.fn(e))}else for(var d=0;++d<=e;)o+=n.fn(d);return o})),r.a.registerHelper("truncate",b.default.cutText),r.a.registerHelper("convertKbToMb",m.default.convertKbToMb),r.a.registerHelper("percentage",m.default.percentage),r.a.registerHelper("quotaLevel",m.default.quotaLevel),r.a.registerHelper("getCommunityLogoUrl",S.default.getCommunityLogoUrl),r.a.registerHelper("presenceIndicatorImg",(function(t){return y.default.existIMNControl()?new r.a.SafeString(y.default.getImage(t)):""}));var R=/\.(pdf|docx?|xlsx?|xlsm|xlsb|pptx?|png|jpg|mp3|wav|wma|m4a|ogg|aiff|flac|aac|mp4|webm|wmv|mov|mpeg|avi|mkv|3gp|mpg|zip|gz)$/,z={pdf:"pdf",doc:"doc",docx:"doc",xls:"xls",xlsx:"xls",xlsm:"xls",xlsb:"xls",ppt:"ppt",pptx:"ppt",png:"png",jpg:"jpg",mp3:"multimedia",wav:"multimedia",wma:"multimedia",m4a:"multimedia",ogg:"multimedia",aiff:"multimedia",flac:"multimedia",aac:"multimedia",mp4:"multimedia",webm:"multimedia",wmv:"multimedia",mov:"multimedia",mpeg:"multimedia",avi:"multimedia",mkv:"multimedia","3gp":"multimedia",mpg:"multimedia",zip:"zip",gz:"zip"};r.a.registerHelper("documentIconType",(function(t){return t&&t.toLowerCase().match(R)&&RegExp.$1?z[RegExp.$1]:"blank"})),r.a.registerHelper("getSettingByName",(function(t){return E.default.getSettingByName(t)})),r.a.registerHelper("encodeUrlProfile",(function(t){return t.replace("\\","\\\\")})),r.a.registerHelper("getCommunityLogoUrl",(function(){return this.LogoUrl&&S.default.hasCurrentUserAccesToCommunity(this)?E.default.getBaseSiteHost()+this.LogoUrl:"".concat(E.default.getSiteCollectionUrl(),"/style library/Images/beezy/groupheader.default-image.svg")})),r.a.registerHelper("getCommunityLogoCover",(function(t){var e=S.default.getCommunityLogoUrl(t),i=e.split("/");return"groupheader.default-image.svg"===i[i.length-1]?e:E.default.getDefaultImageThumbnail(e)})),r.a.registerHelper("getBackgroundColorGradient",(function(t){var e=t;return t||(e="0078D7"),Object(j.getBackgroundColorGradient)("#".concat(e))})),r.a.registerHelper("canBePreviewed",(function(t,e){return g.default.canBePreviewed(t)?e.fn(this):e.inverse(this)})),r.a.registerHelper("isNotStandalone",(function(t,e){return 0!==t.indexOf("StandAlone")?e.fn(this):e.inverse(this)})),r.a.registerHelper("add",(function(t,e){return t+e})),r.a.registerHelper("substract",(function(t,e){return t-e})),r.a.registerHelper("checkUrlProtocol",b.default.checkUrlProtocol),r.a.registerHelper("formatURL",(function(t,e){return b.default.isURL(t)?b.default.cutText(t,e):t})),r.a.registerHelper("notificationAction",m.default.getNotificationAction),r.a.registerHelper("getShareFullUrl",m.default.getShareFullUrl),r.a.registerHelper("getNotificationUrl",(function(t){if(t){switch(t.Reason){case I.default.getReason("StoryEditorAdded"):case I.default.getReason("StoryWriterAdded"):return"".concat(E.default.getSiteHost()+E.default.getEditorialModule().Url,"/SitePages/Editorial%20Dashboard.aspx#manage/user");case I.default.getReason("CorporatepageEditorAdded"):case I.default.getReason("CorporatepageWriterAdded"):case I.default.getReason("CorporatepageGuestWriterAdded"):return"".concat(E.default.getSiteHost()+E.default.getCorporateModule().Url,"/SitePages/Dashboard.aspx#manage/user");case I.default.getReason("FollowingUser"):case I.default.getReason("Apps"):return t.activityUrl;case I.default.getReason("CorporatepageApprovalRequest"):return N(t.Activity.Id);default:return m.default.getShareFullUrl(t.Activity,!1,!0)}}})),r.a.registerHelper("getIdeaCampaignEdition",m.default.getIdeaCampaignEdition),r.a.registerHelper("getEmbedlyCssClass",(function(t){return t.toLowerCase().replace(/[^a-z0-9]/g,"-")})),r.a.registerHelper("getSnippetType",(function(t,e){return t===U.default.AttachmentType.VIDEO||t===U.default.AttachmentType.LINK&&e===U.default.AttachmentType.VIDEO?U.default.AttachmentType.VIDEO:t})),r.a.registerHelper("getGroupCreatedDate",(function(){var t;return x.default.getCurrentGroup()?(t=Object(_.getDateStringFromJSON)(x.default.getCreatedDate()),"".concat(Object(_.getMonthName)(t.getMonth())," ").concat(t.getFullYear())):E.default.getProductInstalledDate()?(t=Object(_.getDateStringFromJSON)(E.default.getProductInstalledDate()),"".concat(Object(_.getMonthName)(t.getMonth())," ").concat(t.getFullYear())):""})),r.a.registerHelper("getCommunityHome",(function(){return x.default.getCurrentGroup()?S.default.getGroupUrl():""})),r.a.registerHelper("getCommentCreated",(function(t){return"KnowledgeCenter"===t?Object(f.translate)("This KnowledgeCenter was created in"):"Community"===t?Object(f.translate)("This community was created in"):Object(f.translate)("This network was created in")})),r.a.registerHelper("parseDate",(function(t,e){return t?"string"==typeof t?Object(u.default)(Object(d.default)(Object(h.default)(t))?t:Object(_.getDateStringFromJSON)(t),e):Object(u.default)(Object(d.default)(t)?t:Object(_.getDateStringFromJSON)(t),e):t})),r.a.registerHelper("dateInMilliseconds",(function(t){return t?Object(c.default)(t):t})),r.a.registerHelper("fileSize",(function(t){var e,i,n=parseInt(t,10);if(isNaN(n))return console.error("Handlebars helper fileSize couldn't parse '".concat(t,"'")),t;if(0===(n*=1024))return"< 1 KB";return 0===n?e=i=0:(e=Math.floor(Math.log(n)/Math.log(1e3)),i=(n/Math.pow(1e3,Math.floor(e))).toFixed(e<2?0:1),1===n&&(e=-1)),new r.a.SafeString("".concat(i," ").concat(["byte","bytes","KB","MB","GB"][e+1]))})),r.a.registerHelper("isEnabledOfficePreview",(function(t){return E.default.isOfficePreviewEnabled()?t.fn(this):t.inverse(this)})),r.a.registerHelper("getOfficePreviewUrl",(function(t){return"".concat(E.default.getSiteCollectionUrl(),"/groups/").concat(x.default.getGroupId(),"/_layouts/15/WopiFrame.aspx?sourcedoc=").concat(encodeURIComponent(t))})),r.a.registerHelper("isIE",(function(t){return k.default.isIE?t.fn(this):t.inverse(this)})),r.a.registerHelper("toClassText",(function(t){return b.default.toClassText(t)})),r.a.registerHelper("priorityTask",(function(t){var e=Object(f.translate)("High priority");switch(t){case 1:e=Object(f.translate)("High priority");break;case 2:e=Object(f.translate)("Normal priority");break;case 3:e=Object(f.translate)("Low priority")}return e})),r.a.registerHelper("stateTask",(function(t){var e=Object(f.translate)("Not Started");switch(parseInt(t/25,10)+1){case 1:e=Object(f.translate)("Not Started");break;case 2:e=Object(f.translate)("Started");break;case 3:e=Object(f.translate)("Half-Way");break;case 4:e=Object(f.translate)("Almost Done");break;case 5:e=Object(f.translate)("Done")}return e})),r.a.registerHelper("isMySite",(function(t){return P.default.isProfile()?t.fn(this):t.inverse(this)})),r.a.registerHelper("isNotMySite",(function(t){return P.default.isProfile()?t.inverse(this):t.fn(this)})),r.a.registerHelper("isUserInfoVisible",(function(t,e,i){return P.default.isProfile()?"activityComment"===e?i.fn(this):i.inverse(this):i.fn(this)})),r.a.registerHelper("showFrom",(function(t,e,i,n){var o="";e>i.length&&(e=i.length);for(var s=t;s<e;s++)o+=n.fn(i[s]);return o})),r.a.registerHelper("getFirstAttachmentTitle",(function(t){return t&&t[0]&&t[0].Title&&"string"==typeof t[0].Title?t[0].Title:null})),r.a.registerHelper("truncateNumber",T.default.truncateNumber),r.a.registerHelper("GetUrlGroupSitePages",(function(){return U.default.UrlGroupSitePages})),r.a.registerHelper("IsToolEnabled",(function(t,e){return x.default.isToolEnabled(t)?e.fn(this):e.inverse(this)})),r.a.registerHelper("showFileUploader",(function(t){var e=x.default.getToolsGroup().find((function(t){return"files"===t.Type}));return e.Active&&(e.ReadOnly&&x.default.isCurrentUserWebAdmin()||!e.ReadOnly&&(x.default.isGroupMember()||x.default.isPublic()&&E.default.isPublicCommunitiesOpen())||P.default.isBeezyAdministrator())?t.fn(this):t.inverse(this)})),r.a.registerHelper("redirectRelatedItem",(function(t,e,i,n){return e===U.default.Type.TASK?"".concat(E.default.getBaseSiteHost()+i,"/SitePages/Tasks%20Detail.aspx?ActivityId=").concat(n):e===U.default.Type.CALENDAR?"".concat(E.default.getBaseSiteHost()+i,"/SitePages/Calendar%20Detail.aspx?ActivityId=").concat(n):E.default.isSharepointApp()?E.default.getBaseSiteHost()+t:t})),r.a.registerHelper("isSharepointApp",(function(t){return E.default.isSharepointApp()?t.fn(this):t.inverse(this)})),r.a.registerHelper("IsNotInCommunity",(function(t){return x.default.getCurrentGroup()?t.inverse(this):t.fn(this)})),r.a.registerHelper("myprofileSettings",(function(t){var e=P.default.getCurrentNetwork(),i=void 0!==e,n=E.default.getBaseSiteCollection(),o=i?e.CreateBlogSiteCollection.SiteCollectionUrl:n,s=i?e.CreateWikiSiteCollection.SiteCollectionUrl:n,r=i?e.CreateForumSiteCollection.SiteCollectionUrl:n,a=i?e.CreateCommunitySiteCollection.SiteCollectionUrl:n;return"blog"===t?"".concat(o+U.default.UrlGroupSitePages+encodeURIComponent("Blog settings"),".aspx"):"wiki"===t?"".concat(s+U.default.UrlGroupSitePages+encodeURIComponent("Wiki settings"),".aspx"):"forum"===t?"".concat(r+U.default.UrlGroupSitePages+encodeURIComponent("Forum settings"),".aspx"):"communities"===t?"".concat(a+U.default.UrlGroupSitePages+encodeURIComponent("community settings"),".aspx"):"corporate"===t?"".concat(E.default.getSiteHost()).concat(E.default.getCorporateModule().Url,"/SitePages/Page.aspx"):void 0})),r.a.registerHelper("getSettingsUrl",(function(t){return m.default.getSettingsFullUrl(t)})),r.a.registerHelper("isLocalEntitiesEnabled",(function(t){return E.default.isLocalEntitiesEnabled()?t.fn(this):t.inverse(this)})),r.a.registerHelper("getSiteQuotaDescription",(function(t){return Object(f.sprintf)(t,m.default.convertKbToMb(E.default.getDefaultSiteQuota()))})),r.a.registerHelper("getRoleDescription",(function(t){return v.default.getValueById(t)})),r.a.registerHelper("atLeastOneAuthorIsPublic",(function(t,e){return t.find((function(t){return t.IsPublic}))?e.fn(L):e.inverse(L)})),r.a.registerHelper("isnotNewPublishingDraft",(function(t){return(new A.default).isnewPublishingDraft()?t.inverse(this):t.fn(this)})),r.a.registerHelper("getCreateNewCorporatePageUrl",(function(){var t=E.default.getCorporateModule();return t&&t.Url?encodeURI("".concat(E.default.getBaseSiteHost()).concat(t.Url).concat(U.default.Corporate.createNewPageUrl)):"#"})),r.a.registerHelper("getEditCorporatePageUrl",(function(t){var e=E.default.getCorporateModule();return e&&e.Url?encodeURI("".concat(E.default.getBaseSiteHost()).concat(e.Url).concat(U.default.Corporate.editPageUrl,"/").concat(t)):"#"})),r.a.registerHelper("getEditGuestAuthorCorporatePageUrl",(function(t){var e=E.default.getCorporateModule();return e&&e.Url?encodeURI("".concat(E.default.getBaseSiteHost()).concat(e.Url).concat(U.default.Corporate.editGuestAuthorUrl,"/").concat(t)):"#"})),r.a.registerHelper("getViewCorporatePageUrl",(function(t){return N(t)})),r.a.registerHelper("getViewStoryUrl",(function(t){return function(t){var e=E.default.getEditorialModule();return e&&e.Url?encodeURI("".concat(E.default.getBaseSiteHost()).concat(e.Url).concat(U.default.Editorial.viewDraftUrl,"/").concat(t)):"#"}(t)})),r.a.registerHelper("getDefaultProfileImage",(function(){return E.default.getProfileImage()})),r.a.registerHelper("getDefaultLinkImage",(function(){return E.default.getDefaultLinkImage()})),r.a.registerHelper("getClassIconByType",m.default.getClassIconByType),r.a.registerHelper("getPlaceAccessLiteral",(function(t,e){var i={};i[U.default.Type.COMMUNITY]={Public:"Public Community",Moderated:"Moderated Community",Restricted:"Restricted Community"},i[U.default.Type.STANDALONE_BLOG]={Public:"Public Blog",Moderated:"Moderated Blog",Restricted:"Restricted Blog"},i[U.default.Type.STANDALONE_WIKI]={Public:"Public Wiki",Moderated:"Moderated Wiki",Restricted:"Restricted Wiki"},i[U.default.Type.STANDALONE_FORUM]={Public:"Public Forum",Moderated:"Moderated Forum",Restricted:"Restricted Forum"},i[U.default.Type.CORPORATESITE]={Public:"Public Site",Moderated:"Moderated Site",Restricted:"Restricted Site"};var n=i[e]&&i[e][t];return n?Object(f.translate)(n):"".concat(Object(f.translate)(t)," ").concat(Object(f.translate)(e))})),r.a.registerHelper("getIdForIcon",(function(t){return t.includes("FollowTag_")?"tag":t.toLowerCase()})),r.a.registerHelper("withoutInitialHash",(function(t){return"#"===t.charAt(0)?t.slice(0):t})),r.a.registerHelper("getGroupTypeText",(function(t){return U.default.GroupTypeText[t]})),r.a.registerHelper("getActivityTypeText",(function(t){return U.default.ActivityTypeText[t]})),e.default=r.a},106:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(116),l=i(2),c=i(7),u=a.default.extend({classes:{container:"btn js-button-action ",isLoading:"is-loading",isDisabled:"is-disabled",isError:"is-error",isSuccess:"is-success"},states:{regular:"regular",loading:"loading",errors:"error",success:"success"},init:function(t){this.$el=this.el,this.options=t||{},this.classes=o.a.extend(this.classes,this.options.classes),this.$el.addClass(this.classes.container),this.options.dataTest&&this.$el.attr("data-test","beezy-dialog-".concat(this.options.dataTest)),this._createTextContainer(this.options.html||""),this.$el.html(this.textContainer),this.state=this.states.regular,this.classSpinner=t.classes&&t.classes.classSpinner?t.classes.classSpinner:""},_createTextContainer:function(t){return this.textContainer=r()("<span />").html(t),this.textContainer},render:function(){return this.$el},bindEvents:function(){var t=this;this.$el.on("click",(function(){})),o.a.each(this.options.events,(function(e,i){t.$el.on(i,e)}))},setText:function(t){this.options.html=t,this.$el.html(t)},unbindEvents:function(){var t=this;o.a.each(this.options.events,(function(e,i){t.$el.off(i,e)}))},disable:function(){this.isDisabled=!0,this.$el.addClass(this.classes.isDisabled)},enable:function(){this.isDisabled=!1,this.$el.removeClass(this.classes.isDisabled)},toggleRegular:function(t){var e=this;this.state!==this.states.regular&&(this.state=this.states.regular,this.isDisabled=!1,this.$el.removeClass(this.classes.isLoading),this.$el.removeClass(this.classes.isError),this.$el.removeClass(this.classes.isSuccess),this.$el.removeClass(this.classes.isDisabled),this.textContainer.fadeOut("slow",(function(){var i=e._createTextContainer(t||e.options.html).hide();e.$el.html(i),i.fadeIn("slow")})))},toggleLoading:function(){if(this.state===this.states.loading)this.isDisabled=!1,this.$el.removeClass(this.classes.isLoading),this.$el.removeClass(this.classes.isDisabled),this._createTextContainer(this.options.html||""),this.options.html===Object(l.translate)("Update")&&(this.classSpinner=c.default.Spinners.classWhite),this.$el.html(this.textContainer),this.state=this.states.regular;else{this.isDisabled=!0,this.state=this.states.loading;var t=r()("<span />").addClass("".concat(this.classSpinner," js-spinnerloading spinner-typing--white"));this.options.html===Object(l.translate)("Publish")&&(this.classSpinner=c.default.Spinners.classWhite),this.$el.addClass("".concat(this.classes.isLoading," ").concat(this.classes.isDisabled)),this.$el.html(t)}},toggleError:function(t){this.state===this.states.errors?this.$el.removeClass(this.classes.isError):(this.state=this.states.errors,this.$el.removeClass(this.classes.isDisabled),this._createTextContainer(t||this.options.errorText||Object(l.translate)("Error!")),this.$el.html(this.textContainer).addClass(this.classes.isError))},toggleSuccess:function(t){this.state===this.states.success?this.$el.removeClass(this.classes.isSuccess):(this.state=this.states.success,this._createTextContainer(t||this.options.successText||Object(l.translate)("Success!")),this.$el.html(this.textContainer).addClass(this.classes.isSuccess),this.$el.removeClass(this.classes.isDisabled))},dispose:function(){this.unbindEvents()}});e.default=u},107:function(t,e,i){"use strict";i.r(e);var n=i(27),o=i.n(n),s=i(3),r=i.n(s),a=i(5),l=i(10),c=i(52),u=i(8),d=function(t,e){var i=e[t];return"function"==typeof i?i.call(e):i},h=o.a.Collection.extend({model:c.default.Activity,baseUrl:function(){return a.default.getApiUrlv2()},controller:"",action:"/Activities",filterUrl:"/Search",remaining:!1,filtered:!1,parse:function(t,e){r.a.isArray(t)||(t=[t]);var i=e.data&&e.data.take;return t.length<(i||2)?(this.remaining=!1,t):(this.remaining=!0,t.splice(-1,1),t)},url:function(){var t=d("controller",this),e=this.activityId?"/".concat(this.activityId):d("filterUrl",this);return this.baseUrl()+t+this.action+(this.filtered?e:"")}}),f={getCount:function(){return l.default.get("".concat(this.url,"/Count?discover=true"))}},p=h.extend(r.a.extend({url:function(){return a.default.getApiUrlv2()+(this.filtered?"/Activities/Search":"/Activities?discover=true")}},f)),m=o.a.Collection.extend({initialize:function(t,e){this.options=r.a.defaults(e||{},{skip:0,take:3})},url:function(){return"".concat(a.default.getApiUrlv2(),"/Activities?discover=true")},parse:function(t,e){r.a.isArray(t)||(t=[t]);var i=e.data&&e.data.take;return t.length<(i||3)?(this.remaining=!1,t):(this.remaining=!0,t.splice(-1,1),t)}}),g=h.extend({controller:function(){return this.filtered?"/Groups":"/Communities"}}),v=h.extend({initialize:function(t,e){this.groupId=e.groupId},controller:function(){return"/Groups/".concat(this.groupId)}}),b=h.extend({initialize:function(t,e){if(!e||!e.groupId)throw new Error("TypedActivities: A groupId must be provided");this.skip=0,this.take=20,this.groupId=e.groupId,this.type=e.type,this.orderby=e.orderby||b.ORDERBY.CREATED},url:function(){return"".concat(this.baseUrl(),"/Groups/").concat(this.groupId,"/Activities")},fetch:function(t){var e=b.__super__.fetch;return(t=t||(t={})).data=r.a.extend({type:this.type,orderby:this.orderby,skip:this.skip,take:this.take},t.data),e.call(this,t)}});b.ORDERBY={CREATED:"created",ANSWERED:"answered",BEST_ANSWERED:"bestanswered",LIKES:"likes",VOTES:"votes",ACTIVE:"active"};var y=h.extend({url:function(){return"".concat(a.default.getApiUrlv2(),"/Follows")}}),C=h.extend({baseUrl:function(){return u.default.getGroupServiceV2Url()},activityDetailUrl:"/Activities",activityCommentDetailUrl:"/Activities/Comments",url:function(){return this.activityId?"".concat(a.default.getApiUrlv2()+this.activityDetailUrl,"/").concat(this.activityId):this.commentId?"".concat(a.default.getApiUrlv2()+this.activityCommentDetailUrl,"/").concat(this.commentId):C.__super__.url.call(this)}}),w=h.extend({baseUrl:function(){return u.default.getGroupServiceV2Url()},url:function(){return"".concat(a.default.getApiUrlv2(),"/Activities/").concat(this.activityId,"/Files/").concat(this.attachmentId)}}),T=C.extend({baseUrl:function(){return u.default.getGroupServiceV2Url()},filterUrl:function(){return this.filteredByTerm?"":"/Search"}}),x={getCount:function(){return l.default.get("".concat(this.url,"/Count"))}},O=h.extend(r.a.extend({url:function(){return a.default.getApiUrlv2()+(this.filtered?"/Activities/Search":"/Users/Current/Following/Activities")}},x)),S=h.extend(r.a.extend({url:function(){return"".concat(u.default.getGroupServiceV2Url(),"/Activities/Follow")}},x)),I=h.extend(r.a.extend({url:function(){return"".concat(u.default.getGroupServiceV2Url(),"/Activities/Follow")}},x)),A=h.extend(r.a.extend({url:function(){return a.default.getApiUrlv2()+(this.filtered?"/Activities/Search":"/Users/Current/Bookmarks")}},x)),k=h.extend(r.a.extend({url:function(){return a.default.getApiUrlv2()+(this.filtered?"/Activities/Search":"/Users/Current/ExternalTasks")}},x));e.default={Activities:h,Communities:g,StickyAnnouncements:v,TypedActivities:b,Colleagues:y,Community:C,KnowledgeCenter:T,CountBehavior:x,Follows:O,Bookmarks:A,Tasks:k,FollowTag:I,MyBookmarks:S,Discover:p,DiscoverNewContent:m,Document:w}},109:function(t,e,i){publicPathAssets;i.p=publicPathAssets},110:function(t,e,i){"use strict";i.r(e);var n=i(1),o=i.n(n),s=i(50),r=i.n(s),a=i(2457),l=i(1456),c=i(2462),u=i.n(c);i(3327);u()();var d=Object(l.default)({id:"as-custom-properties"});r.a.render(o.a.createElement(a.default,null),d)},1104:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n);function s(){}/(Documents|Videos|Slideshows|Links)\.aspx$/.test(document.location.href)&&null!=document.getElementById("breadcrumb")&&(document.getElementById("breadcrumb").style.display="none");var r=window.console,a=Array.prototype.slice,l=["debug","dir","error","group","groupCollapsed","groupEnd","info","log","time","timeEnd","trace","warn"],c=l.length,u={log_errors:!1};function d(t){return function(){var e;u.log_errors&&(e=r)[t].apply(e,o()(a.call(arguments)))}}if(void 0===r){for(r={};c--;)r[l[c]]=s;window.console=r}else for(;c--;)void 0===r[l[c]]&&(r[l[c]]=s);u.error=d("error"),u.warn=d("warn"),u.info=d("info"),u.debug=d("debug"),u.log=d("log"),u.exception=function(t){var e=t.stack;e||(e=[t.message," (",t.type||t.name,", ",(t.arguments||[]).join("-"),")"].join("")),u.log(e,[].slice.call(arguments,1))},e.default=u},1105:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(7),r=i(2),a=i(169);function l(t){this.activity=t}l.prototype={hasAttachments:function(){return this.activity.Attachments&&this.activity.Attachments.length},hasAttachmentsFromType:function(t){return this.hasAttachments()&&o.a.some(this.activity.Attachments,(function(e){return o.a.isArray(t)?o.a.contains(t,e.Type):e.Type===t}))},getAttachmentsFromType:function(t){return o.a.find(this.activity.Attachments,(function(e){return e.Type===t}))},getFirstAttachmentFromType:function(t){var e=a.default.Snippets.removeNotAllowedProvidersLinks(this.activity.Attachments);return o.a.isArray(t)?o.a.find(e,(function(e){return o.a.some(t,(function(t){return e.Type===t}))})):o.a.findWhere(e,{Type:t})},getTimeago:function(t,e){this.activity.Type===s.default.Type.SHARE?t.timeago(e).prepend("".concat(Object(r.translate)("Shared")," ")):t.timeago(e)},isActivityOwner:function(t){return!!this.activity.Owner&&t.Id===this.activity.Owner.Id},isGroupOwner:function(){return this.activity&&this.activity.Group&&this.activity.Group.IsCurrentUserWebAdmin}},e.default=l},1108:function(t,e,i){"use strict";i.d(e,"getGraphAuthHandlerUrl",(function(){return s}));var n=i(5),o=i(127);function s(){var t="".concat(n.default.getUrlLayout(),"/Spenta.Beezy/UserGraphApiRedirectHandler.ashx");return Object(o.default)(t).replace(/^http:\/\//i,"https://")}},111:function(t,e,i){"use strict";i.r(e);var n=i(82),o=i.n(n),s=i(5),r=i(268),a=i(30),l=i(38),c=i(4),u=i.n(c),d=i(28),h=i(12),f=i(56),p=i(7),m=i(1157),g=i(1926),v=i(387),b=i(2),y=(i(112),i(261)),C=i(2463),w=i(53),T=i(281),x=i(696);function O(){var t=s.default.startPageUrl(),e=document.querySelector("#js-beezy-ribbon-open-app");function i(t,e){var i,n="is-block";t.mouseenter((function(){i=setTimeout((function(){return e.addClass(n)}),300)})).mouseleave((function(){clearTimeout(i),e.removeClass(n)}))}if(e&&window.innerWidth<=480&&l.default.renderComponent(e,C.default,{ribbonOpenAppContainer:"#js-beezy-ribbon-open-app"}),function(){var t=Object(a.sharePointItems)(),e=t.topBar,n=t.topBarCloud,s=t.ribbon,r=t.mainContainer,l=Object(x.default)("DisplayMode"),c=o()(l,1)[0];if((void 0!==e.get(0)||void 0!==n.get(0))&&"Design"!==c){s.addClass("is-hidden"),r.addClass("is-ribbon-hidden"),void 0!==e.get(0)&&i(e,s),void 0!==n.get(0)&&i(n,s)}}(),document.getElementById("DeltaSiteLogo")){var n=Object(w.sprintf)({string:Object(b.translate)("%applicationTitle home"),replacements:[s.default.getApplicationTitle()],pattern:/%applicationTitle/gi}),c=document.querySelector("#DeltaSiteLogo > a > img");if(c&&(c.alt=n),t&&t.length){var d=document.querySelector("#DeltaSiteLogo > a");d&&(d.href=t)}}var O={people:f.default.askForPeopleNotificationCount(),hashtags:f.default.askForHashtagsNotificationCount()},S={People:0,Hashtags:[],Notifications:0},I=!1;function A(t){l.default.unMountComponent(t)}function k(t){A(t);var e=Object(T.createModalContainer)({id:"modal-privacy-warning"}),i={modalElem:e,onClose:function(){return A(e)},onConfirm:function(){return function(t){A(t),window.location.href="".concat(s.default.getBaseSiteCollection(),"/_layouts/closeConnection.aspx?loginasanotheruser=true")}(e)},show:!0};l.default.renderComponent(e,y.Privacy,i)}"base"===beezyContext.CurrentPageKey&&u()(document).ready((function(){u()("#js-beezy-publishingcontent").length&&u()("#js-beezy-publishingcontent").show()})),f.default.getNotifications(!1,O.people,O.hashtags),h.default.subscribe("notifications","more",(function(t){S=t,I=!0})),h.default.subscribe("notifications","getNotificationsObject",(function(){I&&h.default.publish("notifications","more",S)})),h.default.subscribe("activity","reported",(function(){var t=Object(b.translate)("The content on this page has been reported and is currently under review");throw new v.default({el:Object(a.getSharePointItem)("content"),iconClass:"icon--empty-reported-content",title:Object(b.translate)("Reported content"),text:t,showButton:!0}).render(),new Error(t)})),h.default.subscribe("activity","deleted",(function(){var t=Object(b.translate)("This content has been deleted and is no longer available");throw new v.default({el:Object(a.getSharePointItem)("content"),iconClass:"icon--empty-deleted-content",title:Object(b.translate)("Deleted content"),text:t,showButton:!0}).render(),new Error(t)})),h.default.subscribe("page","unauthorized",(function(){var t=Object(b.translate)("You do not have permissions to access this page. If you believe that this is an error, please contact your system administrator.");throw new v.default({el:Object(a.getSharePointItem)("content"),iconClass:"icon--access-denied",title:Object(b.translate)("Access denied"),text:t,showButton:!0,buttonText:Object(b.translate)("Go to home")}).render(),new Error(t)})),h.default.subscribe("page","not_found",(function(){var t=Object(b.translate)("The page you are looking for does not exist anymore or an error ocurred.");throw new v.default({el:Object(a.getSharePointItem)("content"),iconClass:"icon--error-404",title:Object(b.translate)("Oops! Page not found"),text:t,showButton:!0,buttonText:Object(b.translate)("Go to home")}).render(),new Error(t)})),h.default.subscribe("page","unknown_error",(function(){var t=Object(b.translate)("This page cannot be displayed. Please try it again and if the problem persists please contact your system administrator.");throw new v.default({el:Object(a.getSharePointItem)("content"),iconClass:"icon--error-generic",title:Object(b.translate)("Something went wrong"),text:t,showButton:!0,buttonText:Object(b.translate)("Go to home")}).render(),new Error(t)})),h.default.subscribe("readonly","showLoginModal",(function(){var t=Object(T.createModalContainer)({id:"modal-account-limitation"}),e={modalElem:t,onClose:function(){return A(t)},onConfirm:function(){return k(t)},show:!0};l.default.renderComponent(t,y.AccountLimitation,e)})),r.default.delayCallback((function(){m.default.existIMNControl()&&m.default.processPresenceIndicators()}),p.default.delayProcessPresenceIndicator),r.default.delayCallback((function(){Object(g.default)()}),p.default.delayRenderScrollToTop),window.SetDefaultUserProfileImage=function(t){t.onerror=null,t.src=s.default.getProfileImage()},setInterval((function(){f.default.getNotifications(!1,O.people,O.hashtags)}),f.default.notificationInterval)}d.default.addEntryPoint(O),e.default=O},113:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(3),s=i.n(o),r=i(26),a=i(10),l=r.default.extend({urlRoot:function(){return"".concat(n.default.getApiUrlv2(),"/Groups")},idAttribute:"GroupId",sync:function(t,e,i){return"update"===t?n.default.isSharepointApp()&&e.get("ParentJobId")?s.a.extend(i,{url:"".concat(n.default.getApiUrlv2(),"/GroupsAsync")}):s.a.extend(i,{url:"function"==typeof this.urlRoot?this.urlRoot():this.urlRoot}):"read"===t?s.a.extend(i,{url:"".concat(this.urlRoot(),"/").concat(this.id,"/ExtendedEdit")}):"create"===t&&n.default.isSharepointApp()&&s.a.extend(i,{url:"".concat(n.default.getApiUrlv2(),"/GroupsAsync")}),l.__super__.sync.call(this,t,e,i)},setQuota:function(t){var e=this.urlRoot;this.urlRoot="".concat(this.urlRoot(),"/Quota"),this.save("Quota",t),this.urlRoot=e},getAdministrators:function(){return this.get("Administrators")},join:function(){return this.has("IsCurrentUserMember")&&!this.get("IsModerated")&&this.set("IsCurrentUserMember",!0),a.default.get("".concat(this.url(),"/join"))},requestMembership:function(){if(this.has("IsCurrentUserMember")&&!this.get("IsModerated"))return a.default.get("".concat(this.url(),"/join"))},leave:function(){return this.has("IsCurrentUserMember")&&this.set("IsCurrentUserMember",!1),a.default.get("".concat(this.url(),"/leave"))},getDetailUrl:function(){return this.Url},getOwner:function(){return""},checkStatus:function(t){return a.default.get("".concat(n.default.getApiUrlv2(),"/AsyncTask/").concat(t,"/Status"))},getCommunity:function(t){return a.default.get("".concat(n.default.getApiUrlv2(),"/AsyncTask/").concat(t,"/Community"))}});e.default=l},1132:function(t,e,i){"use strict";i.r(e),i.d(e,"BlogsSidebar",(function(){return d})),i.d(e,"BlogsCollection",(function(){return h})),i.d(e,"SearchBlogsCollection",(function(){return f}));var n=i(5),o=i(3),s=i.n(o),r=i(27),a=i.n(r),l=i(10),c=i(1316),u=i(79),d=a.a.Collection.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Blogs/Navigation")},initialize:function(t,e){this.options=s.a.defaults(e||{},{skip:0,take:100})},fetch:function(t){return(t=t||{}).data=s.a.extend({skip:this.options.skip,take:this.options.take},t.data),d.__super__.fetch.call(this,t)}}),h=u.default.extend({model:c.default,currentData:{start:"",end:"",orderby:"",userId:"",hashtag:"",type:"",text:"",grouptype:""},initialize:function(t,e){e=e||{},this.skip=e.skip||0,this.take=e.take||3,this.hashtag=e.hashtag||"",this.userId=e.user||"",this.start=e.currentData.start||0,this.end=e.end||0,this.orderby=e.currentData.orderby||"",this.currentData=s.a.extend(this.currentData,e.currentData||{}),this.itemsPerPage=e.itemsPerPage||15,this.text=e.text||"",this.grouptype=e.grouptype||""},fetch:function(t){return t=s.a.extend({data:{skip:this.skip,take:this.take,hashtag:this.hashtag,userId:this.userId,start:this.start,end:this.end,orderby:this.orderby,text:this.text,grouptype:this.grouptype}},t),h.__super__.fetch.call(this,t)},url:function(){return"".concat(n.default.getApiUrlv2(),"/BlogPosts")},getParameters:function(){return{start:new Date,end:new Date}},getTotalCount:function(){return l.default.get("".concat(this.url(),"/Count"),this.getParameters())},more:function(){return this.currentData.skip+=this.currentData.take,this.fetch({update:!0,remove:!1})},changeDates:function(t){return this.currentData.start=t,this.start=this.currentData.start,this.fetch({remove:!0})},setFilter:function(){this.currentData.skip=0},setHashtag:function(t){this.currentData.hashtag=t},reset:function(){this.setHashtag(""),this.filtered=!1}}),f=h.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/BlogPosts/Search")},setFilter:function(t){this.text=t.text,this.currentData.text=t.text}})},1133:function(t,e,i){"use strict";i.r(e),i.d(e,"ForumsSidebar",(function(){return d})),i.d(e,"ForumsCollection",(function(){return h})),i.d(e,"SearchForumsCollection",(function(){return f}));var n=i(5),o=i(3),s=i.n(o),r=i(27),a=i.n(r),l=i(10),c=i(1317),u=i(79),d=a.a.Collection.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Forums/Navigation")},initialize:function(t,e){this.options=s.a.defaults(e||{},{skip:0,take:100})},fetch:function(t){return(t=t||{}).data=s.a.extend({skip:this.options.skip,take:this.options.take},t.data),d.__super__.fetch.call(this,t)}}),h=u.default.extend({model:c.default,currentData:{start:"",end:"",orderby:"",userId:"",hashtag:"",type:"",text:"",grouptype:""},initialize:function(t,e){e=e||{},this.skip=e.skip||0,this.take=e.take||3,this.hashtag=e.hashtag||"",this.userId=e.user||"",this.start=e.currentData.start||0,this.end=e.end||0,this.orderby=e.currentData.orderby||"",this.currentData=s.a.extend(this.currentData,e.currentData||{}),this.itemsPerPage=e.itemsPerPage||15,this.text=e.text||"",this.grouptype=e.grouptype||""},fetch:function(t){return t=s.a.extend({data:{skip:this.skip,take:this.take,hashtag:this.hashtag,userId:this.userId,start:this.start,end:this.end,orderby:this.orderby,text:this.text,grouptype:this.grouptype}},t),h.__super__.fetch.call(this,t)},url:function(){return"".concat(n.default.getApiUrlv2(),"/Discussions")},getParameters:function(){return{start:new Date,end:new Date}},getTotalCount:function(){return l.default.get("".concat(this.url(),"/Count"),this.getParameters())},more:function(){return this.currentData.skip+=this.currentData.take,this.fetch({update:!0,remove:!1})},changeDates:function(t){return this.currentData.start=t,this.start=this.currentData.start,this.fetch({remove:!0})},setFilter:function(){this.currentData.skip=0},setHashtag:function(t){this.currentData.hashtag=t},reset:function(){this.setHashtag(""),this.filtered=!1}}),f=h.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Discussions/Search")},setFilter:function(t){this.text=t.text,this.currentData.text=t.text}})},1134:function(t,e,i){"use strict";i.r(e),i.d(e,"WikisSidebar",(function(){return d})),i.d(e,"WikisCollection",(function(){return h})),i.d(e,"SearchWikisCollection",(function(){return f}));var n=i(5),o=i(3),s=i.n(o),r=i(27),a=i.n(r),l=i(10),c=i(1318),u=i(79),d=a.a.Collection.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Wikis/Navigation")},initialize:function(t,e){this.options=s.a.defaults(e||{},{skip:0,take:100})},fetch:function(t){return(t=t||{}).data=s.a.extend({skip:this.options.skip,take:this.options.take},t.data),d.__super__.fetch.call(this,t)}}),h=u.default.extend({model:c.default,currentData:{start:"",end:"",orderby:"",userId:"",hashtag:"",type:"",text:"",grouptype:""},initialize:function(t,e){e=e||{},this.skip=e.skip||0,this.take=e.take||3,this.hashtag=e.hashtag||"",this.userId=e.user||"",this.start=e.currentData.start||0,this.end=e.end||0,this.orderby=e.currentData.orderby||"",this.currentData=s.a.extend(this.currentData,e.currentData||{}),this.itemsPerPage=e.itemsPerPage||15,this.text=e.text||"",this.grouptype=e.grouptype||""},fetch:function(t){return t=s.a.extend({data:{skip:this.skip,take:this.take,hashtag:this.hashtag,userId:this.userId,start:this.start,end:this.end,orderby:this.orderby,text:this.text,grouptype:this.grouptype}},t),h.__super__.fetch.call(this,t)},url:function(){return"".concat(n.default.getApiUrlv2(),"/WikiPages")},getParameters:function(){return{start:new Date,end:new Date}},getTotalCount:function(){return l.default.get("".concat(this.url(),"/Count"),this.getParameters())},more:function(){return this.currentData.skip+=this.currentData.take,this.fetch({update:!0,remove:!1})},changeDates:function(t){return this.currentData.start=t,this.start=this.currentData.start,this.fetch({remove:!0})},setFilter:function(){this.currentData.skip=0},setHashtag:function(t){this.currentData.hashtag=t},reset:function(){this.setHashtag(""),this.filtered=!1}}),f=h.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/WikiPages/Search")},setFilter:function(t){this.text=t.text,this.currentData.text=t.text}})},1154:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(1899),r=i(7),a=s.default,l={PRAISES:a.Praise,STORY:a.Story,CORPORATEPAGE:a.CorporatePage,DOCUMENT:a.Document,ITEM:a.Item,DELETED:a.Deleted,DELETED_APP:a.DeletedApp,SHARE_APP:a.ShareApp};e.default={getViewByType:function(t){var e=null;o.a.some(r.default.Type,(function(i,n){if(i===t)return e=n,!0}));var i=l[e];return i||(i=a.Activity),i}}},1157:function(t,e,i){"use strict";var n=i(195),o=i(1663),s=i(4),r=i.n(s),a=i(7),l=i(5),c={tmpl:"",id:"",getOnClickPresence:function(){return l.default.isSharepointApp()?"":'onclick="IMNImageOnClick(event);return false;"'},getImage:function(t){return this.getTmpl(),this.muTmpl(this.tmpl,{src:n.default.getAbsoluteURL("".concat(l.default.getUrlLayout(),"/images/imnhdr.gif")),id:"imn_".concat(o.default.guid(),",type=sip"),sip:t||""})},muTmpl:function(t,e){for(var i in e)t=t.replace(new RegExp("{".concat(i,"}"),"g"),e[i]);return t},getTmpl:function(){this.tmpl=['<span class="ms-imnSpan">',"<a ".concat(this.getOnClickPresence(),' class="ms-imnlink ms-spimn-presenceLink" >'),'<span class="ms-spimn-presenceWrapper ms-imnImg ms-spimn-imgSize-10x10"><img name="imnmark" title="" ShowOfflinePawn="1" class="ms-spimn-img ms-spimn-presence-disconnected-10x10x32" src="'.concat(beezySettings.BaseSiteCollectionUrl,'/_layouts/15/images/spimn.png?rev=23" alt="presence pawn for" sip="{sip}" id="{id}" />'),"</span>","</a>","</span>"].join(""),this.id="imn_".concat(o.default.guid(),",type=sip")},getPresenceIndicatorsInPage:function(){return Array.from(document.getElementsByName("imnmark"))},processPresenceIndicators:function(){var t=this,e=this.getPresenceIndicatorsInPage();window.PresenceIndicatorControl.OnStatusChange=function(i,n){t.changePresenceUserInPage(e,i,n)},e.forEach((function(t){var e=t.getAttribute("sip");window.PresenceIndicatorControl.GetStatus(e,"1");var i=r()(t);i.off("mouseover").on("mouseover",(function(){window.PresenceIndicatorControl.ShowOOUI(e,0,0,0)})),i.off("mouseout").on("mouseout",(function(){window.PresenceIndicatorControl.HideOOUI()})),i.off("click").on("click",(function(){window.PresenceIndicatorControl.ShowOOUI(e,0,0,0),window.PresenceIndicatorControl.DoAccelerator()}))}))},changePresenceUserInPage:function(t,e,i){var n=this,o=document.querySelectorAll('[sip="'.concat(e,'"]'));[].forEach.call(o,(function(t){return n.changePresenceIndicator(t,i)}))},changePresenceIndicator:function(t,e){var i=a.default.ClassesPresenceIndicatorByStatus[e];t.className="",t.className=i||"ms-spimn-img ms-spimn-presence-disconnected-10x10x32"},existIMNControl:function(){return"undefined"!=typeof PresenceIndicatorControl&&null!==PresenceIndicatorControl&&void 0!==PresenceIndicatorControl.PresenceEnabled}};e.default=c},1158:function(t,e,i){"use strict";var n=i(3),o=i.n(n),s=i(13),r=i(2467),a=i.n(r),l=i(18),c=s.default.extend({events:{"click .js-view-more":"showMore"},initialize:function(t){this.options=t||{},this.template=t.template||a.a,this.context=o.a.extend(this.options.context,this.options.options)},render:function(){var t=this;!this.options.usingContext&&this.collection?(this.$el.append(this.template(this.context)),this.collection.then((function(e){e.length>0?(t.context.Items=e,t.context.withoutDiv=!0,t.$el.find("#".concat(t.context.idSelector)).html(t.template(t.context))):t.$el.find("#".concat(t.context.idSelector)).remove()})).fail((function(){t.$el.find("#".concat(t.context.idSelector)).remove()}))):this.$el.append(this.template(this.context))},showMore:function(t){t.preventDefault(),t.stopPropagation(),l.default.redirectToUrl(this.context.ShowMoreLink)}});e.default=c},116:function(t,e,i){"use strict";i.r(e);var n=i(98),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(310);function u(){var t=[].slice.call(arguments).pop();this.classes=l.a.clone(this.classes||{}),this.options="object"===o()(t)?t:{},this.hidden=this.options.hidden,this.el=this.options.el||this.el||r()("<div/>"),this.setClasses(this.options.classes||{}),this.init.apply(this,arguments)}u.prototype={init:function(){},setClasses:function(t){l.a.extend(this.classes,t)},setParent:function(t){this.el=t},show:function(){this.hidden&&(this.emit("show"),this.el.show(),this.hidden=!1,this.emit("visible"))},hide:function(){this.hidden||(this.emit("hide"),this.el.hide(),this.hidden=!0,this.emit("invisible"))},borderBoxWidth:function(){return this._borderBoxWidth||(this._borderBoxWidth=this.el.outerWidth()-this.el.width()),this._borderBoxWidth},borderBoxHeight:function(){return this._borderBoxHeight||(this._borderBoxHeight=this.el.outerHeight()-this.el.height()),this._borderBoxHeight},dispose:function(){},data:function(t){l.a.each(t,(function(t,e){this.el.attr("data-".concat(e),t)}),this)}},c.default.mixin(u.prototype),u.extend=function(t){var e,i=this;e=t&&Object.prototype.hasOwnProperty.call(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},l.a.extend(e,i);var n=function(){this.constructor=e};return n.prototype=i.prototype,e.prototype=new n,t&&l.a.extend(e.prototype,t),e.__super__=i.prototype,e},e.default=u},117:function(t,e,i){"use strict";i.r(e);var n,o,s=i(4),r=i.n(s),a="placeholder",l=a in document.createElement("input"),c=function(t){this._$placeholderInput.attr(a,t)},u=function(){this._$placeholderInput.removeAttr(a)},d=function(){var t=r()(this);t.val()===t.attr(a)&&t.hasClass(a)&&(t.val(""),t.removeClass(a))},h=function(){var t=r()(this);t.val().length||t.val(t.attr(a)).addClass(a)},f=function(t){return!!t.attr(a)},p=function(t){var e=this._$placeholderInput;f(e)||(e.attr(a,t),e.val(t).addClass(a),e.on("focus",d),e.on("blur",h))},m=function(){var t=this._$placeholderInput;f(t)&&(t.removeAttr(a),t.removeClass(a),t.off("focus",d),t.off("blur",h))},g={setInput:function(t){this._$placeholderInput=t instanceof r.a?t:r()(t)}},v=function(){var t=this._$placeholderInput;t.blur(),t.focus()};l?(n=c,o=u,v=function(){},p=m=null,d=h=null):(n=p,o=m,c=u=null),g.mixin=function(t){t.setInput=this.setInput,t.setPlaceholder=n,t.clearPlaceholder=o,t.focus=v},g.create=function(t){var e={setPlaceholder:n,clearPlaceholder:o,focus:v};return this.setInput.call(e,t),e},e.default=g},1181:function(t,e,i){"use strict";e.default={container:"bz-container--Up4qI",button:"bz-button--Up4qI","tools__icon--more":"bz-tools__icon--more--Up4qI","is-open":"bz-is-open--Up4qI"}},119:function(t,e,i){"use strict";var n=i(1437);i.d(e,"getCurrentUserLocalEntity",(function(){return n.default}));var o=i(2040);i.d(e,"isCurrentUser",(function(){return o.default}));var s=i(2041);i.d(e,"isCurrentUserReadOnly",(function(){return s.default}))},12:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(3),r=i.n(s),a={publish:function(t,e,i){var n=r.a.toArray(arguments).slice(2);i=["".concat(t,":").concat(e)].concat(n),this.emit.apply(this,o()(i))},subscribe:function(t,e,i,n,o){o?this.onByKey("".concat(t,":").concat(e),i,n,o):this.on("".concat(t,":").concat(e),i,n)}};i(310).default.mixin(a),e.default=a},121:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(4),s=i.n(o),r=i(28),a=i(47),l=i(19),c=i.n(l);function u(){}u.prototype={init:function(){s()(document).ready((function(){if(null!==beezyContext){if(!n.default.isLicenseValid()&&"settings"!==beezyContext.CurrentPageKey)return void 0!==window.contentLoader&&window.contentLoader.clearCacheObject("beezySettings"),void a.default.showLicenseError();if(null===beezyCurrentUser||!beezyCurrentUser.IsActive){if(-1!==window.location.hash.indexOf("1"))return void a.default.showNoUserError();window.location.href="".concat(window.location,"#1"),window.location.reload()}!beezyCurrentUser.EulaAccepted&&n.default.isEnableTermsOfUse()&&a.default.showEulaDisclaimer()}else a.default.showGenericError()}))}},r.default.addEntryPoint((function(t,e){c.a.all([t.promise,e.promise]).then((function(){(new u).init(t,e)}))}),["beezySettings","beezyCurrentUser"],1),e.default=u},1217:function(t,e,i){"use strict";i.r(e);var n=i(57),o=i(310),s=i(1759),r=i(2),a=i(47),l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.view=new s.default({el:a.default.createDialogContainer("js-metadata-selection"),groupId:t.groupId}).render();e.on("close",(function(){this.dialog.hide()}),this),e.on("save",(function(e){t.onSaveTermsDialog&&t.onSaveTermsDialog(e),this.dialog.hide()}),this),this.dialog=new n.default(e,{extend:{width:600},title:Object(r.translate)("Choose tags"),buttons:[]}),this.dialog.onBeforeClose((function(t){e.onClose()||t.preventDefault()}))};l.prototype={show:function(){this.dialog.show()},ready:function(){return this.view.ready()},reset:function(){this.view.reset()},getView:function(){return this.view},getDialog:function(){return this.dialog},addTermExternal:function(t){this.view.addTermExternal(t)},removeTermExternal:function(t){this.view.removeTermExternal(t)}},o.default.mixin(l.prototype),e.default=l},123:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(5),l=i(295),c=i(37),u=i(18),d=i(51),h=i(189),f=i(273),p=i(497),m=i(222),g=i(195),v=i(15),b=i(17),y=i(2),C=i(13),w=i(95),T=i(2426),x=i.n(T),O=i(773),S=i(173),I=i(234),A=i(267),k=i(151),P=i(142),E=i(7),_=i(8),j=i(78),D=C.default.extend({template:x.a,tagName:"li",events:{"click .js-owner-name":"showProfile","click .js-activity":"goToActivity","hover .js-more":"getOwners","click .js-more":"showOwnersDialog"},initialize:function(t){t=t||{},this.template=t.template||this.template,this.month=t.month||"",this.feedType=t.feedType,this.titleLines=t.titleLines||3,this.bodyLines=t.bodyLines||3,this.classes=t.classes||"bordered-padded-container feed-list__item feed-list__item--extra-margin-bottom feed-list__item--".concat(this.feedType),this.context=this.model.attributes,this.showSnippetFeed=t.showSnippetFeed||!1,this.showTools=!t.model.get("IsPublic")&&!t.model.get("IsCurrentUserMember"),this.noTools=t.noTools||!1,this.hideDotDotDot=t.hideDotDotDot||!1,this.lcid=this.model.get("LCID")||p.beezyDefaultLanguage.lcid,t.isCard&&r.a.extend(this.context,{isCard:!0}),this.initializeFeedTools(t),"poll"===this.feedType&&(this.model.set({Comments:null}),this.initializePolls(),this.addTmplAttribute("pollButtonText",v.default.isReadOnly()?this.texts.votes:this.texts.resultsInit)),this.timezoneDefault=_.default.getGroupTimezone(),this.timeDifferenceUTCLocal=(new Date).getTimezoneOffset()/-60},getTitle:function(){return this.feedType===E.default.Type.POLL?this.model.get("Message"):this.feedType!==E.default.Type.CORPORATEPAGE||this.model.get("Title")?this.model.get("Title"):Object(y.translate)("Page title")},getDetailUrl:function(){if(this.feedType===E.default.Type.CORPORATEPAGE&&!this.model.get("IsPublished")){var t=this.model.get("Id");return t?"".concat(a.default.getSiteHost()).concat(a.default.getCorporateModule().Url).concat(E.default.Corporate.viewDraftUrl,"/").concat(t):""}return this.model.getDetailUrl()},render:function(){var t=this.model.get("Activity"),e=r.a.extend(this.model.toJSON(),{Title:this.getTitle(),Message:this.model.get("Message"),PostDetailUrl:this.getDetailUrl(),Month:this.model.getMonth?this.model.getMonth():void 0,feedType:this.feedType,showUserProfile:this.showUserProfile(),showToolsArea:this.showToolsArea(),TotalOfTags:"function"!=typeof this.model.getNumberTags?0:this.model.getNumberTags(),showTools:this.showTools,hideDotDotDot:this.hideDotDotDot||!1,isReadOnly:v.default.isReadOnly(),languageCode:Object(f.getBeezyLanguageByLCID)(this.lcid).code});this.context.TotalOfTags=e.TotalOfTags,o()(".js-tag-count").attr("aria-label",this.context.TotalOfTags?Object(y.sprintf)(Object(y.translate)("%d tags"),this.context.TotalOfTags):""),t&&e.TotalOfTags&&(t.TotalOfTags=e.TotalOfTags),e.Type===E.default.Type.DOCUMENT&&e.Activity.Type===E.default.Type.QUESTION&&(e.Activity.Type=E.default.Type.DOCUMENT),e.Type===E.default.Type.POLL&&(e.TotalOfVotes=l.default.getTotalOfPeopleVoted(e));var i=Object(h.getUserTimeZone)(),n=this.timezoneDefault.IanaTimezoneName,s=Object(h.getOffset)(n)/1e3/3600;if(e.Type===E.default.Type.CALENDAR){var a=r.a.extend(e,{DateTimeFrom:Object(d.createDateUTC)(e.DateTimeFrom,n),DateTimeTo:Object(d.createDateUTC)(e.DateTimeTo,n),DateTimeFromUTC:Object(h.getLocalDateFromJSON)(e.DateTimeFrom),DateTimeLocalFrom:Object(d.createDateUTC)(e.DateTimeFrom,i),DateTimeLocalTo:Object(d.createDateUTC)(e.DateTimeTo,i),Month:Object(d.getFormattedDate)(e.DateTimeFrom,"MMM")});this.$el.html(this.template(a));var u=this.timezoneDefault.TotalHours>0?"+":"",p={el:this.$el.find(".js-timechange"),dateTimeFromLocal:Object(d.createDateUTC)(this.model.get("DateTimeFrom"),i).format("HH:mm"),dateTimeToLocal:Object(d.createDateUTC)(this.model.get("DateTimeTo"),i).format("HH:mm"),timezoneDescription:this.timezoneDefault.Description.split(") ")[1],timezone:"(UTC ".concat(u).concat(s,")"),localTimezone:Object(d.getStringLocalTimezone)(),dateTimeFromCommunity:a.DateTimeFrom.format("HH:mm"),dateTimeToCommunity:a.DateTimeTo.format("HH:mm"),localTimeZoneRegion:Object(h.getUserTimeZone)(),localTimeUTC:Object(h.getOffset)(i)/1e3/3600};this.timezoneTooltip=this.initializeTimezoneTooltip(p)}else if(e.Type===E.default.Type.STORY){var C=g.default.applyOriginalOrCroppedImage(e,m.DESKTOP.regularCard.key);this.$el.html(this.template(C))}else this.$el.html(this.template(e));if(this.$el.addClass(this.classes),this.noTools||this.renderTools(this.options.tools),e.Type===E.default.Type.CORPORATEPAGE){if(e.Hashtags&&e.Hashtags.length>0)this.$(".js-tag-count").text(Object(y.sprintf)(Object(y.translate)("%d tags"),e.Hashtags.length));if(e.Views&&e.Views>0)this.$(".js-views-count").text(Object(y.sprintf)(Object(y.translate)("%d views"),e.Views))}if(this.createTooltip(),this.$commentsCount=this.viewRegion("comments-count"),S.default.applyColors(this.$el,this._getColor()),"mysite"===beezyContext.CurrentPageKey){var T=this.model.getOwner();if(T){var x=this.$(".author-name").get(0);w.default.create(x,x,this.$(".js-quickprofile"),b.default.saveUser(T)),this.showUserProfile()&&w.default.create(this.$(".js-owner-name").get(0),b.default.saveUser(T),{hAlign:E.default.DropPosition.LEFT})}}return this.ownersTooltip=new c.default({el:this.$(".js-more").get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.ActivityTooltip=new c.default({el:this.$(".js-activity"),text:Object(y.translate)("Read conversation"),horizontalPosition:"right"}),this.showSnippetFeed&&this.loadSnippet(this.model),e.tools.timeago&&this.$(".activity-tools-time-ago").timeago(),this},initializeTimezoneTooltip:function(t){var e=t.localTimeUTC,i=t.el,n=t.localTimeZoneRegion,o=t.dateTimeFromCommunity,s=t.dateTimeToCommunity,r=t.timezone,a="(UTC ".concat(e>=0?"+":"").concat(e,")");return new c.default({el:i,text:"".concat(Object(y.translate)("Time displayed is")," ").concat(n," ").concat(a,"<br>\n\t\t\t\t").concat(Object(y.translate)("Community time is")," ").concat(o," ").concat(Object(y.translate)("to")," ").concat(s," ").concat(r),horizontalPosition:"right"})},_getColor:function(){return this.model.attributes.Activity&&this.model.attributes.Activity.Group&&this.model.attributes.Activity.Group.Color?this.model.attributes.Activity.Group.Color:this.model.attributes.Group&&this.model.attributes.Group.Color?this.model.attributes.Group.Color:this.model.attributes.Color?this.model.attributes.Color:null},showUserProfile:function(){},showToolsArea:function(){var t;return!(!this.model.get("Group")||!(this.model.get("MembersCount")>0||this.model.get("Tags")&&this.model.get("Tags").length>0||!1===this.model.get("IsPublic")))||(!!(this.model.get("Hashtags")&&this.model.get("Hashtags").length||this.model.get("TotalOfComments")||this.model.get("TotalOfLikes"))||!!this.model.get("Activity")&&((t=this.model.get("Activity")).Hashtags&&t.Hashtags.length||t.TotalOfComments||t.TotalOfLikes))},showProfile:function(t){var e;t.preventDefault(),t.stopPropagation(),e=this.model.getOwner().Id,this.model.get("Administrators")&&this.model.get("Administrators").length>0&&(e=this.model.getAdministrators()[0].Id);var i=a.default.getProfileUrl()+e;j.default.showUserProfilePage(i)},getOwners:function(t){t.stopPropagation();var e=this.model.get("Administrators").concat(),i=o()("<ul/>"),n=e.splice(10,e.length-10);r.a.each(e,(function(t){o()("<li/>").text(t.FullName).appendTo(i)})),n.length&&o()("<li/>").text(Object(y.sprintf)(Object(y.translate)("and %d more..."),n.length)).appendTo(i),this.ownersTooltip&&this.ownersTooltip.message(i)},showOwnersDialog:function(t){t.stopPropagation();var e=this.model.get("Administrators");e.length>10&&Object(O.default)(e,{title:Object(y.translate)("All community owners")},this.$el.find(".js-like-count"))},goToActivity:function(t){t.stopPropagation(),u.default.redirectToUrl("".concat(this.model.get("Activity").Group.Url,"?activity=").concat(this.model.get("Activity").Id))},createComments:function(){var t,e;this.model.isCommunityQuestion()?(t="Answers",e="CommentsQuestion"):t=e="Comments";var i=new k.default[e]({el:this.viewPlaceholder("comments"),collection:new P.default[t]({activity:this.model}),parentActivity:this,fold:this.model.get("HasMoreComments")&&this.model.get("Comments").length,answer:this.model.get("Answer"),hasPinComment:!!this.model.getMetadata("pinComment"),pinCommentId:this.model.getMetadata("pinComment"),readOnly:this.options.readOnly});this.listenTo(i,"load",this.onloadcomments),this.listenTo(i,"add",this.incrementCommentsCount),this.listenTo(i,"remove",this.decrementCommentsCount),this.listenTo(i,"removeAnswer",(function(){this._commentsView.hide()})),this.listenTo(i,"bestAnswer",this.saveBestAnswer),this.addView("comments",i)},isActive:function(){return beezyCurrentGroup?!_.default.isGroupDisabled():!this.model.get("Group")||this.model.get("Group").IsActive&&(this.model.get("Group").IsCurrentUserWebAdmin||this.model.get("Group").IsPublic&&beezySettings.PublicCommunitiesOpen||this.model.get("Group").IsCurrentUserMember)}});D.mixin(A.default),D.mixin(I.default),e.default=D},125:function(t,e,i){"use strict";var n=i(811);i.d(e,"ButtonListItem",(function(){return n.default}));var o=i(567);i.d(e,"Dots",(function(){return o.default}));var s=i(2013);i.d(e,"LinkListItem",(function(){return s.default}));i(1003);var r=i(2014);i.d(e,"PopoverList",(function(){return r.default}));o.default},1262:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(3),s=i.n(o),r=i(26),a=i(7).default.Type,l={};l[a.POLL]={service:"/Polls/:id"},l[a.POST]={service:"/Posts/:id"},l[a.PRAISES]={service:"/Praises/:id"},l[a.ACTIVITY_COMMENT]={service:"/Comments/:id"},l[a.ACTIVITY_ANSWER]={service:"/Comments/:id"},l[a.CALENDAR]={service:"/Events/:id"};var c=r.default.extend({idAttribute:"Id",initialize:function(){this._parseMetadata()},sync:function(t,e,i){return s.a.extend(i,{url:this.urlRoot()}),c.__super__.sync.call(this,t,e,i)},urlRoot:function(){return n.default.getApiUrlv2MSC()+l[this.get("Type")].service.replace(":id",this.get("Id"))},setMetadata:function(t){var e,i,n;e=this.has("MetadataProperties")?this.get("MetadataProperties").slice():[],"string"==typeof t&&2===arguments.length?t={Name:i=t,Value:n=arguments[1]}:(i=t.Name,n=t.Value);var o=s.a.indexOf(this._metadataProperties,i);o>-1?e[o].Value=n:(e.push(t),this._metadataProperties.push(i)),this.set({MetadataProperties:e}),this._metadata[i]=n},_parseMetadata:function(){var t=this.get("MetadataProperties");this._metadata={},this._metadataProperties=s.a.pluck(t,"Name"),s.a.each(t,(function(t){this._metadata[t.Name]=t.Value}),this)}});e.default=c},1265:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(73),l=i(3),c=i.n(l),u=i(2),d=i(233),h=i(267),f=i(234),p=i(1572),m=i(13),g=i(968),v=i(173),b=i(7),y=i(303),C=i(8),w=i(1105),T=i(195),x=i(1877),O=i(169),S=i(712),I=i(49),A=i(2381),k=i.n(A),P=i(2382),E=i.n(P),_=i(413),j=i.n(_),D=i(78),U=i(580),M=i(313),L=i(1268),N=i(1878),R=i(15),z=i(5),F=i(37),B=i(18),$=i(51),V=i(95);i(682);function H(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var G=m.default.extend({tagName:"li",className:"activity",template:k.a,name:"activity",defaultColor:"ccc",dom:{summaryContainer:".activity-summary",summaryContainerText:".activity-summary-text",summaryContainerMore:".activity-summary-more",messageContainer:".js-activity-message"},classes:{toolsContainer:"activity-tools__container",snippetHtml:"snippet__html",snippetHtmlContainer:"snippet__html__container",snippetContent:"snippet__content",snippetThumbnail:"snippet__thumbnail",snippetTitle:"snippet__title",snippetDescription:"snippet__description",commentActivity:"js-content-main",quickProfile:"js-quick-profile-dialog",messageContent:"js-activity-message-content"},events:{"click [data-region=related-item-link]":"showRelatedItem","click [data-region=view-group]":"handleClickViewGroup","click .snippet__html__close":"hideSnippetHTML","keydown .snippet__html__close":"focusOpenSnippet","click .js-snippet-with-html":"showSnippetHTML","keydown .js-snippet-with-html":"focusCloseSnippet","click .icon-custom":"openFirstLink","click .js-owner-name":"showProfile","click .js-beezy-profileload":"showProfile","click [data-region=close]":"clear",mouseover:"hoverInWallItem","focus :focusable":"hoverInWallItem"},exposedProperties:["Id","Group.GroupId"],initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t||{},this.context=this.model.attributes,this.activityViewMode=this.options.activityViewMode||b.default.ActivityViewMode.FEED,this.template=t.template||this.template,this.activityViewMode===b.default.ActivityViewMode.CARD&&(this.template=t.templateCard||E.a,this.isCard=!0),this.inGlobalPage=!beezyCurrentGroup;var e=this.model.get("Type"),i=e===b.default.Type.TASK||e===b.default.Type.ITEM||e===b.default.Type.CALENDAR||e===b.default.Type.DOCUMENT||e===b.default.Type.MEDIA;if(this.displayHideTool=(this.inGlobalPage||!beezyContext.CurrentActivity)&&!y.default.isCurrentPageFilesDetail()&&i,this.options.parentActivity){var n=this.options.parentActivity.model.get("Mentions");this.model.set({Mentions:c.a.union(this.model.get("Mentions")||[],n)},{silent:!0});var o=this.options.parentActivity.model.get("Group");o&&this.model.attributes.Group&&-1===this.model.attributes.Group.GroupId&&c.a.extend(this.model.attributes.Group,o)}this.initializeActivityTools(t),this.setActivityMarkupData(this.exposedProperties)},render:function(){this.componentsActivityRendered=!1;var t=this.options.parentActivity;if(t){this.isPinComment=!1,c.a.extend(this.context.Group,t.model.get("Group")),this.context.parentActivity=t.model.toJSON();var e=t.model.getMetadata("pinComment");e&&(this.isPinComment=parseInt(e,10)===this.model.id),this.context.isPinComment=this.isPinComment}this.parseAttachments();var i="card"===this.options.activityViewMode,n=c.a.extend(this.context,{isMySite:R.default.isProfile(),isAnswer:this.model.isAnswer(),showRole:!1,_type:this.model._type,currentUser:window.beezyCurrentUser,contentIcon:this.contentIcon||"activity-type--post",messageLinkBroken:this.messageLinkBroken||"",isLinkBroken:this.isLinkBroken(),isOldVersion:"function"==typeof this.isOldVersion&&this.isOldVersion(),isCard:this.isCard||i,showTextCommentLike:this.options.showTextCommentLike||this.model.get("showTextCommentLike"),showMessage:"idea"===this.model._type||"communityQuestion"===this.model._type||"calendar"===this.model._type||"blogpost"===this.model._type||"wikipage"===this.model._type||"discussion"===this.model._type||"task"===this.model._type||this.model._type===b.default.Type.EXTENDEDIDEA,isKnowledgeCenter:"knowledgecenter"===beezyContext.CurrentPageKey,TotalOfTags:this.model.getNumberTags(),hasPinned:this.context.isPinComment||this.options.hasPinned,showAttachments:this.model._type!==b.default.Type.EXTENDEDIDEA,Message:this.model.get("Attachments").length||this.model._type.toLowerCase()!==b.default.Type.DOCUMENT?this.context.Message:Object(u.translate)("The file was deleted"),isNewsfeed:z.default.isNewsfeedLayout(),hasActivitySnippetSaved:this.hasActivitySnippetSaved,edited:this.model.get("LastModifiedBy"),isReadOnly:R.default.isReadOnly(),linkUrl:this.getUserProfileUrl(),linkActivityUrl:this.getGroupUrl()});if(this.helperActivity=new w.default(n),this.hasActivitySnippetSaved=!1,n.hasActivitySnippetSaved=!1,this.checkEmbeds(),this.existSnippetSavedInActivity()){this.hasActivitySnippetSaved=!0,n.hasActivitySnippetSaved=!0;var o=this.getSnippetFromActivity();n.snippetContext=O.default.Snippets.getSnippetContextFromActivity(o),this.snippetHTML=n.snippetContext.html}var s=this.template(n);this.$el.html(s),this.renderTooltipDate(n),this.relocateSnippets(this.context.Type),this.renderTools(this.options.tools),this.configAfterRenderTools(),v.default.applyColors(this.$el,this.getForegroundColor(),"fff"),this.searchSnippet();var r=this.$(".".concat(this.classes.messageContent));r&&r.length&&(this.showMore=new x.default({boundElement:r.get(0),numberLines:b.default.numberLinesMessageActivity[this.model._type],classHideContent:"hideContent",classShowContent:"showContent"})),this.$(".js-timeago").timeago(!0),this.$(".js-regular-timeago").timeago(!1),this.createImageGallery();var a=this.getObserverBackgroundImage({}),l=this.$el.get(0).querySelector(".".concat(this.classes.snippetThumbnail));l&&a.observe(l);var d=this.$el.get(0).querySelector(".js-beezy-profileload");return d&&(a.observe(d),d.setAttribute("data-email",this.model.get("Owner").Email)),this},hoverInWallItem:function(){this.createComponentsWallItem()},createImageGallery:function(){if(this.context.imageAttachments&&this.context.imageAttachments.length>0){var t=this.getObserverImage({});this.$el.find(".js-image-gallery-item").each((function(){var e=r()(this).attr("data-mfp-src").replace(/^(?:\/\/|[^/]+)*\//,"/"),i=r()(this).attr("data-thumbnail-url").replace(/^(?:\/\/|[^/]+)*\//,"/");r()(this).find("img").attr("data-src",i).attr("data-full-src",e),t.observe(r()(this).find("img").get(0))})),Object(N.default)(this.$el.find(".js-image-gallery"))}},updateModelIfNeeded:function(t,e){this.model.getOwner().get("Id")===t&&this.model.getOwner().set("IsCurrentUserColleague",e)},createComponentsWallItem:function(){var t=this;this.componentsActivityRendered||(this.componentsActivityRendered=!0,this.createTooltip(),V.default.create(this.$(".js-owner-name").get(0),r()(this.$(".js-activity-header-profile-link").get(0)),r()(this.$(".js-activity-header-quickprofile").get(0)),this.model.getOwner(),{relatedElement:this.options.relatedElement}),Object(M.default)(this.$el),Object(U.default)(this.$el,this.context.Hashtags),this.activityTypeTooltip=new F.default({el:this.$el.find(".activity__icon"),text:Object(u.translate)("See more of this content type"),horizontalPosition:"center"}),r()(this.$el).find(".js-modified-tag").each((function(e,i){t.modifiedTooltip=new F.default({el:i,text:Object(u.translate)("This tag has been deleted or modified")})})))},checkEmbeds:function(){var t=this.links=I.default.getLinks(this.context.Message);if(t){var e=this.getEmbeds(t);if(e){var i=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?H(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({isNotEmbly:!0},e);this.afterSearchSnippets(i)}}},getForegroundColor:function(){return this.context._type===b.default.Type.POST||this.context._type===b.default.Type.POLL||this.context._type===b.default.Type.PRAISES?this.context.Group?this.context.Group.Color:this.defaultColor:this.context.Group&&this.context.Group.Color},setActivityMarkupData:function(t){c.a.each(t,(function(t){var e=t.split(".");if(this.model.has(e[0])){t=e.shift();for(var i="data-activity-".concat(t),n=this.model.get(t);t=e.shift();)i+="-".concat(t),n=n[t];this.$el.attr(i,n)}}),this)},checkShowMore:function(){var t=this;b.default.typesActivitiesShowMore.some((function(e){return e===t.model._type}))&&this.showMore.checkShowMore()},parseAttachments:function(){if(this.context.Attachments&&this.context.Attachments.length){var t=[],e=[];c.a.each(this.context.Attachments,(function(i){i.Type!==b.default.AttachmentType.DOCUMENT&&i.Type!==b.default.AttachmentType.MEDIA||(T.default.checkImageExtension(i.FileName)&&i.Url.includes("MediaGallery")?t.push(i):(this.context.Group&&(i.Url=encodeURI("".concat(this.context.Group.Url,"/SitePages/File Detail.aspx?ActivityId=").concat(this.context.Id,"&AttachmentId=").concat(i.Id))),e.push(i)))}),this),c.a.extend(this.context,{imageAttachments:t,otherAttachments:e})}},findEmbeddedLink:function(t){var e;return c.a.find(t,(function(t){return c.a.find(a.default.embeddedLinks,(function(i,n){if(t.indexOf(n)>-1)return e=i.template({link:t}),!0}))})),e},parseMessage:function(t,e){var i=this.links=I.default.getLinks(t);if(i){var n=this.findEmbeddedLink(i);if(n)this.$(".".concat(this.classes.commentActivity)).first().append(n);else{var o=this.getEmbeds(i);if(e&&o){var s=c.a.extend({isNotEmbly:!0},o);this.afterSearchSnippets(s)}}}},getEmbeds:function(t){var e=null;if(beezySettings.Embeds){var i=JSON.parse(beezySettings.Embeds);if(!i||!i.filter)return null;var n=i.filter((function(t){return!!t.template}));if(c.a.first(n)){var o=Object.keys(c.a.first(n))[0],s=Object.keys(c.a.first(n))[1],r=c.a.pluck(n,o),a=c.a.pluck(n,s);c.a.find(t,(function(t){var i=/{(.*?)}/g,n=t;c.a.forEach(r,(function(t,o){var s=I.default.escapeRegExpSnippets(t),r=s.replace(i,"(.*)"),l=""!==r?n.match(r):void 0,u=s.match(i);l&&(c.a.forEach(u,(function(t,e){var i=new RegExp(t,"g");a[o]=a[o].replace(i,l[e+1])})),n.match(r)&&(e={key:t,value:n,template:a[o]}))}))}))}}return e},afterSearchSnippets:function(t){var e=this;this.filterAll({compact:!0,data:t,callback:function(){setTimeout((function(){e.showSnippet(t)}),0)}})},filterAll:function(t){var e=this.searchCustomLink(this.links);t.data&&(e[t.data.position]=t.data),t.compact&&(e=c.a.compact(e)),e[0]&&e[0].Pattern&&this.model.isCommunity()?(this.isCustomLink=!0,this.transformActivity(e[0])):t.callback&&t.callback()},relocateSnippets:function(t){var e=this.region("snippet");(t===b.default.Type.QUESTION||"idea"===t||"poll"===t||"praise"===t||this.isCustomLink)&&(this.region("snippet").remove(),this.$(".".concat(this.classes.commentActivity)).append(e))},showSnippet:function(t){if(t.isNotEmbly)this.region("snippet").first().removeClass("is-hidden").html(t.template);else if("error"!==t.type&&O.default.Snippets.isProviderAllowed(t.provider_name)){var e=j.a,i=c.a.pick(t,"provider_name","provider_url","original_url","title","description","author_url","url","favicon_url");t.media&&t.media.html?(this.snippetHTML=i.html=t.media.html,i.type=t.media.type):i.type="link",t.images.length?i.thumbnail_url=t.images[0].url:i.thumbnail_url="".concat(z.default.getBaseSiteCollection(),"/Style%20Library/images/beezy/snippet-default.jpg"),this.region("snippet").first().removeClass("is-hidden").html(e(i))}},showSnippetHTML:function(t,e){this.$container=this.$(".".concat(this.classes.snippetHtmlContainer)),this.loadHTML(),this.$(".".concat(this.classes.snippetContent)).hide(),this.$(".".concat(this.classes.snippetThumbnail)).hide(),this.$(".".concat(this.classes.snippetHtml)).fadeIn(600,e)},hideSnippetHTML:function(t,e){this.$(".".concat(this.classes.snippetHtml)).hide(),this.$(".".concat(this.classes.snippetContent)).fadeIn(600),this.$(".".concat(this.classes.snippetThumbnail)).fadeIn(600,e),this.loadHTML()},focusCloseSnippet:function(t){var e=this;Object(S.isEnterKey)(t)&&this.showSnippetHTML(null,(function(){return e.$(".js-snippet-close").trigger("focus")}))},focusOpenSnippet:function(t){var e=this;Object(S.isEnterKey)(t)&&this.hideSnippetHTML(null,(function(){return e.$(".js-snippet-with-html").trigger("focus")}))},loadHTML:function(){var t=this;this.$container.addClass("is-loading"),this.$container.each((function(){r()(this).html(t.snippetHTML),t.$container.removeClass("is-loading")}))},searchCustomLink:function(t){var e,i=[];return c.a.each(t,(function(t,n){e=O.default.Snippets.isExternal(t),i[n]=e||null})),i},existSnippetSavedInActivity:function(){var t=[b.default.AttachmentType.LINK,b.default.AttachmentType.VIDEO];if(this.helperActivity.hasAttachmentsFromType(t)){var e=new p.default(this.helperActivity.getFirstAttachmentFromType(t));if(e&&e.attachment&&e.attachment.Url&&O.default.Snippets.isExternal(e.attachment.Url)&&O.default.Snippets.isProviderAllowed(e.attachment.Provider))return e.hasSnippet()}return!1},getSnippetFromActivity:function(){var t=[b.default.AttachmentType.LINK,b.default.AttachmentType.VIDEO];return new p.default(this.helperActivity.getFirstAttachmentFromType(t)).getSnippet()},searchSnippet:function(){this.hasActivitySnippetSaved||this.parseMessage(this.context.Message,!0)},cleanProvider:function(t){return t.replace(/^https?:\/\/(?:www.)?([^\/]*)\/?/,"$1")},transformActivity:function(t){var e=this.context;e.customSnippet||(this.contentIcon="custom",e.styleIcon="background-image: url('".concat(T.default.getAbsoluteURL(t.IconUrl),"');"),e.action=t.Action,e.customSnippet=!0,this.render())},openFirstLink:function(){window.open(this.links[0],"customLink").focus()},configAfterRenderTools:function(){if(this.$commentsCount=this.viewRegion("comments-count"),this.options.showComments&&!this.options.isPoll){this._commentsView&&this.removeView("comments"),this.createComments();var t=this;c.a.each(this.model.get("Comments"),(function(e){c.a.extend(e,{showTextCommentLike:t.options.showTextCommentLike})})),this._commentsView.reset(this.model.get("Comments"))}this.options.showTags&&this.options.model.getNumberTags()&&(this._tagsView&&this.removeView("tags"),this.createTags().render(),this.$(".js-activity-tools-tag-count").addClass("is-open"));!this.model.isQuestion()||this._commentsView&&this._commentsView.hasAnswer||g.default.isCurrentUserSpeakerOrModerator()?this.viewRegion("comment").length&&(this.viewRegion("comment")[0].style.display=""):this.viewRegion("comment").hide()},hideDeleteCommand:function(){this.tools.options.context.tools=c.a.extend(this.tools.options.context.tools,{remove:!1}),this.tools.render()},showDeleteCommand:function(){this.tools.options.context.tools=c.a.extend(this.tools.options.context.tools,{remove:!0}),this.tools.render()},isActive:function(){return beezyCurrentGroup?!C.default.isGroupDisabled():!this.model.get("Group")||this.model.get("Group").IsActive&&(this.model.get("Group").IsCurrentUserWebAdmin||this.model.get("Group").IsPublic&&z.default.isPublicCommunitiesOpen()||this.model.get("Group").IsCurrentUserMember)},isLinkBroken:function(){return!1},handleClickViewGroup:function(){this.gotoGroup()},showRelatedItem:function(t){t.preventDefault();var e=this.model.toJSON(),i=this.model.get("RelatedItem"),n=z.default.getBaseSiteHost()+i.Url;this.model.isCalendar()&&(n="".concat(z.default.getBaseSiteHost()+e.Group.Url,"/SitePages/Calendar Detail.aspx?ActivityId=").concat(e.Id)),this.model.isTask()&&(n="".concat(z.default.getBaseSiteHost()+e.Group.Url,"/SitePages/Tasks Detail.aspx?ActivityId=").concat(e.Id)),t.ctrlKey?window.open(n,"_blank"):B.default.redirectToUrl(n)},showProfile:function(t){if(t.preventDefault(),t.stopPropagation(),this.model.get("Owner").IsActive){var e=z.default.getProfileUrl()+this.model.get("Owner").Id;D.default.showUserProfilePage(e)}},getUserProfileUrl:function(){if(this.model.get("Owner").IsActive)return z.default.getProfileUrl()+this.model.get("Owner").Id},gotoGroup:function(){var t=this.getGroupUrl();B.default.redirectToUrl(t)},getGroupUrl:function(){var t=this.model.get("Group");return t&&-1!==t.GroupId?t.SiteCollection.WebApplicationUrl+t.Url:"#"},getActivityLink:function(){return R.default.isProfile()?this.getGroupUrl():this.getUserProfileUrl()},report:function(t){Object(L.default)(R.default.getCurrentUser(),this.model.toJSON(),t)},renderTooltipDate:function(t){t.LastModifiedBy&&new F.default({el:this.$(".js-edited-date"),text:this.getTextToTooltip(t,"Edited")}),t.Created&&new F.default({el:this.$(".js-timeago"),text:this.getTextToTooltip(t)})},getTextToTooltip:function(t,e){return"Edited"===e?Object(u.sprintf)(Object(u.translate)("Edited by %s"),"".concat(t.LastModifiedBy.FullName," ").concat(Object($.getDateWithFormatFromJSON)(t.LastModified,"dd MMM yyyy HH:mm (z)"))):Object(u.sprintf)(Object(u.translate)("Created on %s"),Object($.getDateWithFormatFromJSON)(t.Created,"dd MMM yyyy HH:mm (z)"))}});G.mixin(d.default),G.mixin(h.default),G.mixin(f.default),e.default=G},1266:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(13),r=i(712),a=i(2367),l=i.n(a),c=s.default.extend({tagName:"div",className:"poll-vote js-poll-vote",template:l.a,events:{"mouseup .js-option-container":"handleClickSelection","keydown .js-poll-vote":"handleKeyDown","focus .js-poll-option":"selectVotedOption"},render:function(){return this.$el.html(this.template(this.collection.toJSON())),this.$options=this.$(".js-poll-option"),this.checkVote(this.collection.getVotedOptionIndex()),this},checkVote:function(t){t<0||(this.selectedOption=t,this.$options.get(t).checked=!0)},vote:function(t){t.preventDefault(),this.collection.vote(this.selectedOption),this.trigger("vote",this.getTotalOfVotes())},getTotalOfVotes:function(){var t=0;return this.collection.models.forEach((function(e){t+=e.get("TotalOfLikes")})),t},handleClickSelection:function(t){t.preventDefault();var e=this.$options.index(o()(t.currentTarget).find("input"));this.checkVote(e),e!==this.collection.getVotedOptionIndex()&&(this.selectedOption=e,this.vote(t))},handleKeyDown:function(t){var e=t.key===r.KEYS.ENTER,i=t.key===r.KEYS.SPACE;if(e||i){t.preventDefault();var n=this.$options.index(o()(t.target));this.checkVote(n),this.vote(t)}},selectVotedOption:function(t){o()(this.$options).parent().removeClass("selected"),o()(this.$options.get(t)).parent().addClass("selected")},show:function(){this.$el.show()},hide:function(){this.$el.hide()}});e.default=c},1267:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(13),r=i(2369),a=i.n(r),l=function(t,e,i){t.text("".concat(i,"%")),e.css({width:"".concat(i,"%")})},c=o.a.browser.msie?l:function(t,e,i){setTimeout((function(){e.css({width:"".concat(i,"%"),transition:"width ".concat(.6,"s linear 0s")}),i>0&&function(t,e,i){var n=e/2,o=0,s=setInterval((function(){o>=e?(window.clearInterval(s),t.text("".concat(e,"%"))):(t.text("".concat(parseInt(o,10),"%")),o+=Math.round(e/n))}),1e3*i/n)}(t,i,.6)}),0)},u=s.default.extend({tagName:"div",className:"chart",template:a.a,render:function(){return this.$el.html(this.template(this.collection.toJSON())),this},setPercentages:function(){this.updatePercentages(),this.updateStyle=l},updatePercentages:function(){var t,e=this.$(".js-chart");this.collection.each((function(i,n){t=o()(e.get(n));var s=i.get("percentage"),r=t.find(".js-bar-fill"),a=t.find(".js-percentage");this.updateStyle(a,r,s)}),this)},updateStyle:c,_show:function(){this.$el.show()},show:function(){this._show(),this.setPercentages(),this.show=this._show},hide:function(){this.$el.hide()}});e.default=u},1268:function(t,e,i){"use strict";i.r(e);var n=i(57),o=i(1866),s=i(2),r=i(47),a=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=Object(s.translate)("Report this activity"),c=new o.default({el:r.default.createDialogContainer("modal-report-abuse"),user:t,activity:e}),u=new n.default(c,{buttons:[],onClose:i.onCloseModal});return c.on("close",(function(){u.hide()})),(a=function(t,e,i){c.setTitle(i.title||l),c.setActivity(e),c.render(),u.show()})(t,e,i)};e.default=a},1269:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(1270),r=i(1870),a=i(7),l=i(587),c=i(87),u=i.n(c),d=i(579);function h(t,e){var i=this;null==e&&(e={}),this.createBox=this.createBox.bind(this),this.keyDown=this.keyDown.bind(this),this.click=this.click.bind(this),this.keyUp=this.keyUp.bind(this),this.keyPress=this.keyPress.bind(this),h.__super__.constructor.call(this,t,e),this.searchAdapter=e.SearchAdapter,this.searchAdapterOptions=e.SearchAdapterOptions||{},this.maximumResults=e.MaximumResults,this.buffer=new r.default("",{bufferEmptied:function(){return i.cancel()},bufferChanged:function(t,e){return i.bufferChanged(t,e)}}),this.unbindEvents(),this.bindEvents(),this.onItemSelected=e.onItemSelected||{}}Object(d.default)(h,s.default),h.prototype.autocompleteThreshold=3,h.prototype.buffering=!1,h.prototype.mustExists=!0,h.prototype.enabledWarnings=!0,h.prototype.acceptedCharacters=/[^\s\t\n\b\f\r\0\x0B\x1B]/,h.prototype.unbindEvents=function(){this.elem.off("keydown",this.keyDown),this.elem.off("keypress",this.keyPress),this.elem.off("keyup",this.keyUp),this.elem.off("click",this.click)},h.prototype.bindEvents=function(){return this.elem.bind("keydown",this.keyDown),this.elem.bind("keypress",this.keyPress),this.elem.bind("keyup",this.keyUp),this.elem.bind("click",this.click)},h.prototype.keyPress=function(t){if(this.microbox.disabled)return!1;var e=String.fromCharCode(t.which),i=this.previousChar;return e===this.triggerCharacter&&this.isValidPreviousChar(i)?(this.buffer.empty(),this.startBuffering()):this.buffering&&this.acceptedCharacters.test(e)&&this.wordExists(e)?this.buffer.increment(e):this.buffering&&13!==t.which&&this.buffer.empty(),this.previousChar=e},h.prototype.wordExists=function(){return this.elem.text().replace(/\u00A0$/," ").indexOf(this.triggerCharacter+this.buffer.content())>-1},h.prototype.isValidPreviousChar=function(t){return!t||a.default.MentionsPreviousCharRegExp.test(t)},h.prototype.keyUp=function(t){return 13===t.which&&(this.previousChar=null),this.updateSelectionPosition()},h.prototype.click=function(t){return t.stopPropagation(),this.buffer.empty(),this.updateSelectionPosition()},h.prototype.reset=function(){return this.stopBuffering(),this.previousChar=void 0},h.prototype.cancel=function(){if(this._autocomplete)return this._autocomplete.stop()},h.prototype.startBuffering=function(){return this.buffering={},this.updateSelectionPosition()},h.prototype.stopBuffering=function(){return this.enabledWarnings&&this.microbox.resetWarning(),this.buffering=!1},h.prototype.keyDown=function(t){this.microbox.disabled&&-1===o.a.indexOf([35,36,37,38,39,40,8,45,46],t.which)&&(t.preventDefault(),t.stopPropagation());var e=t.which,i=l.default;if(8===e)if(this.buffer.decrement(),""===this.elem.text())this.previousChar=null;else if(this.elem.text().length>1){var n=u.a.getSelection();n&&n.focusNode&&n.focusNode.nodeValue&&null!==n.focusNode.nodeValue&&(this.previousChar=n.focusNode.nodeValue.substring(n.focusOffset-1,n.focusOffset-2))}if(e!==i.LEFT&&e!==i.RIGHT||this.buffer.empty(),!this._autocomplete&&e===i.INTRO)return!1},h.prototype.createBox=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.buffering,n=u.a.createRange();n.setStart(i.startNode,i.startOffset),n.setEnd(i.endNode,i.endOffset),n.deleteContents();var o=document.createTextNode("‌"),s=document.createElement("span");s.innerHTML="",s.className="beezy-microbox-editable-spanspecial";var r=new this.RenderBox(t),a=r.node;if(n.insertNode(s),n.setStartAfter(s),n.setEndAfter(s),n.insertNode(a),n.setStartAfter(a),n.setEndAfter(a),n.insertNode(o),n.setStartAfter(o),n.setEndAfter(o),e){var l=document.createTextNode(" ");n.insertNode(l),n.setStartAfter(l),n.setEndAfter(l)}var c=u.a.getSelection();return n.collapse(!0),c.setSingleRange(n),this.buffer.empty(),this.elem.focus(),o},h.prototype.stop=function(){return this._autocomplete=void 0,this.microbox.resetComponents()},h.prototype.bufferChanged=function(t,e){if(this.buffering&&t.length>=this.autocompleteThreshold&&!e)return this.searchFor(t)},h.prototype.updateSelectionPosition=function(){if(this.buffering){var t=u.a.getSelection();this.buffering.endNode=t.focusNode,this.buffering.endOffset=t.focusOffset,this.buffering.startNode=t.focusNode,this.buffering.startOffset=this.buffer.content().indexOf(this.triggerCharacter)>-1?t.focusOffset-this.buffer.content().length:t.focusOffset-this.buffer.content().length-1}},h.prototype.searchFor=function(t){var e=this;return this.autocomplete(),this.searchAdapter(t,(function(t){e.updateAutocomplete(t)}),this.searchAdapterOptions)},h.prototype.autocomplete=function(){var t=this,e=this;this.buffering&&(this._autocomplete||(this._autocomplete=new this.AutocompleteDropdown({callback:function(e,i){return t.handleItemSelected(e),t.createBox(e,i)},autocompleteObserver:this})),this._autocomplete.appendTo(this.microbox.container),this._autocompleteWaiting=!0,setTimeout((function(){e._autocompleteWaiting&&e._autocomplete.startLoading()}),500))},h.prototype.updateAutocomplete=function(t){if(!this.buffering)return this.cancel();!this.mustExists||t.length?(this._autocompleteWaiting=!1,this._autocomplete.stopLoading(),this.maximumResults&&t.length>this.maximumResults?(this._autocomplete.hide(),this.microbox.setOverflowWarning()):(this.microbox.resetWarning(),this._autocomplete.update(t))):(this.microbox.resetWarning(),this._autocomplete.hide())},e.default=h},127:function(t,e,i){"use strict";var n=i(5);var o=function(t){return"".concat(t).concat(function(t){return encodeURI(t).indexOf("?")>-1?"&":"?"}(t)).concat(n.default.getApiQueryStringv2())};e.default=function(t){var e,i=n.default.getBaseWebUrl()+t,s=n.default.getBaseSiteCollection()+t;return n.default.isSharepointApp()?(e=i,n.default.getApiQueryStringv2()?o(e):e):s}},1270:function(t,e,i){"use strict";function n(t,e){null==e&&(e={}),this.updateMicroboxDependency=this.updateMicroboxDependency.bind(this),this.microbox=t,this.container=t.container,this.elem=t.elem,this.microbox.on("changeContainer:".concat(e.EventKey).concat(e.Type),this.updateMicroboxDependency)}i.r(e),n.prototype.reset=function(){},n.prototype.isValid=function(){return!0},n.prototype.updateMicroboxDependency=function(){this.container=this.microbox.container},e.default=n},1271:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n);function s(t){this.data=t,this.createNode(),this.addName()}s.prototype.node=null,s.prototype.createNode=function(){var t=o()("<span />");return this.node=t[0],t.addClass("beezy-microbox-box").addClass("beezy-microbox-user"),t.attr("data-id","@".concat(this.data.Id)),t.attr("data-loginName","@".concat(this.data.LoginName)),t[0]},s.prototype.addName=function(){return o.a.browser.msie&&7===parseInt(o.a.browser.version,10)?o()(this.node).html("@".concat(this.data.FullName)).attr("contenteditable","true"):o()(this.node).attr("data-content","@".concat(this.data.FullName))},e.default=s},1272:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(587),r=i(2),a=i(5),l=i(195),c=i(30),u=i(3),d=i.n(u);function h(t){null==t&&(t={}),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.stop=this.stop.bind(this),this.keyPress=this.keyPress.bind(this),this.isComplete=this.isComplete.bind(this),this.onclose=this.onclose.bind(this),this.keyDown=this.keyDown.bind(this),this.onclickdocument=this.onclickdocument.bind(this),this.callback=t.callback||function(){},this.list=o()('<div style="position:absolute;z-index:1000;" />').addClass("autocomplete autocomplete__list autocomplete--bottom bz-webpart"),!!(t&&t.autocompleteObserver&&t.autocompleteObserver.container&&t.autocompleteObserver.container.context&&t.autocompleteObserver.container.context.className)&&t.autocompleteObserver.container.context.className.includes("activity")&&this.list.addClass("autcomplete__list-for-activity"),this.loadingNode=o()('<div class="loading" style="display:none" />'),this.node=o()("<ul />"),this.close=o()('<div style="position:absolute; bottom:0; right:0; z-index:99999;" />').attr("title",Object(r.translate)("Close")).addClass("icon-close-dropdown"),this.list.append(this.loadingNode).append(this.node).append(this.close),this.autocompleteObserver=t.autocompleteObserver,this.itemsToDisplay=t.itemsToDisplay||7,this.elem=this.autocompleteObserver.elem,this.results=[],this.unbindEvents(),this.bindEvents()}h.prototype.items=[],h.prototype.completionKeys=[s.default.INTRO,s.default.TAB,s.default.SPACE],h.prototype.update=function(t){return this.results=t,this.updateResults()},h.prototype.startLoading=function(){this.node.empty(),this.loadingNode.show()},h.prototype.stopLoading=function(){this.loadingNode.hide()},h.prototype.updateResults=function(){return this.node.empty(),this.items=function(){for(var t=this.results,e=[],i=0,n=t.length;i<n;i++){var s=t[i],r=this.createItem(s);o()(this.node).append(r),e.push(r)}return e}.call(this),this.autocompleteObserver.selectFirstOnSearching&&this.selectItem(0),this.setHeight()},h.prototype.bindEvents=function(){var t=o()(this.elem);this.close.on("click",this.onclose),t.keydown(this.keyDown),o()(document).on("click",this.onclickdocument),t.keypress(this.keyPress)},h.prototype.unbindEvents=function(){this.close.off("click",this.onclose),o()(this.elem).unbind("keydown",this.keyDown),o()(document).off("click",this.onclickdocument),o()(this.elem).unbind("keypress",this.keyPress)},h.prototype.onclose=function(t){t.stopPropagation(),this.stop(),this.hide()},h.prototype.onclickdocument=function(){this.hide(),this.stop()},h.prototype.keyDown=function(t){var e=t.which,i=s.default;return e===i.UP?(this.moveUp(),!1):e===i.DOWN?(this.moveDown(),!1):this.isComplete(t)},h.prototype.isComplete=function(t){var e,i=t.which,n=s.default;if(d.a.contains(this.completionKeys,i)){t.preventDefault(),t.stopPropagation(),d.a.isEmpty(this.results)&&this.results.unshift({Name:this.autocompleteObserver.buffer.content()});if(void 0===this._selectedIndex)e=this.callback({Name:this.autocompleteObserver.buffer.content()},true);else{this._selectedIndex=this._selectedIndex||0;var o=this.results[this._selectedIndex];e=this.callback(o,true)}i===n.INTRO&&this.removeExtraNewLines(e),this.stop()}},o.a.browser.msie?h.prototype.removeExtraNewLines=function(t){setTimeout((function(){var e=t.nextSibling;e&&e.tagName&&"BR"===e.tagName&&e.parentNode.removeChild(e)}),0)}:h.prototype.removeExtraNewLines=function(t){setTimeout((function(){for(var e=t.nextSibling;e;){var i=e.nextSibling;e.tagName&&"BR"===e.tagName&&i&&i.tagName&&"BR"===i.tagName&&e.parentNode.removeChild(e),e=i}}),0)},h.prototype.keyPress=function(t){return t.which===s.default.ESCAPE?(this.stop(),!1):this.isComplete(t)},h.prototype.moveUp=function(){var t=this.node[0],e=this;if(this._selectedIndex=void 0===this._selectedIndex?this.items.length-1:this._selectedIndex-1,!(this._selectedIndex<0))return setTimeout((function(){var i=e.itemOffsetHeight(),n=e._selectedIndex*i;if(e.selectItem(e._selectedIndex),n<t.scrollTop)return t.scrollTop-=i}),0),!0;this._selectedIndex=0},h.prototype.moveDown=function(){var t=this.node[0],e=this.items.length-1,i=this;this._selectedIndex=void 0===this._selectedIndex?0:this._selectedIndex+1;var n=this._selectedIndex>e;if(!n)return setTimeout((function(){if(i.selectItem(i._selectedIndex),!n&&i._selectedIndex>=i.itemsToDisplay&&t.offsetHeight<t.scrollHeight)return t.scrollTop+=i.itemOffsetHeight()}),0),!0;this._selectedIndex=e},h.prototype.selectItem=function(t){for(var e=this.items,i=0,n=e.length;i<n;i++){var s=e[i];o()(s).removeClass("is-selected")}return o()(this.items[t]).addClass("is-selected"),this._selectedIndex=t},h.prototype.createItem=function(t){var e=this,i=o()("<li />").attr("data-id",t.Id).addClass("autocomplete__item o-media").click((function(){return e.callback(t,!0),e.stop(),!1})),n=o()("<img />").addClass("profile-img profile-img--small pull-left").attr("src",l.default.getProfileImage(t.PictureUrl)).on("error",(function(){o()(this).attr("src",a.default.getProfileImage())})),s=o()("<div />").addClass("o-media__item").append(n);i.append(s);var r=o()("<div class='o-media__body' />").append(o()("<div />").addClass("autocomplete__item__name").html(t.FullName)).append(o()("<div />").addClass("autocomplete__item__email").html(t.Email));return i.append(r),i},h.prototype.itemOffsetHeight=function(){var t=this.items[0];return t?t[0].offsetHeight:0},h.prototype.setHeight=function(){if(this.items.length>this.itemsToDisplay){var t=this.itemsToDisplay*this.itemOffsetHeight();this.node.css({overflowY:"auto"}),this.node.height(t),this.list.height(t),this.close.css({right:20})}else this.node.css({overflowY:"hidden",height:"auto",width:"100%"}),this.list.css({height:"auto"}),this.close.css({right:0});return!0},h.prototype.setWidth=function(){var t=.8*this._appended.width();this.node.width(t),this.list.width(t)},h.prototype.appendTo=function(t){if(!this._appended){var e=this,i=o()(t),n=i.offset();this.hide();var s=Object(c.isSharepointModern)()?c.sharePointSizes.ribbonModern:c.sharePointSizes.ribbon,r=n.top+i.outerHeight()-s.height()+Object(c.sharePointItems)().content.scrollTop();this.list.offset({top:r,left:n.left}),this._appended=i,Object(c.sharePointItems)().content.append(this.list),o()(window).on("resize",(function(){e.setWidth()}))}return this.setWidth(),this.setHeight(),this.show()},h.prototype.stop=function(){return this.unbindEvents(),o()(this.list).remove(),this.autocompleteObserver.stop()},h.prototype.show=function(){if(!this.isVisible())return this.list.hide(),this.list[0].style.visibility="visible",this.list.fadeIn("fast")},h.prototype.hide=function(){return this.isVisible()&&(this.list[0].style.visibility="hidden"),!0},h.prototype.isVisible=function(){return"visible"===this.list[0].style.visibility},e.default=h},1273:function(t,e,i){"use strict";i.r(e);var n=i(15),o=i(17),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(969),u=i(2),d=i(773),h=Object(u.translate)("People who voted this answer"),f=c.default.extend({events:function(){return l.a.extend({},c.default.prototype.events,{"click .js-tooltip-bestanswer":"markAsBestAnswer"})},initialize:function(t){var e;f.__super__.initialize.call(this,t),e=this.model.isCommunityAnswer()?{vote:!0,comment:!1,share:!1,like:!1,bookmark:!1,markAsBestAnswer:this.options.parentActivity&&(this.options.parentActivity.model.get("Owner").Id===n.default.getCurrentUserId()||n.default.isBeezyAdministrator()),tag:!1}:{comment:!1,share:!1,vote:!1,bookmark:!1,tag:!1},this.configTools(e)},render:function(){var t=this.options.parentActivity;if(t){this.isBestAnswer=!1;var e=t.model.getMetadata("bestAnswer");e&&(this.isBestAnswer=parseInt(e,10)===this.model.id),this.context.isBestAnswer=this.isBestAnswer}return f.__super__.render.call(this),this.updateBestAnswerA11y(),this},showLikersDialog:function(t){t.stopPropagation(),Object(d.default)(this.likers,{title:h},this.$el.find(".js-like-count"))},updateBestAnswer:function(){this.$(".js-info-bestanswer").addClass("icon-feedback-animation"),this.afterUpdateBestAnswerRender()},updateBestAnswerAnimation:function(){var t=this.region("bestanswer-count"),e=this.$el.find(".js-best-answer");t.html(Object(u.translate)(this.isBestAnswer?"Unmark as best answer":"Mark as best answer")),this.isBestAnswer?(this.$(".js-info-bestanswer").first().removeClass("icon--tools-star"),this.$(".js-info-bestanswer").first().addClass("icon--tools-star-active")):(this.$(".js-info-bestanswer").first().removeClass("icon--tools-star-active"),this.$(".js-info-bestanswer").first().addClass("icon--tools-star")),this.isBestAnswer?e.show():e.hide(),this.updateBestAnswerA11y()},updateBestAnswerA11y:function(){var t=this.$el.find(".js-info-bestanswer");t.attr("aria-checked",(!!this.isBestAnswer).toString());var e=Object(u.translate)(this.isBestAnswer?"Unmark as best answer":"Mark as best answer");t.attr("aria-label",e)},afterUpdateBestAnswerRender:function(){var t=this;this.$(".icon-feedback-animation").length?setTimeout((function(){t.$(".icon-feedback-animation").one("webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend",(function(){t.$(".js-info-bestanswer").removeClass("icon-feedback-animation"),t.updateBestAnswerAnimation()}))}),10):t.updateBestAnswerAnimation()},_markAsBestAnswer:function(){this.isBestAnswer=!this.isBestAnswer;var t=this.options.parentActivity;t&&t.model.setMetadata("bestAnswer",this.isBestAnswer&&this.model.id),this.isBestAnswer?this.model.markAsBestAnswer():this.model.unmarkAsBestAnswer()},markAsBestAnswer:function(t){if(t.preventDefault(),t.stopPropagation(),n.default.isReadOnly())return o.default.showReadOnlyModal();this._markAsBestAnswer(),r.a.browser.msie&&Number(r.a.browser.version)<10?this.updateBestAnswerAnimation():this.updateBestAnswer(),this.trigger("bestAnswer",this.isBestAnswer&&this.model.id)}});e.default=f},1274:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(2),s=i(773),r=i(7),a=Object(o.translate)("People who champion this idea"),l=n.default.extend({contentIcon:"activity-type--idea",messageLinkBroken:Object(o.translate)("LinkBrokenIdea"),showLikersDialog:function(t){t.stopPropagation(),this.likers.length>0&&Object(s.default)(this.likers,{title:a},this.$el.find(".js-like-count"))},isLinkBroken:function(){return null===this.model.get("RelatedItem")&&null!==this.model.get("Version")},isOldVersion:function(){return null===this.model.get("RelatedItem")&&null===this.model.get("Version")&&this.model.get("Type")===r.default.Type.IDEA}});e.default=l},128:function(t,e,i){"use strict";i.r(e);var n=i(28),o=i(1675);function s(t){(new o.default).init(t)}n.default.addEntryPoint(s,["beezyCurrentUser"],1),e.default=s},13:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(27),r=i.n(s),a=i(4),l=i.n(a),c=i(3),u=i.n(c),d=i(17),h=i(12),f=i(233),p=r.a.View.extend({name:"base",subscribe:function(t,e,i,n){h.default.subscribe(t,e,i,this,n)},publish:function(t){var e=[this.name,t].concat(u.a.toArray(arguments).slice(1));h.default.publish.apply(h.default,o()(e))},childViewAt:function(t){return this._childViews[this._childViewsId[t]]},childViewNameAt:function(t){return this._childViewsId[t]},childViewsLength:function(){return this._childViewsId.length},getView:function(t){return this._childViews[t]},addView:function(t,e,i,n){var o="_".concat(t,"View"),s=this._childViews||(this._childViews={}),r=this._childViewsId||(this._childViewsId=[]);if(this[o])throw new Error("`".concat(t,"` already exists"));return r.push(t),s[t]=this[o]=e,i&&this.placeChildView(t,e,n),e},removeView:function(t){var e="_".concat(t,"View");this._childViews[t]&&(this._childViews[t].dispose(),this._childViewsId.splice(u()(this._childViewsId).indexOf(t),1),this._childViews[t]=null,delete this._childViews[t],this[e]=null,delete this[e])},placeChildView:function(t,e,i){var n=this.viewPlaceholder(t);i?e.$el.replaceWith(n):n.append(e.$el),e.setElement(n)},viewPlaceholder:function(t){return this.$("[data-view-placeholder=".concat(t,"]"))},viewRegion:function(t){return this.$("[data-view-region=".concat(t,"]"))},region:function(t){return this.$("[data-region=".concat(t,"]"))},render:function(){return this.template&&this.$el.html(this.template(this.context||this.options.context)),this},startLoading:function(t){},stopLoading:function(t){t?l()(t).removeClass("loading"):this.$el.removeClass("loading")},propagateEvents:function(t,e){u.a.each(t,(function(t){var i="_".concat(t,"Listener");this[i]=function(){var e=[].slice.call(arguments);e.unshift(t),this.trigger.apply(this,o()(e))},this.listenTo(e,t,this[i])}),this)},_dispose:function(){},dispose:function(){this._disposed||(this.unbindEvents(),this._dispose(),u()(this._childViewsId).each(this.removeView,this),this.remove(),this._disposed=!0)},hasChildViews:function(){return null!=this._childViews},bindEvents:function(){},unbindEvents:function(){this.stopListening()},subscribeBusEvents:function(){}},{mixin:function(t){var e=this.prototype;u.a.defaults(e,t),u.a.defaults(e.events,t.events),d.default.extendMethod(e,t,"initialize"),d.default.extendMethod(e,t,"render")}});p.mixin(f.default),e.default=p},1316:function(t,e,i){"use strict";i.r(e);var n=i(113).default.extend({defaults:{Type:"StandAloneBlog"},getDetailUrl:function(){return this.get("RelatedItem").Url},getOwner:function(){return this.get("Owner")}});e.default=n},1317:function(t,e,i){"use strict";i.r(e);var n=i(113).default.extend({defaults:{Type:"StandAloneForum"},getDetailUrl:function(){return this.get("RelatedItem").Url},getOwner:function(){return this.get("Owner")}});e.default=n},1318:function(t,e,i){"use strict";i.r(e);var n=i(113).default.extend({defaults:{Type:"StandAloneWiki"},getDetailUrl:function(){return this.get("RelatedItem").Url},getOwner:function(){return this.get("Owner")}});e.default=n},1323:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(10),s=i(140),r=i(1662),a=s.default.extend({model:r.default.Notification,url:function(){var t="";return this.options.reason&&(t+="/Reason/".concat(this.options.reason)),"".concat(n.default.getApiUrlv2(),"/Notifications").concat(t)},markAsRead:function(){var t=this.options.reason;this.setReason("all"),o.default.get("".concat(this.url(),"/Read")),this.setReason(t)},setReason:function(t){t&&"all"!==t.toLowerCase()?this.options.reason=t:this.options.reason=null}}),l=a.extend({model:r.default.PopupNotification,initialize:function(){l.__super__.initialize.call(this,[],{take:n.default.getNotificationPopupSize()})}});e.default={PopupNotificationsCollection:l,NotificationsCollection:a}},133:function(t,e,i){"use strict";i.r(e);var n=i(98),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(2),u=!1,d={expandText:"... ".concat(Object(c.translate)("Show more")),expandClasses:"description-more",collapseText:"...".concat(Object(c.translate)("less")),collapseClasses:"description-less"},h=function(t,e,i){t.dotdotdot(l.a.extend({height:Math.round(parseFloat(t.css("lineHeight"),10))*e,wrap:"letter",lastCharacter:{remove:[" ","\n"]}},i))},f=function(t,e,i){h(t,e,i)},p=function(t,e,i){i&&i.withoutDelay?h(t,e,i):setTimeout((function(){h(t,e,i)}),0)},m=function(t,e,i){t.dotdotdot(l.a.extend({height:Math.round(parseFloat(t.css("lineHeight"),10))*e,after:"span.js-more",wrap:"letter",lastCharacter:{remove:[" ","\n"]}},i))},g=function(t,e){t.find(".js-content-container").detach(),t.append(e)},v=function(t,e,i){if(!u){var n=this;u=!0,this.css({height:"auto",overflow:"hidden"}),i&&i.forEach((function(t){n.addClass(t)})),g(this,e),this.animate({height:"auto"},300,(function(){u=!1}))}},b=function(t,e,i){if(!u){var n=this;u=!0,this.css({height:"auto",overflow:"hidden"}),i&&i.forEach((function(t){n.addClass(t)})),this.animate({height:"auto"},300,(function(){g(n,e),u=!1}))}},y=function(t){r()(t.currentTarget).trigger("destroy")},C=function(t,e){return r()("<span />").addClass(t).addClass(e.classes).text(e.text).hide()},w=function(t,e){var i=e.cssClasses||[];p(t,e.lines,{ellipsis:e.ellipsis,callback:function(n,o){if(n){var s=C("js-less",{classes:e.collapseClasses,text:e.collapseText}).show(),a=C("js-more",{classes:e.expandClasses,text:e.expandText}).show().one("click",y),c=r()('<div class="js-content-container" />').html(t.text()).append(a),u=r()('<div class="js-content-container" />').html(o).append(s);t.html("").append(c),a.on("click",l.a.bind(v,t,c.outerHeight(),u,i)).on("click",(function(t){t.preventDefault(),t.stopPropagation(),e.showmoreCallback&&e.showmoreCallback()})),s.on("click",l.a.bind(b,t,c.outerHeight(),c,i)),s.on("click",l.a.bind(b,t,c.outerHeight(),c,i)).on("click",(function(){e.showlessCallback&&e.showlessCallback()}))}e.after&&e.after()},withoutDelay:e.withoutDelay})},T=function(t,e){if(""!==t.html()&&0===t.find(".js-more").length){var i=C("js-more",{classes:e.buttonClass?e.buttonClass:"description-more",text:e.expandText}).one("click",(function(t){t.preventDefault(),t.stopPropagation(),y(t),i.remove()})).on("hover",(function(t){t.preventDefault(),t.stopPropagation()}));t.append(i)}!function(t,e,i){i&&i.withoutDelay?m(t,e,i):setTimeout((function(){m(t,e,i)}),0)}(t,e.lines,{ellipsis:e.ellipsis,callback:function(t,i){t&&i.prevObject.find("span.description-more").show(),e.after&&e.after()},withoutDelay:e.withoutDelay})};e.default=function(t,e){var i,n=!1,s=o()(e),r=!1;"number"===s?(i=e,n=!!arguments[2]):"object"===s&&(i=e.lines,e.lines=e.lines||1,n=!!e.showMore,delete e.showMore,e.showMore=null,r=e.withoutDelay),n?e.isOnlyShow?T(t,l.a.extend({},d,e)):w(t,l.a.extend({},d,e)):r?f(t,i):p(t,i)}},134:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(15),s=i(27),r=i.n(s),a=i(3),l=i.n(a),c=i(26),u=i(52),d=i(350),h=i(1509),f=i.n(h),p=i(8),m=i(46),g=u.default.Activity.extend({getDetailUrl:function(){return this.get("RelatedItem")?this.get("RelatedItem").Url:""},getOwner:function(){return this.get("Owner")},getMonth:function(){return this.get("Month")},getNumberTags:function(){return p.default.getCurrentGroup()&&"KnowledgeCenter"===p.default.getGroupType()?this.has("Activity")&&this.get("Activity").Terms?this.get("Activity").Terms.length:0:this.has("Activity")&&this.get("Activity").Hashtags?this.get("Activity").Hashtags.length:0}}),v=g.extend({constructor:function(){r.a.Model.apply(this,arguments);var t=this.get("Activity");t&&(this.attributes.ParsedMessage=d.default.parseMentions(t.Message,t.Mentions,f.a))},getDetailUrl:function(){var t="";return t=o.default.isProfile()?n.default.getBaseSiteHost()+this.get("Activity").Group.Url:m.default.getGroupUrl(),encodeURI("".concat(t,"/SitePages/File Detail.aspx?ActivityId=").concat(this.get("Activity").Id,"&AttachmentId=").concat(this.get("Id")))},getOwner:function(){return this.get("Activity").Owner},getMonth:function(){return this.get("Activity").Month}}),b=g.extend({constructor:function(){r.a.Model.apply(this,arguments);var t=this.cid.split("c")[1];this.id=t,this.attributes.Id=t,this.attributes.Device="OneDrive",this.attributes.IsFolder||(this.attributes.Extension=this.getExtension(),this.attributes.FileName="".concat(this.attributes.FileName,".").concat(this.attributes.Extension))},getExtension:function(){return this.attributes.Url.split(".").pop()},getDetailUrl:function(){return this.attributes.IsFolder?"#":n.default.getMySiteSiteCollection()+this.get("Url")},getOwner:function(){return this.get("Creator").FullName},getMonth:function(){return null}}),y=v.extend({idAttribute:"DirectoryContentId"}),C=g.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Activities/").concat(this.get("Id"))},getDetailUrl:function(){var t="";return t=o.default.isProfile()?"".concat(n.default.getBaseSiteCollection(),"/groups/").concat(this.get("Activity").Group.GroupId):m.default.getGroupUrl(),encodeURI("".concat(t,"/SitePages/Poll Detail.aspx?ActivityId=").concat(this.get("Id")))}}),w=g.extend({constructor:function(){r.a.Model.apply(this,arguments);var t=this.get("Activity");this.attributes.ParsedMessage=d.default.parseMentions(t.Message,t.Mentions,f.a)},getDetailUrl:function(){var t="";o.default.isProfile()?t=this.get("Activity").Group?"".concat(n.default.getBaseSiteCollection(),"/groups/").concat(this.get("Activity").Group.GroupId):"#":t=m.default.getGroupUrl();return encodeURI("".concat(t,"/SitePages/Link Detail.aspx?ActivityId=").concat(this.get("Activity").Id))},getOwner:function(){return this.get("Activity").Owner},getMonth:function(){return this.get("Activity").Month}}),T=g.extend({getDetailUrl:function(){var t="";return t=o.default.isProfile()?"".concat(n.default.getBaseSiteCollection(),"/groups/").concat(this.get("Activity").Group.GroupId):m.default.getGroupUrl(),encodeURI("".concat(t,"/SitePages/Calendar Detail.aspx?ActivityId=").concat(this.get("Id")))}}),x=g.extend({idAttribute:"Id",sync:function(t,e,i){return"update"===t&&l.a.extend(i,{url:this.urlRoot}),x.__super__.sync.call(this,t,e,i)},getDetailUrl:function(){var t="";return t=o.default.isProfile()?"".concat(n.default.getBaseSiteCollection(),"/groups/").concat(this.get("Group").GroupId):m.default.getGroupUrl(),encodeURI("".concat(t,"/SitePages/Tasks Detail.aspx?ActivityId=").concat(this.get("Id")))}}),O=g.extend({initialize:function(){this.attributes.Hashtags=this.attributes.Tags},getDetailUrl:function(){return o.default.isProfile()?n.default.getBaseSiteHost()+this.attributes.Url:n.default.getBaseSiteCollection()+this.attributes.Url}}),S=c.default.extend({constructor:function(){r.a.Model.apply(this,arguments);var t=this.get("Activity");this.attributes.ParsedMessage=d.default.parseMentions(t.Message,t.Mentions,f.a)},getDetailUrl:function(){return"".concat(n.default.getBaseSiteCollection()+this.get("Activity").Group.Url,"?activity=").concat(this.get("Activity").Id)},getOwner:function(){return this.get("Owner")},getMonth:function(){return this.get("Month")},getNumberTags:function(){return beezyCurrentGroup&&"KnowledgeCenter"===beezyCurrentGroup.Type?this.has("Activity")&&this.get("Activity").Terms?this.get("Activity").Terms.length:0:this.has("Activity")&&this.get("Activity").Hashtags?this.get("Activity").Hashtags.length:0}}),I=g.extend({getDetailUrl:function(){return"".concat(this.get("Group").Url,"/SitePages/Idea Detail.aspx?ActivityId=").concat(this.get("Id"))}}),A=g.extend({getNumberTags:function(){return this.has("Hashtags")?this.get("Hashtags").length:0}});e.default={FeedItem:g,FilesFeedItem:v,DirectoryFilesFeedItem:y,PollFeedItem:C,LinkFeedItem:w,CalendarFeedItem:T,TaskFeedItem:x,CommunityFeedItem:O,OneDriveFileFeedItem:b,VideoFeedItem:S,ExtendedIdeaFeedItem:I,CorporateFeedItemMySite:A}},137:function(t,e,i){"use strict";i.r(e);var n=i(7),o=i(2),s=i(2120),r=i.n(s);function a(){this.EmptyStateValue={AllStories:{Type:n.default.EmptyStateType.listStories,IconEmpty:"icon--empty-allitems",EmptyTitle:Object(o.translate)("What's a hot topic lately?"),EmptyMessageInfoHTML:'<button class="btn--plain empty-state__button js-new-article">'.concat(Object(o.translate)("Write a new article"),"</button> ").concat(Object(o.translate)("to get started")),CustomCssClass:"card-container"},AllPages:{Type:n.default.EmptyStateType.listPages,IconEmpty:"icon--empty-allpages",EmptyTitle:Object(o.translate)("No pages here yet"),EmptyMessageInfoHTML:'<button class="btn--plain empty-state__button js-new-page">'.concat(Object(o.translate)("Create a new page"),"</button> ").concat(Object(o.translate)("to get started")),CustomCssClass:"card-container"},ChannelsStories:{Type:n.default.EmptyStateType.listCategories,IconEmpty:"icon--empty-channels",EmptyTitle:Object(o.translate)("No channels here yet"),EmptyMessageInfoHTML:"".concat(Object(o.translate)("Start things off by"),' <a class="js-text-addnode"> ').concat(Object(o.translate)("adding a new category"),"</a>"),CustomCssClass:"card-container"},TopicsCorporatePages:{Type:n.default.EmptyStateType.allTopics,IconEmpty:"icon--empty-channels",EmptyTitle:Object(o.translate)("No topics here yet"),EmptyMessageInfoHTML:"".concat(Object(o.translate)("Start things off by"),' <a class="js-text-addnode"> ').concat(Object(o.translate)("adding a new topic"),"</a>"),CustomCssClass:"card-container"},UserStories:{Type:n.default.EmptyStateType.listUserStories,IconEmpty:"icon--empty-users",EmptyTitle:Object(o.translate)("Assign some roles"),EmptyMessageInfoHTML:'<a class="js-action-emptystate">'.concat(Object(o.translate)("Add your first users"),"</a> ").concat(Object(o.translate)("to get things going")),CustomCssClass:"card-container"},Audiences:{Type:n.default.EmptyStateType.listAudiences,IconEmpty:"icon--empty-audiences",EmptyTitle:Object(o.translate)("No audiences here yet"),EmptyMessageInfoHTML:"".concat(Object(o.translate)("Start things off by"),'<a class="js-text-addnode"> ').concat(Object(o.translate)("adding a new category"),"</a> "),CustomCssClass:"card-container"},OrgStructure:{Type:n.default.EmptyStateType.orgStructure,IconEmpty:"icon--empty-org-structure",EmptyTitle:Object(o.translate)("You have no sites or categories"),EmptyMessageInfoHTML:"".concat(Object(o.translate)("Your organization structure will appear here. You can start by"),' <a class="js-text-addnode">').concat(Object(o.translate)("creating a new category"),"</a>"),CustomCssClass:"card-container"},WikiRoot:{Type:n.default.EmptyStateType.wikiRoot,IconEmpty:"icon--wiki-empty",EmptyTitle:Object(o.translate)("This wiki is empty"),EmptyMessageInfoHTML:Object(o.translate)("Wikis are a great way to capture information, exchange it with your colleagues and build knowledge with your team"),newItemSeparated:Object(o.translate)("Create a wiki page"),CustomCssClass:"card-container"},AllChannels:{Type:n.default.EmptyStateType.allChannels,IconEmpty:"icon--cactus",EmptyTitle:Object(o.translate)("Looks like you don't have anything here"),EmptyMessageInfoHTML:Object(o.translate)("Content in this page will appear here as soon as you create it."),CustomCssClass:"card-container"},SortableList:{Type:n.default.EmptyStateType.sortableList,IconEmpty:"icon--card-pile",EmptyTitle:"",EmptyMessageInfoHTML:Object(o.translate)("Drag an article here")},DefaultFeed:{Type:n.default.EmptyStateType.defaultFeed,IconEmpty:"icon--wiki-empty",EmptyTitle:Object(o.translate)("This feed is empty"),newItemSeparated:Object(o.translate)("Create a new item")},LandingCorporatePages:{Type:n.default.EmptyStateType.landingCorporatePages,IconEmpty:"icon--cactus",EmptyTitle:Object(o.translate)("Nothing here yet"),EmptyMessageInfoHTML:Object(o.translate)("Content will appear here as soon as it is created.")},FeedCorporatePagesFeatured:{Type:n.default.EmptyStateType.feedCorporatePagesFeatured,IconEmpty:"icon--empty-pages",EmptyTitle:Object(o.translate)("No pages here yet"),EmptyMessageInfoHTML:Object(o.translate)("Featured pages will appear here.")},FeedCorporatePagesForYou:{Type:n.default.EmptyStateType.feedCorporatePagesForYou,IconEmpty:"icon--empty-pages",EmptyTitle:Object(o.translate)("No pages here yet"),EmptyMessageInfoHTML:Object(o.translate)("Pages from topics you follow will appear here.")},NoResutsFound:{Type:n.default.EmptyStateType.noResultsFound,IconEmpty:"icon--empty-no-results",EmptyTitle:Object(o.translate)("Oh crumbs! No results found"),EmptyMessageInfoHTML:Object(o.translate)("Try searching for more generic words.")},MetadataFilter:{Type:n.default.EmptyStateType.metadataFilter,IconEmpty:"icon--empty-metadata",EmptyTitle:Object(o.translate)("Filters not configured"),EmptyMessageInfoHTML:Object(o.translate)("The owner of this knowledge center has yet to configure the metadata.")},ModalMetadata:{Type:n.default.EmptyStateType.modalMetadata,IconEmpty:"icon--ic-info-gray",EmptyTitle:Object(o.translate)("Filters not configured"),EmptyMessageInfoHTML:Object(o.translate)("The owner of this knowledge center has yet to configure the metadata. Don't worry though, you can share knowledge now and tag it later.")},MetadataKCSettings:{Type:n.default.EmptyStateType.metadataKCSettings,IconEmpty:"icon--empty-metadata",EmptyTitle:Object(o.translate)("No metadata found"),EmptyMessageInfoHTML:Object(o.translate)("Contact your SharePoint administrator to add some."),CustomCssClass:"metadata-empty"},FeedCorporatePagesAddedTopicsMySite:{Type:n.default.EmptyStateType.corporatePagesAddedTopicsMySite,IconEmpty:"icon--empty-pages",EmptyTitle:Object(o.translate)("No pages here yet"),EmptyMessageInfoHTML:Object(o.translate)("Pages added to official topics by an editor or a writer will appear here."),CustomCssClass:"card-container"},CorporatePages:{Type:n.default.EmptyStateType.corporatePages,IconEmpty:"icon--empty-pages",EmptyTitle:Object(o.translate)("Add pages to your site"),EmptyMessageInfoHTML:Object(o.translate)("These pages will appear in the site overview page"),CustomCssClass:"empty-pages"},TeamCorporateSite:{Type:n.default.EmptyStateType.teamCorporateSite,IconEmpty:"icon--corporatesite__team--empty",EmptyTitle:Object(o.translate)("You have no team members"),EmptyMessageInfoHTML:'<p class="empty-state__text">'.concat(Object(o.translate)("Your team structure will appear here. Start by creating a new section."),'</p><button class="btn btn--primary js-add-section">').concat(Object(o.translate)("Add section"),"</button>"),CustomCssClass:"corporatesite__team--empty"}}}a.prototype={getEmptyStateByType:function(t){if(t)return Object.values(this.EmptyStateValue).find((function(e){return e.Type===t}))},getTemplateByType:function(t){var e=this.getEmptyStateByType(t);return r()(e)}},e.default=a},138:function(t,e,i){"use strict";var n=i(2211);i.d(e,"addContentToFragment",(function(){return n.default}));i(368);var o=i(1456);i.d(e,"createModalContainer",(function(){return o.default}));i(1454),i(1489);var s=i(2212);i.d(e,"selectInputText",(function(){return s.default}))},139:function(t,e,i){"use strict";i.r(e);var n=i(19),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(13),u=i(548),d=i.n(u),h=c.default.extend({template:d.a,dom:{componentContainer:".js-containerComponent",buttonSave:".js-button-save",literalErrorAPICall:".js-error-apicall",deleteContainer:".js-delete"},classes:{buttonSave:"btn btn--primary js-save",disable:"is-disabled"},events:{"click .js-save":"save","click .js-cancel":"close","click .js-delete":"delete"},initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this.model="function"==typeof t.Model?new t.Model:{}},render:function(){this.$el.html(this.template(this.options)),this.configureContainer(),this.addContainerComponents(),this.postrender()},configureContainer:function(){this.containerDelete=this.$el.find(this.dom.deleteContainer),this.containerErrorAPI=this.$el.find(this.dom.literalErrorAPICall),this.containerComponents=this.$el.find(this.dom.componentContainer)},addContainerComponents:function(){var t=this;l.a.each(this.components,(function(e){t.containerComponents.append('<div class="form__row"><div class="dialog__components-'.concat(e.name," js-dialog-").concat(e.name,'"></div></div>'))}))},bindEventsValidator:function(t){var e=this;t.on("valid",(function(t){t.unsetError(),e.buttonSave.enable()})),t.on("invalid",(function(t,i){t.setError(i),e.buttonSave.disable()}))},save:function(t){var e=this,i=this,n=o.a.defer();if(t.preventDefault(),!this.buttonSave.isDisabled){var s=!!this.$el.find(".js-create-another:checked").length;return this.buttonSave.toggleLoading(),this._saveAttributes().done((function(){e.model.save().then((function(t){i.buttonSave.toggleLoading(),n.resolve(!0),i.options.isNew?i.trigger("create",t,i.options,s):i.trigger("update",t,i.options)}),(function(t){i.buttonSave.toggleError(),i.setError(t.statusText)}))})),n.promise}},close:function(t){t.preventDefault(),this.trigger("close")},delete:function(t){t.preventDefault(),r()(t.currentTarget).hasClass("is-disabled")||this.trigger("delete",this.model,this.options)},setError:function(t){this.containerErrorAPI.html(t),this.containerErrorAPI.show(),this.buttonSave.disable()}});e.default=h},140:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(27),r=i.n(s).a.Collection.extend({initialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=o.a.defaults(e,{skip:0,take:20})},parse:function(t){return this.lastFetchLen<t.length?(t.pop(),this.hasMoreItems=!0):this.hasMoreItems=!1,t},fetch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.data=t.data||{},t.data.skip=t.data.skip?t.data.skip:this.options.skip,t.data.take=t.data.take?t.data.take:this.options.take,this.lastFetchLen=t.data.take,t.data.take+=1,r.__super__.fetch.call(this,t)}});e.default=r},1405:function(t,e,i){"use strict";i.r(e);var n=i(18),o=i(2),s=i(13),r=i(2443),a=i.n(r),l=i(46),c=s.default.extend({template:a.a,events:{"click .js-search":"search"},dom:{input:".js-input-finder",search:".js-search"},initialize:function(t){t=t||{},this.placeholder=t.placeholder||Object(o.translate)("Find..."),this.feed=t.feed,this.maxLength=t.maxLength||255,this.backToFeed=null,this.minLength=t.minLength||3,this.isFiltering=!1,this.redirectOnSearch=t.redirectOnSearch},render:function(){var t=this,e={placeholderFinder:this.placeholder,maxLength:this.maxLength};return this.$el.html(this.template(e)),this.$el.find(this.dom.input).on("keydown",(function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),t.$el.find(t.dom.search).trigger("click"))})),this},search:function(t){t.preventDefault(),t.stopPropagation();var e=this.getSearch();(!e||e.length>=this.minLength)&&(this.redirectOnSearch?n.default.redirectToUrl("".concat(l.default.getGroupUrl(),"/Sitepages/Wiki.aspx?search=").concat(encodeURIComponent(e))):(this.clearOtherFilters(),this.trigger("search",{text:e}),e?(this.feed._filter={text:{filter:e,label:e,type:this.feed.type}},this.setFilterSearch({text:e})):this.clear()))},getSearch:function(){return this.$el.find(this.dom.input).val()},setSearch:function(t){this.$el.find(this.dom.input).val(t)},hasSearch:function(){return this.isFiltering},setFilterSearch:function(t){this.isFiltering=!0,this.feed.setFilterSearch?this.feed.setFilterSearch(t):(this.feed.collection.filtered=!1,this.feed.collection.setFilter(t),this.feed.refresh())},clear:function(){this.feed.collection.resetTextSearch&&this.feed.collection.resetTextSearch(),this.setSearch(""),this.isFiltering=!1},clearOtherFilters:function(){this.feed.collection.resetOthers&&this.feed.collection.resetOthers()},setFeed:function(t){this.feed=t},setBackToFeed:function(t){this.backToFeed=t},getBackToFeed:function(){return this.backToFeed}});c.tabs={id:"textSearch"},e.default=c},142:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(27),s=i.n(o),r=i(52),a=i(954),l=i(47),c=s.a.Collection.extend({model:r.default.Activity,orderTypes:{mostRecent:"mostRecent",mostLiked:"mostLiked",oldest:"oldest"},initialize:function(t){this.activity=t.activity},url:function(){var t=this.activity.isQuestion()?"/Questions/":"/Activities/";return"".concat(n.default.getApiUrlv2()).concat(t).concat(this.activity.id,"/Comments")},parse:function(t,e){var i=e.data&&e.data.take;return t.length<i||(this.order===this.orderTypes.mostRecent?t.splice(0,1):this.order===this.orderTypes.mostLiked?t.splice(-1,1):this.order===this.orderTypes.oldest&&t.splice(0,1)),t},setOrder:function(t){this.order=t},createComment:function(t){var e=this,i=new a.default.RawComment;this.listenTo(i,"create",(function(t){e.push(t.attributes),e.trigger("commented"),e.stopListening(i)})),this.listenTo(i,"error",(function(){l.default.showGenericError(),e.trigger("commented"),e.stopListening(i)})),i.create(this.activity.id,t)}}),u=c.extend({model:r.default.CommunityAnswer});e.default={Comments:c,Answers:u}},1429:function(t,e,i){"use strict";var n=i(1),o=i.n(n).a.createContext(null);e.default=o},1430:function(t,e,i){"use strict";e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location.origin;if(!t)return"";var i=t.substring(t.lastIndexOf("/")+1).split("?")[0],n=t.split(i)[0].startsWith("http")?t.split(i)[0]:e+t.split(i)[0],o=/\.((\w|\d){3,5})$/.exec(i);return o?"".concat(n,"_w/").concat(i.substring(0,o.index),"_").concat(o[1],".jpg"):""}},1431:function(t,e,i){"use strict";var n=i(1430);e.default=function(t,e,i,o){if(!t)return"";if(t.startsWith("http"))return t;var s=Object(n.default)(o+t,i);if(e){var r=-1===s.indexOf("?")?"?":"&";s="".concat(s).concat(r,"lastUpdated=").concat(e)}return s.replace(/#/g,"%23")}},1437:function(t,e,i){"use strict";e.default=function(){return window.beezyCurrentUser&&window.beezyCurrentUser.LocalEntity||{}}},144:function(t,e,i){"use strict";i(809);var n=i(1989);i.d(e,"useObserver",(function(){return n.default}));var o=i(1990);i.d(e,"useShow",(function(){return o.default}));var s=i(1991);i.d(e,"useCombinedRefs",(function(){return s.default}));var r=i(1992);i.d(e,"useScrollTo",(function(){return r.default}));i(1993);var a=i(1994);i.d(e,"useLoadMore",(function(){return a.default}));var l=i(1995);i.d(e,"usePopoverEvents",(function(){return l.default}))},1444:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(395),l=i(9),c=i(188),u=i(1850);var d=function(t){var e=t.modalElem,i=t.onClose,n=t.onConfirm,s=t.show;return o.a.createElement(c.default,{cancelMessage:Object(l.getTranslation)("Got it"),confirmMessage:Object(l.getTranslation)("Sign in as regular user"),extraClasses:{header:u.default.modal__header,wrapper:u.default.modal__wrapper},modalElem:e,onCancel:i,onClose:i,onConfirm:n,show:s,size:"small"},o.a.createElement("section",{className:"bz-modal__body--Z4pvgW"},o.a.createElement("svg",{className:"bz-modal__image--Z4pvgW",xmlns:"http://www.w3.org/2000/svg",width:"192",height:"257"},o.a.createElement("path",{d:"M0 256.375h192v-42.559H0v42.559zm69.558-16.1H122.5v-10.38H69.56v10.38zm26.538-133.252c11.768-.056 21.317-9.63 21.284-21.34-.034-11.67-9.78-21.392-21.357-21.303-11.927.091-21.425 9.634-21.4 21.501.024 11.657 9.713 21.197 21.473 21.142zm-.124 34.551c-.524-.485-.953-.856-1.354-1.257-7.959-7.936-15.895-15.894-23.904-23.779-.645-.635-1.91-1.272-2.666-1.072-12.9 3.404-21.678 11.28-24.466 24.522-1.165 5.536-.814 11.414-.94 17.141-.138 6.302-.032 12.611-.032 19.068h106.641v-3.035c-.013-8.242-.092-16.485-.025-24.728.131-16.25-8.91-28.334-24.584-32.838-1.466-.42-2.415-.226-3.508.88-7.664 7.763-15.398 15.455-23.115 23.166-.635.634-1.305 1.233-2.047 1.932zM.131 202.837h191.673V43.108H.131v159.729zM112.106 21.495h10.41V11.136h-10.41v10.359zm-42.63.029h31.755V11.195H69.477v10.329zM.118 32.212h191.689V.5H.117v31.712z",fill:"#E2E8EA",fillRule:"evenodd"})),o.a.createElement("h3",{className:"bz-modal__title--Z4pvgW"},Object(l.getTranslation)("Account limitation")),o.a.createElement("p",{className:"bz-modal__intro--Z4pvgW"},Object(l.getTranslation)("You are signed as an anonymous user in read-only mode, this is why you cannot perform the requested action."))))};d.propTypes={modalElem:Object(a.HTMLElement)({isRequired:!0}),onClose:r.a.func.isRequired,onConfirm:r.a.func.isRequired,show:r.a.bool},d.defaultProps={show:!1},e.default=d},1445:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(9),l=i(627),c=i(1561);var u=function(t){var e=t.modalElem,i=t.onClose,n=t.onConfirm,s=t.show;return o.a.createElement(l.default,{cancelMessage:Object(a.getTranslation)("Take me back"),confirmMessage:Object(a.getTranslation)("I understand the risk"),extraClasses:{wrapper:c.default["modal--z-index"],header:c.default.modal__header,body:c.default.modal__body},show:s,modalElem:e,onCancel:i,onClose:i,onConfirm:n,title:Object(a.getTranslation)("Privacy warning")},o.a.createElement("p",{className:"bz-modal__message--Zw07Oo"},Object(a.getTranslation)("You are about to sign in on a shared computer. Make sure to sign out once you are done.")))};u.propTypes={modalElem:r.a.shape({}).isRequired,onClose:r.a.func.isRequired,onConfirm:r.a.func.isRequired,show:r.a.bool},u.defaultProps={show:!1},e.default=u},1449:function(t,e,i){"use strict";var n={unescapeHTML:function(t){return String(t).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&#47;/g,"/").replace(/&#39;/g,"'").replace(/&#123;/g,"{").replace(/&#125;/g,"}").replace(/&#58;/g,":")},escapeHTMLXSS:function(t){return String(t).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\//g,"&#47;").replace(/'/g,"&#39;")}};e.default=n},145:function(t,e,i){"use strict";var n=i(2),o=i(502),s=i(1492),r=i.n(s),a=i(341),l=i.n(a),c=i(211),u=i.n(c),d=o.default.extend({texts:{listPlaceholder:Object(n.translate)("No users added"),invalidSelectedItem:Object(n.translate)("User already selected"),pickerPlaceholder:Object(n.translate)("Add users")},domUserList:{selectorArea:".js-showInvitationsType",lowerRow:".js-lower-row"},type:"user-list",template:r.a,templateItemList:l.a,initialize:function(t){var e=this,i=this;this.options=t||{},this.options.itemList=t.itemList,this.options.searchAdapterString=t.searchAdapterString||"Users",this.options.pickerValueSelector=t.pickerValueSelector||"FullName",this.options.pickerItemTemplate=t.pickerItemTemplate||u.a,this.options.keyParameter=t.keyParameter||"Id",this.options.placeholder=t.placeholder||"",this.options.hasButtonMulti=void 0===t.hasButtonMulti||t.hasButtonMulti,this.options.pickerPlaceholder=this.options.placeholder||this.texts.pickerPlaceholder,this.options.listPlaceholder=this.options.placeholderList||this.texts.listPlaceholder,this.options.template=t.template||this.template,this.options.templateItemList=t.templateItemList||this.templateItemList,this.options.itemsNotClickables=t.itemsNotClickables||!1,this.options.hasRemoveIcon=t.hasRemoveIcon||!1,this.options.hasToolsPopup=t.hasToolsPopup||!1,this.options.templateToolsPopup=t.templateToolsPopup,this.options.roleName=t.roleName||"",this.options.itemListTools=t.itemListTools||[],this.options.hasPicker=void 0===t.hasPicker||t.hasPicker,d.__super__.initialize.call(this,this.options),this.on("beforeAdd",(function(t,i){Array.isArray(t)?t.forEach((function(t){return e.setRole(t,i)})):e.setRole(t,i)})),this.on("add",(function(t){i.trigger("addExclude",t)})),this.on("remove",(function(t){i.trigger("removeExclude",t)}))},setRole:function(t,e){this.picker.selector&&e?t.Role=parseInt(this.picker.selector.getValue(),10):t.Role=t.Role>0?t.Role:2},addExcludedItem:function(t){this.trigger("addExcludeItem",t)},removeExcludedItem:function(t){this.trigger("removeExcludeItem",t)},addUser:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.addItem(t,e,i)},removeSelectedUsers:function(){this.removeSelectedItem()},isInItemList:function(t){var e=t[this.options.keyParameter];return this.itemList.find((function(t){return t[this.options.keyParameter]===e}),this)},isUserInItemList:function(t){return this.isInItemList(t)},updateItem:function(t,e,i){this.itemList.updateItem(t,e,i)},setEmptyState:function(){this.options.hasEmptyState&&(this.itemList._$items.length?(this.$(this.dom.LIST).show(),this.$(this.domUserList.lowerRow).css("display","block"),this.$(this.dom.REMOVE).show(),this.$el.find(this.dom.emptyState).hide()):(this.$(this.dom.LIST).hide(),this.$(this.domUserList.lowerRow).hide(),this.$(this.dom.REMOVE).hide(),this.$el.find(this.dom.emptyState).show()))}});e.default=d},1450:function(t,e,i){"use strict";var n=i(2224);i.d(e,"getBeezyColors",(function(){return n.default}));var o=i(2225);i.d(e,"getColorValue",(function(){return o.default}))},1454:function(t,e,i){"use strict";var n="Chrome",o="Edge",s="Firefox",r="IE";e.default=function(){var t,e,i,a;return navigator.browser||(navigator.browser=(e=navigator.userAgent,i=null,(a=e.match(/(edge(?=\/))\/?\s*(\d+)/i)||[]).length&&"Edge"===a[1]?i={name:"Edge",version:a[2]}:(a=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(a[1])&&(t=/\brv[ :]+(\d+)/g.exec(e)||[],i={name:"IE",version:t[1]||""}),"Chrome"===a[1]&&null!=(t=e.match(/\bOPR\/(\d+)/))&&(i={name:"Opera",version:t[1]})),i||(a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=e.match(/version\/(\d+)/i))&&a.splice(1,1,t[1]),"MSIE"===a[0]&&(a[0]="IE"),i={name:a[0],version:a[1]}),i.isIE=function(){return i.name===r},i.isChrome=function(){return i.name===n},i.isFirefox=function(){return i.name===s},i.isIE10=function(){return i.name===r&&"10"===i.version},i.isIE11=function(){return i.name===r&&"11"===i.version},i.isEdge=function(){return i.name===o},i)),navigator.browser}},1456:function(t,e,i){"use strict";function n(t){var e=t.el,i=void 0===e?"div":e,n=t.id,o=void 0===n?"modal":n,s=document.getElementById(o);if(s)return s;var r=document.createElement(i);return r.setAttribute("id",o),document.body.appendChild(r),r}i.d(e,"default",(function(){return n}))},1457:function(t,e,i){"use strict";var n=i(3),o=i.n(n),s=i(73),r=i(87),a=i.n(r),l=i(584),c={initialize:function(){l.default.UserAutocompleteComponent.prototype.keyPress=function(t){if(this.microbox.disabled)return!1;var e=String.fromCharCode(t.which),i=this.previousChar;return e!==this.triggerCharacter||i&&","!==i&&" "!==i?this.buffering&&this.acceptedCharacters.test(e)?this.buffer.increment(e):this.buffering&&13!==t.which&&this.buffer.empty():(this.buffer.set(e),this.startBuffering()),this.previousChar=e},l.default.UserAutocompleteComponent.prototype.bufferChanged=function(t){if(this.buffering||t===this.triggerCharacter)return t.length>=this.autocompleteThreshold+1?this.searchFor(t.slice(1)):(this.buffering||(this.buffering={},this.autocomplete()),this.searchForOfficeGraph(t))},l.default.UserAutocompleteComponent.prototype.searchForOfficeGraph=function(t){var e=this;if(this.autocomplete(),!s.default.PeopleWorkingWith)return s.default.GetPeopleWorkingWith((function(i){var n=o.a.filter(i,(function(e){if(e.FullName.toLowerCase().indexOf(t.slice(1).toLowerCase())>-1)return e}));s.default.PeopleWorkingWith=n,e.updateAutocomplete(n)}));var i=o.a.filter(s.default.PeopleWorkingWith,(function(e){if(e.FullName.toLowerCase().indexOf(t.slice(1).toLowerCase())>-1)return e}));e.updateAutocomplete(i)},l.default.UserAutocompleteComponent.prototype.updateSelectionPosition=function(){if(this.buffering){var t=a.a.getSelection();return this.buffering.endNode=t.focusNode,this.buffering.endOffset=t.focusOffset,this.buffering.startNode=t.focusNode,this.buffering.startOffset=t.focusOffset-this.buffer.content().length}},l.default.UserAutocompleteComponent.prototype.autocomplete=function(){var t=this;this.buffering&&(this._autocomplete||(this._autocomplete=new this.AutocompleteDropdown({callback:this.createBox,autocompleteObserver:this})),this._autocomplete.appendTo(this.microbox.container),this._autocompleteWaiting=!0,setTimeout((function(){t._autocomplete&&t._autocompleteWaiting&&t._autocomplete.startLoading()}),500))}}};e.default=c},147:function(t,e,i){"use strict";i.r(e);var n,o=i(98),s=i.n(o),r=i(1752),a=i(5),l=i(166),c=i(15),u=i(17),d=i(4),h=i.n(d),f=i(3),p=i.n(f),m=i(2),g=i(116),v=i(2132),b=i.n(v),y=i(2133),C=i.n(y),w=i(204),T=i.n(w),x=i(46),O=(i(252),n=document.createElement("div"),function(t){n.innerHTML=t;var e=n.firstChild;return n.removeChild(e),e}),S=g.default.extend({data:null,_jQueryFileUpload:null,eventsTriggered:{cancel:"cancel",uploading:"uploading",error:"error",complete:"complete",success:"success",preview:"preview",completeall:"completeall"},classes:{dropActive:"qq-upload-drop-area-active",list:"upload-list",file:"file-uploader-attachment",progressBar:"qq-progress-bar",cancel:"qq-upload-cancel"},dom:{button:"#file-uploader",message:"#file-uploader-message",error:"#file-error",progressState:".js-progress-state",dropzone:".js-dropzone"},texts:{failUploadText:"Upload failed"},fileTemplate:b.a,dragDropTemplate:C.a,fileUploadTemplate:T.a,target:function(){return"".concat(a.default.getUrlLayout(),"/Spenta.Beezy/FileUpload.aspx")},init:function(t){return this.addToList=p.a.bind(this.addToList,this),this.options=t,this.targetUrl=t.target||this.target(),this.url=this.getUrl(t.url||this.target(),t.extraParams),this.acceptedFileType=t.acceptedFileType||"",this.autoUpload=t.autoUpload||!1,this.singleFileUploads=void 0===t.singleFileUploads||t.singleFileUploads,this.deferred=t.deferred,this.name=t.name||"noname",this.maxNumberOfFiles=t.maxNumberOfFiles,this.multiple=t.multiple||!1,this.dragDrop=t.dragDrop,this.showProgress=t.showProgress,this.fileTemplate=t.fileTemplate||this.fileTemplate,this.isListHidden=t.isListHidden,this.uploadWithoutButton=t.uploadWithoutButton,this.noFullProgressBar=t.noFullProgressBar||!1,this.enableCropping=t.enableCropping||!1,this.cropOptions=t.cropOptions||{width:0,height:0},this.uploadOriginalImage=t.uploadOriginalImage,t.useTemplate&&this.setTemplate(),this.setElement(t.el),this.dragDrop&&this.setupDragDrop(),this.bindCancelEvent(),this.create()},addToList:function(t,e){var i=this,n={failUploadtext:this.texts.failUploadText},o=O(this.fileTemplate(n));h()(o).data("data",e),h()(o).find(".".concat(this.classes.file)).text(this.formatFileName(t.name)),this.isListHidden&&this.$fileList.addClass("is-hidden"),this.$fileList.append(o),this.options.showProgress&&this.$fileList.show(),h()(this).trigger("fileCountChanged",this.hasFiles()),this.hideMessageError(),this.enableCropping&&r.default.crop(e,this.cropOptions,this.uploadOriginalImage).then((function(t){i.croppedFile=t,h()(i).trigger("cropped")})).catch((function(){i.resetFileList()}))},addExtensionTarget:function(t,e){var i="";i=a.default.isSharepointApp()?a.default.getBaseWebUrl()+this.targetUrl+e:x.default.getGroupUrl()+this.targetUrl+e,this.$fileInput.fileupload("option","url",i),this.upload()},bindEvents:function(){var t=this;this.$button.on("click",(function(e){return e.stopPropagation(),c.default.isReadOnly()?u.default.showReadOnlyModal():t.$fileInput.click()}))},bindCancelEvent:function(){var t=this;this.$fileList.on("click",(function(e){var i=e.target||e.srcElement;if(h()(i).hasClass(t.classes.cancel)){e.preventDefault();var n=h()(i).closest("li").get(0);t.cancelFile(n),n&&n.parentNode&&n.parentNode.childNodes&&1===n.parentNode.childNodes.length&&(t.$fileList.get(0).style.display="none"),h()(n).remove()}}))},cancelFile:function(){this.cancelFilesInProgress(),this.hideMessageError(),h()(this).trigger("fileCountChanged",this.hasFiles()-1)},cancelFilesInProgress:function(){var t=this,e=this.getAllDatas();p.a.each(e,(function(e){"resolved"!==e.state()?(e.abort(),t.refreshProgressBar(t.getItemByData(e.files[0]),e)):h()(t.getItemByData(e.files[0])).remove()}))},changeMultiSiteCollectionGroupUrl:function(t,e){var i;i!==this.checkMyFollows(e)&&(i=a.default.getBaseSiteHost()+e+this.targetUrl,a.default.isSharepointApp()&&(i="".concat(a.default.getBaseWebUrl()+this.targetUrl+(this.targetUrl.includes("?")?"&":"?"),"groupId=").concat(t),beezySettings.ApiServiceV2QueryString&&(i=i+(encodeURI(i).indexOf("?")>-1?"&":"?")+beezySettings.ApiServiceV2QueryString)));this.$fileInput.fileupload("option","url",i)},checkAllFilesUploaded:function(){var t=this.getAllDatas();return p.a.every(t,(function(t){return"resolved"===t.state()}))},checkMyFollows:function(t){return!t&&a.default.getSiteCollectionUrl()+this.targetUrl},clear:function(){this.data=null,this.hideMessage()},configureInputFileTypes:function(){this.acceptedFileType.acceptAttribute&&this.$fileInput.attr("accept",this.acceptedFileType.acceptAttribute)},create:function(){var t=this;if(!this._uploader){var e=this.$fileInput.fileupload({url:t.url,dataType:"json",autoUpload:t.autoUpload,maxNumberOfFiles:t.maxNumberOfFiles,dropZone:t.$el.find(".js-dropzone"),multipart:!0,singleFileUploads:t.singleFileUploads,beforeSend:function(e){e.setRequestHeader("Accept","application/json; charset=utf-8"),t.options.beforeSend&&t.options.beforeSend(e)},done:function(e,i){var n,o;i.name=t.name,t.deferred&&t.deferred.resolve(i),Object.prototype.hasOwnProperty.call(null==i?void 0:i.result,"success")&&(null==i||null===(n=i.result)||void 0===n||!n.success)||Object.prototype.hasOwnProperty.call(null==i?void 0:i.result,"Success")&&(null==i||null===(o=i.result)||void 0===o||!o.Success)?h()(t).trigger(t.eventsTriggered.error,i.result.details):h()(t).trigger(t.eventsTriggered.success,i,e),t.checkAllFilesUploaded()&&(h()(t).trigger(t.eventsTriggered.completeall),t.reset())},fail:function(e,i){i.name=t.name,t.deferred&&t.deferred.reject(i),i&&"object"===s()(i)?h()(t).trigger("abort"===i.errorThrown?t.eventsTriggered.cancel:t.eventsTriggered.error,Object(m.translate)(i.errorThrown)):h()(t).trigger(t.eventsTriggered.error,i)},always:function(e,i){i.name=t.name,t.deferred&&t.deferred.notify(i),h()(t).trigger(t.eventsTriggered.complete,Object.assign(i,{croppedFile:t.croppedFile}))},add:function(e,i){if(c.default.isReadOnly())return u.default.showReadOnlyModal();if(t.data=i,t.$fileInput=h()(this),t.maxNumberOfFiles&&i.files.length>t.maxNumberOfFiles)h()(t).trigger(t.eventsTriggered.error,"maxNumberOfFiles");else{if(t.isNotAcceptedFile(i.originalFiles[0].type)){var n=Object(m.translate)("An unexpected error occurred. You may be uploading a file too large.");throw alert(n),Error(n)}p.a.each(i.files,(function(e){t.addToList(e,i)}),this),h()(t).trigger("preview",e.target.result),t.uploadWithoutButton&&t.upload()}},progress:function(e,i){t.showProgress&&i.files&&i.files.length&&(t.toggleInProgress(t.getItemByData(i.files[0]),!0),t.refreshProgressBar(t.getItemByData(i.files[0]),i))}});return this._uploader=e,this.configureInputFileTypes(),l.default.isAppsCloud()||this.$fileInput.fileupload("option",{xhrFields:{withCredentials:!0}}),this._uploader}},destroy:function(){this.unbindEvents(),this.$fileInput.length&&this.$fileInput.fileupload("destroy")},disable:function(){this.$fileInput.fileupload("disable")},enable:function(){this.$fileInput.fileupload("enable"),this.$button.show()},formatFileName:function(t){return t.length>33&&(t="".concat(t.slice(0,19),"...").concat(t.slice(-13))),t},getFilenameWithoutExtension:function(t){return t.substring(0,t.lastIndexOf("."))},getFiles:function(){var t=[],e=this.$fileList.find("> li");return p.a.each(e,(function(e){t.push(h()(e).data("data").files[0])})),t},getAllDatas:function(){var t=[],e=this.$fileList.find("> li");return p.a.each(e,(function(e){t.push(h()(e).data("data"))})),this._findDuplicates(t)},_findDuplicates:function(t){for(var e=[],i=Object(m.translate)("Duplicated files are not allowed"),n=0;n<t.length;n++){var o=t[n].files[0].name;e.indexOf(o)>=0&&(alert(i),t.splice(n,1),this.$fileList.find("> li").eq(n).remove()),e.push(o)}return t},getItemByData:function(t){for(var e=this.$fileList.get(0).firstChild;e;){if(h()(e).data("data").files[0].name===t.name)return e;e=e.nextSibling}},getUrl:function(t,e){var i=t;if(a.default.isSharepointApp()){if(i.toLowerCase().startsWith("http")||(i=a.default.getBaseWebUrl()+i),-1===i.indexOf("groupId=")){var n=encodeURI(i).indexOf("?")>-1?"&":"?";i="".concat(i+n,"groupId=").concat(beezyCurrentGroup?beezyCurrentGroup.GroupId:0)}if(beezySettings.ApiServiceV2QueryString&&-1===i.indexOf(beezySettings.ApiServiceV2QueryString))i=i+(encodeURI(i).indexOf("?")>-1?"&":"?")+beezySettings.ApiServiceV2QueryString}else i.toLowerCase().startsWith("http")||(i=x.default.getGroupUrl()+i);e&&(i=i+(encodeURI(i).indexOf("?")>-1?"&":"?")+e);return i},hasFiles:function(){return this.getAllDatas().length},hideMessage:function(){this.messageContainer.hide(),this.buttonContainer.removeClass("is-disabled")},isNotAcceptedFile:function(t){return this.acceptedFileType&&this.acceptedFileType.fileExtensionsRegEx&&t.length&&!this.acceptedFileType.fileExtensionsRegEx.test(t)},prependUrl:function(t){this.$fileInput.fileupload("option","url",a.default.getBaseWebUrl()+t+this.targetUrl)},refreshProgressBar:function(t,e){if(e&&e.loaded&&e.total){var i=Math.round(e.loaded/e.total*100);h()(t).find(".".concat(this.classes.progressBar)).length&&(h()(t).find(".".concat(this.classes.progressBar)).get(0).style.width=this.noFullProgressBar?"".concat(i-10,"%"):"".concat(i,"%"))}else h()(t).find(".".concat(this.classes.progressBar)).get(0).style.width="".concat(0,"%")},removeUploader:function(){this.$el.find(".js-fileUploader").remove()},reset:function(){this.clear(),this.resetFileList()},resetFileList:function(){this.$fileList.html("")},setElement:function(t){if(this.unbindEvents(),this.$el=h()(t),!this.$el.length)throw new Error("FileUpload: Invalid options.el");this.$button=this.$el.find(".js-fileupload-button"),this.$fileInput=this.$el.find("input.js-fileupload"),this.$fileList=h()("#file-uploader-files",this.el),this.options.showProgress?this.$fileList.show():this.$fileList.hide(),this.messageContainer=this.$el.find(this.dom.message),this.messageErrorContainer=this.$el.find(this.dom.error),this.buttonContainer=this.$el.find(this.dom.button),this.bindEvents()},setTemplate:function(){if(this.options.dragDrop){var t={isIE:h.a.browser.msie,multipleInput:this.multiple?"multiple":"",dragText:this.multiple?Object(m.translate)("Drop files here or"):Object(m.translate)("Drop file here or"),textSelect:this.multiple?Object(m.translate)("select files"):Object(m.translate)("select file"),textProgress:this.options.textProgress||"".concat(Object(m.translate)("Uploading"),"...")};this.options.container.append(this.dragDropTemplate(t))}else this.options.container.append(this.fileUploadTemplate())},setupDragDrop:function(){var t=this,e=this.$el.find(".js-dropzone");h()(document).bind("drop dragover",(function(t){t.preventDefault()})),e.bind("dragenter",(function(e){h()(e.currentTarget).hasClass(t.classes.dropActive)||h()(e.currentTarget).addClass(t.classes.dropActive),e.stopPropagation()})),e.bind("dragleave",(function(e){h()(e.currentTarget).hasClass(t.classes.dropActive)&&h()(e.currentTarget).removeClass(t.classes.dropActive),e.stopPropagation()}))},showMessage:function(){this.buttonContainer.addClass("is-disabled"),this.messageContainer.show()},setError:function(t){this.messageErrorContainer.html(""),this.messageErrorContainer.append(t)},showMessageError:function(){this.messageErrorContainer.show(),h()(this.dom.dropzone).addClass("error")},hideMessageError:function(){this.messageErrorContainer.hide(),h()(this.dom.dropzone).removeClass("error")},toggleInProgress:function(t,e){t&&(e?(h()(this).trigger(this.eventsTriggered.uploading),h()(t).hasClass("is-uploading")||h()(t).addClass("is-uploading")):h()(t).hasClass("is-uploading")&&h()(t).removeClass("is-uploading"))},showUploadingState:function(){this.$el.find(this.dom.dropzone).addClass("is-hidden"),this.$el.find(this.dom.progressState).removeClass("is-hidden")},hideUploadingState:function(){this.$el.find(this.dom.progressState).addClass("is-hidden"),this.$el.find(this.dom.dropzone).removeClass("is-hidden")},unbindEvents:function(){this.$el&&this.$el.off("click")},upload:function(){var t=this;if(this.hasFiles())if(this.options.autoUpload)this.data.submit();else{var e=this.getAllDatas();p.a.each(e,(function(e){e.submit().error((function(e,i){"abort"===i&&h()(t).trigger(t.eventsTriggered.cancel,i)}))}))}else this.deferred&&this.deferred.resolve({name:t.name,result:{url:""},empty:!0})}});e.default=S},1481:function(t,e,i){"use strict";var n=i(749);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.monthsName;return t.map((function(t){return t.substr(0,3)}))}},1482:function(t,e,i){"use strict";e.default=function(t,e,i){return t&&e&&i?t.replace("%m",i[e.getMonth()]).replace("%d",e.getDate()).replace("%y",e.getFullYear()):(console.error("Parameters error:",t,e,i),null)}},1483:function(t,e,i){"use strict";var n=i(240);function o(t){var e=function(t){var e=new RegExp("{.+?}","g");return t.match(e)}(t);if(e&&e.length){var i=t;return e.forEach((function(t){i=i.replace(t,function(t){return t.substring(1,t.length-1)}(t))})),i}return t}e.default=function(t){return"undefined"!=typeof i18n&&void 0!==i18n[t]?o(String(i18n[t])):Object(n.getBeezySettings)("MissingTranslationAsterisk")?"* ".concat(t):t}},1484:function(t,e,i){"use strict";var n=i(219);e.default=function(t){var e=0,i=Object(n.parseDotNetDate)(t);return i.length>2&&(e=parseInt("".concat(i[2],"1"),10)*(60*parseInt(i[3],10)+parseInt(i[4],10))*60*1e3),new Date(Number(i[1])+e)}},1488:function(t,e,i){"use strict";var n;e.default=function(t){if(!document.getElementById("js-assertive-message")){var e=document.createElement("p");e.className+="visually-hidden",e.setAttribute("id","js-assertive-message"),e.setAttribute("aria-live","assertive"),e.setAttribute("aria-hidden",!1),document.body.appendChild(e)}var i=document.getElementById("js-assertive-message");i.innerText=t,i.setAttribute("aria-hidden",!1),n&&clearTimeout(n),n=setTimeout((function(){document.getElementById("js-assertive-message").innerText=""}),2e3)}},1489:function(t,e,i){"use strict";e.default=function(){window.scrollTo(0,document.body.scrollHeight)}},149:function(t,e,i){"use strict";var n=i(2215);i.d(e,"getHostAbsoluteUrl",(function(){return n.default}));var o=i(1490);i.d(e,"getSpPagecontextInfo",(function(){return o.default}));var s=i(2216);i.d(e,"getUrlLayout",(function(){return s.default}))},1490:function(t,e,i){"use strict";e.default=function(){return window._spPageContextInfo||{}}},15:function(t,e,i){"use strict";i.r(e);var n=i(18);e.default={isProfile:function(){return"mysite"===beezyContext.CurrentPageKey},isValidUserFromQueryString:function(){var t=n.default.getQueryString(),e=beezyContext.ProfileUserId||t.IdUser;return(!e||parseInt(e,10)===beezyCurrentUser.Id)&&(!t.accountname&&!t.accountName||beezyCurrentUser.LoginName.split("#").join("%23")===(t.accountName||t.accountname))},isOwnProfile:function(){return this.isValidUserFromQueryString()&&this.isProfile()},getProfileUserId:function(){var t=n.default.getQueryString(),e=beezyContext.ProfileUserId||t.IdUser;return e?parseInt(e,10):null},isOwnerOrSpeakerOrAdminFromGroup:function(t,e){if(!t||!e)return!1;var i=beezyCurrentGroup||e,n=i.IsCurrentUserWebAdmin,o=i.IsCurrentUserSpeaker;return!!i.IsActive&&!!(this.isCurrentUser(t)||o||n)},isCurrentUser:function(t){return beezyCurrentUser&&t===beezyCurrentUser.Id},isReadOnly:function(){return beezyCurrentUser&&beezyCurrentUser.IsReadOnly},getCurrentUser:function(){return beezyCurrentUser&&beezyCurrentUser},getFullName:function(){return beezyCurrentUser&&beezyCurrentUser.FullName},getPictureUrl:function(){return beezyCurrentUser&&beezyCurrentUser.PictureUrl},getBackgroundPictureUrl:function(){return beezyCurrentUser&&beezyCurrentUser.BackgroundPictureUrl?beezyCurrentUser.BackgroundPictureUrl:""},getCurrentUserId:function(){return beezyCurrentUser&&beezyCurrentUser.Id},isBeezyAdministrator:function(){return beezyCurrentUser&&beezyCurrentUser.IsBeezyAdministrator},isBeezyCommunityManager:function(){return beezyCurrentUser&&beezyCurrentUser.IsBeezyCommunityManager},isCommunityCreator:function(){return beezyCurrentUser&&beezyCurrentUser.IsCommunityCreator},getLastUpdated:function(){return beezyCurrentUser&&beezyCurrentUser.LastUpdated},getNetworks:function(){return beezyCurrentUser&&beezyCurrentUser.Networks},getCurrentNetwork:function(){var t,e=this.getNetworks(),i=window.getUrlSite();return"/"===i.substring(i.length-1)&&(i=i.substring(0,i.length-1)),void 0!==e&&e.length&&(t=e.find((function(t){return t.SiteCollections.some((function(t){return t.SiteCollectionUrl===i}))}))),t},canEdit:function(){return this.isAdministrator()},isAdministrator:function(){return beezyCurrentUser&&beezyCurrentUser.IsBeezyAdministrator||beezyCurrentGroup&&beezyCurrentGroup.IsCurrentUserWebAdmin},isIdeasCampaignCreator:function(){return beezyCurrentUser&&beezyCurrentUser.IsIdeasCampaignCreator},isKnowledgeCenterCreator:function(){return beezyCurrentUser&&beezyCurrentUser.IsKnowledgeCenterCreator},isBeezyCorporateRoot:function(){return this.isAdministrator()},isLocalEntityAdministrator:function(){return beezyCurrentUser&&beezyCurrentUser.IsLocalEntityAdministrator},getLocalEntity:function(){return beezyCurrentUser&&beezyCurrentUser.LocalEntity},localEntityAdminHasModuleEnabled:function(){var t=this.getLocalEntity(),e=t.AppsModuleEnabled,i=t.AudiencesModuleEnabled,n=t.DiscoveryCardsModuleEnabled,o=t.HeroModuleEnabled,s=t.NavigationModuleEnabled,r=t.SitesModuleEnabled;return e||i||n||o||s||r},localEntityAdminHasEditorialSettings:function(){return this.isLocalEntityAdministrator()&&this.getLocalEntity()&&this.localEntityAdminHasModuleEnabled()}}},150:function(t,e,i){"use strict";i.r(e);var n=i(1265),o=i(151),s=i(142),r=i(7),a=n.default.extend({render:function(){return a.__super__.render.call(this),this.$el.addClass(this.isCard?"o-card__list__item grid__item js-card":"wall-list__item"),this},onloadcomments:function(){this.options.showComments?this._commentsView.showOnlyCommented():this._commentsView.show()},createComments:function(){var t,e;this.model.isCommunityQuestion()||this.model.isQuestion()&&this.model.get("Group").Type===r.default.Type.COMMUNITY?(t="Answers",e="CommentsQuestion"):t=e="Comments";var i=new o.default[e]({el:this.viewPlaceholder("comments"),collection:new s.default[t]({activity:this.model}),parentActivity:this,fold:this.model.get("HasMoreComments")&&this.model.get("Comments").length,answer:this.model.get("Answer"),hasPinComment:!!this.model.getMetadata("pinComment"),pinCommentId:this.model.getMetadata("pinComment"),readOnly:this.options.readOnly,showAllComments:!1}),n=this;this.listenTo(i,"load",this.onloadcomments),this.listenTo(i,"add",this.incrementCommentsCount),this.listenTo(i,"remove",this.decrementCommentsCount),this.listenTo(i,"removeAnswer",(function(){this._commentsView.hide(),n.decrementCommentsCount()})),this.listenTo(i,"bestAnswer",this.saveBestAnswer),this.addView("comments",i)}});e.default=a},151:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(13),u=i(2),d=i(1879),h=i(52),f=i(960),p=i(2388),m=i.n(p),g=i(2389),v=i.n(g),b=i(107),y=i(954),C=i(1573),w=i(1881),T=i(12),x=i(8),O=i(1457),S=i(33),I=i(78),A=i(46),k=i(166),P=i(49),E=i(5),_=i(15),j=i(18),D=i(30),U=i(584),M=i(311),L=i(7),N=i(51),R=i(17);function z(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var F=f.default.AnswerDiv,B=c.default.extend({template:m.a,templateOrderComments:v.a,collection:new b.default.Activities,translations:{cancelButton:"Cancel",replyButton:"Reply",placeholder:"Reply here..."},className:{orderMostRecent:"js-order-most-recent",orderMostLiked:"js-order-most-liked",orderOldest:"js-order-oldest",pinComment:".js-pincomment",sortCommentsItem:"sort-comments__list-item",sortCommentsSelectedItem:"sort-comments__list-item--selected"},constants:{takeAllComments:1e3},events:{"click .js-show-all-comments":"showAll","focusin .js-activity-comment-container":"onMicroboxFocus","focusout .js-activity-comment-container":"onMicroboxFocusOut","click .js-beezy-profileload":"showProfile","click .js-activity-order-comments":"showOrderCommentsPopover"},orderComments:{default:[{code:"mostRecent",jsClass:"js-order-most-recent",isDefault:!0,title:"Most recent"},{code:"mostLiked",jsClass:"js-order-most-liked",title:"Most liked"}],question:[{code:"mostLiked",jsClass:"js-order-most-liked",isDefault:!0,title:"Most upvoted"},{code:"mostRecent",jsClass:"js-order-most-recent",title:"Most recent"}],story:[{code:"mostRecent",jsClass:"js-order-most-recent",isDefault:!0,title:"Most recent"},{code:"mostLiked",jsClass:"js-order-most-liked",title:"Most liked"},{code:"oldest",jsClass:"js-order-oldest",title:"Oldest"}]},initialize:function(t){var e=this;this.options=t,this.activityType=t&&t.collection&&t.collection.activity&&t.collection.activity.get("Type"),"question"===this.activityType?this.orderCommentsOptions=this.orderComments.question:"story"===this.activityType?this.orderCommentsOptions=this.orderComments.story:this.orderCommentsOptions=this.orderComments.default,this.showAllComments="boolean"!=typeof this.options.showAllComments||this.options.showAllComments,this.hidden=!0,this.hasAnswer=!1,this.hasPinComment=t.hasPinComment,this.pinCommentId=t.pinCommentId,this.commentsCount=this.options.parentActivity.commentsCount(),this.pinnedComment=null,this.take=this.showAllComments?this.constants.takeAllComments:L.default.defaultNumberOfComments+1,this.ActivityId=t.parentActivity.model.get("Id"),this._pinCommentView=void 0,this.rendered=!1,this.commentBaseTemp=new d.default({collection:this.collection,parentActivity:this.options.parentActivity,readOnly:this.options.readOnly,take:this.take}),this.addView("activities",this.commentBaseTemp),this.setOrder(this.getDefaultOrderCommentsOption().code),this.listenTo(this.collection,"add",this.onAdd),this.listenTo(this.collection,"remove",this.onRemove),this.listenTo(this.collection,"reset",(function(){e.rendered?e.hideOrShowShowAllButton():(e.prerender(),e.setAnswer(e.options.answer||e.collection.answer),e.trigger("load"))})),beezySettings.EnablePinnedComments&&(T.default.subscribe("pinComment".concat(this.ActivityId),"add",l.a.bind(this._showPinComment,this)),T.default.subscribe("pinComment".concat(this.ActivityId),"like",l.a.bind(this._likedPinComment,this)),this.renderPinComment=l.a.bind(this.renderPinComment,this)),T.default.subscribe("ReportAbuse","report",l.a.bind((function(){j.default.redirectToUrl(A.default.getGroupUrl())}),this)),beezySettings.EnableOfficeGraphMention&&k.default.isAppsCloud()&&O.default.initialize()},setOrder:function(t){this.order=t,this.collection.setOrder(t),this.commentBaseTemp.setOrder(t)},prerender:function(){var t=this;if(!this.hasPinComment||!beezySettings.EnablePinnedComments)return this.render();this.renderPinComment(this.pinCommentId).then((function(e){if(!t._pinCommentView)return t.addView("pinComment",new C.default({model:e,parentActivity:t.options.parentActivity,_commentView:t.commentBaseTemp})),t.render()}))},render:function(){if(this.rendered=!0,this.$el.html("."),this.$el.html(this.template({count:this.commentsCount,EnablePinnedComment:beezySettings.EnablePinnedComments,hasAnswer:this.hasAnswer,hasPinComment:this.hasPinComment,orderCommentsButton:this.getDefaultOrderCommentsOption(),Owner:_.default.getCurrentUser(),translations:this.translations})),this.$comments=this.viewRegion("comments"),this.$commentsHeader=this.viewRegion("comments-header"),this.$showAllButton=this.region("show-all-comments"),this.hideOrShowHeader(),this.createOrderCommentsDropDialog(),this.hideOrShowShowAllButton(),this.viewPlaceholder("comments-container").append(this._activitiesView.$el),this.hasPinComment&&beezySettings.EnablePinnedComments&&this.viewPlaceholder("pincomment-container").html(this._pinCommentView.$el),this.options.readOnly||this.options.withOutReply?(this.viewRegion("reply").hide(),this.$(".js-activity-comment-container").html(""),this.$(".js-activity-comment-container").addClass("is-disabled")):(this.getView("reply")||(this.addView("reply",new V({el:this.viewRegion("reply"),translations:this.translations})),this.trigger("reply:loaded",this._replyView)),this.listenTo(this._replyView,"reply",(function(t){var e=P.default.duplicatedQuestionMarks(t);this.loading(),this.collection.createComment(e),this.loaded()})),this.listenTo(this.collection,"commented",(function(){this._replyView.enable(),this.loaded(),T.default.publish("comments","comment")}))),x.default.isScoped()||this.createAccessPopup(this.$(".activity__comment__reply")),this.$el.get(0)){var t=this.getObserverBackgroundImage({});Array.from(this.$el.get(0).querySelectorAll(".js-beezy-profileload")).forEach((function(e){return t.observe(e)}))}return this},getDefaultOrderCommentsOption:function(){return this.orderCommentsOptions.find((function(t){return t.isDefault}))},hideOrShowHeader:function(){this.commentsCount>1?this.$commentsHeader.css({display:"flex"}):this.$commentsHeader.hide()},hideOrShowShowAllButton:function(){!this.showAllComments&&this.commentsCount>this.collection.length?this.$showAllButton.show():this.$showAllButton.hide()},createOrderCommentsDropDialog:function(){this.orderCommentsPopover=new M.default({animated:!0,verticalPosition:L.default.DropVerticalPosition.BOTTOM,position:L.default.DropPosition.CENTER,parent:this.$el.find(".js-activity-order-comments").parent()}),this.orderPopoverContent=r()(this.templateOrderComments(this.orderCommentsOptions)),this.bindEventsOrderCommentsDropDialog(),this.setOrderInDropDialog(this.getDefaultOrderCommentsOption()),this.orderCommentsPopover.inject(this.orderPopoverContent)},showOrderCommentsPopover:function(t){t.stopPropagation(),this.orderCommentsPopover.toggle()},bindEventsOrderCommentsDropDialog:function(){var t=this,e=this.orderCommentsOptions.find((function(e){return e.jsClass===t.className.orderMostRecent}));e&&this.orderPopoverContent.find(".".concat(e.jsClass)).click((function(i){i.preventDefault(),i.stopPropagation(),t.order!==e.code&&(t.orderCommentsPopover.hide(),t.setOrder(e.code),t.setOrderInDropDialog(e),t.orderMostRecent())}));var i=this.orderCommentsOptions.find((function(e){return e.jsClass===t.className.orderMostLiked}));i&&this.orderPopoverContent.find(".".concat(i.jsClass)).click((function(e){e.preventDefault(),e.stopPropagation(),t.order!==i.code&&(t.orderCommentsPopover.hide(),t.setOrder(i.code),t.setOrderInDropDialog(i),t.orderMostLiked())}));var n=this.orderCommentsOptions.find((function(e){return e.jsClass===t.className.orderOldest}));n&&this.orderPopoverContent.find(".".concat(n.jsClass)).click((function(e){e.preventDefault(),e.stopPropagation(),t.order!==n.code&&(t.orderCommentsPopover.hide(),t.setOrder(n.code),t.setOrderInDropDialog(n),t.orderOldest())}))},setOrderInDropDialog:function(t){this.region("order-comments-button").text(Object(u.translate)(t.title)),this.orderPopoverContent.find(".".concat(this.className.sortCommentsItem)).removeClass(this.className.sortCommentsSelectedItem),this.orderPopoverContent.find(".".concat(t.jsClass)).parent().addClass(this.className.sortCommentsSelectedItem)},orderMostRecent:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.showAllComments&&!e){var i=this.collection.models.sort((function(t,e){var i=Object(N.getDateFromJSON)(t.get("Created")),n=Object(N.getDateFromJSON)(e.get("Created"));return i<n?-1:i>n?1:0}));this.collection.reset(i),this.scrollBottomComments()}else this.fetch({orderby:"create",desc:!1}).then((function(){return t.scrollBottomComments()}))},orderMostLiked:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.showAllComments&&!e){var i=this.collection.models.sort((function(t,e){var i=t.get("TotalOfLikes"),n=e.get("TotalOfLikes");return i>n?-1:i<n?1:0}));this.collection.reset(i),this.scrollTopComments()}else this.fetch({orderby:"likes",desc:!0}).then((function(){return t.scrollTopComments()}))},orderOldest:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.showAllComments&&!e){var i=this.collection.models.sort((function(t,e){var i=Object(N.getDateFromJSON)(t.get("Created")),n=Object(N.getDateFromJSON)(e.get("Created"));return i>n?-1:i<n?1:0}));this.collection.reset(i),this.scrollBottomComments()}else this.fetch({orderby:"create",desc:!0}).then((function(){return t.scrollBottomComments()}))},fetch:function(t){var e=this,i=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?z(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({skip:0,take:this.take},t);return new Promise((function(t){e.collection.fetch({reset:!0,data:i}).done((function(){return t()}))}))},showProfile:function(t){t.preventDefault(),t.stopPropagation();var e=E.default.getProfileUrl()+_.default.getCurrentUserId();I.default.showUserProfilePage(e)},createAccessPopup:function(t){this.AccessPopup=new w.default(beezyCurrentGroup||this.options.parentActivity.model.get("Group"),{elementBound:t})},loading:function(){this.$(".js-loading").show(),this.$(".js-activity-comment-container").hide()},loaded:function(){this.$(".js-loading").hide(),this.$(".js-activity-comment-container").show()},setAnswer:function(t){this.hasAnswer=!!t,this.hasAnswer&&(this.collection.answer=t,this.addView("answer",new F({locked:!!this.collection.length,model:new h.default.Answer(t),parentActivity:this.options.parentActivity})),this.listenTo(this._answerView,"clear",(function(){this.$el.parent().find(".is-open").removeClass("is-open"),this.trigger("removeAnswer"),this.collection.answer=null,this.removeView("answer"),this.$(".is-answer").hide().removeClass("enabled")})),this.$(".is-answer").hide().removeClass("enabled"),this.viewPlaceholder("answer").append(this._answerView.render().el),this.$(".is-answer").addClass("enabled").show())},reset:function(t){t&&t.length>=this.take&&(t=t.slice(-(this.take-1))),this.collection.reset(t)},showOnlyCommented:function(){(this.commentsCount||this.hasAnswer)&&(this.$el.show(),this.hidden=!1)},scrollBottomComments:function(){var t=this.$el.find(".js-comments-area");t&&r()(t).animate({scrollTop:r()(t).prop("scrollHeight")},0)},scrollTopComments:function(){var t=this.$el.find(".js-comments-area");t&&r()(t).animate({scrollTop:-r()(t).prop("scrollHeight")},0)},show:function(){this.$el.show(),this.scrollBottomComments(),this._replyView&&this._replyView.focus(),this.hidden=!1},hide:function(){this.$el.hide(),this.hidden=!0},updateCount:function(){this.commentsCount?this.$comments.show():(this.$el.parent().find(".js-comments-count").html(""),this.$comments.hide())},onRemove:function(t){this.trigger("remove",t),this.commentsCount&&this.commentsCount--,this.$comments&&this.updateCount(),this.hideOrShowHeader(),this.hideOrShowShowAllButton(),this.hasAnswer&&0===this.collection.length&&this._answerView.showDeleteCommand()},onAdd:function(t){var e;(this.commentsCount++,this.trigger("add",t),this.$comments&&this.updateCount(),this.hideOrShowHeader(),this.hideOrShowShowAllButton(),this.hasAnswer&&this._answerView.hideDeleteCommand(),t.attributes.Owner.Id===beezyCurrentUser.Id)&&(this.scrollBottomComments(),this.$comments&&(null===(e=this.$comments.find(".js-activity-tools-button").last())||void 0===e||e.focus()))},showAll:function(t){t&&t.preventDefault&&(t.preventDefault(),t.stopPropagation()),this.showAllComments=!0,this.take=this.constants.takeAllComments;var e=!0;switch(this.order){case"mostRecent":this.orderMostRecent(e);break;case"mostLiked":this.orderMostLiked(e);break;case"oldest":this.orderOldest(e);break;default:this.fetch()}},onMicroboxFocus:function(t){if(t.stopPropagation(),_.default.isReadOnly())return R.default.showReadOnlyModal();var e=this.$(".activity__comment__reply"),i=beezyCurrentGroup||this.options.parentActivity.model.get("Group");if(i&&!i.IsModerated&&window.joinRequestedCommunityIdsPublic&&l.a.indexOf(window.joinRequestedCommunityIdsPublic,i.GroupId)>-1||null===i){e.addClass("is-focused");var n=this.getView("reply");""===e.find(".microbox__input.is-input").text()&&n.microbox.showPlaceholder()}else x.default.isGroupDisabled(i)&&this.AccessPopup&&!this.AccessPopup.isJoined()?(e.addClass("is-focused"),this.AccessPopup.render(),this.AccessPopup.show(t)):e.addClass("is-focused")},onMicroboxFocusOut:function(t){t.stopPropagation(),this.$(".activity__comment__reply").removeClass("is-focused"),!r()(".comment-popup:hover").length&&this.AccessPopup&&this.AccessPopup.hide()},_showPinComment:function(t,e){var i=this.$el.find(this.className.pinComment);r()(i).hide(),t&&this.renderPinComment(e).then((function(t,e){e._pinCommentView?r()(i).html(e._pinCommentView.prerender({model:t,parentActivity:e.options.parentActivity,_commentView:e._activitiesView})):(e.addView("pinComment",new C.default({model:t,parentActivity:e.options.parentActivity,_commentView:e._activitiesView})),e.viewPlaceholder("pincomment-container").html(e._pinCommentView.$el)),r()(i).show()}))},_likedPinComment:function(t,e){var i=this;i._pinCommentView.model.isLiked()!==e&&(i._pinCommentView.model.set({likedFromComment:!0},{silent:!0}),i._pinCommentView.$el.find(".js-tooltip-likes").first().click(),i._pinCommentView.model.set({likedFromComment:!1},{silent:!0}))},renderPinComment:function(t){var e=this,i=r.a.Deferred();return new y.default.SingleComment({Id:t}).fetch({cache:!0}).done((function(t){i.resolve(t,e)})),i}}),$=B.extend({translations:{replyButton:"Answer",placeholder:"Answer here..."}}),V=c.default.extend({initialize:function(t){var e=this;this.options=t,this.isNewsFeed=this.options.isNewsFeed,this.microbox=U.default.init(this.$("div"),{placeholderText:Object(u.translate)(this.options.translations.placeholder),MaximumUsers:L.default.maximumDisplayableUsersDropdown,UserSearchAdapter:S.default.searchAdapter("Users"),HashtagSearchAdapter:S.default.searchAdapter("Hashtags"),isRequired:!0}),this.microbox.on("keydown",(function(){e.clearError()})),T.default.subscribe("comments","focus",(function(){e.microbox.focus()}))},events:{"click input":"onReply"},focus:function(){var t;t=(t=r()(this.microbox.elem).offset().top+Object(D.sharePointItems)().content.scrollTop())-Object(D.sharePointItems)().content.height()+100,Object(D.sharePointItems)().content.animate({scrollTop:t}),_.default.isReadOnly()||this.microbox.focus()},disable:function(){this.microbox.disable(),this.$("input").addClass("disabled").attr("disabled","disabled")},enable:function(){this.microbox.enable(),this.$("input").removeClass("disabled").removeAttr("disabled")},onReply:function(t){if(t.preventDefault(),t.stopPropagation(),_.default.isReadOnly())return R.default.showReadOnlyModal();var e=this.isNewsFeed?this.microbox.getDataFollows().message:this.microbox.getData().message;e?(this.disable(),this.trigger("reply",e),this.clearError(),this.microbox.reset()):this.setError(Object(u.translate)("You must write a message"))},setError:function(t){this.$(".js-microbox-error").html(t).show(),this.$(".microbox__input").addClass("error")},clearError:function(){this.$(".js-microbox-error").hide(),this.$(".microbox__input").removeClass("error")}});e.default={Comments:B,CommentsQuestion:$,ReplyComments:V}},153:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(5),l=i(13),c=i(37),u=i(57),d=i(2442),h=i.n(d),f=i(47),p=l.default.extend({template:h.a,dom:{modalPrivacity:".modal--privacity"},events:{"click .js-dataclassification-title":"showModal"},initialize:function(t){this.render=r.a.bind(this.render,this),this.options=t||{},this.el=t.el,this.render()},render:function(){var t;return t=beezyCurrentGroup.Type.toLowerCase().indexOf("standalone")>-1?beezyCurrentGroup.Type.substring("standalone".length):beezyCurrentGroup.Type,this.context=r.a.extend({network:beezyCurrentGroup.Network,EnableNetworkName:beezySettings.EnableNetworkName,EnableAccessDescription:beezySettings.EnableAccessDescription,EnableDataClassificationLabel:beezySettings.EnableDataClassificationLabel,GroupType:t},beezyCurrentGroup),this.$el.html(this.template(this.context)),this.checkRenderTooltip(),this},checkRenderTooltip:function(){var t;return this.context.DataClassification&&this.context.DataClassification.Link&&""!==this.context.DataClassification.Tooltip&&(t=new c.default({el:this.$el.find(".js-dataclassification-title"),text:"<span>".concat(this.context.DataClassification.Tooltip,"</span>"),horizontalPosition:"right"})),t},showModal:function(t){var e=o()(t.currentTarget);t.preventDefault(),t.stopPropagation(),o()(this.dom.modalPrivacity).html("");var i=o()(this.dom.modalPrivacity).length?o()(this.dom.modalPrivacity):o()(f.default.createDialogContainer("modal--privacity")),n=encodeURI(beezyCurrentGroup.DataClassification.Link);i.append('<iframe id="privacity" style="border: 0px; " src="'.concat(n,'" width="520px" height="535px"></iframe>'));var s={};if(i.find("iframe").error((function(){s.hide()})),a.default.isSharepointApp()){var r=e.offset().top;s=new u.default(new l.default({el:i}),{dialogClass:"close-dialog",buttons:{},extend:{position:{my:"top",at:"top+".concat(r)},beforeClose:function(){o()(".ms-dlgOverlay").remove()},showCrossButton:!0}})}else s=new u.default(new l.default({el:i}),{buttons:{}});s.show()}});e.default=p},1561:function(t,e,i){"use strict";e.default={"modal--z-index":"bz-modal--z-index--Zw07Oo",modal__header:"bz-modal__header--Zw07Oo",modal__body:"bz-modal__body--Zw07Oo",modal__message:"bz-modal__message--Zw07Oo"}},1569:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(26),s=i(10),r=o.default.extend({initialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isMultiOption=e.collection.isMultiOption},baseUrl:function(){return"".concat(n.default.getApiUrlv2(),"/Polls")},isVoted:function(){return this.get("CurrentUserLikedComment")},vote:function(){this.isVoted()||(this.set({CurrentUserLikedComment:!0,TotalOfLikes:this.get("TotalOfLikes")+1}),this.isMultiOption||this.sendVote())},unvote:function(){this.isVoted()&&this.set({CurrentUserLikedComment:!1,TotalOfLikes:this.get("TotalOfLikes")-1})},sendVote:function(){return s.default.putJSON("".concat(this.baseUrl(),"/").concat(this.get("ActivityId"),"/Vote"),[{ParentId:this.id}])}});e.default=r},1572:function(t,e,i){"use strict";function n(t){this.attachment=t}i.r(e),n.prototype={hasSnippet:function(){return null!=this.attachment.Provider},getSnippet:function(){return{provider_name:this.attachment.Provider,provider_url:this.attachment.Url,original_url:this.attachment.Url,title:this.attachment.Title,description:this.attachment.Description,author_url:this.attachment.Url,url:this.attachment.Url,favicon_url:this.attachment.IconUrl?this.attachment.IconUrl.replace(/&amp;/gi,"&"):null,images:[{url:this.attachment.PreviewImageUrl}],media:{html:this.attachment.PreviewHtml},type:this.attachment.Type||"link",subType:this.attachment.Subtype}}},e.default=n},1573:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(2),l=i(13),c=i(12),u=i(234),d=i(142),h=i(2390),f=i.n(h),p=i(267),m=i(313),g=i(580),v=i(37),b=l.default.extend({template:f.a,viewPrefix:"v",dom:{classauthorname:".activity__header__author-name",classtimeago:".activity-tools-time-ago",classMessage:".js-activity-message"},events:{mouseover:"hoverInPinnedComment"},initialize:function(t){this.setElement(o()('<li class="activity"></li>')),this.prerender(t),this.editPinComment=r.a.bind(this.editPinComment,this),c.default.subscribe("pinComment","edit",this.editPinComment)},editPinComment:function(t,e){this.context=r.a.extend(this.context,t.toJSON()),this.render();var i=this.options._commentView._views[this.viewPrefix+t.get("Id")];e&&i&&i.model.set(t.toJSON())},prerender:function(t){this.options=t||{};var e=new d.default.Comments({activity:this.options.parentActivity,model:this.options.model});e.add(this.options.model),this.pinnedComment=this.options._commentView.getViewComment(e.last());var i=this;this.unbind(),this.on("deletePin",(function(){var t=i.options._commentView._views[i.viewPrefix+i.model.get("Id")],e={Id:t.model.id};t.options.parentActivity&&r.a.extend(e,{ActivityId:t.options.parentActivity.model.id}),t.model.destroy({data:JSON.stringify(e)}),t.dispose(),t.trigger("clear")})),this.on("liked",(function(){var t=i.options._commentView._views[i.viewPrefix+i.model.get("Id")];t&&(t.model.set({likedFromPin:!0},{silent:!0}),t.$el.find(".js-tooltip-likes").first().click(),t.model.set({likedFromPin:!1},{silent:!0}))})),this.on("pinComment",(function(t,e,n){i.options._commentView._views[i.viewPrefix+n].trigger("pinComment",t,e,n)}),this),this.context=r.a.extend(this.pinnedComment.model.attributes,this.pinnedComment.options),this.context.isCard=t.parentActivity.isCard,this.model=this.pinnedComment.model,this.options.tools=this.pinnedComment.options.tools,this.initializeActivityTools(this.options),this.render()},render:function(){var t=this.options.parentActivity;if(t){this.isPinComment=!1,r.a.extend(this.context.Group,t.model.get("Group")),this.context.parentActivity=t.model.toJSON();var e=t.model.getMetadata("pinComment");e&&(this.isPinComment=parseInt(e,10)===this.model.id),this.context.isPinComment=this.isPinComment,this.context.isViewPinComment=!0}this.$el.html(this.template(this.context)),this.$(this.dom.classtimeago).timeago(!0),this.$(this.dom.classauthorname).after('<span class="activity_header__pincomment">'.concat(Object(a.translate)("Pinned Comment"),"</span>")),this.renderTools(this.options.tools),this.createTooltip();var i=this.getObserverBackgroundImage({}),n=this.$el.get(0).querySelector(".js-beezy-profileload");return n&&i.observe(n),this},hoverInPinnedComment:function(){this.createTooltips()},createTooltips:function(){var t=this;Object(m.default)(this.$el),Object(g.default)(this.$el,this.context.Hashtags),o()(this.$el).find(".js-modified-tag").each((function(e,i){t.modifiedTooltip=new v.default({el:i,text:Object(a.translate)("This tag has been deleted or modified")})}))}});r.a.defaults(b.prototype,p.default,u.default),e.default=b},1579:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(2),r=i(145),a=i(106),l=i(20),c=i(5),u=i(10),d=i(2402),h=i.n(d),f=i(483),p=i(775).default.extend({title:"",bodyTemplate:h.a,buttons:[],events:{"click .js-cancel":"cancel","click .js-invite":"invite","click .js-ok":"ok","click .js-recommend":"recommend"},successText:Object(s.translate)("The invite notifications were sent successfully"),initialize:function(t){this.title=t.title||this.title,this.buttons=t.buttonsExtend||this.buttons,this.optionsTemplate=t.optionsTemplate||{},this.primaryButton=o.a.findWhere(this.buttons,{primary:!0}),this.successText=t.successText||this.successText,p.__super__.initialize.apply(this,arguments),this._done=o.a.bind(this._done,this),this._fail=o.a.bind(this._fail,this),this._always=o.a.bind(this._always,this),this.render()},renderBody:function(){return this.$body.html(this.bodyTemplate(this.optionsTemplate)),this.$main=this.$body.find(".js-main"),this.$success=this.$body.find(".js-success"),this.$error=this.$body.find(".js-error"),this._createPeoplePicker(),this._createButton(),this.reset(),this},_createPeoplePicker:function(){if(this.peoplePicker=new r.default({el:this.$body.find(".js-people-picker"),zIndex:99999,adapterOptions:{onlyEula:c.default.isEnableTermsOfUse()&&!c.default.isAllowRetrieveUsersNoEula()}}).render(),this.listenTo(this.peoplePicker,"add",this._onChangePeoplePicker),this.listenTo(this.peoplePicker,"remove",this._onChangePeoplePicker),this.peoplePicker){var t=this;(new f.default).fetch().done((function(e){var i=[];o.a.each(e,(function(t){i.push(t.User)})),t.peoplePicker.trigger("addExcludeItem",i)}))}},_createButton:function(){this.inviteButton=new a.default({el:this.$(".js-".concat(this.primaryButton.id)),html:this.buttons[0].label,loadingText:"".concat(Object(s.translate)("Sending"),"...")})},cancel:function(){this.trigger("cancel")},recommend:function(){var t=this.peoplePicker.getValue();if(t.length){var e={Message:this.$(".js-optional-message").val(),Users:o.a.pluck(t,"LoginName")},i="".concat(c.default.getApiUrlv2(),"/Communities/").concat(beezyCurrentGroup.GroupId,"/Recommend");this.sendData(i,e)}},invite:function(){var t=this.peoplePicker.getValue();if(t.length){var e={Users:o.a.pluck(t,"LoginName")},i="".concat(c.default.getApiUrlv2(),"/Communities/").concat(beezyCurrentGroup.GroupId,"/Invite");this.sendData(i,e)}},sendData:function(t,e){this.inviteButton.toggleLoading(),u.default.postJSON(t,e).done(this._done).fail(this._fail).always(this._always)},ok:function(){this.trigger("cancel"),this.reset()},reset:function(){this.$(".js-optional-message").val(""),this.peoplePicker.reset(),this.$main.show(),this.$success.hide(),this.$error.hide(),this.resetButtons(),this.$el.css("overflow","auto"),this.$container.css({top:0,height:"auto"})},resetButtons:function(){p.__super__.resetButtons.call(this),this.inviteButton.toggleRegular()},enable:function(){this.peoplePicker.enable(),l.default.enable(this.$(".js-optional-message"))},disable:function(){this.peoplePicker.disable(),l.default.disable(this.$(".js-optional-message"))},_onChangePeoplePicker:function(){if(this.primaryButton){var t=!!this.peoplePicker.getValue().length;l.default[t?"enable":"disable"](this.$(".js-".concat(this.primaryButton.id)))}},_done:function(){var t=this.$body.height(),e=this.$success.height(),i=this.$container.height(),n=(t-e)/2-10;this.$el.css("overflow","hidden"),this.$container.css({height:i}),this.$container.animate({top:n,height:i-n},600),this.$main.hide(),this.$success.html(this.successText),this.$success.show()},_fail:function(t){this.$main.hide(),this.$error.show().html(t.responseText)},_always:function(){this.$(".js-".concat(this.primaryButton.id)).hide(),this.$(".js-cancel").hide(),this.$(".js-ok").show()}});e.default=p},158:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(116),l=i(20),c=i(2),u={label:"",input:"",innerLabel:"switch__label"},d=a.default.extend({item:{label:"",value:null,checked:!1,id:null},classes:u,init:function(){this._label=this.options.label,this._value=this.options.value,this._checked=!!this.options.checked,this._id=this.options.id||null,this.bindToInstance(),this.render(),this.registerEvents()},render:function(){return this.input=o()('<input type="checkbox" />').addClass(this.classes.input).attr("id",this.options.id),this.innerLabel=o()("<span />").addClass(this.classes.innerLabel).text(this.options.label),this.label=o()("<label />").attr("unselectable","on").attr("title",this.options.label).attr("for",this.options.id).addClass(this.classes.label).append(this.input).append('<span class="checkbox" style="display: none;"><span class="icon icon--checkbox"></span></span>').append(this.innerLabel).appendTo(this.el),this._checked&&(this.input.attr("checked","checked"),this.setCheckedClass()),this},bindToInstance:function(){this.onInputChange=r.a.bind(this.onInputChange,this)},registerEvents:function(){this.innerLabel.on("click",this.onInputChange),this.input.on("click",this.onInputChange)},unregisterEvents:function(){this.innerLabel.off("click",this.onInputChange),this.input.off("click",this.onInputChange)},onInputChange:function(){this._checked=this.input.get(0).checked,this["".concat(this._checked?"set":"unset","CheckedClass")](),this.emit("change",this)},check:function(){this._checked=!0,this.input.attr("checked","checked"),this.setCheckedClass()},uncheck:function(){this._checked=!1,this.input.removeAttr("checked"),this.unsetCheckedClass()},setCheckedClass:function(){this.label.addClass("is-checked")},unsetCheckedClass:function(){this.label.removeClass("is-checked")},getLabel:function(){return this._label},getValue:function(){return this._value},isChecked:function(){return this._checked},reset:function(){this.uncheck()},enable:function(){l.default.enable(this.input),l.default.enable(this.innerLabel)},disable:function(){l.default.disable(this.input),l.default.disable(this.innerLabel)},dispose:function(){this.unregisterEvents(),this.el.children().remove()}}),h=d.extend({render:function(){return this.input=o()('<input class="switch__check" type="checkbox" data-id="'.concat(this.options.id,'" />')).addClass(this.classes.input),this.innerLabel=o()("<span />").addClass(this.classes.innerLabel).text(this.options.label),this.switch__container=o()('<div class="switch__container"></div>').append(o()("<div />").addClass("switch__input")).append(o()("<div />").addClass("switch__input-bg")).append(this.input),this.label=o()("<label />").attr("unselectable","on").attr("title",this.options.label).addClass("switch ".concat(this.classes.label)).append(this.switch__container).prepend(this.innerLabel).appendTo(this.el),this._checked&&(this.input.attr("checked","checked"),this.setCheckedClass()),this}}),f=d.extend({classes:{label:"community-settings__list__item__select-container",input:"",innerLabel:"icon icon--tools-detail-edit--14px",select:"community-settings__list__item__select"},setCheckedClass:function(){this.label.addClass("is-checked"),this.select.prop("selectedIndex",1),this._checked=!0,this.input.attr("checked","checked")},unsetCheckedClass:function(){this.label.removeClass("is-checked"),this.select.prop("selectedIndex",0),this._checked=!1,this.input.removeAttr("checked")},registerEvents:function(){var t=this;this.select.on("change",this.onInputChange),this.innerLabel.on("click",(function(){t.openSelect(t.select)}))},onInputChange:function(t){this._checked=1===t.currentTarget.selectedIndex,this["".concat(this._checked?"set":"unset","CheckedClass")](),this.emit("change",this)},openSelect:function(t){if(document.createEvent){var e=document.createEvent("MouseEvents");e.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t[0].dispatchEvent(e)}else t.fireEvent&&t[0].fireEvent("onmousedown")},render:function(){return this.input=o()('<input type="checkbox" data-id="'.concat(this.options.id,'" />')).addClass(this.classes.input),this.innerLabel=o()("<span />").addClass(this.classes.innerLabel),this.select=o()("<select />").addClass(this.classes.select).append(o()("<option />").val("0").text(Object(c.translate)("Everyone"))).append(o()("<option />").val("1").text(Object(c.translate)("Only owners"))),this.label=o()("<label />").attr("unselectable","on").attr("title",this.options.label).addClass("switch ".concat(this.classes.label)).append(this.select).prepend(this.innerLabel).append(this.input).appendTo(this.el),this._checked&&(this.input.attr("checked","checked"),this.setCheckedClass()),this}}),p=function(t,e){return r.a.isEqual(t,e)},m=a.default.extend({items:[],classes:{list:"",column:"",row:"community-settings__list__item",checkbox:u},columns:1,init:function(){this._equalFn=this.options.equalFn||p,this.items=this.options.items,this.columns=this.options.columns||this.columns,this._CheckBoxComponent=this.options.CheckBoxComponent||d,this._checkboxes=[],this._checked=[],this.hasShowMore=this.options.hasShowMore||!1,this.itemsShowMore=this.options.itemsShowMore||7,this.moreItems=[],this.classes=this.options.classes?r.a.extend(this.options.classes,this.classes):this.classes,this.items&&this.render()},appendTo:function(t){return function(e){e.appendTo(t)}},render:function(){var t=this,e=this.getColumns();this.el.addClass(this.classes.list),r.a.chain(e).map(this.renderColumn,this).each(this.appendTo(this.el)),this.showShowMore&&(this.renderShowMore(this.el.find(this.classes.columnJs),r.a.first(e[0]).value.TermSetName),this.el.find(".js-show-more").on("click",(function(e){e.preventDefault(),t.renderMoreItems()})))},renderColumn:function(t){var e=o()("<ul />").addClass(this.classes.column);return this.showShowMore=this.hasShowMore&&t.length>this.itemsShowMore,this.showShowMore&&(this.moreItems=t.slice(this.itemsShowMore,t.length),t=t.slice(0,this.itemsShowMore)),r.a.chain(t).map(this.renderRow,this).each(this.appendTo(e)),e},renderRow:function(t){var e=o()("<li />").addClass(this.classes.row),i=new this._CheckBoxComponent({el:e,label:t.label,value:t.value,checked:t.checked,id:t.id||null});return this._checkboxes.push(i),t.checked&&this._checked.push(i),i.on("change",this.onChangeInput,this),e},renderShowMore:function(t,e){var i=o()('<div class="checklist--showmore"><a title="Show more" class="js-show-more" >Show more</a></div>');i.data("termset",e),t.after(i)},renderMoreItems:function(){var t=this.el.find(this.classes.columnJs).get(0);r.a.chain(this.moreItems).map(this.renderRow,this).each(this.appendTo(t)),this.el.parent().find(".js-show-more").hide()},getColumns:function(){var t,e=[],i=this.items.length;if(!i)return e;for(var n=Math.ceil(i/this.columns),o=0;o<this.columns;o++)t=o*n,e.push(this.items.slice(t,t+n));return e},onChangeInput:function(t){var e=r.a.some(this._checked,(function(e){return t.getValue()===e.getValue()}));t.isChecked()?e||this._checked.push(t):this._checked=r.a.without(this._checked,t),this.emit("change",t)},getCheckedValues:function(){return r.a.map(this._checked,this.extractValue)},extractValue:function(t){return t.getValue()},setCheckStatus:function(t,e){r.a.each(this._checkboxes,(function(i){this._equalFn(i.getValue(),e)&&(i[t?"check":"uncheck"](),this.onChangeInput(i))}),this)},check:function(t){this.setCheckStatus(!0,t)},uncheck:function(t){this.setCheckStatus(!1,t)},reset:function(){this._checked=[],r.a.invoke(this._checkboxes,"reset")},enable:function(){r.a.invoke(this._checkboxes,"enable")},disable:function(){r.a.invoke(this._checkboxes,"disable")},dispose:function(){r.a.each(this._checkboxes,this.disposeCheckBox,this),this.el.children().remove()},disposeCheckBox:function(t){t.off("change",this.onInputChange),t.dispose()}}),g=m.extend({init:function(){this.isMulti=!0,this._SelectBoxComponent=this.options.SelectBoxComponent||f,g.__super__.init.call(this)},renderRow:function(t){var e,i=this,n=o()("<li />").addClass(this.classes.row),s=0;return r.a.each(t,(function(t){e=s?new i._SelectBoxComponent({el:n,label:t.label,value:t.value,checked:t.checked,id:t.id}):new i._CheckBoxComponent({el:n,label:t.label,value:t.value,checked:t.checked,id:t.id}),i._checkboxes.push(e),t.checked&&i._checked.push(e),e.on("change",i.onChangeInput,i),s++})),n}});e.default={CheckBoxComponent:d,CheckBoxSwitchComponent:h,CheckBoxList:m,MultiCheckBoxList:g,SelectBoxComponent:f}},161:function(t,e,i){"use strict";i.r(e);var n={};function o(t,e){e||(e=location.href),t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]".concat(t,"=([^&#]*)"),n=new RegExp(i).exec(e);return null==n?null:n[1]}n.getCurrentItemId=function(t){if(_spPageContextInfo.pageItemId&&-1!==_spPageContextInfo.pageItemId)t(_spPageContextInfo.pageListId.substr(1,36).toUpperCase(),_spPageContextInfo.pageItemId);else{if(!o("RootFolder"))throw new Error("Unable to get the itemId");SP.SOD.executeFunc("sp.js","SP.ClientContext",(function(){!function(t){var e=SP.ClientContext.get_current(),i=e.get_web().getFolderByServerRelativeUrl(decodeURIComponent(o("RootFolder"))).get_listItemAllFields();e.load(i,"Id"),e.executeQueryAsync((function(){var e=i.get_id();t(e)}),(function(){throw new Error("Error getting the itemId")}))}((function(e){t(_spPageContextInfo.pageListId.substr(1,36).toUpperCase(),e)}))}))}},window.BeezyAppClient||(window.BeezyAppClient=n),e.default=n},162:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(333),r=i(57),a=i(2),l=i(47),c=function(t){t||(t={});t.title||(t.title="");var e=Object(a.translate)("Do you want to confirm?");t.text||(t.text=e);var i=Object(a.translate)("Confirm");t.confirmLiteral||(t.confirmLiteral=i);var n=Object(a.translate)("Cancel");t.cancelLiteral||(t.cancelLiteral=n);var u=new s.default({el:o()(".modal--confirmation").length?o()(".modal--confirmation"):l.default.createDialogContainer("modal--confirmation"),stayOpenOnConfirm:t.stayOpenOnConfirm}),d=new r.default(u,{dialogClass:t.dialogClass,buttons:[],extend:{showCrossButton:t.showCrossButton}});return u.setDialog(d),(c=function(t){return u.setTitle(t&&t.title||""),u.setText(t&&t.text||e),u.setConfirm(t&&t.confirmLiteral||i),u.setCancel(t&&t.cancelLiteral||n),u.render(),d.show(),u})(t)};e.default=c},163:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n);e.default={isEqual:function(t,e,i){var n=t||null,o=e||null;return null===n&&null===o||null!==n&&null!==o&&(i?i(n,o):void 0!==n.Id&&void 0!==o.Id?n.Id===o.Id:n===o)},isPromise:function(t){return"function"==typeof t.then&&String(o.a.Deferred().then)===String(t.then)},isFunction:function(t){return"function"==typeof t},isUndefined:function(t){return void 0===t},clone:function(t){return JSON.parse(JSON.stringify(t))}}},166:function(t,e,i){"use strict";i.r(e);var n={isAppsCloud:function(){return/sharepoint.(com|us)/i.test(window.location.href)}};e.default=n},1662:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(4),s=i.n(o),r=i(26),a=i(2),l=i(10),c=i(350),u=r.default.extend({idAttribute:"Id",turnOn:function(){return l.default.getJSON("".concat(this.url(),"/TurnOn"))},turnOff:function(){return l.default.getJSON("".concat(this.url(),"/TurnOff"))},join:function(t){return this.clearCache(),t?l.default.get("".concat(n.default.getApiUrlv2(),"/Groups/").concat(t,"/join")):l.default.get("".concat(n.default.getApiUrlv2(),"/Groups/").concat(this.get("Group").GroupId,"/join"))},leave:function(t){return this.clearCache(),t?l.default.get("".concat(n.default.getApiUrlv2(),"/Groups/").concat(t,"/leave")):l.default.get("".concat(n.default.getApiUrlv2(),"/Groups/").concat(this.get("Group").GroupId,"/leave"))},parse:function(t){return c.default.parseNotification(t)},delete:function(){return l.default.del("".concat(n.default.getApiUrlv2(),"/Notifications"),{Id:this.get("Id")})},markAsProcessed:function(){return l.default.put("".concat(n.default.getApiUrlv2(),"/Notifications"),{Id:this.get("Id"),IsProcessed:!0})},approveSkill:function(){var t=this,e=s.a.Deferred();return this.clearCache(),l.default.put("".concat(n.default.getApiUrlv2(),"/Users/Current/Skills"),{Name:this.get("MetaData").SkillName}).done((function(){t.markAsProcessed().done((function(){e.resolve()})).fail((function(i){t.showError(i,Object(a.translate)("Can't process the notification")),e.reject()}))})).fail((function(i){t.showError(i,Object(a.translate)("Can't approve the skill")),e.reject()})),e},declineSkill:function(){var t=this,e=s.a.Deferred();return this.clearCache(),l.default.del("".concat(n.default.getApiUrlv2(),"/Users/Current/Skills"),{Name:this.get("MetaData").SkillName}).done((function(){t.delete().done((function(){e.resolve()})).fail((function(i){t.showError(i,Object(a.translate)("Can't delete the notification")),e.reject()}))})).fail((function(i){t.showError(i,Object(a.translate)("Can't decline the skill")),e.reject()}))},showError:function(t,e){alert(c.default.parseAjaxError(t,e))},clearCache:function(){void 0!==window.contentLoader&&(window.contentLoader.clearCacheObject("beezyCurrentUser"),this.has("Group")&&window.contentLoader.clearCacheObject("beezyCurrentGroup",this.get("Group").Url))}}),d=r.default.extend({idAttribute:"Id",parse:function(t){var e=t.Participants.length?t.Participants[0]:null;return t.LastParticipant=e,t.isPopup=!0,c.default.parseNotification(t)}});e.default={Notification:u,PopupNotification:d}},1663:function(t,e,i){"use strict";i.r(e);var n={guid:function(){return"".concat(this.s4()+this.s4(),"-").concat(this.s4(),"-").concat(this.s4(),"-").concat(this.s4(),"-").concat(this.s4()).concat(this.s4()).concat(this.s4())},s4:function(){return(65536*(1+Math.random())||0).toString(16).substring(1)}};e.default=n},1675:function(t,e,i){"use strict";var n=i(4),o=i.n(n),s=i(19),r=i.n(s),a=i(2466),l=i(2474),c=i(2477),u=i(1920),d=i(30),h=i(2481),f=i.n(h),p=i(2482),m=i.n(p),g=i(56),v=i(12),b=i(2483),y=i.n(b),C=i(2484),w=i.n(C),T=i(194),x=i(490),O=(i(130),i(38)),S=i(5),I=i(15),A=function(){return i.e(102).then(i.bind(null,3724))};function k(){}k.prototype={sharePointSearchBar:"#DeltaPlaceHolderSearchArea",selectorToolbar:"#js-beezy-toolbar",selectorFooter:"#js-beezy-footer",renderNavigationSidebar:function(t){new u.default({el:t.find(".js-navigation-sidebar-container")}).render()},createNotificationsPopupView:function(){this.notificationPopupView=new l.default({parent:o()("#toolbar").find(".js-notification-icon"),button:o()("#toolbar").find(".js-toolbar-notification")}),this.notificationPopupView.on("show",(function(){o()("#toolbar").find(".js-notification-icon").addClass("selected"),o()("#toolbar").find(".js-toolbar-notification").attr("aria-pressed",!0)})),this.notificationPopupView.on("hide",(function(){o()("#toolbar").find(".js-notification-icon").removeClass("selected"),o()("#toolbar").find(".js-toolbar-notification").attr("aria-pressed",!1)}))},renderQuicklinkPopupView:function(){var t=new c.default({parent:o()("#toolbar").find(".js-quicklink-icon"),button:o()("#toolbar").find(".js-toolbar-quicklink"),template:y.a}).render();t.on("show",(function(){o()("#toolbar").find(".js-quicklink-icon").addClass("selected"),o()("#toolbar").find(".js-toolbar-quicklink").attr("aria-pressed",!0)})),t.on("hide",(function(){o()("#toolbar").find(".js-quicklink-icon").removeClass("selected"),o()("#toolbar").find(".js-toolbar-quicklink").attr("aria-pressed",!1)}))},renderNotificationsPopupView:function(){this.notificationPopupView.render()},addNotificationsPopupViewEvents:function(){o()("#notificationscounter").on("click",(function(){(new T.default).trackPageEvent("notifications",{obj:this.parentNode})})),this.notificationPopupView.on("open",(function(){setTimeout(g.default.updateNotificationsCounter,0)}))},initializerSideBar:function(t){var e=this,i=o()(this.selectorToolbar).find(".js-effect-open");i.on("focus",(function(){i.off("focus"),e.renderNavigationSidebar(t)}))},initializerNotificationsPopup:function(){var t=this;v.default.subscribe("notifications","more",(function(e){t.notificationsReceived=!0,t.notificationPopupView.setNewNotifications(e)})),this.addNotificationsPopupViewEvents()},initializerQuicklinks:function(){var t=this,e=o()(this.selectorToolbar).find(".js-toolbar-quicklink");e.on("mouseover focus",(function(){e.off("mouseover focus"),t.renderQuicklinkPopupView()}))},hideSharePointSearchBar:function(){o()(this.sharePointSearchBar).hide()},init:function(t){var e=this;this.notificationsReceived=!1,o()("#js-beezy-groupheader").before(w.a),0!==o()(this.selectorToolbar).length&&(o()(this.selectorFooter).append(m()()),r.a.all([window.contentLoader.ajaxAndSettingsReady.promise,t.promise]).then((function(){var t={ShowQuickLinks:x.default.hasAnyQuicklinks()&&!I.default.isReadOnly(),ShowNotificationsIcon:!I.default.isReadOnly()};o()(e.selectorToolbar).append(f()(t)),o()(e.selectorToolbar).parent().addClass("toolbar-container");var i=new a.default;e.hideSharePointSearchBar(),S.default.isInsideSharepointContainer()&&"base"!==beezyContext.CurrentPageKey&&O.default.renderComponent(o()(e.selectorToolbar).find("#toolbar-search"),A,{baseSiteCollection:S.default.getBaseSiteCollection(),baseSiteHost:S.default.getBaseSiteHost(),minCharsToSearch:3,numberOfItems:4,profileUrl:S.default.getProfileUrl()},!0,!0),e.initializerSideBar(o()(".js-navigation-sidebar")),e.createNotificationsPopupView(),e.initializerNotificationsPopup(),t.ShowQuickLinks&&e.initializerQuicklinks(),Object(d.prepareSharePointLeftBar)(),i.setSelectedNode(o()(e.selectorToolbar)),e.notificationsReceived||v.default.publish("notifications","getNotificationsObject")})))}},e.default=k},169:function(t,e,i){"use strict";var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(19),l=i.n(a),c=i(5),u=i(7),d=i(80),h=i(49),f="video",p="slideshow",m="link",g={Brightcove:{name:"brightcove",type:f},Compete:{name:"compete",type:m},"Compete.com":{name:"compete",type:m},Default:{name:"default",type:m},Dailymotion:{name:"dailymotion",type:f},Facebook:{name:"facebook",type:m},Flickr:{name:"flickr",type:m},Foursquare:{name:"foursquare",type:m},Github:{name:"github",type:m},"Google Maps":{name:"googlemaps",type:m},Hulu:{name:"hulu",type:f},Instagram:{name:"instagram",type:m},"Justin.tv":{name:"justintv",type:f},Linkedin:{name:"linkedin",type:m},Livestream:{name:"livestream",type:f},MetaCafe:{name:"metacafe",type:f},"Picasa Web Albums":{name:"picasa",type:m},Pinterest:{name:"pinterest",type:m},Prezi:{name:"prezi",type:p},Rdio:{name:"rdio",type:m},SlideShare:{name:"slideshare",type:p},Sliderocket:{name:"sliderocket",type:p},Slidr:{name:"slidr",type:p},SoundCloud:{name:"soundcloud",type:m},Spotify:{name:"spotify",type:m},TED:{name:"ted",type:f},Twitter:{name:"twitter",type:m},"Ustream.tv":{name:"ustream",type:f},Vevo:{name:"vevo",type:f},Vimeo:{name:"vimeo",type:f},Vine:{name:"vine",type:f},Wikipedia:{name:"wikipedia",type:m},YouTube:{name:"youtube",type:f}};var v=[];function b(t){return new Promise((function(e){e(i.e(52).then(i.t.bind(null,3721,7)).then((function(){var e=v.find((function(e){return d.default.isEqual(e.links,t)}));if(e)return e.promiseExtract;var i=o.a.embedly.extract(t);return v.push({links:t,promiseExtract:i}),i})))}))}var y={},C={options:{serviceProviders:g},get:function(t){var e=r.a.find(t,(function(t){if(r.a.has(y,t))return t}));if(e){var i=r.a.extend({position:r.a.indexOf(t,e),isSnippet:!0},y[e]);return l()(i)}return this.adapter(this.filterLinksWithHTMLSnippetPattern(t))},removeNotAllowedProvidersLinks:function(t){return r.a.each(u.default.NotAllowedProviders,(function(e){t=t.filter((function(t){return t.Provider!==e}))}),this),t},adapter:function(t){var e=this;return t.length<1?l.a.promise((function(t){t({})})):l.a.promise((function(i){return b(t).then((function(n){r.a.map(n,(function(t){r.a.map(t.images,(function(t){t.url.startsWith("https")||(t.url=t.url.replace("http","https"))}))})),e.saveInCache(n,t),i(function(t){return t[0]}(n)||{})}),(function(){i({})}))}))},filterLinksWithHTMLSnippetPattern:function(t){if(beezySettings.Embeds){var e=JSON.parse(beezySettings.Embeds);if(!e||!e.filter)return!1;var i=e.filter((function(t){return!!t.template}));if(r.a.first(i)){var n=Object.keys(r.a.first(i))[0],o=r.a.pluck(i,n);return t.filter((function(t){var e=/{(.*?)}/g;return!o.filter((function(i){var n=h.default.escapeRegExpSnippets(i).replace(e,"(.*)");return""!==n?t.match(n):void 0})).length}))}}return t},saveInCache:function(t,e){r.a.each(t,(function(t,i){t.error||(y[e[i]]=t)}),this)},clearCache:function(){y={}},getCache:function(){return y},getProviders:function(){return this.options.serviceProviders},getDefaultProvider:function(){return this.options.serviceProviders.Default},isExternal:function(t){return!!t&&(0!==t.indexOf(c.default.getBaseSiteHost())&&0!==t.indexOf(u.default.LoginOfficeUrl))},isProviderAllowed:function(t){return-1===u.default.NotAllowedProviders.indexOf(t)},getSnippetContextFromActivity:function(t){var e=r.a.pick(t,"provider_name","provider_url","original_url","title","description","author_url","url","favicon_url","type","subType");return t.media&&t.media.html?this.snippetHTML=e.html=t.media.html:e.type="link",t.images.length?e.thumbnail_url=t.images[0].url:e.thumbnail_url="".concat(c.default.getBaseSiteCollection(),"/Style%20Library/images/beezy/snippet-default.jpg"),e}};function w(t){var e,i=!!(e=t.provider_name)&&r.a.find(g,(function(t,i){return i.toUpperCase()===e.toUpperCase()}));return t.beezyType=i?i.type:m,t}function T(){this._links={},this._pendingLinks=[],this.deferred=null}T.prototype={add:function(t){var e=[],i=[],n=l.a.defer();return r.a.isArray(t)||(t=[t]),r.a.each(t,(function(t){this._links[t]?e.push(l.a.resolve(this._links[t])):i.push(t)}),this),setTimeout(r.a.bind(this._add,this,i,n),0),l.a.all(e.concat(n.promise)).spread(this._processArrayLinks)},_add:function(t,e){var i,n=this,o=this._links,s=t.concat(),a={url:t[0],beezyType:"link",description:null,favicon_url:null,provider_name:null,title:null,media:t[0]};(s=s.filter((function(t){return C.isExternal(t)})),(s=C.filterLinksWithHTMLSnippetPattern(s)).length>0)?(b(s).then((function(t){n.cancelTimerTimeoutEmbdely(i),r.a.each(t,(function(t,e){o[s[e]]=w(t)})),e.resolve(t)})).catch((function(){e.reject()})),i=this.configureTimeoutEmbedly(e)):e.resolve(a)},cancelTimerTimeoutEmbdely:function(t){clearTimeout(t)},configureTimeoutEmbedly:function(t){return setTimeout((function(){t.resolve([])}),u.default.waitTimeEmbedly)},_processArrayLinks:function(){return r.a.reduce(arguments,(function(t,e){return r.a.isArray(e)&&(e=r.a.flatten(e)),t.concat(e)}),[])},get:function(t){return this._links[t]},getAll:function(){return this._links},Adapters:{attachment:function(t){return t.error_code?{FileName:t.original_url||t.url,Description:t.description,IconUrl:t.favicon_url,Title:t.title,Type:t.beezyType,Url:t.original_url||t.url}:{FileName:t.original_url||t.url,Description:t.description,IconUrl:t.favicon_url,Provider:t.provider_name,Title:t.title,Type:t.beezyType,Url:t.original_url||t.url,PreviewImageUrl:t.images&&t.images.length>0?t.images[0].url:"".concat(c.default.getBaseSiteCollection(),"/Style%20Library/images/beezy/snippet-default.jpg"),PreviewHtml:t.media.html}}}},e.default={Snippets:C,LinkRepository:T}},17:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(2),l=i(415),c=i(214),u=i(49),d=i(12),h=i(7),f=i(46),p=i(56),m=i(8),g=i(5),v={};v.getUserRepository=function(){var t=new l.default;return v.getUserRepository=function(){return t},t},v.getUser=function(t){var e=v.getUserRepository().get(t);return e||(e=v.emptyUser(t)),e},v.emptyUser=function(t){var e=new c.default;return e.id=t,v.getUserRepository().add(e),e},v.saveUser=function(t){var e=v.getUserRepository();return e.add(t,{merge:!0}),e.get(t.Id)},v.checkQuota=function(){beezyCurrentGroup&&beezyCurrentGroup.ReadOnly?(o()(".js-site-quota").removeClass("is-hidden"),d.default.publish("site","quota-exceeded")):o()(".js-quicklinks").removeClass("is-hidden")},v.convertKbToMb=function(t){return Math.round(t/1024*100)/100},v.percentage=function(t,e){return Math.ceil(e/t*100)},v.quotaLevel=function(t,e){var i=v.percentage(t,e),n=v.quotaLevel;return i>=100?n.FULL:i>=beezySettings.QuotaFirstWarningPercentage?n.HIGH:n.LOW},v.quotaLevel.LOW=1,v.quotaLevel.HIGH=2,v.quotaLevel.FULL=3,v.getBaseFullUrl=function(){return f.default.getGroupUrl()},v.getShareFullUrl=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return"";if(t.Group){if(!t.Group.Url)return encodeURI(g.default.getBaseSiteHost()+t.Url);var n=[g.default.getBaseSiteHost(),u.default.trimCharacter(t.Group.Url,"/")],o="?activity=".concat(t.Id);if((t.Type===h.default.Type.BLOG||t.Type===h.default.Type.WIKI||t.Type===h.default.Type.DISCUSSION||t.Type===h.default.Type.IDEA||t.Type===h.default.Type.QUESTION||t.Type===h.default.Type.STORY||t.Type===h.default.Type.CORPORATEPAGE||t.Type===h.default.Type.GROUPSECTIONPAGE)&&t.RelatedItem&&t.RelatedItem.Url){var s=u.default.trimCharacter(t.RelatedItem.Url,"/"),r=s.split("/").map(encodeURIComponent);s=r.join("/"),n=[g.default.getBaseSiteHost(),s]}else t.Type===h.default.Type.EXTENDEDIDEA?n=[g.default.getBaseSiteHost()+t.Group.Url,"SitePages/Idea%20Detail.aspx?ActivityId=".concat(t.Id)]:t.Type===h.default.Type.CALENDAR?n=[g.default.getBaseSiteHost()+t.Group.Url,"SitePages/Calendar%20Detail.aspx?ActivityId=".concat(t.Id)]:t.Type===h.default.Type.TASK?n=[g.default.getBaseSiteHost()+t.Group.Url,"SitePages/Tasks%20Detail.aspx?ActivityId=".concat(t.Id)]:t.Type===h.default.Type.POLL?n=[g.default.getBaseSiteHost()+t.Group.Url,"SitePages/Poll%20Detail.aspx?ActivityId=".concat(t.Id)]:e&&t.Type===h.default.Type.DOCUMENT&&t.Attachments&&t.Attachments.length?n=[g.default.getBaseSiteHost()+t.Group.Url,"SitePages/File%20Detail.aspx?ActivityId=".concat(t.Id,"&AttachmentId=").concat(t.Attachments[0].Id)]:i||t.Type!==h.default.Type.DOCUMENT?n.push(o):n=[g.default.getBaseSiteHost()+t.Group.Url,"SitePages/File%20Detail.aspx?ActivityId=".concat(t.Attachments.length?t.Id:t.Activity.Id,"&AttachmentId=").concat(t.Attachments.length?t.Attachments[0].Id:t.Id)];return n.join("/")}if(t.Url)return g.default.getBaseSiteHost()+t.Url;var a=g.default.startPageUrl();return a&&a.length?"".concat(a,"?activity=").concat(t.Id):"".concat(beezySettings.BaseSiteCollectionUrl,"/SitePages/Start.aspx?activity=").concat(t.Id)},v.getIdeaCampaignEdition=function(t,e){return"".concat(g.default.getBaseSiteHost()+t.Group.Url,"/SitePages/Idea Edit.aspx?ActivityId=").concat(t.Id).concat(e?"&Tab=".concat(e):"")},v.getIdeaCampaignImpact=function(t){return"".concat(g.default.getBaseSiteHost(),"/").concat(t.Url,"/Pages/Group/Impact.aspx")},v.getSettingsFullUrl=function(t){var e="",i=[];return t||(t=beezyCurrentGroup),t&&!t.SiteCollection?i.push(g.default.getBaseSiteCollection()):i.push(t.SiteCollection&&t.SiteCollection.SiteCollectionUrl?t.SiteCollection.SiteCollectionUrl:f.default.getGroupUrl(t)),t&&(e={Community:"community settings",KnowledgeCenter:"knowledge center settings",StandAloneBlog:"blog settings",StandAloneWiki:"wiki settings",StandAloneQuestions:"standalone questions settings",StandAloneForum:"forum settings",EditorialModule:"Editorial Modules settings",IdeasCampaign:"Ideas campaign settings",CorporateSite:"Corporate Site settings"}[t.Type]),i.concat(["Sitepages","".concat(encodeURI(e),".aspx")]).join("/")},v.getNotificationAction=function(t){var e=t.Activity&&t.Activity.Owner.Id===t.Destinatary.Id,i=t.Reason;t.Activity&&"praise"===t.Activity.Type&&(i+="praise"!==i?"_praise":"");var n,o=e?Object(a.translate)(i):Object(a.translate)("".concat(i,"_others"));return t.Activity&&"stickyannouncement"===t.Activity.Type&&(o+=" ".concat(Object(a.translate)("in an announcement"))),t.Reason===p.default.getReason("GroupInvite")&&(o=Object(a.translate)("invited you")),t.Reason===p.default.getReason("LeaveCommunity")&&(o=Object(a.translate)("left a community")),t.Reason===p.default.getReason("OwnerAdded")&&(o=Object(a.translate)("made you an owner")),t.Reason===p.default.getReason("MemberAdded")&&(o=Object(a.translate)("you are now a member of")),t.Reason===p.default.getReason("HeadOwnerAdded")&&(o=Object(a.translate)("made you a head")),t.Reason===p.default.getReason("GroupCreated")&&(n=t.Group.Type,o=Object(a.translate)({Community:"Your community has been created",KnowledgeCenter:"Your knowledge center has been created",StandAloneBlog:"Your blog has been created",StandAloneWiki:"Your wiki has been created",StandAloneForum:"Your forum has been created",IdeasCampaign:"Your ideas campaign has been created"}[n])),t.Reason===p.default.getReason("Like")&&t.Activity.Type===h.default.Type.EXTENDEDIDEA&&(o="Championed"),t.Reason===p.default.getReason("StoryApprovalRequest")&&(o=Object(a.translate)("requested you an article review")),t.Reason===p.default.getReason("StoryApprove")&&(o=Object(a.translate)("approved your article")),t.Reason===p.default.getReason("StoryReject")&&(o=Object(a.translate)("rejected your article")),t.Reason===p.default.getReason("StoryApprovalRequestReminder")&&(o=Object(a.translate)("requested you an article review (reminder)")),t.Reason===p.default.getReason("CorporatepageApprovalRequest")&&(o=Object(a.translate)("requested you a page review")),t.Reason===p.default.getReason("CorporatepageApprove")&&(o=Object(a.translate)("approved your page")),t.Reason===p.default.getReason("CorporatepageReject")&&(o=Object(a.translate)("rejected your page")),t.Reason===p.default.getReason("CorporatepageApprovalRequestReminder")&&(o=Object(a.translate)("requested you a page review (reminder)")),t.Reason===p.default.getReason("SharedActivity")&&(o=Object(a.translate)(p.default.getSharedActivityNotificationReasonText(t.MetaData.SharedActivityType))),i===p.default.getReason("Apps")&&(o=Object(a.translate)("made you contact for an app")),t.Reason===p.default.getReason("DeclineInvitation")&&(o=Object(a.translate)("Declined your invitation")),t.Reason===p.default.getReason("StoryEditorAdded")&&(o=Object(a.translate)("is an editor")),t.Reason===p.default.getReason("StoryWriterAdded")&&(o=Object(a.translate)("is a writer")),t.Reason===p.default.getReason("CorporatepageEditorAdded")&&(o=Object(a.translate)("is an editor")),t.Reason===p.default.getReason("CorporatepageWriterAdded")&&(o=Object(a.translate)("is a writer")),t.Reason===p.default.getReason("CorporatepageGuestWriterAdded")&&(o=Object(a.translate)("is a guest writer"))," ".concat(o)},v.getCssIntValue=function(t,e){var i=t.css(e).replace(/[^-\d\.]/g,"")||0;return parseInt(i,10)},v.multilineEllipsis=function(t,e){var i="... ".concat(Object(a.translate)("Show more")),n="||".concat(i,"||");u.default.ellipsis(t,e,{ellipsis:n,callback:function(e,s){if(e){var r=t.text().replace(n,""),a=s.text().replace(r,"");t.text(r);var l=o()("<span />").addClass("comm-header__body__description-more").text(i).on("click",(function(){var e=v.getTextHeight(s,t);l.remove(),t.css({height:t.height(),overflow:"hidden"}).append(a).animate({height:e},300),l=null})).appendTo(t)}}})},v.getTextHeight=function(t,e){var i=e.clone().css({position:"absolute",top:0,left:0,width:e.width(),visibility:"hidden"}).html("").append(t).appendTo(e.parent()),n=i.height();return i.remove(),i=null,n},v.getIdeaCampaignImpactPageUrl=function(){return"".concat(m.default.getCurrentGroup().Url,"/Pages/Group/Impact.aspx")},v.getNewIdeaCampaignUrl=function(){return"".concat(m.default.getCurrentGroup().Url,"/SitePages/Idea Edit.aspx")},v.extendMethod=function(t,e,i){if(!r.a.isUndefined(e[i])){var n=t[i];t[i]=function(){var t=n.apply(this,arguments);return e[i].apply(this,arguments),t}}},v.getTitleByType=function(t){var e="";switch(t){case h.default.Type.STANDALONE_BLOG:e=Object(a.translate)("Blog");break;case h.default.Type.STANDALONE_WIKI:e=Object(a.translate)("Wiki");break;case h.default.Type.STANDALONE_QUESTIONS:e=Object(a.translate)("Question");break;case h.default.Type.STANDALONE_FORUM:e=Object(a.translate)("Forum");break;case h.default.Type.IDEAS_CAMPAIGN:e=Object(a.translate)("Ideas");break;case h.default.Type.KNOWLEDGECENTER:e=Object(a.translate)("Knowledge Center");break;case h.default.Type.CORPORATESITE:e=Object(a.translate)("Corporate Site");break;case h.default.Type.COMMUNITY:e=Object(a.translate)("Community");break;default:e=t}return e},v.isToolsPage=function(){return["wiki","blog","files","calendar","forum","polls","questions","wikiroot","ideas","links","tasks"].indexOf(beezyContext.CurrentPageKey)>-1},v.getBadge=function(t){var e=g.default.getPraiseIcons();return r.a.find(e,(function(e){return e.Name===t}))},v.getClassIconByType=function(t){var e=h.default.ActivitySnippetImageClass[t];return e||(e=h.default.ActivitySnippetImageClass[h.default.Type.POST]),e},v.showReadOnlyModal=function(){d.default.publish("readonly","showLoginModal")},e.default=v},1713:function(t,e,i){"use strict";e.default={title:"bz-title--1S3JGi",description:"bz-description--1S3JGi","container--centered":"bz-container--centered--1S3JGi"}},1716:function(t,e,i){"use strict";e.default={"icon--alert":"bz-icon--alert--ZGYelO","box--centered":"bz-box--centered--ZGYelO","container--margin":"bz-container--margin--ZGYelO"}},173:function(t,e,i){"use strict";i.r(e);var n=i(7),o={};o.applyColors=function(t,e,i){if(t&&(t.find(".js-color-background")||t.find(".js-color-color"))){var o=e?"#".concat(e):n.default.defaults.color,s=e?"#".concat(e):n.default.defaults.backgroundcolor,r=i?"#".concat(i):n.default.defaults.hovercolor;t.find(".js-color-background").css("background-color",s),t.find(".js-color-background-opacity").css("background-color",function(t,e){t=t.replace("#","");var i=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),o=parseInt(t.substring(4,6),16);return"rgba(".concat(i,",").concat(n,",").concat(o,",").concat(e/100,")")}(s,70)),t.find(".js-color-color").css("color",o),t.find(".js-color-border").css("border-color",o),t.find(".js-color-stroke").css("stroke",o),t.find(".js-color-fill").css("fill",o),t.find(".js-color-svg-hover").attr("onMouseOver",'this.style.fill="'.concat(o,'"')).attr("onMouseOut",'this.style.fill="#fff"'),t.find(".js-card-community-hover").attr("onMouseOver",'this.style.color="'.concat(r,'";this.style.backgroundColor="').concat(o,'"')).attr("onMouseOut",'this.style.color="'.concat(o,'";this.style.backgroundColor="').concat(r,'"')),t.find(".js-color-border-hover").attr("onMouseOver",'this.style.setProperty("border-color", "'.concat(o,'", "important")'))}},e.default=o},174:function(t,e,i){"use strict";var n=i(3),o=i.n(n),s=i(95),r=i(17),a=i(7);e.default=function(t,e,i,n){var l={hAlign:a.default.DropPosition[n?"LEFT":"RIGHT"]};o.a.each(t,(function(t){var n=".".concat(i,"[data-id=").concat(t.Id,"]"),o=e.find(n),a=o.parent();s.default.create(o,a.find(".js-activity-header-profile-link"),a.find(".js-activity-header-quickprofile"),r.default.saveUser(t),l)}))}},1743:function(t,e,i){"use strict";var n=i(2011);i.d(e,"useFollowUserMutation",(function(){return n.default}));var o=i(2012);i.d(e,"useUnFollowUserMutation",(function(){return o.default}))},1744:function(t,e,i){"use strict";e.default={"list__item--clickable":"bz-list__item--clickable--ZHojVR",icon:"bz-icon--ZHojVR"}},1752:function(t,e,i){"use strict";i.r(e);var n=i(2131),o=i.n(n),s=i(4),r=i.n(s),a=i(1032),l={crop:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{width:0,height:0},o=arguments.length>2?arguments[2]:void 0;return new Promise((function(s,a){i.e(40).then(i.bind(null,2089)).then((function(){if(0===n.width)return!0;t.resolve=s,t.reject=a;var i=n.width<800?800:n.width,c=n.height<250?250:n.height,u=l.openCropDialog(i,c);setTimeout((function(){var i=l.initCroppie(n);l.initFileReader(i,e.files[0]),r()(".js-image-cropper-btn-crop").click((function(a){a.preventDefault(),i.croppie("result",l.getCroppieOptions(n)).then((function(i){var n=new Blob([i],{type:"image/jpeg"}),a=e.originalFiles[0].name.split(".").reverse()[0];n.name="".concat(e.originalFiles[0].name.substring(0,e.originalFiles[0].name.length-a.length-1),".jpg"),o||(e.files[0]=n,e.originalFiles[0]=n),e.croppedFile=n,s(n),r()("#cropper").remove(),r()(t).remove(),u.hide()}))}))}),300)}))}))},openCropDialog:function(t,e){var i=this;r()(".js-image-cropper").length&&r()(".js-image-cropper").remove(),r()("body").append(o()({vpWidth:"".concat(t,"px")}));var n=new a.default({extend:{closeOnEscape:!0,width:t,height:e+280,dialogClass:"form-dialog"},selector:r()(".js-image-cropper")}).show();return r()(".js-image-cropper-btn-close").click((function(){i.reject(),n.hide()})),n},initCroppie:function(t){var e=r()('<div id="cropper" style="opacity: 0"></div>').croppie({viewport:t,boundary:t});return r()(".js-cropper-container").append(e),e},initFileReader:function(t,e){var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){t.croppie("bind",{url:e.target.result}).then((function(){r()(".js-cropper-loader").remove(),t.fadeTo(1500,1)}))}},getCroppieOptions:function(t){return{format:"jpeg",type:"blob",size:t}}};e.default=l},1753:function(t,e,i){"use strict";i.r(e);var n=i(1011),o=i(3),s=i.n(o),r=i(4),a=i.n(r),l=i(277),c=n.default.extend({classes:{container:"",list:"",item:""},init:function(){var t=this;n.default.prototype.init.apply(this,arguments),this.items=new l.default({el:this.render().el,template:this.options.template,items:this.options.items,classes:{list:this.classes.list,item:this.classes.item},listAriaAttrs:this.options.listAriaAttrs,itemAriaAttrs:this.options.itemAriaAttrs}),this.items.render(),this.onkeydown=s.a.bind(this.onkeydown,this),this.on("show",this.bindKeyboardEvents,this),this._setHeight=s.a.bind(this._setHeight,this),this.on("show",this._setDimensions,this),this.on("hide",this.unbindKeyboardEvents,this),this.items.on("select",this.onselectitem,this),this.items.on("keydown",this.onselectitem,this),this.items.on("itemfocus",(function(e,i,n){return t.emit("itemfocus",e,i,n)})),this.itemsWindowSize=this.options.itemsWindowSize||10},setItems:function(t){this.items.set(t)},reset:function(t){this.items.reset(t)},selectFirst:function(){this.items.selectFirst()},getSelectedItem:function(){return this.items.getSelected()},find:function(t,e){return this.items.find(t,e)},bindKeyboardEvents:function(){this._isBinded()||(a()(this.options.input||document).on("keydown",this.onkeydown),this._setAsBinded(),this.el.css("overflow-y","auto"))},unbindKeyboardEvents:function(){a()(this.options.input||document).off("keydown",this.onkeydown),this._setAsUnbinded(),this.el.css("overflow-y","hidden")},_setAsBinded:function(){a()(this.options.input||document).data("dropdownBinded",!0)},_setAsUnbinded:function(){a()(this.options.input||document).data("dropdownBinded",!1)},_isBinded:function(){return a()(this.options.input||document).data("dropdownBinded")||!1},onkeydown:function(t){switch(t.keyCode){case 13:t.preventDefault(),t.stopPropagation();break;case 9:this.onFocusOut();break;case 38:t.preventDefault(),this.items.move("prev"),this._scrollUp();break;case 40:t.preventDefault(),t.stopPropagation(),this.items.move("next"),this._scrollDown()}},onFocusOut:function(){var t=this;setTimeout((function(){t.hide()}),50)},onselectitem:function(t){var e=this;this.emit("select",t),setTimeout((function(){e.hide()}),50)},_scrollUp:function(){var t=this.items.getSelectedIndex()*this._itemOffsetHeight,e=this.el.scrollTop();t<e&&this.el.scrollTop(e-this._itemOffsetHeight)},_scrollDown:function(){this.items.getSelectedIndex()>=this.itemsWindowSize&&this.el[0].offsetHeight<this.el[0].scrollHeight&&this.el.scrollTop(this.el.scrollTop()+this._itemOffsetHeight)},_setDimensions:function(){this._setHeight(),this._setWidth()},_setHeight:function(){this.items.count()>this.itemsWindowSize?(this._itemOffsetHeight=this.items.getItemOffsetHeight()||42,this.el.css({overflowY:"auto",height:"".concat(this.itemsWindowSize*this._itemOffsetHeight+this.borderBoxHeight(),"px")}),this.items.getItemOffsetHeight()||setTimeout(this._setHeight,50)):this.el.css({overflowY:"hidden",height:"auto"})},_setWidth:function(){if(this.options.input){var t=a()(this.options.input).outerWidth();this.el.css({"max-width":t,width:t})}},dispose:function(){c.__super__.dispose.call(this),this.items.off("select",this.onselectitem,this),this.items.dispose()}});e.default=c},1759:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(13),r=i(361),a=i(574),l=i(2221),c=i.n(l),u=i(2),d=i(1458),h=i.n(d),f=i(137),p=i(7),m=s.default.extend({template:c.a,dom:{emptyStateContainerModal:".js-container-empty-state",emptyStateContainer:".js-empty-state",containerDataModal:".js-container-data",containerModal:".js-container-modal"},events:{"click .js-close":"close","click .js-add":"save","click .js-remove-metadata-item":"removeHashtag"},initialize:function(t){this.readyPromise=o.a.Deferred(),this._selectedTerms=new r.default.MetadataTerms,this.template=t.template||this.template,this._$terms={},this._modified=[],this.collection=new r.default.TermSetsAvailable(null,{groupId:t.groupId})},render:function(){return this.$el.html(this.template()),this.fetchTermsAvailable(),this.render=function(){return this},this},createMetadataFilter:function(){var t=this;this._metadataFilter=new a.default({el:this.$(".js-metadata-list"),collection:this.collection,hideButton:!0,collapsed:!0,isAccordion:!1,properties:[{Key:"tab",Value:"Terms"},{Key:"items",Value:"Name"},{Key:"parent",Value:"Name"}],onChangeValueItem:function(e,i){i?t.addTerm(e):t.removeTerm(e.Id)}}).render()},fetchTermsAvailable:function(){var t=this;this.collection.fetch().then((function(e){e.length?(t.showContainerData(),t.createMetadataFilter()):(t.showEmptyStateModal(),t.addClassEmptyToModal()),t.readyPromise.resolve()}))},ready:function(){return this.readyPromise},addClassEmptyToModal:function(){this.$(this.dom.containerModal).addClass("empty-modal")},showContainerData:function(){this.$(this.dom.containerDataModal).show()},showEmptyStateModal:function(){var t=(new f.default).getTemplateByType(p.default.EmptyStateType.modalMetadata);this.$(this.dom.emptyStateContainer).html(t),this.$(this.dom.emptyStateContainerModal).show()},addTermExternal:function(t){this._selectedTerms.models.some((function(e){return e.get("Id")===t.get("Id")}))||(this._selectedTerms.add(t),this.addTermNode(t.toJSON()),this._metadataFilter.checkItem(t))},removeTermExternal:function(t){this._selectedTerms.remove(t),this.removeTermNode(t.get("Id")),this._metadataFilter.uncheckItem(t)},close:function(){this.trigger("close")},onClose:function(){return this._saved?!this._modified.length||!!this.showConfirm()&&(this.restoreSavedState(),!0):!(this._selectedTerms.length&&!this.showConfirm())&&(this.reset(),!0)},showConfirm:function(){return window.confirm(Object(u.translate)("There are selected tags, are you sure?"))},save:function(){this._saved=!0,this._modified=[],this.trigger("save",this._selectedTerms)},restoreSavedState:function(){var t=this;this._modified.forEach((function(e){"add"===e.action?t.removeTerm(e.term):t.addTerm(e.term)})),this._modified=[]},getSelectedModelById:function(t){return this._selectedTerms.models.find((function(e){return e.get("Id")===t}))},reset:function(){this._metadataFilter&&(this._metadataFilter.reset(),this.$(".js-metadata-selected").html(""),this._selectedTerms.reset(),this._$terms={},this._modified=[],this.$(".js-selected-area").hide())},addTerm:function(t){this.getSelectedModelById(t.Id)||(this._selectedTerms.add(t),this.addTermNode(t),this._modified.push({action:"add",term:t}))},addTermNode:function(t){this.$(".js-selected-area").show();var e=h()({metadata:t.Name,Id:t.Id});this._$terms[t.Id]=o()(e),this.$(".js-metadata-selected").append(this._$terms[t.Id])},removeFromCollection:function(t){this._selectedTerms.remove(t)},removeTerm:function(t){var e=this.getSelectedModelById(t);e&&(this.removeFromCollection(e),this.removeTermNode(e.get("Id")),this._modified.push({action:"remove",term:e}))},unCheckMetadataFilter:function(t){this._metadataFilter.uncheckItem(this.getSelectedModelById(t))},removeHashtag:function(t){var e=o()(t.currentTarget).data("id");this.unCheckMetadataFilter(e),this.removeTerm(e)},removeTermNode:function(t){this._$terms[t]&&this._$terms[t].remove(),delete this._$terms[t],this._selectedTerms.length||this.$(".js-selected-area").hide()},onSelectItem:function(t,e){this.setTerm(e)},setTerm:function(t){this.addTerm(t),this._metadataFilter.checkItem(this.getSelectedModelById(t.Id))},setTerms:function(t){var e=this;this._metadataFilter&&this._metadataFilter.ready().then((function(){Array.isArray(t)?t.forEach((function(t){return e.setTerm(t)})):e.setTerm(t),e._modified=[]}))}});e.default=m},1760:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(116),l=i(310),c=function(t){this.isCollapsed=!!t.collapsed,this.options=t,this.wrapper=o()("<li />").addClass(t.classes.item),this.title=o()("<span />").addClass(t.classes.headerTitle).attr("data-tabsName",t.title).text(t.title),this.icon=o()("<span />").addClass(t.classes.headerIcon).addClass(this.isCollapsed?t.classCollapsed:t.classExpanded).text(t[this.isCollapsed?"iconCollapsed":"iconExpanded"]),this._onClickIcon=r.a.bind(this._onClickIcon,this),this.header=o()("<div />").addClass(t.classes.header).append(this.title).append(this.icon).appendTo(this.wrapper).on("click",this._onClickIcon),this.content=o()("<div />").addClass(t.classes.content).css("display",this.isCollapsed?"none":"").appendTo(this.wrapper),t.container.append(this.wrapper)};c.prototype={setTitle:function(t){this.title.text(t)},collapse:function(){this.content.slideToggle("slow"),this.icon.addClass(this.options.classCollapsed),this.icon.removeClass(this.options.classExpanded)},expand:function(){this.content.slideToggle("slow"),this.icon.addClass(this.options.classExpanded),this.icon.removeClass(this.options.classCollapsed)},remove:function(){this.icon.off("click")},show:function(){this.wrapper.show()},hide:function(){this.wrapper.hide()},destroy:function(){this.header.off("click",this._onClickIcon),this.wrapper.remove()},_onClickIcon:function(){this.isCollapsed=!this.isCollapsed,this.emit("toggle",this.isCollapsed,this),this[this.isCollapsed?"collapse":"expand"]()}},l.default.mixin(c.prototype);var u=a.default.extend({classes:{container:"",list:"accordion__list",item:"accordion__list__item",header:"accordion__title",headerTitle:"accordion__title__text",headerIcon:"accordion__title__icon icon",content:"accordion__body"},init:function(t){this._items=[],this.el.addClass(this.classes.container),this._list=o()("<ul />").addClass(this.classes.list).appendTo(this.el),t.items&&this.addItems(t.items)},addItems:function(t){if(r.a.isArray(t))return r.a.map(t,this.addItems,this);var e=new c({container:this._list,title:t.title,classes:this.classes,iconCollapsed:this.options.iconCollapsed||"",classCollapsed:this.options.classCollapsed||"icon--arrow-down-fill",iconExpanded:this.options.iconExpanded||"",classExpanded:this.options.classExpanded||"icon--arrow-up-fill",collapsed:t.collapsed});return this._items.push(e),e},reset:function(){r.a.invoke(this._items,"destroy"),this._items=[]},collapseAll:function(){r.a.invoke(this._items,"collapse")}});e.default=u},1761:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(116),l=i(89),c=i(117),u=i(211),d=i.n(u),h=i(12),f=i(185),p=i(64),m=a.default.extend({classes:{container:"picker",autocomplete:{},button:"picker-button"},init:function(){var t=this;this.onClickAdd=o.a.bind(this.onClickAdd,this),this.createAutocomplete(),h.default.subscribe("network","changed",(function(e){t.autocomplete.setAdapterOptions({adapterOptions:{networkId:e,type:"Community"}})})),this.selectedItem=null},createAutocomplete:function(){var t=this;this.autocomplete=new l.default({el:this.el,template:this.options.template||d.a,classes:this.classes.autocomplete||{},searchAdapter:this.options.searchAdapter,valueSelector:this.options.valueSelector,placeholderText:this.options.placeholder,adapterOptions:this.options.adapterOptions,zIndex:this.options.zIndex,itemsWindowSize:4,listInsertItems:this.options.listInsertItems,keyParameter:this.options.keyParameter,excludeItems:this.options.excludeItems,dependent:this.options.dependent,insideOtherDrop:this.options.insideOtherDrop,threshold:this.options.threshold}),this.autocomplete.setAdapterOptions(this.options),this.autocomplete.input.on("blur",(function(e){t.emit("blur",e)})),this.autocomplete.input.on("focus",(function(e){t.emit("focus",e)})),this.autocomplete.on("selectitem",this.onAutocompletSelectItem,this),this.autocomplete.on("inputchanged",this.onAutocompleteChange,this)},createButton:function(){this.button=r()('<input type="button" />').addClass(this.classes.button).val(this.options.buttonText||"Submit").on("click",this.onClickAdd).appendTo(this.el),p.default.disable(this.button)},getInput:function(){return this.autocomplete.input},renderSelector:function(t,e){this.selector=new f.default({el:e,options:t}).render()},onAutocompletSelectItem:function(t,e){this.autocomplete.setValue(t),this.setSelectedItem(e)},onAutocompleteChange:function(){var t=this.autocomplete.getSelectedDataItem();t?this.setSelectedItem(t):(this.resetSelectedItem(),this.emit("unselectItem"))},onClickAdd:function(t){t.preventDefault(),this.emit("add",this.selectedItem),this.options.removeAfterAdd&&(this.autocomplete.reset(),this.resetSelectedItem(),this.autocomplete.focus())},setSelectedItem:function(t){this.selectedItem=t,this.emit("selectItem",t),this.options.removeAfterAdd&&(this.autocomplete.reset(),this.resetSelectedItem(),this.autocomplete.focus())},resetSelectedItem:function(){this.selectedItem=null},enable:function(){this.autocomplete.enable()},disable:function(){this.autocomplete.disable()},reset:function(){this.resetSelectedItem()},dispose:function(){this.autocomplete.dispose()}});c.default.mixin(l.default.prototype),e.default=m},178:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(116),l=i(1011),c=i(7),u=a.default.extend({classes:{button:"dropdialog-btn",zindex:"droptime__container",drop:{container:"",top:"",bottom:""}},init:function(t){var e=this;this.el=t.el?t.el:o()("<span />"),this.onclickbutton=t.onclickbutton||this._onclickbutton,this.onclickbutton=r.a.bind(this.onclickbutton,this),this.el.on("click",this.onclickbutton),this.title=t.title||"",this.drop=new l.default({positionDefault:this.options.positionDefault,offset:this.options.offset,classes:this.classes.drop,fixed:this.options.fixed||!1,zIndex:this.options.zIndex||1,showDelay:t.showDelay,hideDelay:t.hideDelay,classContainer:t.classContainer,insideOtherDrop:t.insideOtherDrop,relatedElements:t.relatedElements}),this.drop.on("show",(function(){e.emit("show")})),this.drop.on("hide",(function(){e.emit("hide")})),this.drop.on("visible",(function(){this.emit("visible")}),this)},dropElement:function(){return this.drop.el},inject:function(t){this.drop.el.html(t)},append:function(t){this.drop.el.append(t)},addClassDrop:function(t){this.drop.el.addClass(t)},show:function(){this.opening=!0,this.options.animated?this.drop.showAnimated():this.drop.show()},hide:function(){return this.opening=!1,this.options.animated?this.drop.hideAnimated():this.drop.hide()},toggle:function(){this.render(),this.options.animated?this.drop.toggleAnimated():this.drop.toggle(),this.options.isDialog&&this.drop.el.addClass(this.classes.zindex)},toggleWithoutRender:function(){this.options.animated?this.drop.toggleAnimated():this.drop.toggle(),this.options.isDialog&&this.drop.el.addClass(this.classes.zindex)},clearDrop:function(){this.drop.clearDrop()},render:function(){return this.el.addClass(this.classes.button),this.options.data&&this.data(this.options.data),this.drop.bindTo(this.el),this.drop.render(),this.title&&this.drop.el.prepend('<div class="popover__header"><span class="popover__title">'.concat(this.title,"</span></div>")),this.emit("render"),this},bindTo:function(){this.drop.bindTo(this.el)},_calculatePosition:function(){this.drop._calculatePosition()},_onclickbutton:function(t){t.preventDefault(),t.stopPropagation(),this.toggle()},dispose:function(){this.el.off("click",this.onclickbutton),this.drop.dispose()},isHidden:function(){return this.drop.hidden}});u.create=function(t,e){return new u({el:e,classes:{button:t,drop:{container:"popover bz-webpart",top:"popover--top",bottom:"popover--bottom"}},offset:{top:-10,left:-3},positionDefault:{vertical:c.default.DropVerticalPosition.TOP,horizontal:c.default.DropPosition.CENTER},fixed:!0})},u.Configurations={bottom:{classes:{button:"",drop:{container:"popover bz-webpart",top:"popover--top",bottom:"popover--bottom"}},offset:{top:7,left:1},positionDefault:{vertical:c.default.DropVerticalPosition.BOTTOM,horizontal:c.default.DropPosition.CENTER},fixed:!0},right:{classes:{button:"",drop:{container:"popover bz-webpart md-popover--fixed",top:"popover--top",bottom:"popover--bottom-right"}},offset:{top:7,left:62},positionDefault:{vertical:c.default.DropVerticalPosition.BOTTOM,horizontal:c.default.DropPosition.LEFT},fixed:!0},rightNoTriangle:{classes:{button:"",drop:{container:"popover bz-webpart",top:"popover--top",bottom:"popover--bottom-right popover--no-triangle"}},offset:{top:7,left:0},positionDefault:{vertical:c.default.DropVerticalPosition.BOTTOM,horizontal:c.default.DropPosition.LEFT},fixed:!0},toolsLeft:{classes:{button:"",drop:{container:"popover bz-webpart",top:"popover--tools-top-left",bottom:"popover--tools-bottom-left"}},offset:{top:7,left:-10},positionDefault:{vertical:c.default.DropVerticalPosition.BOTTOM,horizontal:c.default.DropPosition.RIGHT},fixed:!0},toolsRight:{classes:{button:"",drop:{container:"popover bz-webpart",top:"popover--tools-top-right",bottom:"popover--tools-bottom-right"}},offset:{top:7,left:16},positionDefault:{vertical:c.default.DropVerticalPosition.BOTTOM,horizontal:c.default.DropPosition.LEFT},fixed:!0},topCentered:{classes:{button:"",drop:{container:"popover bz-webpart",top:"popover--top",bottom:"popover--bottom"}},offset:{top:7,left:109},positionDefault:{vertical:c.default.DropVerticalPosition.BOTTOM,horizontal:c.default.DropPosition.LEFT},fixed:!0}},e.default=u},18:function(t,e,i){"use strict";i.r(e),e.default={getQueryString:function(){var t,e={},i="".concat(document.location.search.substring(1),"&").concat(""),n=/([^&=]+)=([^&]*)/g;if(document.location.hash)for(;t=n.exec(i);)"accountname"===t[1]&&(e[decodeURIComponent(t[1])]=escape(decodeURIComponent(decodeURIComponent(t[2])+window.location.hash)));else for(;t=n.exec(i);)e[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return e},redirectToUrl:function(t){window.location.href=t},redirectToUrlInNewTab:function(t){window.open(t)},reloadView:function(t,e){if(t){for(var i in e="",t)e+="".concat(encodeURIComponent(i),"=").concat(encodeURIComponent(t[i]),"&");e=e.replace(/&\s*$/,"")}this.redirectToUrl("".concat(window.location.href.split("?")[0],"?").concat(e))},pushState:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};window.history&&void 0!==window.history.pushState&&window.history.pushState(i,t,e)}}},183:function(t,e,i){"use strict";i.d(e,"getWebAbsoluteUrl",(function(){return a})),i.d(e,"getWebRelativeUrl",(function(){return r})),i.d(e,"getSiteAbsoluteUrl",(function(){return l})),i.d(e,"getServerRequestPath",(function(){return d})),i.d(e,"getDefaultNetworkUrl",(function(){return u})),i.d(e,"getProfileUrl",(function(){return h})),i.d(e,"getCurrentLCID",(function(){return c})),i.d(e,"getCorporateModuleUrl",(function(){return f}));var n=i(149),o=i(1033),s=i(264);function r(){return Object(n.getSpPagecontextInfo)().webServerRelativeUrl}function a(){return Object(n.getSpPagecontextInfo)().webAbsoluteUrl}function l(){return Object(n.getSpPagecontextInfo)().siteAbsoluteUrl}function c(){return Object(n.getSpPagecontextInfo)().currentLanguage}function u(t){return 0===t.network.length?"":t.network[0].defaultWeb.rootWebLocation}function d(){return Object(n.getSpPagecontextInfo)().serverRequestPath}function h(t,e){return e===o.default.APPS?"".concat(l()).concat(s.AppsProfileUrl).concat(t):"".concat(l()).concat(s.WspProfileUrl).concat(t)}var f=function(){return window.beezySettings&&window.beezySettings.CorporateModule&&window.beezySettings.CorporateModule.Url}},185:function(t,e,i){"use strict";var n=i(36),o=i(3),s=i.n(o),r=i(4),a=i.n(r),l=i(2),c=i(20),u=i(2258),d=i.n(u),h=0,f=n.default.extend({dom:{SELECT:".js-selector"},type:"selector-type",template:d.a,events:{"change .js-selector":"onChange","mouseenter .js-selector":"onMouseEnter","mouseleave .js-selector":"onMouseLeave"},initialize:function(t){var e;this.options=t||{},this.isUpdate=t&&!t.isNew||!0,f.__super__.initialize.call(this,t),this.context=s.a.extend({id:this.type+(e=+new Date,(h+=1)+e),options:this.options.options||[]},this.options)},render:function(){return this.$el.append(this.template(this.context)),this.$select=this.$(this.dom.SELECT).get(0),a()(this.$select).find("option[value=".concat(this.context.selectedIndex,"]")).attr("selected","selected"),(this.context.disableSelector||1===this.context.options.length)&&this.disable(),this.$select[this.$select.selectedIndex]&&this.trigger("loaded",parseInt(this.$select[this.$select.selectedIndex].value,10)),this},refresh:function(){this.$el.children().remove(),this.render(),this.trigger("refreshed")},getValue:function(){var t=this;return this.options.useContext?s.a.find(this.options.context,(function(e){return e.Id===t.$select[t.$select.selectedIndex].value})):this.$select[this.$select.selectedIndex].value},getValueOptions:function(){return s.a.pluck(this.context.options,"Value")},setValue:function(t){var e=this;this.options.useContext?t&&t.Id&&(this.trigger("loaded",t.Id,this.isUpdate),a()(this.$select).find("option[value=".concat(parseInt(t.Id,10),"]")).attr("selected","selected")):(s.a.each(t.Values,(function(t){e.context.options.push({Value:t,Title:Object(l.translate)("Show latest"),showValue:!0})})),e.context.selectedIndex=parseInt(t.ValueSelected,10))},changeValues:function(t){var e=this;a()(this.$select).find("option").remove().end(),s.a.each(t,(function(t){a()(e.$select).append(a()("<option></option>").attr("value",t.Value).text(t.Title))})),t.length>1?this.enable():this.disable()},setValueSelected:function(t){a()(this.$select).find("option[value=".concat(parseInt(t,10),"]")).attr("selected","selected")},setFirst:function(){a()(a()(this.$select).find("option").get(0)).attr("selected","selected")},setError:function(){a()(this.$select).addClass(this.classes.error)},unsetError:function(){a()(this.$select).removeClass(this.classes.error)},attachError:function(){return this.$select},getJSON:function(){return this.getValue()},enable:function(){c.default.enable(this.$select)},disable:function(){c.default.disable(this.$select)},hide:function(){this.$el.hide()},onChange:function(){this.trigger("change",parseInt(this.$select[this.$select.selectedIndex].value,10))},onMouseEnter:function(t){this.trigger("mouseenter",t)},onMouseLeave:function(t){this.trigger("mouseleave",t)}});e.default=f},1850:function(t,e,i){"use strict";e.default={modal__header:"bz-modal__header--Z4pvgW",modal__body:"bz-modal__body--Z4pvgW",modal__image:"bz-modal__image--Z4pvgW",modal__title:"bz-modal__title--Z4pvgW",modal__intro:"bz-modal__intro--Z4pvgW",modal__wrapper:"bz-modal__wrapper--Z4pvgW"}},186:function(t,e,i){"use strict";i.d(e,"getCurrentLocationUrl",(function(){return o})),i.d(e,"getHashFromUrl",(function(){return s})),i.d(e,"getQueryString",(function(){return r})),i.d(e,"getFirstQueryString",(function(){return a})),i.d(e,"redirectToUrl",(function(){return l})),i.d(e,"reload",(function(){return c}));var n=i(696);function o(){return window.location.href}function s(){return window.location.hash}function r(t){for(var e,i={},n=t.search.substring(1),o=/([^&=]+)=([^&]*)/g;e=o.exec(n);)i[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return i}function a(t){var e={},i=t.search.substring(1),n=/([^&=]+)=([^&]*)/.exec(i);return n&&(e[decodeURIComponent(n[1])]=decodeURIComponent(n[2])),e}function l(t){window.location.href=t}function c(){window.location.reload()}i.d(e,"getStringParamsByKeys",(function(){return n.default}))},1860:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(38),s=i(49),r=i(2391),a=i.n(r),l=i(2392),c=i.n(l),u=function(){return i.e(4).then(i.bind(null,3074))},d=n.default.extend({initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.template=a.a,t.templateCard=c.a,d.__super__.initialize.call(this,t),this.configTools({edit:!1,share:!1,bookmark:!1,highlight:!1})},render:function(){return this.context.hasSecuredUsers=this.model.get("SecuredUsers")&&this.model.get("SecuredUsers").length>1,n.default.__super__.render.call(this),this.$el.addClass(this.isCard?"o-card__list__item grid__item js-card":"wall-list__item"),this},checkShowMore:function(){try{o.default.renderComponent(this.$(".js-content-main"),u,{adaptiveCardTemplate:this.getJsonAdaptiveCard(),submittedOutcome:this.model.getMetadata("TaskOutcome"),idCard:this.model.id},!1,!0)}catch(t){console.info("[ERROR] Render action card - Review the json for the adaptive card, it could not be well formed")}},getJsonAdaptiveCard:function(){var t=this.model.get("MetadataProperties").filter((function(t){return"AdaptiveTemplate"===t.Name}))[0].Value;return t=s.default.cleanNewLinesInJson(t),JSON.parse(t)},parseMessage:function(){}});e.default=d},1861:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(13),r=i(7),a=i(303),l=i(2355),c=i.n(l),u=i(2356),d=i.n(u),h=i(1862),f=s.default.extend({className:"activity-tools",classContainer:"activity-tools__container",template:c.a,conditions:["altText","bookmark","calendar","edit","editTags","hideFromNews","highlight","remove","report","share","createTask"],classes:{moreOptionsButton:".js-activity-tools-button"},initialize:function(t){this.options=t,this.options.hideMoreTools=t.hideMoreTools||!1,this.conditions=t.conditions||this.conditions,this.options.context.isCard&&!this.options.context.isViewPinComment&&(this.template=d.a)},showMoreTools:function(){var t=this.conditions,e=Object.prototype.hasOwnProperty.call(this.options.context,"Activity")?this.options.context.Activity:this.options.context;if(e)return o.a.some(this.options.context.tools,(function(i,n){var s=i&&o.a.indexOf(t,n)>-1;return"remove"===n&&i&&(s=s&&e.Owner&&(this._currentUserIsOwner(e.Owner.Id)||e.Group&&e.Group.IsCurrentUserWebAdmin)),s}),this)},_currentUserIsOwner:function(t){return beezyCurrentUser.Id===t},render:function(){if(this.options.context&&this.options.context.tools&&this.options.context.tools.like&&this.options.context.Type&&(this.options.context.tools.hasChampion=this.options.context.Type.toLowerCase()===r.default.Type.IDEA||this.options.context.Type.toLowerCase()===r.default.Type.EXTENDEDIDEA),this.options.activityView.feedType||(this.options.context.isCommentsOpen=a.default.isCurrentPageDetail()&&this.model._type!==r.default.Type.ACTIVITY_COMMENT&&this.model.get("TotalOfComments")>0,this.prepareContext(this.options.context),this.$el.html(this.template(this.options.context))),!this.options.hideMoreTools&&this.showMoreTools()){var t=new h.default({context:this.options.context,activityView:this.options.activityView,el:this.region("more"),model:this.options.model,parent:this.region("more"),button:this.$el.find(this.classes.moreOptionsButton)});this.propagateEvents(this.conditions,t)}else this.region("more").html("")},prepareContext:function(t){(t._type===r.default.Type.ACTIVITY_COMMENT||t._type===r.default.Type.ACTIVITY_ANSWER)&&this.options.context&&this.options.context.CurrentUserLikedActivity&&(this.options.context.CurrentUserLikedActivity=!1)}});e.default=f},1862:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(311),u=i(13),d=i(7),h=i(2358),f=i(2360);function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var g=u.default.extend({toolTypes:{Activity:{conditions:["altText","bookmark","calendar","edit","editTags","hideFromNews","highlight","remove","report","share","createTask"],hideAfterSelectConditions:["altText","calendar","edit","editTags","hideFromNews","remove","report","share","createTask"],showAfterSelectConditions:["bookmark","highlight"],dropDialogConfig:{verticalPosition:d.default.DropVerticalPosition.BOTTOM,position:d.default.DropPosition.LEFT},View:f.default},Community:{conditions:[],hideAfterSelectConditions:[],showAfterSelectConditions:["request"],dropDialogConfig:{verticalPosition:d.default.DropVerticalPosition.BOTTOM,position:d.default.DropPosition.CENTER},View:h.default,onHover:function(){this.toolsInitialized||(this.createDropDialog(),this.createTools()),this.render()},onClickButton:function(t){t.stopPropagation(),t.preventDefault(),this.show()}}},events:{mouseenter:"onHover",focusin:"onHover"},initialize:function(t){this.options=t,this.promiseEntity=void 0,this.toolsInitialized=!1,this.showTools=!1,this.toolsDialogId="tools-dialog-popover",l.a.has(this.toolTypes,this.options.model.get("Type"))?l.a.extend(this,this.toolTypes[this.options.model.get("Type")]):l.a.extend(this,this.toolTypes.Activity),this.onClickButton=l.a.bind(this.onClickButton,this),t.button.on("click",this.onClickButton),this.options.button.attr("aria-controls",this.toolsDialogId)},createDropDialog:function(){this.popover&&this.popover.dispose();var t=this.options.context.Type||this.options.context._type,e="activityComment"===t||"activityAnswer"===t||"task"===t||"Community"===t||"KnowledgeCenter"===t||"pollsdetails"===beezyContext.CurrentPageKey||this.options.context.isPinComment;this.popover=new c.default(m(m({},this.dropDialogConfig),{},{parent:this.options.parent,role:"menu",fixed:e,id:this.toolsDialogId,hideOnBlur:this.onPopoverBlur.bind(this),classNames:"popover-tools-moreoptions"}))},createTools:function(){this.toolsView=new this.View({context:this.options.context,model:this.options.model,targetOrigin:this.options.button}),this.propagateEvents(this.conditions,this.toolsView),l.a.each(this.hideAfterSelectConditions,(function(t){this.listenTo(this.toolsView,t,this.hide)}),this),l.a.each(this.showAfterSelectConditions,(function(t){this.listenTo(this.toolsView,t,this.recalculatePosition)}),this)},recalculatePosition:function(){this.popover._calculatePosition()},onHover:function(){this.toolsRendered=r.a.Deferred(),this.toolsInitialized||(this.createDropDialog(),this.createTools()),this.render()},onPopoverBlur:function(){this.showTools=!1,this.options.button.attr("aria-pressed",this.showTools),this.options.button.attr("aria-expanded",this.showTools)},onClickButton:function(t){var e=this;t.stopPropagation(),t.preventDefault(),this.showTools=!this.showTools,this.options.button.attr("aria-pressed",this.showTools),this.options.button.attr("aria-expanded",this.showTools),this.toolsRendered.done((function(){e.show()}))},render:function(){return this.renderTools(),this},renderTools:function(){var t=this;this.toolsInitialized&&this.toolsRendered?this.toolsRendered.resolve():(void 0===this.promiseEntity&&(this.promiseEntity=this.toolsView.getEntity()),this.promiseEntity?this.promiseEntity.then((function(e){t.popover.inject(t.toolsView.render(e).$el),t.toolsInitialized=!0,t.toolsRendered.resolve()})):(this.popover.inject(this.toolsView.render(this.options.model).$el),this.toolsInitialized=!0))},show:function(){this.popover.toggle()},hide:function(){this.popover.hidden||this.popover.toggle()}});e.default=g},1863:function(t,e,i){"use strict";i.r(e);var n=i(303),o=i(3),s=i.n(o),r=i(13),a=i(2362),l=i.n(a),c=i(305),u=i(503),d=i(8),h=c.default.MicroTag,f=r.default.extend({template:l.a,initialize:function(t){this.options=t||{},this.model=t.model,this.hidden=!0,this.tags=this.model.getTags()||[],this.activityId=this.model.get("Id"),this.setGroupId(),this.listenTo(this.model,"change:Terms",this.preRender)},setGroupId:function(){beezyCurrentGroup?this.groupId=beezyCurrentGroup.GroupId:this.groupId=this.model.get("Group")?this.model.get("Group").GroupId:null},render:function(){this.tags.forEach((function(t){t.isClickable=!0}));var t={Tags:this.tags};this.$el.html(this.template(t)),this.createMicrotags(),this.show()},isKnowledgeCenter:function(){return this.model.get("isKnowledgeCenter")},createMicrotags:function(){var t=this;if(!this.isKnowledgeCenter()&&!n.default.isCurrentPageCorporateSite()){var e=[];this.tags.forEach((function(i){var n=s.a.extend(i,{GroupId:t.groupId});e.push(new h(n))})),this.$(".js-microtag").toArray().forEach((function(i){var n=i.getAttribute("data-id"),o=e.find((function(t){return t.get("Name")===n}));o&&(d.default.getCurrentGroup()?o.getValueGroup().then((function(e){s.a.extend(o.attributes,{Value:e,GroupId:t.groupId}),u.default.create(i,o)})):o.getValue().then((function(e){s.a.extend(o.attributes,{Value:e,GroupId:t.groupId}),u.default.create(i,o)})))}))}},show:function(){this.$el.show(),this.hidden=!1},hide:function(){this.$el.hide(),this.hidden=!0},preRender:function(){this.tags=this.model.getTags(),this.render()}});e.default=f},1864:function(t,e,i){"use strict";i.r(e);var n=i(13),o=i(2364),s=i.n(o),r=n.default.extend({template:s.a,events:{"click .js-close":"close"},render:function(){return this.$el.html(this.template({title:this.title,users:this.users||[]})),this},setUsers:function(t){this.users=t},setTitle:function(t){this.title=t},close:function(){this.trigger("close")}});e.default=r},1865:function(t,e,i){"use strict";i.r(e);var n=i(13),o=i(2368),s=i.n(o),r=i(106),a=i(2),l=i(295),c=n.default.extend({tagName:"div",className:"poll-vote",template:s.a,events:{"change .js-poll-option":"changeOption"},render:function(){this.$el.html(this.template(this.collection.toJSON())),this.$options=this.$(".js-poll-option");var t=this.collection.getVotedOptionsIndexes();return this.selectOptions(t),this.buttonVote=new r.default({el:this.$el.find(".js-vote-button"),html:Object(a.translate)("Vote"),classes:{container:"btn btn--primary"},events:{click:this.onClickVoteButton.bind(this)},spinnerLoadingOnLeft:!0}),this.buttonVote.bindEvents(),this.buttonVote.hide(),this},onClickVoteButton:function(t){var e=this;t.preventDefault(),this.collection.vote().done((function(t){e.buttonVote.hide(),e.trigger("vote",l.default.getTotalOfPeopleVoted(t))}))},selectOptions:function(t){var e=this;t.forEach((function(t){var i=e.$options.get(t);i&&(i.checked=!0,i.parentElement.classList.add("selected"))}))},changeOption:function(t){t.preventDefault(),this.buttonVote.hidden&&this.buttonVote.show();var e=this.$options.index(t.target);e<0||(this.$options.get(e).checked?(this.$options.get(e).parentElement.classList.add("selected"),this.collection.addVote(e)):(this.$options.get(e).parentElement.classList.remove("selected"),this.collection.removeVote(e)))},show:function(){this.$el.show()},hide:function(){this.$el.hide()}});e.default=c},1866:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(5),l=i(13),c=i(774),u=i(20),d=i(2370),h=i.n(d),f=i(12),p=i(49),m=i(166),g=i(2),v=l.default.extend({template:h.a,events:{"click .js-close":"close","click .js-report":"report","keydown .js-comments":"checkText"},initialize:function(t){this.model=new c.default({},{user:t.user}),this.setActivity(t.activity),this.enable=o.a.bind(this.enable,this)},render:function(){return this.$el.html(this.template({title:this.title,reportTypes:beezySettings.ReportTypes})),this},setTitle:function(t){this.title=t},setActivity:function(t){var e;"activityComment"===(e=t)._type||"activityAnswer"===e._type||"answer"===e._type?(this.model.comment=t,this.model.activity=null,delete this.model.activity,this.setTitle(Object(g.translate)("Report this comment"))):(this.model.activity=t,this.model.comment=null,delete this.model.comment,this.setTitle(Object(g.translate)("Report this activity")))},report:function(){var t=this,e=m.default.isAppsCloud()||a.default.isSharepointApp()?p.default.duplicatedQuestionMarks(this.$(".js-comments").val()):this.$(".js-comments").val(),i=this.$(".js-reason :selected").val();this.disable(),this.model.set({Comments:e,Type:i}),this.model.report().then((function(){f.default.publish("ReportAbuse","report"),t.close()})).always(this.enable)},checkText:function(t){r()(t.currentTarget).val().trim()?this.enableReportButton():this.disableReportButton()},enableReportButton:function(){u.default.enable(this.$(".js-report"))},disableReportButton:function(){u.default.disable(this.$(".js-report"))},enable:function(){u.default.enable(this.$(".js-comments")),u.default.enable(this.$(".js-reason")),u.default.enable(this.$(".js-close")),u.default.enable(this.$(".js-report"))},disable:function(){u.default.disable(this.$(".js-comments")),u.default.disable(this.$(".js-reason")),u.default.disable(this.$(".js-close")),u.default.disable(this.$(".js-report"))},close:function(){this.trigger("close")}});e.default=v},1868:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(1869),u=i(1872),d=i(1875),h=i(5),f=i(1271),p=i(7),m=i(310),g=i(64),v=i(2),b=i(87),y=i.n(b),C=(i(124),r()('<input style="position: absolute; top: -2000rem;" tabindex="-1">').appendTo(document.body));function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options=e,this.components=[],this.users=[],this.hashtags=[],1===arguments.length?e=t:this.setContainer(t,e),null==e&&(e={}),this.placeholderText=e.placeholderText,this.labelText=e.labelText,this.labelId,e.labelId,this.onKeyDown=this.onKeyDown.bind(this),this.addComponent=this.addComponent.bind(this),this.resetDom(),this.label=this.createLabel(),this.elem=this.createElem(this.options.isTall,this.options.isRequired),this.error=this.createError(),this.warning=this.createWarning(),this.activateNewLine(!0),this.setElementEvents(),this.showPlaceholder(),this.addInputLabel(),this.render(),this.addComponent(c.default,{SearchAdapter:e.UserSearchAdapter,SearchAdapterOptions:{onlyEula:h.default.isEnableTermsOfUse()},MaximumResults:e.MaximumUsers||0,EventKey:e.eventKey,Type:"User",onItemSelected:this.handleSelectUser.bind(this)}),this.addComponent(u.default,{SearchAdapter:e.HashtagSearchAdapter,MaximumResults:e.MaximumHashtags||0,EventKey:e.eventKey,Type:"Hashtag",onItemSelected:this.handleSelectHashtag.bind(this)}),e.maxLength&&(this.disabled=!1,this.addComponent(d.default,{maxLength:e.maxLength,maxLengthLabel:e.maxLengthLabel}))}w.prototype.handleSelectUser=function(t){this.users.find((function(e){var i=e.Id;return t.Id===i}))||this.users.push(t)},w.prototype.handleSelectHashtag=function(t){this.hashtags.find((function(e){var i=e.Name;return t.Name.trim()===i.trim()}))||this.hashtags.push(t)},w.prototype.getUsers=function(){return this.users},w.prototype.setUsers=function(t){this.users=t},w.prototype.getHashtags=function(){return this.hashtags},w.prototype.setHashtags=function(t){this.hashtags=t},w.prototype.elem=null,w.prototype.container=null,w.prototype.components=[],w.prototype.empty=!0,w.prototype.labelText="",w.prototype.labelId="",w.prototype.placeholderText="",w.prototype.onReset=function(){},w.prototype.unbindEvents=function(){for(var t=0,e=this.components.length;t<e;t++){var i=this.components[t];i&&i.unbindEvents&&i.unbindEvents()}},w.prototype.addComponent=function(t,e){return null==e&&(e={}),this.components.push(new t(this,e))},w.prototype.hasFocus=function(){return this.elem.is(":focus")},w.prototype.focus=function(){var t=this.elem;setTimeout((function(){t.focus()}),0)},w.prototype.focusInLastCharacter=function(){var t=this,e=this.elem;setTimeout((function(){e.focus(),t.getData().message&&g.default.setFocusLastCharacter(e)}),0)},w.prototype.isEmpty=function(){return 0===this.rawContent().length},w.prototype._blurHack=function(t,e){var i,n;r.a.browser.msie&&parseInt(r.a.browser.version,10)<9&&t.appendTo(e.elem.parent()),document.createRange?((i=document.createRange()).selectNodeContents(t[0]),i.collapse(!1),(n=window.getSelection()).removeAllRanges(),n.addRange(i)):document.selection&&((i=document.body.createTextRange()).moveToElementText(t[0]),i.collapse(!1),i.select()),t.blur()},w.prototype.reset=function(){return this.empty=!0,this.elem.html(""),this.users=[],this.onReset(),this.blur(),!0},w.prototype.blur=function(){var t=this;this.elem.attr("contenteditable",!1),this.elem.blur(),setTimeout((function(){t.elem.attr("contenteditable",!0);try{/Edge/.test(navigator.userAgent)||t._blurHack(C,t)}catch(t){console.error(t)}}),1)},w.prototype.onKeyDown=function(t){if(8===t.which){var e=y.a.getSelection();if(e.isCollapsed){var i=e.focusNode.nodeValue;if(" "===i||""===i){var n=this.elem.contents().filter((function(){return!(3===this.nodeType&&""===this.nodeValue)})).first();n[0]!==e.focusNode&&n[0]!==e.focusNode.previousSibling||n.remove()}}}},w.prototype.setElementEvents=function(){var t=this;return r.a.browser.msie&&this.elem.on("keydown",this.onKeyDown),r.a.browser.mozilla&&this.elem.on("click",(function(){t.elem.focus()})),this.elem.on("keyup",(function(){return t.emit("keyup"),t.empty=t.isEmpty(),!0})),this.elem.on("mousedown",(function(){return t.elem.focus(),!0})),this.elem.on("keydown",(function(){return t.emit("keydown"),t.hasPlaceholder&&"true"===t.elem.attr("contenteditable")&&(t.removePlaceholder(),t.elem.html("<br>")),!0})),this.elem.on("focus",(function(){return t.emit("focus"),t.hasPlaceholder&&(t.removePlaceholder(),t.elem.html("<br>")),!0})),this.elem.on("blur",(function(){t.emit("blur"),r()(this).text().length||(t.showPlaceholder(),t.addInputLabel())})),this.elem.on("paste",(function(){return t.pasteText()}))},w.prototype.setPlaceholder=function(t){this.placeholderText=t,this.elem.hasClass("has-placeholder")&&this.elem.html(this.placeholderText)},w.prototype.showPlaceholder=function(){this.elem.html(this.placeholderText),this.hasPlaceholder=!0,this.elem.addClass("has-placeholder")},w.prototype.removePlaceholder=function(){return this.elem.html(""),this.hasPlaceholder=!1,this.elem.removeClass("has-placeholder")},w.prototype.addInputLabel=function(){this.elem.attr("aria-label",this.placeholderText)},w.prototype.resetComponents=function(){for(var t=this.components,e=[],i=0,n=t.length;i<n;i++){var o=t[i];e.push(o.reset())}return e},w.prototype.resetDom=function(){r()(this.container).html("")},w.prototype.setContainer=function(t,e){t instanceof r.a||(t=r()(t)),t.hasClass("beezy-microbox")||t.addClass("beezy-microbox"),this.container=t,this.emit("changeContainer:".concat(e.eventKey))},w.prototype.enable=function(){this.elem.removeClass("disabled").attr("contenteditable","true")},w.prototype.disable=function(){this.elem.addClass("disabled").attr("contenteditable","false")},w.prototype.render=function(){this.container&&(this.labelText?this.container.append(this.label):this.resetDom(),this.container.append(this.elem),this.container.append(this.warning),this.container.append(this.error))},w.prototype.createLabel=function(){return r()("<label />").addClass("microbox__label")},w.prototype.createLabelText=function(t,e){this.labelText=t,this.labelId=e,this.labelText?(this.label.text(this.labelText).attr("id",this.labelId||""),this.elem.attr("aria-labelledby",this.labelId||""),this.render()):(this.render(),this.setElementEvents())},w.prototype.createElem=function(t,e){var i=t?"microbox__input--tall":"",n=r()("<div />").addClass("microbox__input ".concat(i," is-input")).attr("contenteditable","true").attr("data-test","microbox").attr("role","textbox").attr("aria-multiline",!0);return e&&n.attr("aria-required",!0),n},w.prototype.createWarning=function(){return r()("<div />",{class:"beezy-microbox-warning"}).hide()},w.prototype.createError=function(){return r()("<div />").addClass("microbox__error js-microbox-error").attr("role","alert").hide()},w.prototype.resetWarning=function(){this.warning.text("").hide()},w.prototype.setThresholdWarning=function(t){this.warning.text(Object(v.translate)("Type at least %s letters to get names suggestions.").replace("%s",t)).show()},w.prototype.setOverflowWarning=function(){this.warning.text(Object(v.translate)("Too many names available, please keep trying.")).show()},w.prototype.rawContent=function(){var t,e=r()("<div />").html(this.elem.html());return r()("span[data-id]",e).replaceWith((function(){return r()(this).attr("data-id")})),r.a.browser.msie?t=e.get(0).innerText:(e.find("br").replaceWith("\n"),t=e.text()),e=null,l.a.str.trim(t.replace(/\u200C/g,""))},w.prototype.followsContent=function(){var t,e=r()("<div />").html(this.elem.html());return r()("span[data-loginName]",e).replaceWith((function(){return r()(this).attr("data-loginName")})),r()("span[data-id]",e).replaceWith((function(){return r()(this).attr("data-id")})),r.a.browser.msie?t=e.get(0).innerText:(e.find("br").replaceWith("\n"),t=e.text()),e=null,l.a.str.trim(t)},w.prototype.plainText=function(){var t=r()("<div />").html(this.elem.html());r()("span[data-id]",t).replaceWith((function(){return l.a.rest(r()(this).attr("data-content")).join("")}));var e=t.text();return t=null,l.a.str.trim(e)},w.prototype.isValid=function(){for(var t=!0,e=this.components,i=0,n=e.length;i<n;i++){e[i].isValid()||(t=!1)}return t},w.prototype.getData=function(){return{message:this.empty?"":this.rawContent(),valid:this.isValid(),users:this.getUsers(),hashtags:this.getHashtags()}},w.prototype.getDataFollows=function(){return{message:this.empty?"":this.followsContent(),valid:this.isValid()}},w.prototype.UserBox=f.default,w.prototype.insertNewLine=function(){var t=document.createElement("br"),e=y.a.getSelection(),i=y.a.createRange();i.setStart(e.anchorNode,e.anchorOffset),i.setEnd(e.focusNode,e.focusOffset),e.isCollapsed||e.deleteFromDocument(),i.insertNode(t);var n=t.previousSibling;return r.a.browser.webkit&&n&&3===n.nodeType&&" "!==n.nodeValue&&!t.nextSibling&&i.insertNode(document.createElement("br")),i.setStartAfter(t),i.setEndAfter(t),i.collapse(!1),e.setSingleRange(i)},w.prototype.activateNewLine=function(t){return this.elem.keydown(t?this.enableNewLines():this.disableNewLines()),this.elem.keypress(this.disableNewLines())},w.prototype.enableNewLines=function(){var t=this;return function(e){if(13===e.which)return e.stopPropagation(),e.preventDefault(),t.insertNewLine(),!1}},w.prototype.disableNewLines=function(){return function(t){if(13===t.which)return t.stopPropagation(),t.preventDefault(),t.originalEvent.keyCode=0,!1}},w.prototype.disableCharacterEntry=function(){return this.disabled=!0},w.prototype.enableCharacterEntry=function(){return this.disabled=!1},w.prototype.count=function(){return this.empty?0:this.rawContent().length},w.prototype.extractContent=function(t){for(var e,i=document.createDocumentFragment();e=t.firstChild;)i.appendChild(e);return i},w.prototype.pasteText=function(){var t=this,e=this.elem[0],i=y.a.saveSelection(),n=this.extractContent(e);setTimeout((function(){var o=document.createElement("SPAN");o.innerHTML=l.a.str.stripTags(e.textContent).replace(/(\n\n)|(\r\r)|(\r\n)|(\n\r)|(\n|\r)/g,"<br>"),e.innerHTML="",e.appendChild(n);var s=y.a.getSelection();y.a.restoreSelection(i),s.deleteFromDocument();var r=o.lastChild,a=s.getRangeAt(0);a.insertNode(o),a.collapseAfter(r),y.a.getSelection().setSingleRange(a),t.empty=!1}),1)},w.prototype.initText=function(t,e,i){var n=t.replace(/(?:\r\n|\r|\n)/g,"<br>").concat("<br>");t.length&&(this.empty=!1,this.removePlaceholder()),this.elem&&(this.elem.html(n),e&&e.length&&this.parseHashtags(t,e),i&&i.length&&this.parseMentions(t,i))},w.prototype.parseHashtags=function(t,e){var i=p.default.HashtagRegExp;this.addPropertyInDom(e,i,"#",this.components[1],t,(function(t,e){return t.find((function(t){return t.Name.toLowerCase()===e.toLowerCase()}))}))},w.prototype.parseMentions=function(t,e){var i=p.default.MentionsRegExp;this.addPropertyInDom(e,i,"@",this.components[0],t,(function(t,e){return t.find((function(t){return t.Id===parseInt(e,10)}))}))},w.prototype.addPropertyInDom=function(t,e,i,n,s,r){for(var a,l=this,c=[];null!=(a=e.exec(s));)c.push({index:a.index,name:a[1]});var u=c;"#"===i&&(u=c.filter((function(e){return e.name.split(i).some((function(e){return t.find((function(t){return t.Name.toLowerCase()===e.toLowerCase()}))}))}))),u.forEach((function(s){var c=s.name.split(i);c.fill(i,1,c.length-1).shift();var u=c.join(""),d=r(t,u),h=o()(l.elem.get(0).childNodes).find((function(t){return t.textContent.indexOf("".concat(i+u," "))>-1}));for(h||(h=o()(l.elem.get(0).childNodes).find((function(t){return t.textContent.indexOf("".concat(i+u))>-1})));null!=(a=e.exec(h.textContent));)s.name===a[0]&&(s.index=a.index);l.elem.focus(),g.default.selectText(h,i+u),n.buffer.set(i+u,true),n.startBuffering(),n.createBox(d)}))},m.default.mixin(w.prototype),e.default=w},1869:function(t,e,i){"use strict";i.r(e);var n=i(1269),o=i(1271),s=i(1871),r=i(579);function a(){return a.__super__.constructor.apply(this,arguments)}Object(r.default)(a,n.default),a.prototype.acceptedCharacters=/[^\t\n\b\f\r\0\x0B\x1B]/,a.prototype.triggerCharacter="@",a.prototype.selectFirstOnSearching=!0,a.prototype.RenderBox=o.default,a.prototype.AutocompleteDropdown=s.default,a.prototype.handleItemSelected=function(t){this.onItemSelected(t)},e.default=a},1870:function(t,e,i){"use strict";function n(t,e){null==t&&(t=""),null==e&&(e={}),this._content=t,this.bufferEmptied=e.bufferEmptied||function(){},this.bufferChanged=e.bufferChanged||function(){}}i.r(e),n.prototype.content=function(){return this._content},n.prototype.decrement=function(){var t=this._content,e=t.length;return e>0?this.set(t.substr(0,e-1)):this.empty()},n.prototype.increment=function(t){return"number"==typeof t&&(t=String.fromCharCode(t)),this.set("".concat(this._content).concat(t))},n.prototype.set=function(t,e){return this._content=t,this.bufferChanged(this._content,e)},n.prototype.empty=function(){return this.set(""),this.bufferEmptied()},e.default=n},1871:function(t,e,i){"use strict";i.r(e);var n=i(1272),o=i(587),s=i(579);function r(){return r.__super__.constructor.apply(this,arguments)}Object(s.default)(r,n.default),r.prototype.completionKeys=[o.default.INTRO,o.default.TAB],e.default=r},1872:function(t,e,i){"use strict";i.r(e);var n=i(1269),o=i(1873),s=i(1874),r=i(579);function a(){return a.__super__.constructor.apply(this,arguments)}Object(r.default)(a,n.default),a.prototype.acceptedCharacters=/[^\s\t\n\b\f\r\0\x0B\x1B\!\:\?\;\.\,]/,a.prototype.triggerCharacter="#",a.prototype.selectFirstOnSearching=!1,a.prototype.mustExists=!1,a.prototype.enabledWarnings=!1,a.prototype.RenderBox=o.default,a.prototype.AutocompleteDropdown=s.default,a.prototype.handleItemSelected=function(t){this.onItemSelected(t)},e.default=a},1873:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n);function s(t){this.data=t,this.createNode(),this.addName()}s.prototype.node=null,s.prototype.createNode=function(){var t=o()("<span />");return this.node=t[0],t.addClass("beezy-microbox-box").addClass("beezy-microbox-hashtag"),t.attr("data-id","#".concat(this.data.Name)),t[0]},s.prototype.addName=function(){return o.a.browser.msie&&7===parseInt(o.a.browser.version,10)?o()(this.node).html("#".concat(this.data.Name)).attr("contenteditable","true"):o()(this.node).attr("data-content","#".concat(this.data.Name))},e.default=s},1874:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(1272),r=i(579);function a(){return this.keyDown=this.keyDown.bind(this),a.__super__.constructor.apply(this,arguments)}Object(r.default)(a,s.default),a.prototype.createItem=function(t){var e=this,i=o()("<li />").attr("data-id",t.Name).addClass("autocomplete__item").click((function(){return e.callback(t,!0),e.stop(),!1}));return i.append(o()("<span />").addClass("name").html("#".concat(t.Name))),i},a.prototype.update=function(t){return this.results=t,this.updateResults()},a.prototype.keyDown=function(t){if(" "===String.fromCharCode(t.which)&&32!==t.which){return this.callback({Name:this.autocompleteObserver.buffer.content()},!0),this.stop(),!1}return a.__super__.keyDown.call(this,t)},e.default=a},1875:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(1270),l=i(579);function c(t,e){var i=this;c.__super__.constructor.call(this,t,e),this.maxLength=e.maxLength,this.maxLengthLabel=e.maxLengthLabel||"Characters: %",this.unbindEvents(),this.bindEvents(),this.createCounter(),this.updateCounter(),this.microbox.onReset=function(){return i.reset()}}Object(l.default)(c,a.default),c.prototype.unbindEvents=function(){this.elem.off("keyup",this.onKeyupCounter),this.elem.off("cut",this.onCutCounter)},c.prototype.bindEvents=function(){return this.elem.bind("keyup",this.onKeyupCounter),this.elem.bind("cut",this.onCutCounter)},c.prototype.onKeyupCounter=function(){return this.updateCounter()},c.prototype.onCutCounter=function(){var t=this;return setTimeout((function(){return t.updateCounter()}),0)},c.prototype.createCounter=function(){var t,e=this;this.charactersLeft=o()("<span />").addClass("beezy-microbox-characters");var i=this.maxLengthLabel.indexOf("%");return 0===i?t=[this.charactersLeft,o()("<span />").html(this.maxLengthLabel.substring(1))]:i===this.maxLengthLabel.length-1?t=[o()("<span />").html(this.maxLengthLabel.substring(0,i)),this.charactersLeft]:i>0?(t=this.maxLengthLabel.split("%"),t=[o()("<span />").html(t[0]),this.charactersLeft,o()("<span />").html(t.slice(1).join("%"))]):t=[o()("<span />").html(this.maxLengthLabel)],this.counter=o()("<span />").addClass("beezy-microbox-counter"),this.container.addClass("with-counter"),r.a.each(t,(function(t){return t.appendTo(e.counter)})),this.counter.appendTo(this.container)},c.prototype.updateCounter=function(){var t=this.maxLength-this.microbox.count();return t<=0?(this.microbox.disableCharacterEntry(),t=0):this.microbox.enableCharacterEntry(),this.charactersLeft.html(t)},c.prototype.reset=function(){return this.charactersLeft.html(this.maxLength)},c.prototype.isValid=function(){return this.microbox.count()<this.maxLength},e.default=c},1876:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n);function s(){this._processing=!1,this._current=null,this.reset=o.a.bind(this.reset,this)}s.prototype={process:function(t){this._processing&&this.stop(),this._processing=!0,this._current=t,t.always(this.reset)},stop:function(){this._current&&this._current.abort&&this._current.abort(),this.reset()},reset:function(){this._processing=!1,this._current=null}},e.default=s},1877:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(2380),r=i.n(s),a=i(64);function l(t){this.boundElement=t.boundElement,this.numberLines=t.numberLines,this.classHide=t.classHideContent,this.classShow=t.classShowContent}l.prototype={checkShowMore:function(){var t=this.boundElement.scrollHeight,e=parseInt(window.getComputedStyle(this.boundElement).getPropertyValue("line-height"),10);t>this.numberLines*e+1&&this.appendShowMoreElement()},clickShowMore:function(){var t=this;this.boundElement.classList.add(this.classShow),this.destroyShowMoreElement(),o()(this.boundElement).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",(function(){t.boundElement.scrollHeight>t.boundElement.clientHeight&&(t.boundElement.style.maxHeight="".concat(t.boundElement.scrollHeight,"px"))}))},appendShowMoreElement:function(){this.boundElement.classList.add(this.classHide),this.showMoreElement=a.default.addChildToElement(this.boundElement,r()()),this.showMoreElement.addEventListener("click",this.clickShowMore.bind(this))},destroyShowMoreElement:function(){this.boundElement.classList.remove(this.classHide),a.default.destroyElement(this.showMoreElement)}},e.default=l},1878:function(t,e,i){"use strict";i.r(e);var n=i(2),o=i(2385),s=i.n(o),r=i(2386),a=i.n(r);e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.e(76).then(i.t.bind(null,3723,7)).then((function(){var i={};Object.assign(i,{delegate:"button",type:"image",gallery:{tPrev:Object(n.translate)("Previous image"),tNext:Object(n.translate)("Next image"),enabled:!0},image:{titleSrc:function(t){return a()({src:t.el.find("img").attr("data-full-src"),title:t.el.attr("title"),altText:t.el.find("img").attr("alt")})}},tCounter:s()(),preload:[1,2]},e),t.magnificPopup(i)}))}},1879:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(73),l=i(13),c=i(49),u=i(2),d=i(215),h=i.n(d),f=i(1880),p=i(12),m=i(7),g=i(169),v=i(30),b=l.default.extend({showComments:!1,showTextCommentLike:!0,activityTools:!1,filterTemplate:h.a,viewPrefix:"v",tagName:"ul",className:"activities js-comments-area",lastBestAnswerId:0,lastpinCommentId:0,initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,t.activityId&&(this.collection.activityId=t.activityId,this.isActivityDetail=!0);var e=this.options.parentActivity;e&&(this.lastBestAnswerId=e.model.getMetadata("bestAnswer"),this.lastpinCommentId=e.model.getMetadata("pinComment"),this.showTextCommentLike="undefined"!==e.model.get("showTextCommentLike")?e.model.getMetadata("showTextCommentLike"):this.showTextCommentLike),this.skip=t.skip||0,this.take=t.take||20,this._filter={},this._elements=[],this._views={},this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"remove",this.onRemoveActivity),this.listenTo(this.collection,"add",this.appendActivities),this.on("snippetsLoaded",this.showSnippetsActivity),this.animatedScrollTop=r.a.bind(this.animatedScrollTop,this),p.default.publish("created","Comment",this.createdComment)},events:{"click .alert__close":"reset"},clearComment:function(t){var e=r()(this._elements).indexOf(t);this._elements.splice(e,1)},render:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.$el.html(""),this.$el.attr("data-view-placeholder","comments-list"),t.avoidSort&&this._sortCollection(),this.collection.each(this.appendActivities,this),this.trigger("render"),this.setOldTitle(),this},getViewComment:function(t){var e={model:t,showComments:this.showComments,showTextCommentLike:this.showTextCommentLike,tools:this.activityTools,readOnly:this.options.readOnly,hasPinned:r.a.isString(this.lastpinCommentId)||r.a.isNumber(this.lastpinCommentId)};this.showUnbookmark&&(t.attributes.CurrentUserMarkAsFavorite=!0),this.options.parentActivity&&r.a.extend(e,{parentActivity:this.options.parentActivity});var i=e.model._type;return"Poll"===i&&r.a.extend(e,{isPoll:!0}),b.commentFactory(m.default.Type.getKey(i),e)},renderActivity:function(t){var e=this.getViewComment(t);return e.options.parentActivity&&r.a.each(t.get("Mentions"),(function(t){r.a.some(e.options.parentActivity.model.get("Mentions"),(function(e){return t.Id===e.Id}))||e.options.parentActivity.model.get("Mentions").push(t)})),this.listenTo(e.model,"change",(function(){var t=e.model.changedAttributes().attributes||e.model.changedAttributes();e.model.hasChanged()&&r.a.extend(e.model.attributes,t),e.render()})),e.on("clear",(function(){this.clearComment(e.$el)}),this),e.on("voted",(function(t){var e=this;this.render({avoidSort:"mostLiked"===this.order}),setTimeout((function(){e.$el.find('[data-activity-id="'.concat(t.attributes.Id,'"] .js-info-votes')).trigger("focus")}),100)}),this),e.on("pinComment",(function(t,e,i){var n=this;if(this.lastpinCommentId){var o=this._views[this.viewPrefix+this.lastpinCommentId];o&&o.render()}this.lastpinCommentId=e?i:void 0,p.default.publish("pinComment".concat(t),"add",e,i),setTimeout((function(){n.$el.find('[data-activity-id="'.concat(i,'"] .js-info-pincomment')).trigger("focus")}),100)}),this),e.on("likedPin",(function(t,e,i){this.lastpinCommentId&&this.lastpinCommentId.toString()===e.toString()&&p.default.publish("pinComment".concat(t),"like",e,i)}),this),e.on("bestAnswer",(function(t){this.lastBestAnswerId=t,this.trigger("bestAnswer",t)}),this),this.registerActivityEvents(e),this._views[this.viewPrefix+t.id]=e,e.render()},registerActivityEvents:function(){},_compareVotesCount:function(t,e){return t.get("TotalOfLikes")<e.get("TotalOfLikes")?1:t.get("TotalOfLikes")===e.get("TotalOfLikes")?0:-1},_sortCollection:function(){var t=this.collection.toArray().sort(this._compareVotesCount);this.collection.reset(t,{silent:!0})},showFirst:function(t){if(t){var e=this._elements.length-t;r.a.chain(this._elements).first(t).invoke("show"),r()(this._elements.slice(-e)).invoke("hide")}else r()(this._elements).invoke("show")},showLast:function(t){if(t){var e=this._elements.length-t;r.a.chain(this._elements).rest(e).invoke("show"),r()(this._elements.slice(0,e)).invoke("hide")}else r()(this._elements).invoke("show")},show:function(){return this.$el.show(),this.isHidden=!1,this},hide:function(){return this.$el.hide(),this.isHidden=!0,this},animatedScrollTop:function(){var t=this.$el;setTimeout((function(){var e=t.offset().top-50;e<=0&&(e+=Object(v.sharePointItems)().content.scrollTop()),Object(v.sharePointItems)().content.animate({scrollTop:e},600)}))},appendActivity:function(t){var e=this.renderActivity(t);this._elements.push(e.$el),this.$el.append(e.el)},appendActivities:function(t){this.tempActivities=this.tempActivities||{activities:o()(),count:0};var e=this.renderActivity(t);return this._elements.push(e.$el),this.tempActivities.activities=this.tempActivities.activities.add(e.$el),this.tempActivities.count++,this.tempActivities.count!==this.take&&this.remaining()||(this.$el.append(this.tempActivities.activities),this.tempActivities=null),e},prependActivity:function(t){var e=this.renderActivity(t);this._elements=[e.$el].concat(this._elements),this.$el.prepend(e.el)},setLoading:function(){this.trigger("loading"),this.$el.append(o()("<li />").addClass("loading"))},unsetLoading:function(){this.trigger("loaded"),this.$("li.loading").remove()},setOrder:function(t){this.order=t},fetchData:function(t){var e=this;return t.hideLoading||this.setLoading(),this.collection.fetch(r.a.extend({success:function(t,i,n){n.hideLoading||e.unsetLoading(),t.filtered&&(e.renderFilter(),t.length||e.renderEmptyMessage());var o=t.slice(e.skip,e.skip+e.take);e.getSnippets(o,n.callback)},error:function(t,i,n){n.hideLoading||e.unsetLoading()}},t))},getSnippets:function(t,e){this.snippetLinks=[],r.a.each(t,this.parseMessage,this);var i=this;g.default.Snippets.get(this.snippetLinks).then((function(){i.trigger("snippetsLoaded"),e&&e()}))},parseMessage:function(t){var e=c.default.getLinks(t.get("Message"));e&&(this.snippetLinks=r.a.union(this.snippetLinks,e))},showSnippetsActivity:function(){var t=this;this.collection.each((function(e){var i=t.getActivityViewById(e.id);i.snippetLoaded||(i.searchSnippet(),i.snippetLoaded=!0)}))},refresh:function(t){t=t||{};var e=r.a.extend({skip:t.skip||0,take:(t.take||this.collection.length||this.take)+1},this._dataFilter(this._filters));return this.fetchData(r.a.extend({data:e,reset:!0},t.fetch))},more:function(){return this.skip+=this.options.take,this.refresh({fetch:{update:!0,remove:!1},skip:this.skip,take:this.options.take})},reset:function(){return this.removeFilter(),this.skip=this.options.skip,this.refresh({fetch:{hideLoading:!0},take:this.options.take})},renderFilter:function(){this.$("li.filter").length||(this.filterEl=o()("<li>").addClass("filter"),this.filterEl.html(this.filterTemplate(this._filter)),this.$el.prepend(this.filterEl))},renderEmptyMessage:function(){this.$("li.empty-message").length||(this.filterEl=o()("<li>").addClass("empty-message"),this.filterEl.html('<div class="alert alert--error">'.concat(Object(u.translate)("No results found"),"</div>")),this.$el.append(this.filterEl))},removeFilter:function(){this.trigger("removeFilter");var t=document.location.href.indexOf("?");if(t>-1){var e=document.location.href.substring(t);document.location.href=document.location.href.replace(e,"")}else this.resetFilters()},_dataFilter:function(){var t={};return r()(this._filter).each((function(e){t[e.name]=e.value})),t},resetFilters:function(){this._filter={},this.collection.filtered=!1,this.filterEl&&this.filterEl.remove()},addFilter:function(t,e){this.collection.filtered=!0,this._filter[e]={name:t.name,value:t.value,label:t.label||t.value}},filter:function(t){t&&r()(t).each(this.addFilter,this),r.a.isEmpty(this._filter)||this.refresh({take:this.options.take})},filterByHashtag:function(t){this.addFilter({name:"hashtag",value:t},"hashtag"),this.refresh({fetch:{callback:this.animatedScrollTop},take:this.options.take}),this.trigger("filteredByHashtag",t)},filterByUser:function(t,e){this.addFilter({name:"userid",value:t,label:e},"user"),this.refresh({fetch:{callback:this.animatedScrollTop},take:this.options.take})},collectionSize:function(){return this.collection.size()},remaining:function(){return this.collection.remaining},onRemoveActivity:function(t){var e=t.id;this.trigger("remove"),this._views[this.viewPrefix+e]=null,delete this._views[this.viewPrefix+e]},unsetBestAnswer:function(t){this.getActivityViewById(t).unsetBestAnswer()},setBestAnswer:function(t){this.getActivityViewById(t).setBestAnswer()},getActivityViewById:function(t){return this._views[this.viewPrefix+t]},setOldTitle:function(){document.title=a.default.currentTitle||window.document.title}}),y=function(t,e){return new t(e||{})};b.commentFactory=function(t,e){var i=f.default,n={ANSWER:i.Answer,ACTIVITY_COMMENT:i.Answer,ACTIVITY_ANSWER:i.ActivityAnswer};return b.activityFactory=function(t,e){return y(n[t],e)},y(n[t],e)},e.default=b},188:function(t,e,i){"use strict";var n=i(2289);e.default=n.default},1880:function(t,e,i){"use strict";i.r(e);var n=i(1273),o=i(960),s={};s.ActivityAnswer=n.default,s.Answer=o.default.Answer,e.default=s},1881:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(955),l=i(2),c=i(1935),u=i.n(c),d=i(1411),h=i.n(d),f=i(113),p=i(12),m=i(46),g=i(15),v=i(17),b=a.default.extend({className:"bz-webpart popover comment-popup popover--no-triangle",dom:{classContainer:"js-popup-access"},template:u.a,events:{mouseenter:"show","click .js-comment-popup-btn":"makeAction"},hideInResponsive:!1,initialize:function(t,e){this.model=this.model?this.model:new f.default(t),this.options={bindEvents:!1},g.default.isReadOnly()||this.initializeDrop(e.elementBound)},bindEvents:function(){this.delegateEvents()},makeAction:function(t){if(t.preventDefault(),t.stopPropagation(),g.default.isReadOnly())return v.default.showReadOnlyModal();var e=this;o()(t.currentTarget).addClass("is-loading").html("").append('<div class="btn--loading-ellipsis"></div>'),this.model.join().then((function(){e.requestSent=!0,e.template=h.a,e.rerender(),window.setTimeout((function(){e.hide(),e.template=u.a,"start"===beezyContext.CurrentPageKey?e.model.get("IsModerated")?(window.joinRequestedCommunityIdsModerated||(window.joinRequestedCommunityIdsModerated=[]),window.joinRequestedCommunityIdsModerated.push(e.model.get("GroupId"))):(window.joinRequestedCommunityIdsPublic||(window.joinRequestedCommunityIdsPublic=[]),window.joinRequestedCommunityIdsPublic.push(e.model.get("GroupId"))):"community"===beezyContext.CurrentPageKey&&(e.model.get("IsModerated")?(window.joinRequestedCommunityIdsModerated||(window.joinRequestedCommunityIdsModerated=[]),window.joinRequestedCommunityIdsModerated.push(e.model.get("GroupId"))):"community"===beezyContext.CurrentPageKey?p.default.publish("groupHeader","join"):window.location.reload())}),2500)}),(function(){}))},rerender:function(){this.$el.html(this.template({isModerated:this.model.get("IsModerated")}))},render:function(){var t=this.model.toJSON();return t.IsCurrentUserMember||!m.default.isPublicAndNotOpen(t)&&!m.default.isModerated(t)?this.$el.html(""):(this.requestSent&&(this.template=h.a),this.model.get("IsModerated")?window.joinRequestedCommunityIdsModerated&&r.a.indexOf(window.joinRequestedCommunityIdsModerated,this.model.get("GroupId"))>-1&&(this.template=h.a):window.joinRequestedCommunityIdsPublic&&r.a.indexOf(window.joinRequestedCommunityIdsPublic,this.model.get("GroupId"))>-1&&(this.template=h.a),this.$el.html(this.template({isModerated:this.model.get("IsModerated")}))),this},isJoined:function(){return this.model.get("IsModerated")?this.model.get("IsCurrentUserMember"):this.$el.text().trim()===Object(l.translate)("Joined")}});b.position={TOP:"top-left",RIGHT:"top-right",LEFT:"bottom-right",BOTTOM:"bottom-left"},e.default=b},1882:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(2),s=n.default.extend({contentIcon:"activity-type--blog",messageLinkBroken:Object(o.translate)("LinkBrokenBlog"),initialize:function(t){s.__super__.initialize.call(this,t),this.configTools()},isLinkBroken:function(){return null===this.model.get("RelatedItem")}});e.default=s},1883:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(2),s=n.default.extend({contentIcon:"activity-type--event",messageLinkBroken:Object(o.translate)("LinkBrokenEvent"),initialize:function(t){s.__super__.initialize.call(this,t),this.configTools({calendar:!0})},isLinkBroken:function(){return null===this.model.get("RelatedItem")}});e.default=s},1884:function(t,e,i){"use strict";i.r(e);var n=i(150).default.extend({contentIcon:"activity-type--discussion",initialize:function(t){t.tools={comment:!1},n.__super__.initialize.call(this,t)}});e.default=n},1885:function(t,e,i){"use strict";i.r(e);var n=i(150).default.extend({contentIcon:"activity-type--file",initialize:function(t){n.__super__.initialize.call(this,t)}});e.default=n},1886:function(t,e,i){"use strict";i.r(e);var n=i(150).default.extend({contentIcon:"activity-type--sp-item",initialize:function(t){n.__super__.initialize.call(this,t)}});e.default=n},1887:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(150),l=i(1217),c=i(2394),u=i.n(c),d=i(12),h=a.default.extend({template:u.a,events:r.a.extend({},a.default.prototype.events,{"click .js-tagfilter":"filterTag"}),initialize:function(t){h.__super__.initialize.call(this,t),this.configTools({edit:!1,editTags:!0}),this.toolsEvents=r.a.extend(this.toolsEvents,{editTags:"editTags"}),this.listenTo(this.model,"change:Terms",this.renderTerms),d.default.subscribe("tagcloud","filter",this.filterTag,this)},editTags:function(){var t=this,e=new l.default({onSaveTermsDialog:function(e){return t.setTags(e)},groupId:this.getGroup(this.model).GroupId});e.ready().then((function(){e.getView().setTerms(t.model.get("Terms")),e.show()}))},setTags:function(t){var e=this;this.model.save({Terms:t.toJSON()},{success:function(t){var i=t.has("Terms")?t.get("Terms"):[];e.updateNumberTags(i)},error:function(t){console.info(t)},wait:!0})},renderTerms:function(){this.$(".js-metadata-list").html(this.template(this.model.attributes))},filterTag:function(t){var e,i=o()(t.currentTarget).attr("data-id");e=i?r.a.findWhere(this.model.get("Terms"),{Name:i}):t,this.trigger("filterTag",e)},updateNumberTags:function(t){this.$el.find(".js-tag-count").html(t.length)}});e.default=h},1888:function(t,e,i){"use strict";i.r(e);var n=i(150).default.extend({initialize:function(t){n.__super__.initialize.call(this,t),this.configTools({comment:!1,like:!1,remove:!1,share:!1,timeago:!1})}});e.default=n},1889:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(150),r=i(293),a=s.default.extend({contentIcon:"activity-type--poll",dom:{votes:".js-votes-count",votesText:".js-vote-icon"},extendEventsPoll:function(t){var e={"click [data-region=poll-button]":t};return o.a.extend(this.events,e)},initialize:function(t){a.__super__.initialize.call(this,t)},render:function(){return this.initializePolls(),this.configTools({comment:!1,poll:!0}),this.addTmplAttribute("pollButtonText",this.texts[this.displayedView]),a.__super__.render.call(this),this.inDashboard||this.renderOptions(),this}});o.a.extend(a.prototype,r.default),e.default=a},189:function(t,e,i){"use strict";var n=i(219);i.d(e,"getFormattedDate",(function(){return n.getFormattedDate})),i.d(e,"getLocalDateFromJSON",(function(){return n.getLocalDateFromJSON})),i.d(e,"parseDotNetDate",(function(){return n.parseDotNetDate}));var o=i(2182);i.d(e,"getCalendarDateWithFormat",(function(){return o.default}));var s=i(2187);i.d(e,"getDateWithFormat",(function(){return s.default}));i(2188),i(2189);var r=i(2190);i.d(e,"getISODateStringFromJSON",(function(){return r.default}));var a=i(2191);i.d(e,"getOffset",(function(){return a.default}));var l=i(2195);i.d(e,"setOffsetUTC",(function(){return l.default}));var c=i(1039);i.d(e,"setUTCDate",(function(){return c.default}));var u=i(2196);i.d(e,"getUTCDate",(function(){return u.default}));var d=i(2197);i.d(e,"getDateFromUTC",(function(){return d.default}));var h=i(2198);i.d(e,"getUserTimeZone",(function(){return h.default}));i(2199)},1890:function(t,e,i){"use strict";i.r(e);var n=i(150).default.extend({initialize:function(t){n.__super__.initialize.call(this,t),(this.model.isDiscussion()||this.model.isDocument())&&(this.context.action=this.context.Message)}});e.default=n},1891:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(2),l=i(150),c=i(195),u=i(17),d=i(95),h=i(2395),f=i.n(h),p=i(78),m=i(37);var g=l.default.extend({contentIcon:"activity-type--praise",events:r.a.extend({},l.default.prototype.events,{"click .js-profile":"onClickProfile"}),initialize:function(t){g.__super__.initialize.call(this,t)},getData:function(t){this.badge=u.default.getBadge(t.getMetadata("SeletedBadge")),this.praised=JSON.parse(r.a.find(t.get("MetadataProperties"),(function(t){return"Users"===t.Name})).Value)},render:function(){var t,e;return g.__super__.render.call(this),this.getData(this.model),this.$(".js-content-main").first().prepend((t=r.a.extend(this.praised,{styleIcon:(e=this.badge&&this.badge.IconUrl,e?'background: url("'.concat(c.default.getAbsoluteURL(e),'")'):"background: none"),badgeTitle:this.badge?Object(a.translate)(this.badge.Title):""}),o()('<div class="praise-container" />').html(f()(t)))),this.badge&&new m.default({el:this.$(".js-content-icon"),text:Object(a.translate)(this.badge.Title)}),this.addQuickProfiles(),this},onClickProfile:function(t){if(t.preventDefault(),!this.model.get("Owner").IsReadOnly){var e=o()(t.currentTarget).attr("href");p.default.showUserProfilePage(e)}},addQuickProfiles:function(){var t=this.praised;this.$(".js-profile").each((function(e){var i=o()(this),n=u.default.saveUser(t[e]);d.default.create(i,i,i.parent().find(".js-activity-header-quickprofile"),n,{})}))}});e.default=g},1892:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(7),s=i(2),r=n.default.extend({contentIcon:"activity-type--question",messageLinkBroken:Object(s.translate)("LinkBrokenQuestion"),isLinkBroken:function(){return null===this.model.get("RelatedItem")&&null!==this.model.get("Version")},isOldVersion:function(){return null===this.model.get("RelatedItem")&&null===this.model.get("Version")&&this.model.get("Type")===o.default.Type.QUESTION}});e.default=r},1893:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(2),s=n.default.extend({contentIcon:"activity-type--task",messageLinkBroken:Object(o.translate)("LinkBrokenTask"),initialize:function(t){s.__super__.initialize.call(this,t),this.configTools()},isLinkBroken:function(){return null===this.model.get("RelatedItem")}});e.default=s},1894:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(2),s=n.default.extend({contentIcon:"activity-type--wiki",messageLinkBroken:Object(o.translate)("LinkBrokenWiki"),initialize:function(t){s.__super__.initialize.call(this,t),this.configTools()},isLinkBroken:function(){return null===this.model.get("RelatedItem")}});e.default=s},1895:function(t,e,i){"use strict";i.r(e);var n=i(7),o=i(1274).default.extend({contentIcon:"activity-type--extendedidea",isOldVersion:function(){return null===this.model.get("RelatedItem")&&null===this.model.get("Version")&&this.model.get("Type")===n.default.Type.EXTENDEDIDEA},initialize:function(t){o.__super__.initialize.call(this,t);var e=this.model.get("RelatedItem");e.Url="".concat(this.model.get("Group").Url,"/SitePages/Idea Detail.aspx?ActivityId=").concat(this.model.get("Id")),this.model.set("RelatedItem",e)}});e.default=o},1896:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(63),s=n.default.extend({initialize:function(t){var e=new o.default;s.__super__.initialize.call(this,t),this.configTools({comment:e.allowComments(),like:e.allowLikes(),bookmark:!1,highlight:!1,remove:!1})}});e.default=s},1897:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(63),s=n.default.extend({initialize:function(t){var e=new o.default;s.__super__.initialize.call(this,t),e.getActivity()&&this.configTools({comment:e.allowComments(),like:e.allowLikes(),bookmark:!1,highlight:!1,remove:!1,edit:!!t.currentUserCanEdit,share:e.isPublished()})}});e.default=s},1898:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(1154),s=i(7),r=n.default.extend({dom:{activitySnippet:".js-activity-snippet"},initialize:function(t){r.__super__.initialize.call(this,t);var e=this.model.get("SharedActivity"),i=this.model.get("SharedApp");if(e){var n=o.default.getViewByType(e.Type);this.ActivitySnippet=new n({SharedActivity:e,IsCard:this.isCard})}else if(i){var a=o.default.getViewByType(s.default.Type.SHARE_APP);this.ActivitySnippet=new a({SharedApp:i})}else{var l=o.default.getViewByType(s.default.Type.DELETED);this.ActivitySnippet=new l({SharedActivity:null,IsCard:this.isCard}),this.model.get("Type")===s.default.Type.SHARE_APP&&(l=o.default.getViewByType(s.default.Type.DELETED_APP),this.ActivitySnippet=new l)}},render:function(){return r.__super__.render.call(this),this.ActivitySnippet.$el.insertBefore(this.$el.find(this.dom.activitySnippet)),this.ActivitySnippet.render(),this}});e.default=r},1899:function(t,e,i){"use strict";i.r(e);var n=i(1900),o=i(1901),s=i(1902),r=i(1903),a=i(1904),l=i(416),c=i(1905),u=i(1906),d=i(1907),h={};h.Praise=n.default,h.Story=o.default,h.CorporatePage=s.default,h.Document=r.default,h.Item=a.default,h.Activity=l.default,h.Deleted=c.default,h.DeletedApp=u.default,h.ShareApp=d.default,e.default=h},1900:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(416),r=i(2397),a=i.n(r),l=i(17),c=s.default.extend({name:"praiseSnippet",template:a.a,initialize:function(){c.__super__.initialize.apply(this,arguments),this.context.SharedActivity=o.a.extend(this.context.SharedActivity,{Badge:l.default.getBadge(o.a.find(this.context.SharedActivity.MetadataProperties,(function(t){return"SeletedBadge"===t.Name})).Value),PraisedUsers:JSON.parse(o.a.find(this.context.SharedActivity.MetadataProperties,(function(t){return"Users"===t.Name})).Value)})}});e.default=c},1901:function(t,e,i){"use strict";i.r(e);var n=i(38),o=i(17),s=i(5),r=i(416),a=i(1574),l=i.n(a),c=function(){return i.e(185).then(i.bind(null,819))},u=function(){return i.e(185).then(i.bind(null,926))},d=r.default.extend({name:"storySnippet",template:l.a,events:{"click .js-snippet-play-button":"openVideoPlayer"},initialize:function(t){this.options=t||{},d.__super__.initialize.call(this,t),this.context.OwnerSnippet=t.SharedActivity&&t.SharedActivity.Authors.find((function(t){return t.IsPublic})),this.context.url=o.default.getShareFullUrl(t.SharedActivity,!0)},openVideoPlayer:function(t){t.preventDefault();var e=document.getElementById("video-player-wrapper");this.showVideoPlayer=!0;var i=this.closeVideoPlayer.bind(this);this.options.IsCard?n.default.renderComponent(e,u,{videoUrl:this.options&&this.options.SharedActivity&&this.options.SharedActivity.VideoUrl,detailUrl:this.options&&this.options.SharedActivity&&this.options.SharedActivity.RelatedItem&&"".concat(s.default.getBaseSiteHost()).concat(this.options.SharedActivity.RelatedItem.Url),title:this.options&&this.options.SharedActivity&&this.options.SharedActivity.Title,showVideoPlayer:this.showVideoPlayer,onClose:i},!0,!0):n.default.renderComponent(e,c,{videoUrl:this.options&&this.options.SharedActivity&&this.options.SharedActivity.VideoUrl,show:this.showVideoPlayer,onClose:i},!0,!0),document.querySelector(".ui-dialog").classList.add("is-hidden"),document.querySelector(".ui-widget-overlay").classList.add("is-hidden")},closeVideoPlayer:function(){var t=document.getElementById("video-player-wrapper");this.showVideoPlayer=!1,n.default.unMountComponent(t),document.querySelector(".ui-dialog").classList.remove("is-hidden"),document.querySelector(".ui-widget-overlay").classList.remove("is-hidden")}});e.default=d},1902:function(t,e,i){"use strict";i.r(e);var n=i(416),o=i(1574),s=i.n(o),r=i(17),a=n.default.extend({name:"corporatePageSnippet",template:s.a,initialize:function(t){a.__super__.initialize.call(this,t),this.context.OwnerSnippet=t.SharedActivity&&t.SharedActivity.Authors&&!!t.SharedActivity.Authors.filter((function(t){return t.IsPublic})).length&&t.SharedActivity.Authors.filter((function(t){return t.IsPublic})).sort((function(t,e){return t.FullName.localeCompare(e.FullName)})).shift(),this.context.url=r.default.getShareFullUrl(this.SharedActivity,!0)},redirectToActivity:function(){}});e.default=a},1903:function(t,e,i){"use strict";i.r(e);var n=i(416),o=i(2398),s=i.n(o),r=n.default.extend({name:"documentSnippet",template:s.a});e.default=r},1904:function(t,e,i){"use strict";i.r(e);var n=i(416),o=i(2399),s=i.n(o),r=n.default.extend({name:"itemSnippet",template:s.a});e.default=r},1905:function(t,e,i){"use strict";i.r(e);var n=i(416),o=i(1575),s=i.n(o),r=i(2),a=i(7),l=n.default.extend({name:"deletedSnippet",template:s.a,events:{},initialize:function(t){this.context.IsCard=t.IsCard||!1,this.context.Text=Object(r.translate)("This shared content has been deleted"),this.context.Type=a.default.Type.DELETED}});e.default=l},1906:function(t,e,i){"use strict";i.r(e);var n=i(416),o=i(1575),s=i.n(o),r=i(2),a=i(7),l=n.default.extend({name:"deletedSharedAppSnippet",template:s.a,events:{},initialize:function(){this.context.Text=Object(r.translate)("This shared content has been deleted"),this.context.Type=a.default.Type.DELETED}});e.default=l},1907:function(t,e,i){"use strict";i.r(e);var n=i(49),o=i(38),s=i(416),r=i(2400),a=i.n(r),l=i(426),c=i(5),u=i(18),d=s.default.extend({name:"sharedAppSnippet",dom:{title:".js-snippet-title",description:".js-snippet-description",image:".js-snippet-image"},template:a.a,initialize:function(t){var e=t.SharedApp,i=e.Id,n=e.Title,o=e.Icon,s=e.Categories;this.SharedApp=t.SharedApp,this.context.Id=i,this.context.Title=n,this.context.Categories=s.map((function(t){return t})).join(", "),this.context.Icon=o},render:function(){this.$el.html(this.template(this.context));var t=this.$el.find(this.dom.image);return o.default.renderComponent(t,l.default,{id:this.context.Id,url:this.context.Icon,extraClasses:{container:"snippet__activity-apps-image",image:"snippet__activity-apps-image"}}),n.default.ellipsis(this.$el.find(this.dom.title),1),n.default.ellipsis(this.$el.find(this.dom.description),1),this},redirectToActivity:function(){var t="".concat(c.default.getBaseSiteCollection(),"/SitePages/Apps/Detail.aspx?appId=").concat(this.SharedApp.Id);u.default.redirectToUrl(t)}});e.default=d},1908:function(t,e,i){"use strict";i.r(e);var n=i(150),o=i(38),s=i(49),r=function(){return i.e(4).then(i.bind(null,3074))},a=n.default.extend({initialize:function(t){a.__super__.initialize.call(this,t),this.configTools({edit:!1,share:!1,highlight:!1})},render:function(){return n.default.__super__.render.call(this),this.$el.addClass(this.isCard?"o-card__list__item grid__item js-card":"wall-list__item"),this},checkShowMore:function(){try{var t=this.getJsonAdaptiveCard();o.default.renderComponent(this.$(".js-content-main"),r,{adaptiveCardTemplate:t,submittedOutcome:this.model.getMetadata("TaskOutcome"),idCard:this.model.id},!1,!0)}catch(t){console.info("[ERROR] Render adaptive card - Review the json for the adaptive card, it could not be well formed")}},getJsonAdaptiveCard:function(){var t=this.model.get("MetadataProperties").filter((function(t){return"AdaptiveTemplate"===t.Name}))[0].Value;return t=s.default.cleanNewLinesInJson(t),JSON.parse(t)},parseMessage:function(){}});e.default=a},1911:function(t,e,i){"use strict";i.r(e);var n=i(26),o=i(8),s=n.default.extend({url:function(){return"".concat(o.default.getGroupServiceV2Url(),"/Attendees")}});e.default=s},1912:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(7),r=i(311),a=i(2405),l=i.n(a),c={},u=".js-header-logo",d=".js-toggle-more",h=".js-more-text",f=function(t,e,i,n,a,l,c){for(var f=t.find(".js-toggle-more"),p=o()(u).outerWidth(!0)||0,m=t.find(".js-header-menu-item").not(l),g=f.outerWidth(!0),v=i,b="mysite"===beezyContext.CurrentPageKey||"community"===beezyContext.CurrentPageKey?760:0,y=window.matchMedia("(min-width: ".concat(b+1,"px)")).matches&&o()(".".concat(n)).outerWidth(!0)||80;e+p+y+g+m.last().outerWidth(!0)>v;){var C=m.not(".".concat(a)).last(),w="",T=m.last().hasClass(a);if(null===C.outerWidth(!0))break;e-=C.outerWidth(!0),C.attr("class")&&C.attr("class").split(" ").forEach((function(t){0===t.lastIndexOf("js-",0)&&(w+=" ".concat(t))})),C.removeClass().addClass(w).prependTo(l),m.splice(T?-2:-1,1)}return function(t,e,i){var n=t.find(d),o=t.find(e),a=t.find(h),l=!1,c=new r.default({animated:!0,verticalPosition:s.default.DropVerticalPosition.BOTTOM,position:s.default.DropPosition.CENTER,parent:n,hideOnBlur:function(){l=!1,a.attr("aria-pressed",l)},shouldFlipVertical:!1});return c.on("click",(function(){return c.shown&&c.hide()})),t.find(h).on("click",(function(t){t.stopPropagation(),c.inject(o),c.toggle(),l=!l,a.attr("aria-pressed",l)})),i&&c.on("render",(function(){i()})),o}(t,l,c)},p=function(t,e,i,n,s,r){var a=t.find(s);if(e>t.width()-o()(".".concat(i)).width()){var c=t.parent().width();1===a.length?(a.html(""),a=f(t,e,c,i,n,s,r)):(function(t){var e=l.a;t.append(e)}(t),a=f(t,e,c,i,n,s,r),function(t){t.find(".js-toggle-more").on("click",(function(){t.find(".js-moreoption-container").hasClass("is-open")?t.find(".js-moreoption-container").removeClass("is-open"):t.find(".js-moreoption-container").addClass("is-open")}))}(t))}return a};c.moreOptions=function(t,e){this.options=e||{},this.options.buttonsLayout=e.buttonsLayout||"js-menu-buttons",this.options.selectedCss=e.selectedCss||"selected",this.options.classMore=e.classMore||".js-more";var i=t.find(".js-header-menu-item"),n=0;return i.each((function(){n+=o()(this).outerWidth(!0)})),p(t,n,this.options.buttonsLayout,this.options.selectedCss,this.options.classMore,this.options.bindEvent)},e.default=c},1919:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(89),r=i(13),a=i(2445),l=i.n(a),c=i(2446),u=i.n(c),d=i(2447),h=i.n(d),f=r.default.extend({template:l.a,itemTemplate:u.a,searchTemplate:h.a,tagName:"li",events:{"click .js-toggle-navigation-list":"onToggle","click .js-more":"showMore"},initialize:function(t){this.options=t||{},this.collection=this.options.collection,this.container=this.options.container,this.title=this.options.title,this.searchText=this.options.searchText,this.searchAdapter=this.options.searchAdapter,this.valueSelector=this.options.valueSelector,this.collapsed=this.options.collapsed,this.icon=this.options.icon,this.fetchOnStart=this.options.fetchOnStart,this.fetched=!1,this.hasSearch=this.options.hasSearch},render:function(){return this.context={title:this.title,collapsed:this.collapsed,icon:this.icon,hasSearch:this.hasSearch},this.$el.html(this.template(this.context)),this.fetchOnStart&&this.renderItems(),this.setupSearch(),this},renderItems:function(){var t=this;this.promise=this.fetch(),this.fetched=!0,this.promise.done((function(e){e.length>0?(t.context.items=e,o.a.each(e,(function(e){t.renderItem(e)})),e.length>7&&(t.$(".js-navigation-item:gt(7)").hide(),t.$(".js-more").show())):(t.$(".js-search-container").hide(),t.$(".js-nodata").show()),t.fetchOnStart||t.toggleList()}))},renderItem:function(t){this.$(".js-navigation-list-container").append(this.itemTemplate(t))},getPromise:function(){return this.promise},onToggle:function(){this.fetchOnStart||this.fetched?this.toggleList():this.renderItems()},showMore:function(t){t.preventDefault(),this.$(".js-navigation-item").show(),this.$(".js-more").hide()},toggleList:function(){var t=this.$(".js-toggle-navigation-list > .icon"),e=this.$(".js-navigation-list"),i=this.$(".js-toggle-navigation-list");t.hasClass("is-collapsed")?(e.slideDown(),t.removeClass("is-collapsed"),i.attr("aria-expanded",!0)):(e.slideUp(),t.addClass("is-collapsed"),i.attr("aria-expanded",!1))},setupSearch:function(){var t=new s.default({el:this.$(".js-navigation-search"),template:this.searchTemplate,inputTitle:this.searchText,placeholderText:this.searchText,classes:{input:"left-menu__search__input",container:"autocomplete bz-webpart",list:"",item:"autocomplete__item"},zIndex:10,searchAdapter:this.searchAdapter,valueSelector:this.valueSelector||"Title",insideSidebar:!0,role:"searchbox"});t.on("selectitem",(function(e,i){t.input.val(e),document.location.href=i.Url}))},fetch:function(){return this.collection.fetch().done((function(t){return t}))}});e.default=f},1920:function(t,e,i){"use strict";i.r(e);var n=i(421),o=i(5),s=i(15),r=i(8),a=i(30),l=i(4),c=i.n(l),u=i(3),d=i.n(u),h=i(19),f=i.n(h),p=i(2),m=i(13),g=i(1132),v=i(1133),b=i(1134),y=i(1921),C=i(1919),w=i(2448),T=i.n(w),x=i(12),O=i(33),S=i(712),I=i(768),A=m.default.extend({template:T.a,communityCollection:new n.CommunitiesSidebar,blogsCollection:new g.BlogsSidebar,forumsCollection:new v.ForumsSidebar,wikisCollection:new b.WikisSidebar,sitesCollection:new y.default,render:function(){var t=this;return this.openned=!1,this.navigationLists=[],this.context={FullName:s.default.getFullName(),Id:s.default.getCurrentUserId(),PictureUrl:s.default.getPictureUrl(),LastUpdated:s.default.getLastUpdated(),BackgroundPictureUrl:s.default.getBackgroundPictureUrl(),IsReadOnly:s.default.isReadOnly(),ReadOnlySubtitle:Object(p.sprintf)(Object(p.translate)("Switch to personal %s account"),r.default.getAplicationTitle()),ReadOnlyImgUrl:"".concat(o.default.getImagesPath(),"/read-only-user-img.svg")},this.globalMenuContainer=document.querySelector(".js-global-menu-container"),t.$el.html(t.template(t.context)),this.addNavigationList({title:"Communities",searchText:Object(p.translate)("Search your communities"),searchAdapter:O.default.searchAdapter("Communities/Navigation",1e3,"title"),collection:this.communityCollection,icon:"icon--community-stroke-menu",fetchOnStart:!0,hasSearch:!0}),this.addNavigationList({title:"Sites",searchText:"Search site",searchAdapter:O.default.searchAdapter("CorporateSites/Navigation",1e3,"title"),collection:this.sitesCollection,collapsed:!0}),o.default.isEnableStandaloneForum()&&this.addNavigationList({title:"Forums",searchText:Object(p.translate)("Search forum"),searchAdapter:O.default.searchAdapter("Forums/Navigation",1e3,"title"),collection:this.forumsCollection,collapsed:!0}),o.default.isEnableStandaloneBlog()&&this.addNavigationList({title:"Blogs",searchText:Object(p.translate)("Search blog"),searchAdapter:O.default.searchAdapter("Blogs/Navigation",1e3,"title"),collection:this.blogsCollection,collapsed:!0}),o.default.isEnableStandaloneWiki()&&this.addNavigationList({title:"Wikis",searchText:Object(p.translate)("Search wiki"),searchAdapter:O.default.searchAdapter("Wikis/Navigation",1e3,"title"),collection:this.wikisCollection,collapsed:!0}),this.ondocumentclick=d.a.bind(this.ondocumentclick,this),this.onkeydown=d.a.bind(this.onkeydown,this),this.effect=d.a.bind(this.effect,this),this.hideSideBar=d.a.bind(this.hideSideBar,this),this.fetch().done((function(e){t.bindEvents(),c()(".js-global-menu-container").show(),x.default.publish("sidebar","communitiesLoaded",e[1])})),this},bindEvents:function(){var t=this;c()(".js-effect-open").on("click",this.effect),c()(".js-effect-close").on("click",this.hideSideBar),x.default.subscribe("sidebar","Hide",(function(e){t.hideSideBar(e)}))},hideSideBar:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.openned&&(this.toggleSideBar(!this.openned),t&&(c()(".js-effect-open").attr("aria-pressed",!1),c()(".js-drawer-menu").trigger("focus")))},ondocumentclick:function(t){t.srcElement&&!c()(t.srcElement).hasClass("js-global-menu-container")&&0===c()(t.srcElement).parents(".js-global-menu-container").size()&&c()(".js-effect-close").trigger("click")},onkeydown:function(t){Object(S.isEscKey)(t)&&this.hideSideBar()},effect:function(t){x.default.publish("drop","HideAllDrops"),t.stopPropagation(),t.preventDefault(),c()(".js-effect-open").attr("aria-pressed",!0),this.toggleSideBar(!this.openned)},toggleSideBar:function(t){var e=c()(".global-menu-container"),i=Object(a.sharePointItems)().innerElement,n=c()("#s4mp-mainarea"),o=c()(".js-groupheader"),s=c()(".js-mp-header"),r=c()(".hamburger-menu");e.className="global-menu-container",t?(x.default.publish("megamenu","Hide"),e.addClass("is-open"),i.addClass("is-open"),n.addClass("is-open"),o.addClass("is-open"),s.addClass("is-open"),r.addClass("is-open"),this.openned=!0,c()(document).on("click",this.ondocumentclick),c()(document).on("keydown",this.onkeydown),Object(I.createFocusTrap)({element:this.globalMenuContainer,elementToFocus:".js-effect-close",active:Boolean(window.matchMedia("(max-width: 760px)").matches)})):(e.removeClass("is-open"),i.removeClass("is-open"),n.removeClass("is-open"),o.removeClass("is-open"),s.removeClass("is-open"),r.removeClass("is-open"),this.openned=!1,c()(document).off("click",this.ondocumentclick),c()(document).off("keydown",this.onkeydown))},addNavigationList:function(t){this.navigationLists.push(new C.default(t))},fetch:function(){var t=this,e=f.a.defer(),i=[];return i.push(d.a.each(this.navigationLists,(function(e){var i=e.render();return t.$(".js-navigation-lists-container").append(i.$el),i.getPromise()}))),f.a.allSettled(i).then((function(t){e.resolve(t)})),e.promise}});e.default=A},1921:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(27),r=i.n(s),a=i(5),l=r.a.Collection.extend({url:function(){return"".concat(a.default.getApiUrlv2(),"/CorporateSites/Navigation")},initialize:function(t,e){this.options=o.a.defaults(e||{},{skip:0,take:100})},fetch:function(t){return(t=t||{}).data=o.a.extend({skip:this.options.skip,take:this.options.take},t.data),l.__super__.fetch.call(this,t)}});e.default=l},1924:function(t,e,i){"use strict";i.r(e),e.default={truncateNumber:function(t){var e=t;if(t>=1e3){for(var i=Math.floor(t.toString().length/3),n="",o=2;o>=1;o--){if((n=parseFloat((0!==i?t/Math.pow(1e3,i):t).toPrecision(o))).toString().replace(/[^a-zA-Z 0-9]+/g,"").length<=2)break}n%1!=0&&(n=n.toFixed(1)),e=n+["","K","M","B","T"][i]}return e}}},1925:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(13),l=i(276),c=i(10),u=i(2),d=i(384),h=i(17),f=i(2452),p=i.n(f),m=i(2453),g=i.n(m),v=i(2454),b=i.n(v),y=i(173),C=i(311),w=i(244),T=i(386),x=i(398),O=i(12),S=i(8),I=i(78),A=i(162),k=i(7),P=i(15),E=a.default.extend({texts:{follow:Object(u.translate)("Follow"),unfollow:Object(u.translate)("Unfollow"),subscribe:Object(u.translate)("Subscribe"),unsubscribe:Object(u.translate)("Unsubscribe"),tooltipUnfollow:Object(u.translate)("You cannot unfollow, this is an audience-based community"),tooltipLeave:Object(u.translate)("You cannot leave, this is an audience-based community")},events:{"click .js-invite":"invite","click .js-recommend":"recommend","click .js-toggle-join":"toggleJoin","click .js-toggle-follow":"toggleFollow","click .js-profile-image":"showProfile"},dom:{menu:".js-horiz-menu",preload:"#js-groupheader-preload"},initialize:function(t){var e=this;this.template=this.getTemplate(),this.model=t.model||new T.default(r.a.extend({isGroupAttendee:S.default.isGroupMember(),isGroupFollower:beezyCurrentGroup&&beezyCurrentGroup.IsCurrentUserFollower,isCurrentUserSubscribedToEmailDigest:null!==beezyCurrentGroup&&beezyCurrentGroup.IsCurrentUserSubscribedToEmailDigest,isGroupOwner:S.default.isGroupOwner()},beezyCurrentGroup)),E.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"change:IsCurrentUserMember",this.renderJoinLeave),this.listenTo(this.model,"change:isGroupFollower",this.renderFollowUnfollow),this.listenTo(this.model,"change:isCurrentUserSubscribedToEmailDigest",this.renderSubscribeUnsubscribe),this.inviteDialog=l.default.GroupInvite,this.recommendDialog=l.default.Recommend,this.exportMembers=r.a.bind(this.exportMembers,this),this.toggleDropDown=r.a.bind(this.toggleDropDown,this),this.ariaExpanded=!1,O.default.subscribe("groupHeader","join",(function(){e.model.clearCache(),window.location.reload()})),this.model.on("change:isGroupFollower",(function(){e.render()})),this.model.on("change:IsCurrentUserMember",(function(){e.render()})),this.model.on("change:isCurrentUserSubscribedToEmailDigest",(function(){e.render()}))},render:function(){o()(this.dom.preload).length&&o()(this.dom.preload).remove(),Object(u.translateStaticLiterals)(".js-translate"),Object.assign(this.texts,this.getTexts());var t=r.a.extend(this.model.toJSON(),{texts:r.a.extend(this.texts,{leave:this.texts.textLeave,modalLeave:this.model.get("IsModerated")?this.texts.moderatedTextModalLeave:this.model.get("IsPublic")?"":this.texts.restrictedTextModalLeave}),settingsUrl:h.default.getSettingsFullUrl(),settingsTitle:this.texts.settingsTitle});return this.context=r.a.extend(t,this.context||{}),this.context.BannerUrlWithLastUpdated="".concat(this.context.BannerUrl,"?lastUpdated=").concat(this.context.Updated),E.__super__.render.call(this),h.default.multilineEllipsis(this.$(".js-description"),1),this.createDropDialog(this.model),this.renderJoinLeave(this.model,this.model.get("IsCurrentUserMember")),this.renderFollowUnfollow(this.model,this.model.get("isGroupFollower")),this.renderSubscribeUnsubscribe(this.model,this.model.get("isCurrentUserSubscribedToEmailDigest")),this.renderHorizontalMenu(),y.default.applyColors(this.$el,this.context.Color),h.default.checkQuota(),this},getTemplate:function(){return"community"===beezyContext.CurrentPageKey?g.a:S.default.isStandAloneGroup()?b.a:p.a},getTexts:function(){switch(this.model.get("Type")){case k.default.Type.STANDALONE_BLOG:return{textLeave:Object(u.translate)("Leave this blog"),moderatedTextModalLeave:Object(u.translate)("This is a moderated blog so you will not be able to contribute to it once you leave. Are you sure you want to leave this community?"),restrictedTextModalLeave:Object(u.translate)("This is a restricted blog so you will not be able to access its content once you leave. Are you sure you want to leave this community?"),join:Object(u.translate)("Join blog"),settingsTitle:Object(u.translate)("Standalone blog settings")};case k.default.Type.STANDALONE_FORUM:return{textLeave:Object(u.translate)("Leave this forum"),moderatedTextModalLeave:Object(u.translate)("This is a moderated forum so you will not be able to contribute to it once you leave. Are you sure you want to leave this community?"),restrictedTextModalLeave:Object(u.translate)("This is a restricted forum so you will not be able to access its content once you leave. Are you sure you want to leave this community?"),join:Object(u.translate)("Join forum"),settingsTitle:Object(u.translate)("Standalone forum settings")};case k.default.Type.STANDALONE_WIKI:return{textLeave:Object(u.translate)("Leave this wiki"),moderatedTextModalLeave:Object(u.translate)("This is a moderated wiki so you will not be able to contribute to it once you leave. Are you sure you want to leave this community?"),restrictedTextModalLeave:Object(u.translate)("This is a restricted wiki so you will not be able to access its content once you leave. Are you sure you want to leave this community?"),join:Object(u.translate)("Join wiki"),settingsTitle:Object(u.translate)("Standalone wiki settings")};default:return{textLeave:Object(u.translate)("Leave this community"),moderatedTextModalLeave:Object(u.translate)("This is a moderated community so you will not be able to contribute to it once you leave. Are you sure you want to leave this community?"),restrictedTextModalLeave:Object(u.translate)("This is a restricted community so you will not be able to access its content once you leave. Are you sure you want to leave this community?"),join:Object(u.translate)("Join community"),settingsTitle:Object(u.translate)("Community settings")}}},recommend:function(){if(P.default.isReadOnly())return h.default.showReadOnlyModal();this.recommendDialog(),this.trigger("showInviteDialog")},invite:function(){if(P.default.isReadOnly())return h.default.showReadOnlyModal();this.inviteDialog(),this.trigger("showInviteDialog")},toggleJoin:function(){var t,e=this;if(P.default.isReadOnly())return h.default.showReadOnlyModal();if(null===(t=this.context)||void 0===t||!t.IsCurrentUserMemberFromAudience){var i=this.model.get("IsCurrentUserMember"),n=this.model.get("IsModerated"),o=!this.model.get("IsPublic");if(i)if(!i||o||n){var s,r,a,l,c=Object(A.default)({title:"",text:(null===(s=this.options)||void 0===s||null===(r=s.texts)||void 0===r?void 0:r.modalLeave)||(null===(a=this.context)||void 0===a||null===(l=a.texts)||void 0===l?void 0:l.modalLeave),stayOpenOnConfirm:!0,confirmLiteral:Object(u.translate)("Leave")});c.getPromise().done((function(t){"confirm"===t?(e.model.set("IsCurrentUserMember",!1),e.model.leave(),c.close()):c.close()}))}else this.model.leave(),this.model.set("IsCurrentUserMember",!i);else this.model.join(),this.model.set("IsCurrentUserMember",!i)}},toggleFollow:function(){var t;if(P.default.isReadOnly())return h.default.showReadOnlyModal();if(null===(t=this.context)||void 0===t||!t.IsCurrentUserMemberFromAudience){var e=this.model.get("isGroupFollower");this.model[e?"unfollow":"follow"](),this.model.set("isGroupFollower",!e),e||this.model.get("isCurrentUserSubscribedToEmailDigest")||(this.model.subscribe(),this.model.set("isCurrentUserSubscribedToEmailDigest",!0)),e&&this.model.get("isCurrentUserSubscribedToEmailDigest")&&(this.model.unsubscribe(),this.model.set("isCurrentUserSubscribedToEmailDigest",!1))}},toggleMail:function(){if(P.default.isReadOnly())return h.default.showReadOnlyModal();var t=this.model.get("isCurrentUserSubscribedToEmailDigest");this.model[t?"unsubscribe":"subscribe"](),this.model.set("isCurrentUserSubscribedToEmailDigest",!t)},toggleDropDown:function(){this._popover.toggle()},renderHorizontalMenu:function(){this.horizontalMenu=new w.default({el:this.$(this.dom.menu),model:this.model.attributes.NavigationLinks}).render()},renderDropDown:function(t,e){this._popover&&!this._popover.node&&(t.set("showInviteInDropdown",S.default.isStandAloneGroup()||!this.model.get("IsCurrentUserMember")),this.DropDownListView=new d.default({context:t,texts:this.texts,settingsUrl:h.default.getSettingsFullUrl(),settingsTitle:this.texts.settingsTitle}),this._popover.inject(this.DropDownListView.render().el),this.DropDownListView.on("invite",this.invite),this.DropDownListView.on("toggleMail",this.toggleMail),this.DropDownListView.on("toggleDropDown",this.toggleDropDown),this.DropDownListView.on("toggleJoin",this.toggleJoin),this.DropDownListView.on("toggleExport",this.exportMembers)),e&&this._popover.hide()},renderJoinLeave:function(t,e){e?(this.$("input.js-toggle-join").hide(),this.$("li.js-toggle-join").show()):(this.$("input.js-toggle-join").show(),this.$("li.js-toggle-join").hide(),S.default.isModerated()?this.$("input.js-toggle-join").val(Object(u.translate)("Request membership")):this.$("input.js-toggle-join").val(Object(u.translate)("Join"))),this.renderDropDown(t)},renderFollowUnfollow:function(t,e){e?(this.$("input.js-toggle-follow").hide(),this.$("button.js-toggle-follow").show()):(this.$("input.js-toggle-follow").show(),this.$("button.js-toggle-follow").hide()),this.renderDropDown(t,!0)},renderSubscribeUnsubscribe:function(t){this.renderDropDown(t)},createDropDialog:function(t){var e="community-header-popover";this._popover=new C.default({verticalPosition:k.default.DropVerticalPosition.BOTTOM,position:k.default.DropPosition.LEFT,parent:this.$(".js-configuration-container"),role:"menu",hideOnBlur:this.onPopoverBlur.bind(this),id:e,shouldFlipVertical:!1}),this.$(".js-dropdown-group").on("click",r.a.bind(this.onClickButton,this)),this.$(".js-dropdown-group").attr("aria-controls",e),this.renderDropDown(t)},onPopoverBlur:function(){this.ariaExpanded=!1,this.$(".js-dropdown-group").attr("aria-expanded",this.ariaExpanded)},onClickButton:function(t){t.stopPropagation(),t.preventDefault(),this._popover.toggle(),this.ariaExpanded=!this.ariaExpanded,this.$(".js-dropdown-group").attr("aria-expanded",this.ariaExpanded)},showProfile:function(t){t.preventDefault(),t.stopPropagation(),I.default.showUserProfilePage(o()(t.currentTarget).data("url"))},exportMembers:function(){var t="".concat(S.default.getGroupServiceV2Url(),"/Attendees");c.default.getJSON(t,{take:1e4,skip:0}).then((function(t){var e=r.a.pluck(t,"User"),i=r.a.map(e,(function(t){return{FullName:Object.prototype.hasOwnProperty.call(t,"FullName")?t.FullName:"",Email:Object.prototype.hasOwnProperty.call(t,"Email")?t.Email:"",Department:Object.prototype.hasOwnProperty.call(t,"Department")?t.Department:""}})),n=JSON.stringify(i);x.default.JSON2CSV(n,"".concat(S.default.getCurrentGroupTitle()," Members"),!0)}),(function(){}))}});e.default=E},1926:function(t,e,i){"use strict";i.r(e);var n=i(30),o=i(2),s=i(4),r=i.n(s),a=i(3),l=i.n(a);e.default=function(){var t=r()('<button class="scroll-to-top" type="button"><span class="visually-hidden">'.concat(Object(o.translate)("Go to beginning of page"),"</span></button>")),e=Object(n.isSharepointModern)()?r()('[data-is-scrollable="true"]'):r()("#s4-workspace");r()("body").append(t),e.scroll(l.a.debounce((function(){e.scrollTop()>=500?t.fadeIn("fast"):t.fadeOut("fast")}),300)),t.click((function(){e.animate({scrollTop:0},"400")}))}},193:function(t,e,i){"use strict";var n=i(2051);i.d(e,"absoluteLayer",(function(){return n.default}));var o=i(2052);i.d(e,"buttonReset",(function(){return o.default}));var s=i(2053);i.d(e,"focusVisibleOutline",(function(){return s.default}));var r=i(2061);i.d(e,"textEllipsis",(function(){return r.default}));var a=i(2062);i.d(e,"visuallyHidden",(function(){return a.default}));var l=i(2063);i.d(e,"maxLines",(function(){return l.default}));var c=i(2064);i.d(e,"createColorVariables",(function(){return c.default}));var u=i(2065);i.d(e,"createColorAlias",(function(){return u.default}));var d=i(2066);i.d(e,"adjustColor",(function(){return d.default}))},1931:function(t,e,i){"use strict";var n=i(2171);i.d(e,"typePolicies",(function(){return n.default}));var o=i(2173);i.d(e,"possibleTypes",(function(){return o.default}))},1937:function(t,e,i){"use strict";e.default={"button--margin":"bz-button--margin--ZR9MQB"}},194:function(t,e,i){"use strict";var n=i(131),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=function(t){t=t||{},this.pendingPageView=[],this.pendingEvents=[],this.siteCollectionUrl=t.siteCollectionUrl};c.prototype={pageMap:{},eventMap:{},propMap:{},onReady:function(){this.flush()},load:function(){},flush:function(){l.a.each(this.pendingPageView,(function(t){this.trackPageView.apply(this,o()(t))}),this),l.a.each(this.pendingEvents,(function(t){this.trackPageEvent.apply(this,o()(t))}),this),this.pendingPageView=[],this.pendingEvents=[]},trackPageViewSync:function(t,e,i){var n=this.pageMap[t.split(":")[0]];n&&l.a.each(n,this.trackVar,this),e&&l.a.each(e,this.trackVar,this),this.addEvents(i),this.trackPage(t)},trackPageView:function(t,e,i){if(this.tracker)return this.trackPageView=this.trackPageViewSync,void this.trackPageView(t,e,i);this.pendingPageView.push([t,e,i])},trackPageEventSync:function(t,e){this.trackEvent(t,e)},trackPageEvent:function(t,e){if(this.tracker)return this.trackPageEvent=this.trackPageEventSync,void this.trackPageEvent(t,e);this.pendingEvents.push([t,e])},addEvents:function(t){if(t){l.a.isArray(t)||(t=[t]),t=l.a.map(t,(function(t){return this.eventMap[t]&&this.eventMap[t].name||t}),this);var e=this.tracker.events.split(",");this.tracker.events=e.concat(t).join()}},trackPage:function(){},trackEvent:function(){},trackVar:function(){},addScript:function(t){r.a.getScript(this.siteCollectionUrl+t).then(l.a.bind(this.onReady,this))}},e.default=c},1944:function(t,e,i){"use strict";e.default={"visually-hidden":"bz-visually-hidden--Z14z9yR","ribbon-open-app":"bz-ribbon-open-app--Z14z9yR","close-info":"bz-close-info--Z14z9yR",text:"bz-text--Z14z9yR","button--close":"bz-button--close--Z14z9yR","icon--close":"bz-icon--close--Z14z9yR","button--open":"bz-button--open--Z14z9yR"}},195:function(t,e,i){"use strict";var n=i(24),o=i.n(n),s=i(7),r=i(5);function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}window.loadingMySite=!1,e.default={getAbsoluteURL:function(t){return"string"!=typeof t||"http:"===t.split("/")[0]||"/"!==t[0]||function(t){var e=r.default.getSiteCollectionUrl(),i=r.default.getSiteHost(),n=e.toLowerCase().replace(i.toLowerCase(),"");return""!==n&&0===t.toLowerCase().indexOf(n)}(t)?t||"":r.default.getBaseSiteCollection()+t},checkImageExtension:function(t){return/\.(jpg|jpeg|gif|png|bmp)$/i.test(t)},getProfileImage:function(t,e){if(!t)return"";if(t.startsWith("http"))return t;var i=r.default.getDefaultImageThumbnail(r.default.getBaseSiteCollection()+t,!1);if(i=i.replace(/#/g,"%23"),e){var n=-1===i.indexOf("?")?"?":"&";return"".concat(i).concat(n,"lastUpdated=").concat(e)}return i},getImageGroupingClass:function(t){return"notifications__image-list--".concat(t.length>=4?"four":{1:"one",2:"two",3:"three",4:"four"}[t.length],"-profiles")},getImageDimensionsWithScale:function(t,e){var i=t.height,n=t.width,o=n/i,s=e.innerHeight(),r=e.innerWidth(),a=1,l=0,c=0;return o>=r/s?(a=s/i,l=Math.round(t.width*a),c=s):(a=r/n,l=r,c=Math.round(t.height*a)),{width:l,height:c}},calculateNewPositionImage:function(t,e,i,n,o,r){var a,l,c=s.default.imagesDimensions.article.header.width,u=s.default.imagesDimensions.article.header.height,d=0,h=0;(l=i*r/n)<o&&(l=o),(a=n*o/i)<r&&(a=r);var f=a-r;0!==f&&(d=-.5*f);var p=l-o;return 0!==p&&(h=-.5*p),{offsetContainerX:d,offsetContainerY:h}},configureImageWithDimensions:function(t,e){var i=this.calculateNewPositionImage(t.BackgroundImageOffsetX,t.BackgroundImageOffsetY,t.BackgroundImageHeight,t.BackgroundImageWidth,e.dimensions[0],e.dimensions[1]),n=i.offsetContainerX,o=i.offsetContainerY;return l(l({},t),{},{dimensionY:e.dimensions[0],dimensionX:e.dimensions[1],BackgroundImageOffsetY:o,BackgroundImageOffsetX:n,liClass:e.liClass,itemClass:e.itemClass})},hasCroppedKey:function(t,e){return t.ImageCroppingIds&&t.ImageCroppingIds.find((function(t){return t===e}))},applyOriginalOrCroppedImage:function(t,e){if(this.hasCroppedKey(t,e)){var i=t.BackgroundImageUrl.split(".").reverse()[0],n=t.BackgroundImageUrl.substring(0,t.BackgroundImageUrl.length-i.length-1),o="".concat(n,"_").concat(e,".jpg");return l(l({},t),{},{BackgroundImageUrl:o,hasCropping:!0})}return t},getOriginalOrCroppedImage:function(t,e,i){if(this.hasCroppedKey(t,i)){var n=t.BackgroundImageUrl.split(".").reverse()[0],o=t.BackgroundImageUrl.substring(0,t.BackgroundImageUrl.length-n.length-1);if(o.indexOf(i)<0)return"".concat(o,"_").concat(i,".jpg")}return e.imageUrl}}},196:function(t,e,i){"use strict";i.r(e);var n=i(2),o=i(775),s=i(2371),r=i.n(s),a=i(158),l=o.default.extend({dom:{literalErrorAPICall:".js-error-apicall",container:".js-container",body:".js-body",checkList:".js-checkList",confirmButton:".js-confirm"},defaultOptions:{icon:"icon icon--warning-delete",title:Object(n.translate)("Delete item?"),buttons:[{id:"confirm",label:Object(n.translate)("Yes, delete")},{id:"cancel",label:Object(n.translate)("Cancel")}]},template:r.a,events:{"click .js-confirm":"confirm","click .js-cancel":"cancel"},initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this.template=t.template||this.template,this.icon=t.icon||this.defaultOptions.icon,this.title=t.title||this.defaultOptions.title,this.description=t.description,this.buttons=t.buttons||this.defaultOptions.buttons,this.showCheckboxList=t.showCheckboxList,this.listPageUrl=t.listPageUrl,l.__super__.initialize.apply(this,arguments),this.render()},render:function(){var t={icon:this.icon,title:this.title,description:this.description,buttons:this.buttons,showCheckboxList:this.showCheckboxList};return this.$el.html(this.template(t)),this.containerErrorAPI=this.$el.find(this.dom.literalErrorAPICall),this.$container=this.$(this.dom.container),this.$body=this.$(this.dom.body),this},postRender:function(){return this.showCheckboxList&&(this._checkList=new a.default.CheckBoxList({classes:{list:"remove-alert__checkbox-list",column:"",row:"remove-alert__checkbox"},el:this.$(this.dom.checkList),items:this.options.componentItems}),this._checkList.on("change",this.checkButton,this)),this},setDialog:function(t){this.dialog=t},showDialog:function(){this.dialog.show()},setModel:function(t){this.model=t},confirm:function(t){t.stopPropagation(),this.confirmButtonEnabled()&&this.undelegateEvents(),this.trigger("confirm",!0)},cancel:function(t){t.stopPropagation(),this.trigger("confirm",!1),this.closeDialog()},closeDialog:function(){this.notDialog||!this.confirmButtonEnabled()||this.stayOpenOnConfirm||this.dialog.hide()},confirmButtonEnabled:function(){return!this._checkList||this._checkList._checked.length===this._checkList._checkboxes.length},checkButton:function(){this.confirmButtonEnabled()?this.$el.find(this.dom.confirmButton).attr("aria-disabled",!1):this.$el.find(this.dom.confirmButton).attr("aria-disabled",!0)},setError:function(t){this.containerErrorAPI.html(t),this.containerErrorAPI.show()}});e.default=l},1989:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(1);e.default=function(t){var e=t.root,i=void 0===e?null:e,n=t.rootMargin,r=void 0===n?"0px":n,a=t.threshold,l=void 0===a?0:a,c=Object(s.useState)(null),u=o()(c,2),d=u[0],h=u[1],f=Object(s.useState)(null),p=o()(f,2),m=p[0],g=p[1],v=Object(s.useRef)(new IntersectionObserver((function(t){var e=o()(t,1)[0];return g(e)}),{root:i,rootMargin:r,threshold:l}));return Object(s.useEffect)((function(){var t=v.current;return t.disconnect(),d&&t.observe(d),function(){t&&t.disconnect()}}),[d]),[v.current,h,m]}},1990:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(1);e.default=function(t,e){var i=Object(s.useState)(!1),n=o()(i,2),r=n[0],a=n[1],l=Object(s.useState)(!1),c=o()(l,2),u=c[0],d=c[1];t&&!r&&a(!0),!r||t||u||d(!0);return[function(){u&&(a(!1),d(!1),e&&e())},t||u]}},1991:function(t,e,i){"use strict";e.default=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){e.forEach((function(e){e&&("function"==typeof e?e(t):e.current=t)}))}}},1992:function(t,e,i){"use strict";var n=i(1);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.block,i=void 0===e?"start":e,o=t.behavior,s=void 0===o?"auto":o,r=Object(n.useRef)(null),a=function(){var t;null==r||null===(t=r.current)||void 0===t||t.scrollIntoView({block:i,behavior:s})};return[a,r]}},1993:function(t,e,i){"use strict";i(1999).default},1994:function(t,e,i){"use strict";var n=i(43),o=i.n(n),s=i(11),r=i.n(s),a=i(1);e.default=function(t){var e=t.fetchMore,i=t.items,n=void 0===i?[]:i,s=t.first,l=void 0===s?20:s,c=t.keyArgs,u=void 0===c?[]:c,d=Object(a.useState)(),h=r()(d,2),f=h[0],p=h[1];return Object(a.useEffect)((function(){f&&e({variables:{offset:f,first:l}})}),[f].concat(o()(u))),{loadMore:function(){f!==n.length&&p(n.length)}}}},1995:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(673),r=i(809);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.useSingle,i=void 0!==e&&e,n=t.target,a=void 0===n?window:n,l=t.onReturnFocus,c=void 0===l?function(){}:l,u=Object(s.useSingleOpen)({useSingle:i}),d=o()(u,2),h=d[0],f=d[1],p=function(t){h&&t.stopPropagation(),f(!1),c(t)};return Object(r.default)("Escape",p,{target:a}),[h,f]}},1996:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(1),r=i(1429);e.default=function(){var t=Object(s.useState)(),e=o()(t,2),i={openedComponentId:e[0],setOpenedComponent:e[1]};return[r.default.Provider,i]}},1997:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(1),r=i(1429),a=0;e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.useSingle,i=void 0===e||e,n=Object(s.useContext)(r.default),l=Object(s.useState)(),c=o()(l,2),u=c[0],d=c[1],h=Object(s.useMemo)((function(){return a++}),[]);if(i){if(!n)throw new Error("useSingleOpen must be used within SingleOpenContextProvider");var f=n.openedComponentId,p=n.setOpenedComponent,m=function(t){p(t?h:void 0)},g=h===f;return[g,m]}return[u,d]}},1998:function(t,e,i){"use strict";var n=i(1);function o(t){return"function"==typeof t?t:"string"==typeof t?function(e){return e.key===t}:t instanceof Array?function(e){return t.includes(e.key)}:function(){return!0}}e.default=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=i.eventType,r=void 0===s?"keydown":s,a=i.target,l=void 0===a?window:a,c=Object(n.useMemo)((function(){var i=o(t);return function(t){return i(t)&&e(t)}}),[e,t]);Object(n.useEffect)((function(){return l.addEventListener(r,c),function(){l.removeEventListener(r,c)}}))}},1999:function(t,e,i){"use strict";var n=i(2e3);e.default=function(t){var e=Object(n.default)(),i=e.data,o=e.loading,s=e.error;return!o&&!s&&(Object.keys(i).includes(t)&&i[t]||!1)}},20:function(t,e,i){"use strict";i.r(e);var n=i(4);function o(t){return t instanceof n?t:n(t)}var s={enable:function(t){(t=o(t||this.el)).removeClass("is-disabled"),t.removeAttr("disabled")},disable:function(t){(t=o(t||this.el)).addClass("is-disabled"),t.attr("disabled","disabled")},startLoading:function(t){if(!this.__loadingElement){if(!t||!o(t).length)return;this.__loadingElement=n("<div />").addClass("loading").appendTo(t)}this.__loadingElement.show()},stopLoading:function(){this.__loadingElement&&this.__loadingElement.hide()},mixin:function(t){t.enable=this.enable,t.disable=this.disable},loaderMixin:function(t){t.startLoading=this.startLoading,t.stopLoading=this.stopLoading}};e.default=s},2e3:function(t,e,i){"use strict";var n,o=i(29),s=i.n(o),r=i(16),a=Object(r.gql)(n||(n=s()(["\n\tquery getFeatures {\n\t\tsettings {\n\t\t\tcurrent {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t}\n"])));e.default=function(){var t,e=Object(r.useQuery)(a),i=e.loading,n=e.error,o=e.data;return{loading:i,error:n,data:null==o||null===(t=o.settings)||void 0===t?void 0:t.current}}},2001:function(t,e,i){"use strict";var n=i(35),o=i.n(n),s=i(11),r=i.n(s),a=i(23),l=i.n(a),c=i(1),u=i.n(c),d=i(0),h=i.n(d),f=i(164),p=i(32),m=i(404),g=i(44),v=i(676),b=i(119),y=i(21),C=i(183),w=i(527),T=i(9),x=i(353),O=i(1743),S=i(402),I=i(2022),A=i(1431);var k=function(t){var e=t.profile,i=t.urlProfile,n=t.hide,s=t.onMouseEnter,a=e.attributes,d=a.FullName,h=void 0===d?e.attributes.fullName||e.attributes.fullname:d,k=a.JobTitle,P=void 0===k?e.attributes.title:k,E=a.Title,_=void 0===E?e.attributes.title:E,j=a.Email,D=void 0===j?e.attributes.email:j,U=a.PictureUrl,M=void 0===U?e.attributes.pictureUrl||e.attributes.pictureurl:U,L=a.Id,N=void 0===L?e.attributes.id:L,R=a.SipAddress,z=void 0===R?e.attributes.sipAddress||e.attributes.sipaddress:R,F=a.BackgroundPictureUrl,B=void 0===F?e.attributes.backgroundPictureUrl||e.attributes.backgroundpictureurl||e.attributes.BackgroundImageUrl:F,$=a.LastUpdated,V=void 0===$?e.attributes.lastUpdated:$,H=Object(I.default)({id:N}),G=H.error,W=H.loading,K=H.data,q=Object(O.useFollowUserMutation)({userId:N}).followMutate,J=Object(O.useUnFollowUserMutation)({userId:N}).unfollowMutate,Q=Object(c.useState)(!1),Y=r()(Q,2),Z=Y[0],X=Y[1],tt=Object(c.useState)(!W&&K.users.getById.isCurrentUserColleague),et=r()(tt,2),it=et[0],nt=et[1],ot=Object(c.useRef)(),st=Object(c.useRef)(),rt=Object(c.useCallback)(function(){var t=o()(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),e.stopPropagation(),X(!0),t.prev=3,t.next=6,q();case 6:nt(!0),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error(t.t0.message);case 12:return t.prev=12,X(!1),t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[3,9,12,15]])})));return function(e){return t.apply(this,arguments)}}(),[q,nt]),at=Object(c.useCallback)(function(){var t=o()(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),e.stopPropagation(),X(!0),t.prev=3,t.next=6,J();case 6:nt(!1),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error(t.t0.message);case 12:return t.prev=12,X(!1),t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[3,9,12,15]])})));return function(e){return t.apply(this,arguments)}}(),[nt,J]),lt=Object(c.useMemo)((function(){return Object(A.default)(B,V,Object(C.getSiteAbsoluteUrl)(),"")}),[B,V]);Object(c.useEffect)((function(){var t=ot.current,e=function(t){it?at(t):rt(t)};return t&&t.addEventListener&&t.addEventListener("click",e),function(){t&&t.removeEventListener&&t.removeEventListener("click",e)}}),[it,rt,at]),Object(c.useEffect)((function(){var t=st.current,e=function(t){t.preventDefault(),t.stopPropagation(),window.open("https://outlook.office.com/calendar/deeplink/compose","popupWindow","width=1080, height=580, scrollbars=yes")};return t&&t.addEventListener&&t.addEventListener("click",e),function(){t&&t.removeEventListener&&t.removeEventListener("click",e)}}),[]);var ct=Object(b.isCurrentUser)(N),ut=w.default.isAppsCloud(window.location.href),dt=document.querySelector("#s4-workspace");return G?null:u.a.createElement("div",{className:"bz-main__container--1PK36e",onMouseLeave:n,onMouseEnter:s},u.a.createElement("a",{"data-interception":"off",href:i,className:"bz-main__container__link--1PK36e",tabIndex:"-1"},u.a.createElement("div",{"data-test":"[common-quickProfile].profile",className:"bz-profile__img--1PK36e",style:lt?{backgroundImage:"url('".concat(lt,"')")}:{}},u.a.createElement("span",{"data-email":D,"data-user-id":""},u.a.createElement(x.default,{pictureUrl:M,extraClasses:{avatar:S.default["profile__img--avatar"]},avatarSize:"xxSmall",lastUpdated:"today",ariaHidden:!0})))),u.a.createElement("div",{className:"bz-user__info__container--1PK36e"},u.a.createElement(f.default,{data:{interception:"off"},href:i,extraClasses:{link:S.default["user__info__container--user-name"]}},h),u.a.createElement("p",{className:"bz-user__info__container--user-role--1PK36e"},_||P||""),u.a.createElement("div",{className:"bz-actions__container--1PK36e"},u.a.createElement(u.a.Fragment,null,ct?u.a.createElement(f.default,{data:{interception:"off"},href:"".concat(i,"&edit=true"),extraClasses:{link:S.default["link--profile"]}},u.a.createElement("span",{className:"bz-link--profile--text--1PK36e"},Object(T.getTranslation)("Edit my profile"))):u.a.createElement(u.a.Fragment,null,z?u.a.createElement(f.default,{data:{interception:"off"},href:"sip:".concat(z),extraClasses:{link:S.default["btn--message"]}},u.a.createElement(p.I,{typeIcon:"Teams",extraClasses:{icon:S.default["btn--icon--color"]}}),u.a.createElement("span",{className:"bz-btn--message--text--1PK36e"},Object(T.getTranslation)("Message"))):u.a.createElement(m.default,{addKeyboardFocus:!0,appendTarget:dt,key:12,title:Object(T.getTranslation)("Messaging not configured for this user"),anchorOrigin:{horizontal:"middle",vertical:"top"},targetOrigin:{horizontal:"middle",vertical:"bottom"},extraClasses:{popLayerContainer:S.default["tooltip--animation"],tooltipSpan:S.default["tooltip__container--size"]}},u.a.createElement(f.default,{data:{interception:"off"},href:"sip:",extraClasses:{link:Object(y.unionClassNames)(S.default["btn--message"],S.default["btn--message--disabled"])},disabled:!0},u.a.createElement(p.I,{typeIcon:"Teams",extraClasses:{icon:S.default["btn--icon--color"]}}),u.a.createElement("span",{className:"bz-btn--message--text--1PK36e"},Object(T.getTranslation)("Message")))),u.a.createElement(g.default,{innerRef:function(t){ot.current=t},"aria-pressed":!!it,category:"outline",loading:Z,disabled:Z,size:"small",extraClasses:{button:S.default["btn--following"]}},it&&Object(T.getTranslation)("Following")||Object(T.getTranslation)("Follow")))),!ct&&u.a.createElement("div",{className:"bz-icons__container--1PK36e"},u.a.createElement(m.default,{addKeyboardFocus:!0,appendTarget:dt,key:13,title:Object(T.getTranslation)("Send an email"),anchorOrigin:{horizontal:"middle",vertical:"top"},targetOrigin:{horizontal:"middle",vertical:"bottom"},extraClasses:{popLayerContainer:S.default["tooltip--animation"],tooltipSpan:S.default["tooltip__container--size"]}},u.a.createElement(v.default,{onClick:function(t){t.preventDefault(),t.stopPropagation(),window.location.href="mailto:".concat(D)},typeIcon:"EmailClosed",extraClasses:{icon:S.default["icons__container--icon"]},className:"bz-icons__link--1PK36e"})),ut&&u.a.createElement(m.default,{addKeyboardFocus:!0,appendTarget:dt,key:14,title:Object(T.getTranslation)("Schedule a meeting"),anchorOrigin:{horizontal:"middle",vertical:"top"},targetOrigin:{horizontal:"middle",vertical:"bottom"},extraClasses:{popLayerContainer:S.default["tooltip--animation"],tooltipSpan:S.default["tooltip__container--size"]}},u.a.createElement(v.default,{innerRef:function(t){st.current=t},typeIcon:"Calendar",extraClasses:{icon:Object(y.unionClassNames)(S.default["icons__container--icon"],S.default["icons__container--extra-space"])},className:"bz-icons__link--1PK36e"}))))))};k.propTypes={profile:h.a.shape({attributes:h.a.shape({FullName:h.a.string,fullName:h.a.string,fullname:h.a.string,JobTitle:h.a.string,jobTitle:h.a.string,Title:h.a.string,title:h.a.string,Email:h.a.string,email:h.a.string,PictureUrl:h.a.string,pictureUrl:h.a.string,pictureurl:h.a.string,Id:h.a.number,id:h.a.number,SipAddress:h.a.string,sipAddress:h.a.string,sipaddress:h.a.string,BackgroundPictureUrl:h.a.string,backgroundPictureUrl:h.a.string,BackgroundImageUrl:h.a.string,backgroundpictureurl:h.a.string,LastUpdated:h.a.string,lastUpdated:h.a.string}).isRequired}).isRequired,urlProfile:h.a.string.isRequired,hide:h.a.func.isRequired,onMouseEnter:h.a.func.isRequired},e.default=k},2002:function(t,e,i){"use strict";var n=i(149),o=i(183);e.default=function(){return"".concat(Object(o.getWebAbsoluteUrl)()).concat(Object(n.getUrlLayout)(),"/images/PersonPlaceholder.96x96x32.png")}},2003:function(t,e,i){"use strict";i(35),i(23),i(2015)},2011:function(t,e,i){"use strict";var n,o=i(11),s=i.n(o),r=i(29),a=i.n(r),l=i(16),c=Object(l.gql)(n||(n=a()(["\n\tmutation followUser($userId: Int!) {\n\t\tusers {\n\t\t\tfollowUser(userId: $userId) {\n\t\t\t\tid\n\t\t\t\tisCurrentUserColleague\n\t\t\t}\n\t\t}\n\t}\n"])));e.default=function(t){var e=t.userId,i=Object(l.useMutation)(c,{variables:{userId:e}}),n=s()(i,2),o=n[0],r=n[1];return{followMutate:o,data:r.data,loading:r.loading,error:r.error}}},2012:function(t,e,i){"use strict";var n,o=i(11),s=i.n(o),r=i(29),a=i.n(r),l=i(16),c=Object(l.gql)(n||(n=a()(["\n\tmutation unfollowUser($userId: Int!) {\n\t\tusers {\n\t\t\tunfollowUser(userId: $userId) {\n\t\t\t\tid\n\t\t\t\tisCurrentUserColleague\n\t\t\t}\n\t\t}\n\t}\n"])));e.default=function(t){var e=t.userId,i=Object(l.useMutation)(c,{variables:{userId:e}}),n=s()(i,2),o=n[0],r=n[1];return{unfollowMutate:o,data:r.data,loading:r.loading,error:r.error}}},2013:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(164),l=i(32),c=i(119),u=i(21),d=i(245),h=i(1003),f=i(1744);var p=function(t){var e=t.href,i=t.openInNewTab,n=t.title,s=t.typeIcon,r=t.onShowAccountLimitation,p=t.extraClasses,m=t.onClick;return o.a.createElement(h.default,null,o.a.createElement(a.default,{extraClasses:{link:Object(u.unionClassNames)(f.default["list__item--clickable"],p.linkListItem)},href:e,openInNewTab:i,opensNewTabTextA11y:i?Object(d.addOpenNewTabLiteral)():null,onClick:Object(c.isCurrentUserReadOnly)()?r:m},s?o.a.createElement(l.I,{typeIcon:s,extraClasses:{icon:f.default.icon}}):null,n))};p.propTypes={href:r.a.string,openInNewTab:r.a.bool,title:r.a.string,typeIcon:r.a.string,onClick:r.a.func,onShowAccountLimitation:r.a.func,extraClasses:r.a.shape({linkListItem:r.a.string})},p.defaultProps={href:"#",openInNewTab:!1,onShowAccountLimitation:function(){},title:"",typeIcon:"",onClick:function(){},extraClasses:{linkListItem:""}},e.default=p},2014:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(21),l=i(135),c=i(2024);var u=function(t){var e=t.id,i=t.children,n=t.extraClasses,s=t.role;return o.a.createElement(l.default,{id:e,role:s,extraClasses:{list:Object(a.unionClassNames)(c.default.list,n.list)}},i)};u.propTypes={children:r.a.node,id:r.a.string,role:r.a.string,extraClasses:r.a.shape({list:r.a.string})},u.defaultProps={extraClasses:{list:""}},e.default=u},2015:function(t,e,i){"use strict";e.default=function(t){return new Promise((function(e,i){var n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var t=n.result;e(t)},n.onerror=function(t){i(t.message)}}))}},2016:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(1745),l=i(511),c=i(183),u=i(2017),d=Object(l.getProfileBackgroundImage)(),h=function(t,e,i,n,o){if(t||e)return d;var s=i.settings&&i.settings.current&&i.settings.current.siteHost,r=i.networks;return s&&r&&Object(l.getProfileImage)(n,o,s,Object(c.getDefaultNetworkUrl)(r))||d},f=function(t){var e=t.pictureUrl,i=t.lastUpdated,n=t.avatarSize,s=t.extraClasses,r=t.avatarShape,l=t.ariaHidden;return o.a.createElement(u.default,{webUrl:Object(c.getSiteAbsoluteUrl)()},(function(t){var c=t.loading,u=t.error,f=t.data;return o.a.createElement(a.default,{previewUrl:d,url:h(c,u,f,e,i),size:n,extraClasses:{avatar:s.avatar},shape:r,"aria-hidden":l})}))};f.propTypes={pictureUrl:r.a.string,lastUpdated:r.a.string,avatarSize:r.a.string,extraClasses:r.a.shape({avatar:r.a.string}),avatarShape:r.a.string,ariaHidden:r.a.bool},f.defaultProps={avatarSize:"xSmall",lastUpdated:"",extraClasses:{avatar:""}},e.default=f},2017:function(t,e,i){"use strict";var n,o=i(29),s=i.n(o),r=i(1),a=i.n(r),l=i(0),c=i.n(l),u=i(16),d=i(283),h=Object(u.gql)(n||(n=s()(["\n\tquery getSettingsAndNetworks($webUrl: String!) {\n\t\tsettings {\n\t\t\tcurrent {\n\t\t\t\tid\n\t\t\t\tsharePointVersion\n\t\t\t\tsiteHost\n\t\t\t}\n\t\t}\n\t\tnetworks {\n\t\t\tnetwork(webUrl: $webUrl) {\n\t\t\t\tid\n\t\t\t\tdefaultWeb {\n\t\t\t\t\trootWebLocation\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]))),f=function(t){var e=t.children,i=t.webUrl;return a.a.createElement(d.Query,{query:h,variables:{webUrl:i}},(function(t){var i=t.loading,n=t.error,o=t.data;return e({loading:i,error:n,data:o})}))};f.propTypes={children:c.a.func.isRequired,webUrl:c.a.string},e.default=f},2018:function(t,e,i){"use strict";var n=i(114),o=i.n(n),s=i(41),r=i.n(s),a=i(11),l=i.n(a),c=i(85),u=i.n(c),d=i(1),h=i.n(d),f=i(0),p=i.n(f),m=i(144),g=i(625);function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function b(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){r()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var y=Object(d.forwardRef)((function(t,e){var i=t.children,n=t.show,s=t.align,r=t.verticalAlign,a=t.className,c=t.containerClassName,f=t.fixed,p=t.shouldPosition,v=t.shouldFlip,y=t.width,C=(t.hasTip,u()(t,["children","show","align","verticalAlign","className","containerClassName","fixed","shouldPosition","shouldFlip","width","hasTip"])),w=Object(m.useShow)(n),T=l()(w,2),x=T[0],O=T[1],S=Object(d.useRef)(),I=Object(m.useCombinedRefs)(e,S),A=Object(d.useState)({}),k=l()(A,2),P=k[0],E=k[1],_=Object(d.useState)(s),j=l()(_,2),D=j[0],U=j[1],M=Object(d.useState)(r),L=l()(M,2),N=L[0],R=L[1],z=Object(d.useRef)();Object(d.useEffect)((function(){var t=function(){if(null!=S&&S.current){var t=S.current.getBoundingClientRect();E({top:t.top,left:t.left})}};return f&&p&&(t(),window.addEventListener("resize",t,!0),document.addEventListener("scroll",t,!0)),function(){f&&p&&(window.removeEventListener("resize",t),document.removeEventListener("scroll",t))}}),[n,f,p,S,D,N]),Object(d.useEffect)((function(){O?null!=z&&z.current&&v&&setTimeout((function(){if(z.current){var t=z.current.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight;t.right>e?U("left"):t.left<0&&U("right"),window.matchMedia("(max-width: 760px)").matches||(t.bottom>i?R("top"):t.top<0&&R("bottom"))}}),0):(U(s),R(r))}),[n,O,s,r,z,v]);var F={left:g.default["popover--left"],center:g.default["popover--center"],right:g.default["popover--right"]},B={top:g.default["popover--top"],bottom:g.default["popover--bottom"]},$=F[D],V=B[N];return O?h.a.createElement("div",o()({},C,{ref:I,onAnimationEnd:x,className:"".concat(g.default.popover," ").concat(n?g.default["popover--show"]:g.default["popover--hide"],"\n\t\t\t").concat($," ").concat(V," ").concat(a)}),h.a.createElement("div",{ref:z,className:"".concat(g.default["popover-container"]," ").concat(f?g.default["popover-container--fixed"]:""," ").concat(c),style:f?b(b({},P),{},{width:y?"".concat(y,"px"):""}):{}},i)):null}));y.propTypes={align:p.a.oneOf(["left","center","right"]),verticalAlign:p.a.oneOf(["top","bottom"]),className:p.a.string,containerClassName:p.a.string,children:p.a.node.isRequired,show:p.a.bool.isRequired,fixed:p.a.bool,shouldPosition:p.a.bool,shouldFlip:p.a.bool,width:p.a.number,hasTip:p.a.bool},y.defaultProps={align:"right",verticalAlign:"bottom",className:"",containerClassName:"",fixed:!1,shouldPosition:!0,shouldFlip:!0,width:void 0},e.default=y},2020:function(t,e,i){"use strict";e.default={link:/((www\.|((ht|f)tp(s?)|file):\/\/|mailto:){1}\S[-A-Za-zÀ-ÿ0-9+&@#/%?$=~_()[\]{}|!:,.;'’£]*[-A-Za-zÀ-ÿ0-9+&@#/%=~_()[\]{}|])/gi,singleNewLine:/([^\u000d\u000a])(\u000d\u000a)/g,doubleNewLine:/\u000d\u000a\u000d\u000a/g,url:/((www\.|((ht|f)tp(s?)|file):\/\/|mailto:){1}\S[-A-Za-zÀ-ÿ0-9+&@#/%?=~_()[\]{}|!:,.;']*[-A-Za-zÀ-ÿ0-9+&@#/%=~_()[\]{}|])/i,hashTag:/(?:^|\s|\()(#([^\s\t\n\b\f\r\0\x0B\x1B\!\:\?\;\.\,\)\(\<]+))/g,mentions:/(?:^|\s|)(\@\d+)/gi,monthDayYearDate:"%m %d %y",dayMonthYearDate:"%d %m %y"}},2021:function(t,e,i){"use strict";i.d(e,"MAX_WIDTH_FOR_HIDING_POPOVERS",(function(){return n}));var n="1024"},2022:function(t,e,i){"use strict";var n,o=i(29),s=i.n(o),r=i(16),a=Object(r.gql)(n||(n=s()(["\n\tquery getUserExtended($id: Int!) {\n\t\tusers {\n\t\t\tgetById(id: $id) {\n\t\t\t\tid\n\t\t\t\tisCurrentUserColleague\n\t\t\t}\n\t\t\t__typename\n\t\t}\n\t\tsettings {\n\t\t\tcurrent {\n\t\t\t\tid\n\t\t\t\tsiteHost\n\t\t\t}\n\t\t}\n\t}\n"])));e.default=function(t){var e=t.id,i=Object(r.useQuery)(a,{variables:{id:e}});return{data:i.data,loading:i.loading,error:i.error}}},2023:function(t,e,i){"use strict";e.default={list__item:"bz-list__item--1cgzdx"}},2024:function(t,e,i){"use strict";e.default={list:"bz-list--Uq5UI"}},2030:function(t,e,i){"use strict";var n=i(260);e.default=function(t){return n.default.find((function(e){return e.code.toLowerCase().trim()===t.toLowerCase().trim()}))}},2031:function(t,e,i){"use strict";var n=i(260);e.default=function(t){return n.default.find((function(e){return e.lcid===t}))}},2032:function(t,e,i){"use strict";var n=i(260);e.default=function(t){var e=n.default;return t&&e.find((function(e){return e.code.trim().toLowerCase()===t.trim().toLowerCase()}))?t.split("-")[0]:null}},2033:function(t,e,i){"use strict";var n=i(43),o=i.n(n);e.default=function(t){if(!Array.isArray(t))return null;var e=t.find((function(t){return t.isDefault})),i=t.filter((function(t){return!t.isDefault&&t.hasTranslation})),n=t.filter((function(t){return!t.isDefault&&!t.hasTranslation}));return i.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),n.sort((function(t,e){return t.name<e.name?-1:t.name>e.name?1:0})),[e].concat(o()(i),o()(n))}},2034:function(t,e,i){"use strict";var n=i(41),o=i.n(n),s=i(678);function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}e.default=function(t){return a(a(a(a(a(a(a(a(a({},t.id?{id:t.id}:{}),t.categories?{categories:t.categories.map((function(t){return t.title})).join(", ")}:{}),t.isInCurrentUserFavorites?{hasFavorite:t.isInCurrentUserFavorites}:{}),t.icon?{iconUrl:t.icon}:{}),t.title?{title:t.title}:{}),t.description?{description:t.description}:{}),t.link?{link:t.link}:{}),t.backgroundColor?{backgroundColor:JSON.parse(t.backgroundColor)}:{}),t.id?{urlDetail:"".concat(s.AppDetailPage).concat(t.id)}:{})}},2035:function(t,e,i){"use strict";e.default=function(t){if(!t)return"";var e=t.split("icon://")[1].split("/")[0];return e.charAt(0).toUpperCase()+e.slice(1)}},2036:function(t,e,i){"use strict";e.default=function(t,e){return t>e}},2037:function(t,e,i){"use strict";e.default=function(t){return t&&t.match(/icon:\/\//)&&t.match(/icon:\/\//).length}},2040:function(t,e,i){"use strict";e.default=function(t){return t===window.beezyCurrentUser.Id}},2041:function(t,e,i){"use strict";e.default=function(){return window.beezyCurrentUser&&window.beezyCurrentUser.IsReadOnly}},2043:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(246),l=i(2044),c=i(2046),u=function(t){var e=t.altText,i=t.calculateBgGradient,n=t.extraClasses,s=t.id,r=t.isSvgIcon,u=t.onLoadIcon,d=t.teamsIcon,h=t.url,f=(r||Object(a.isSvgIcon)(h))&&(d||Object(a.getSvgIcon)(h));return f?o.a.createElement(c.default,{ariaLabel:e,calculateBgGradient:i,extraClasses:{container:n.container,icon:n.icon},icon:f,id:s,onLoadIcon:u}):o.a.createElement(l.default,{alt:e,calculateBgGradient:i,dataId:d?"adaptiveCard-image":"",extraClasses:{image:n.image},onLoadIcon:u,url:h})};e.default=u,u.propTypes={altText:r.a.string,calculateBgGradient:r.a.bool,extraClasses:r.a.shape({container:r.a.string,icon:r.a.string,image:r.a.string}),id:r.a.number.isRequired,isSvgIcon:r.a.bool,onLoadIcon:r.a.func,teamsIcon:r.a.string,url:r.a.string.isRequired},u.defaultProps={calculateBgGradient:!1,extraClasses:{container:"",icon:"",image:""},isSvgIcon:!1,onLoadIcon:function(){}}},2044:function(t,e,i){"use strict";var n=i(35),o=i.n(n),s=i(23),r=i.n(s),a=i(1),l=i.n(a),c=i(0),u=i.n(c),d=i(674),h=i(599),f=i(21),p=i(2045);var m=function(t){var e=t.alt,i=t.calculateBgGradient,n=t.dataId,s=t.extraClasses,a=t.onLoadIcon,c=t.url;return l.a.createElement(d.default,{alt:e,data:n?{id:n}:{},extraClasses:{image:Object(f.unionClassNames)(p.default["img--bitmap"],s.image)},onLoad:i?o()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a,t.next=3,Object(h.getColorFromImage)(c);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)}))):void 0,src:c})};m.propTypes={alt:u.a.string,calculateBgGradient:u.a.bool,dataId:u.a.string,extraClasses:u.a.shape({image:u.a.string}),onLoadIcon:u.a.func,url:u.a.string.isRequired},m.defaultProps={alt:"",calculateBgGradient:!1,extraClasses:{image:""},onLoadIcon:function(){}},e.default=m},2045:function(t,e,i){"use strict";e.default={"img--bitmap":"bz-img--bitmap--99IWg"}},2046:function(t,e,i){"use strict";var n=i(65),o=i.n(n),s=i(66),r=i.n(s),a=i(67),l=i.n(a),c=i(68),u=i.n(c),d=i(42),h=i.n(d),f=i(1),p=i.n(f),m=i(0),g=i.n(m),v=i(32),b=i(21),y=i(2047);function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=h()(t);if(e){var o=h()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u()(this,i)}}var w=function(t){l()(i,t);var e=C(i);function i(){return o()(this,i),e.apply(this,arguments)}return r()(i,[{key:"componentDidMount",value:function(){this.props.calculateBgGradient&&this.props.onLoadIcon()}},{key:"render",value:function(){var t=this.props,e=t.extraClasses,i=t.id,n=t.icon,o=t.ariaLabel;return p.a.createElement("div",{className:Object(b.unionClassNames)(y.default["img--vector"],e.container)},p.a.createElement(v.I,{key:i,typeIcon:n,extraClasses:{icon:e.icon},aria:o}))}}]),i}(f.Component);w.propTypes={id:g.a.number.isRequired,icon:g.a.string.isRequired,calculateBgGradient:g.a.bool,extraClasses:g.a.shape({container:g.a.string,icon:g.a.string}),ariaLabel:g.a.string,onLoadIcon:g.a.func},w.defaultProps={calculateBgGradient:!1,extraClasses:{container:"",icon:""},onLoadIcon:function(){}},e.default=w},2047:function(t,e,i){"use strict";e.default={"img--vector":"bz-img--vector--Z1uOyyi"}},2048:function(t,e,i){"use strict";var n=i(731),o=[n.default.ESC,n.default.ESCAPE];e.default=function(t){return o.includes(t.key)}},2049:function(t,e,i){"use strict";i(731).default.SPACE},2050:function(t,e,i){"use strict";var n=[i(731).default.ENTER];e.default=function(t){return n.includes(t.key)}},2051:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34),a=i(77);e.default=function(t){var e=t.pointerEvents,i=void 0===e?"none":e,o=t.offset,l=void 0===o?0:o;return Object(r.css)(n||(n=s()(["\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tbottom: 0;\n\tleft: 0;\n\tmargin: ",";\n\tcontent: '';\n\tpointer-events: ",";\n"])),Object(a.rem)(l),i)}},2052:function(t,e,i){"use strict";var n,o,s=i(62),r=i.n(s),a=i(34);e.default=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Object(a.css)(n||(n=r()(["\n\tbox-sizing: border-box;\n\tborder: 0;\n\tbackground: transparent;\n\tcursor: pointer;\n\n\t","\n\n\t&:active,\n\t&:focus {\n\t\toutline: 0;\n\t}\n"])),t?Object(a.css)(o||(o=r()(["\n\t\t\t\tpadding: 0;\n\t\t  "]))):"")}},2053:function(t,e,i){"use strict";var n,o,s,r,a,l,c,u,d=i(62),h=i.n(d),f=i(34),p=i(77),m=i(272);e.default=function(t){var e=t.type,i=void 0===e?"outside":e,d=t.elementPosition,g=void 0===d?"relative":d,v=t.hasBorder,b=void 0!==v&&v,y=t.useCustomBorderRadius,C=void 0!==y&&y,w=t.borderRadius,T=function(){return C?Object(f.css)(n||(n=h()(["\n\t\t\t\tborder-radius: var(--br__gl--border-radius, ",");\n\t\t\t"])),m.borderRadius.global):"number"==typeof w?Object(f.css)(o||(o=h()(["\n\t\t\t\tborder-radius: ",";\n\t\t\t"])),Object(p.rem)(w)):Object(f.css)(s||(s=h()(["\n\t\t\tborder-radius: ",";\n\t\t"])),w)},x="";return"spaced"===i&&(x=Object(f.css)(r||(r=h()(["\n\t\t\tposition: ",";\n\n\t\t\t&::before {\n\t\t\t\t","\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 0;\n\t\t\t\tright: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tmargin: ",";\n\t\t\t\tbox-shadow: 0 0 0 2px var(--br__gl-outline-primary--color, ","),\n\t\t\t\t\t0 0 0 3px var(--br__gl-outline-secondary--color, ",");\n\t\t\t\tcontent: '';\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t"])),g,T(),Object(p.rem)(-2),m.colors.primary,m.colors.white)),"outside"===i&&(x=Object(f.css)(a||(a=h()(["\n\t\t\t","\n\t\t\tbox-shadow: 0 0 0 2px var(--br__gl-outline-primary--color, ","), 0 0 0 3px var(--br__gl-outline-secondary--color, ",");\n\t\t"])),T(),m.colors.primary,m.colors.white)),"inside"===i&&(x=b?Object(f.css)(l||(l=h()(["\n\t\t\t\tborder: solid 1px var(--br__gl-outline-primary--color, ",");\n\t\t\t\tbox-shadow: inset 0 0 0 1px var(--br__gl-outline-primary--color, ","),\n\t\t\t\t\t0 0 0 1px var(--br__gl-outline-secondary--color, ",");\n\t\t\t"])),m.colors.primary,m.colors.primary,m.colors.white):Object(f.css)(c||(c=h()(["\n\t\t\t\t","\n\t\t\t\tbox-shadow: inset 0 0 0 1px var(--br__gl-outline-secondary--color, ","), inset 0 0 0 3px var(--br__gl-outline-primary--color, ",");\n\t\t\t"])),T(),m.colors.white,m.colors.primary)),Object(f.css)(u||(u=h()(["\n\t\toutline: 0;\n\n\t\t",";\n\t"])),x)}},2054:function(t,e,i){"use strict";e.default={global:"var(--as-border-radius-global)",heroBlocks:"var(--as-border-radius-hero-blocks)",pill:"var(--as-border-radius-pill)"}},2055:function(t,e,i){"use strict";e.default={dark:"var(--as-dark)",slate:"var(--as-slate)",grey:"var(--as-grey)",light:"var(--as-light)",ghost:"var(--as-ghost)",pale:"var(--as-pale)",white:"var(--as-white)",primary:"var(--as-primary)",accent1:"var(--as-accent-1)",accent2:"var(--as-accent-2)",accent3:"var(--as-accent-3)",negative:"var(--as-negative)",positive:"var(--as-positive)",label:"var(--as-label-background)"}},2056:function(t,e,i){"use strict";e.default={fs12:12,fs16:16,fs14:14,fs15:15,fs18:18,fs20:20,fs22:22,fs28:28,fs30:30,fs50:50}},2057:function(t,e,i){"use strict";e.default={regular:400,medium:500,semibold:600,bold:700,extrabold:800,black:900}},2058:function(t,e,i){"use strict";e.default={lh12:12,lh14:14,lh15:15,lh19:19,lh20_5:20.5,lh21:21,lh22:22,lh24:24,lh25:25,lh26:26,lh28:28,lh32:32,lh34:34,lh36:36,lh38:38,lh46:46,lh55:55,lh60:60}},2059:function(t,e,i){"use strict";e.default={default:"var(--as-font-family-default)",titles:"var(--as-font-family-titles)"}},2060:function(t,e,i){"use strict";e.default={hero:"var(--hero-gap)"}},2061:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"100%";return Object(r.css)(n||(n=s()(["\n\toverflow: hidden;\n\tmax-width: ",";\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n"])),t)}},2062:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34),a=i(77);e.default=function(){return Object(r.css)(n||(n=s()(["\n\tposition: absolute;\n\toverflow: hidden;\n\twidth: ",";\n\theight: ",";\n\tpadding: 0;\n\tborder: 0;\n\tclip: rect(0 0 0 0);\n"])),Object(a.rem)(1),Object(a.rem)(1))}},2063:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34);e.default=function(t){return Object(r.css)(n||(n=s()(["\n\t/* If we are not in IE, we use webkit specific properties and values to apply max line size */\n\t/* stylelint-disable-next-line value-no-vendor-prefix */\n\tdisplay: -webkit-box;\n\toverflow: hidden;\n\t/* stylelint-disable-next-line property-no-vendor-prefix, order/properties-alphabetical-order */\n\t-webkit-box-orient: vertical;\n\t/* stylelint-disable-next-line property-no-vendor-prefix, order/properties-alphabetical-order */\n\t-webkit-line-clamp: ",";\n\tword-break: break-word;\n"])),t)}},2064:function(t,e,i){"use strict";var n=i(77),o=i(2094);e.default=function(t,e){var i=Object(o.default)("var(".concat(t,")"),e),s=Object(n.parseToHsl)(i);return"\n\t\t".concat(t,": ").concat(e,";\n\t\t").concat(t,"-h: ").concat(Math.floor(s.hue),";\n\t\t").concat(t,"-s: ").concat(Math.floor(100*s.saturation),"%;\n\t\t").concat(t,"-l: ").concat(Math.floor(100*s.lightness),"%;\n\t")}},2065:function(t,e,i){"use strict";e.default=function(t,e){return"\n\t\t".concat(t,": var(").concat(e,");\n\t\t").concat(t,"-h: var(").concat(e,"-h);\n\t\t").concat(t,"-s: var(").concat(e,"-s);\n\t\t").concat(t,"-l: var(").concat(e,"-l);\n\t")}},2066:function(t,e,i){"use strict";e.default=function(t){var e=t.color,i=t.lightness,n=void 0===i?"0%":i,o=t.opacity,s=void 0===o?1:o,r=/(--.*[^\)])/i.exec(e)[1];return"hsla(var(".concat(r,"-h), var(").concat(r,"-s), calc(var(").concat(r,"-l) + ").concat(n,"), ").concat(s,")")}},2085:function(t,e,i){"use strict";function n(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return"string"==typeof t&&t.length>e?i?"".concat(t.substring(0,e-3),"..."):t.substring(0,e):t}i.d(e,"default",(function(){return n}))},2094:function(t,e,i){"use strict";e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=/var\((.*)\)/i,n=i.exec(t),o="undefined"!=typeof document&&null!==document.documentElement&&null!==n&&n.length>1,s=function(t){return getComputedStyle(document.documentElement).getPropertyValue(t)},r=s(n[1]).trim();return o&&r?r:e}},21:function(t,e,i){"use strict";var n=i(2214);i.d(e,"unionClassNames",(function(){return n.default}))},2100:function(t,e,i){"use strict";e.default=function(){return window.beezyCurrentGroup&&window.beezyCurrentGroup.LocalEntity}},2101:function(t,e,i){"use strict";var n=i(260),o=i(497),s=i(76);e.default=function(){var t=Object(s.getCurrentGroupLocalEntity)();return t?n.default.find((function(e){return e.lcid===t.DefaultLcid})):o.beezyDefaultLanguage}},2102:function(t,e,i){"use strict";e.default=function(){return window.beezyCurrentGroup&&window.beezyCurrentGroup.Url}},2103:function(t,e,i){"use strict";e.default=function(){return window.beezyCurrentGroup&&window.beezyCurrentGroup.GroupId}},2119:function(t,e,i){"use strict";function n(t){var e=function(t,e,i){return t.replace(e,i)};return e(t,/"([\s\S]*?)"/g,(function(t){return e(e(e(t,/\r/g,"\\r"),/\n/g,"\\n"),/\t/g,"\\t")}))}i.d(e,"default",(function(){return n}))},214:function(t,e,i){"use strict";i.r(e);var n=i(26),o=i(10),s=i(5),r=n.default.extend({idAttribute:"Id",initialize:function(){return r.__super__.initialize.call()},urlRoot:function(){return"".concat(s.default.getApiUrlv2(),"/Users")},getExtended:function(){return this.isExtended=!0,this.fetch({url:"".concat(this.url(),"/Extended")})},putExtended:function(){return this.isExtended=!0,o.default.put("".concat(s.default.getApiUrlv2(),"/Users/Current"),this.toJSON())},follow:function(){return o.default.postJSON("".concat(s.default.getApiUrlv2(),"/Users/Current/Following"),{Id:this.get("Id")})},unFollow:function(){return o.default.del("".concat(s.default.getApiUrlv2(),"/Users/Current/Following"),{Id:this.get("Id")})},getMyVisibleWidgets:function(){return o.default.get("".concat(s.default.getApiUrlv2(),"/Users/").concat(this.get("Id"),"/ProfileVisibleWidgets"))},hideWidget:function(t){return o.default.del("".concat(s.default.getApiUrlv2(),"/Users/Current/ProfileVisibleWidgets/").concat(t),{})},showWidget:function(t){return o.default.postJSON("".concat(s.default.getApiUrlv2(),"/Users/Current/ProfileVisibleWidgets/").concat(t),{})}});e.default=r},2147:function(t,e,i){"use strict";var n=i(65),o=i.n(n),s=i(66),r=i.n(s),a=i(67),l=i.n(a),c=i(68),u=i.n(c),d=i(42),h=i.n(d),f=i(1),p=i.n(f),m=i(0),g=i.n(m),v=i(138),b=i(183),y=i(1444),C=i(1445);function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=h()(t);if(e){var o=h()(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return u()(this,i)}}var T=function(t){l()(i,t);var e=w(i);function i(){var t;o()(this,i);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).state={showPrivacyWarning:!1},t.handleConfirmPrivacyWarning=function(){t.handleClosePrivacyWarning(),window.location.href="".concat(Object(b.getSiteAbsoluteUrl)(),"/_layouts/closeConnection.aspx?loginasanotheruser=true")},t.handleClosePrivacyWarning=function(){t.setState({showPrivacyWarning:!1})},t.handleConfirmAccountLimitationModal=function(e){var i=t.props.onCloseAccountLimitation;t.setState({showPrivacyWarning:!0},(function(){return i(e)}))},t}return r()(i,[{key:"render",value:function(){var t=this,e=this.props,i=e.onCloseAccountLimitation,n=e.showAccountLimitation,o=this.state.showPrivacyWarning;return p.a.createElement(p.a.Fragment,null,p.a.createElement(y.default,{modalElem:Object(v.createModalContainer)({id:"modal-account-limitation"}),onClose:i,onConfirm:function(e){return t.handleConfirmAccountLimitationModal(e)},show:n}),p.a.createElement(C.default,{modalElem:Object(v.createModalContainer)({id:"modal-privacy-warning"}),onClose:this.handleClosePrivacyWarning,onConfirm:this.handleConfirmPrivacyWarning,show:o}))}}]),i}(f.Component);T.propTypes={onCloseAccountLimitation:g.a.func.isRequired,showAccountLimitation:g.a.bool.isRequired},e.default=T},2165:function(t,e,i){"use strict";i.r(e);var n=i(27),o=i.n(n),s=i(10);window.configuringAjax||function t(e){setTimeout((function(){void 0!==window.contentLoader?(window.configuringAjax=!0,window.contentLoader.getPromiseObject("beezySettings").promise.then((function(){s.default.configureAjax(),o.a.ajax=s.default.ensureDataCallbacks,window.contentLoader.ajaxAndSettingsReady.resolve()}))):t(e)}),e)}(100)},2171:function(t,e,i){"use strict";var n=i(41),o=i.n(n),s=i(43),r=i.n(s),a=i(93);function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var u={merge:function(t,e){return Object(a.mergeDeep)(t,e)}},d=function(t){return{keyArgs:t,merge:function(t,e){var i=t?Object.keys(t).find((function(t){return 0===t.indexOf("items")})):void 0,n=e?Object.keys(e).find((function(t){return 0===t.indexOf("items")})):void 0;if(!i||!n)return Object(a.mergeDeep)(t,e);var s=[].concat(r()(t[i]||[]),r()(e[n]||[]));return c(c({},Object(a.mergeDeep)(t,e)),{},o()({},i,s))},fields:{items:{keyArgs:["first","offset"]}}}},h={AppStoreQuery:u,AudiencesQuery:u,AutoTranslateQuery:u,CorporateModuleQuery:u,CorporateStructureQuery:u,DiscoveryCardsQuery:u,EditorialModuleQuery:u,HashTagQuery:u,HeroQuery:u,LanguageQuery:u,LinksQuery:u,LocalEntityQuery:u,NetworkQuery:u,PlaceQuery:u,SettingsQuery:u,SocialItemQuery:u,UserQuery:u,OrderedPaginatedListPublicTopicGraphType:d(["text","moduleId"]),OrderedPaginatedListPublicChannelGraphType:d(["text","moduleId"]),StoryPaginatedList:d(["urlSite"]),NodeQuery:{fields:{search:d(["text","type","lcid"])}}};e.default=h},2173:function(t,e,i){"use strict";e.default={SocialItemGraphType:["StoryGraphType","IdeaGraphType","ExtendedIdeaGraphType","QuestionGraphType","ShareGraphType","PollGraphType","BlogPostGraphType","WikiPageGraphType","PraiseGraphType","CalendarGraphType","MicroBlogGraphType","TaskGraphType","CorporatePageGraphType","SharePointItemGraphType","AdaptiveCardGraphType","DocumentGraphType","ActionCardGraphType","ShareAppGraphType","DiscussionGraphType"],HeroBlock:["AnnouncementBlock","BannerBlock","GlobalStoriesBlockGraphType","LocalStoriesBlockGraphType","HighlightBlock","WidgetBlock"]}},2176:function(t,e,i){"use strict";e.default=function(t){var e=(new Date).getTimezoneOffset()/60,i=t&&new Date(t);return i&&i instanceof Date?new Date(i.setHours(i.getHours()-e)):null}},2177:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(1483);e.default=function(t,e){var i=Object(s.default)(t),n=new RegExp("<.+>","g"),r=i.match(n),a=r&&r[0];if(a){var l=a.substring(1,a.length-1),c=i.substring(0,i.indexOf(a)),u=i.substring(i.indexOf(a)+a.length);return o.a.createElement(o.a.Fragment,null,c,e(l),u)}return i}},2178:function(t,e,i){"use strict";e.default=function(t){return window.beezySettings&&window.beezySettings[t]}},2179:function(t,e,i){"use strict";var n=i(240);e.default=function(){var t=[];return JSON.parse(Object(n.getBeezySettings)("EditorVideosConfiguration")).forEach((function(e){t.push({urlsDefault:e.url,videoThumbnail:e.APIVideoThumbnail,srcTemplateDefault:e.srcIframe})})),t}},2180:function(t,e,i){"use strict";var n=i(1437);e.default=function(){var t=Object(n.default)();return t&&t.DefaultLcid||1033}},2181:function(t,e,i){"use strict";e.default=function(t){return t?t.match(/\/Date\((\d+)(?:([+-])(\d{2})(\d{2}))?\)\//).filter(Boolean):""}},2182:function(t,e,i){"use strict";var n=i(71);e.default=function(t,e){return t&&e?Object(n.default)(new Date(t),e):""}},2187:function(t,e,i){"use strict";var n=i(71);e.default=function(t,e){return t&&e?Object(n.default)(new Date(t),e):""}},2188:function(t,e,i){"use strict"},2189:function(t,e,i){"use strict"},219:function(t,e,i){"use strict";i.r(e);var n=i(2176);i.d(e,"getLocalDate",(function(){return n.default}));var o=i(1481);i.d(e,"getAbbreviatedMonthNames",(function(){return o.default}));var s=i(1482);i.d(e,"getDateFromPattern",(function(){return s.default}));var r=i(557);i.d(e,"getFormattedDate",(function(){return r.default}));var a=i(1484);i.d(e,"getLocalDateFromJSON",(function(){return a.default}));var l=i(2181);i.d(e,"parseDotNetDate",(function(){return l.default}));var c=i(749);i.d(e,"dateDefaultFormat",(function(){return c.dateDefaultFormat})),i.d(e,"timeDefaultFormat",(function(){return c.timeDefaultFormat})),i.d(e,"monthsName",(function(){return c.monthsName})),i.d(e,"weekdaysName",(function(){return c.weekdaysName})),i.d(e,"tooltipTimeAgoFormat",(function(){return c.tooltipTimeAgoFormat})),i.d(e,"monthDayYear",(function(){return c.monthDayYear}))},2190:function(t,e,i){"use strict";var n=i(219);e.default=function(t){return t?Object(n.getLocalDateFromJSON)(t).toISOString():""}},2191:function(t,e,i){"use strict";var n=i(1107);e.default=function(t,e){return Object(n.getTimezoneOffset)(t,e)}},2195:function(t,e,i){"use strict";var n=i(1486);e.default=function(t){return t.hasTimezoneDst&&function(t){return Object(n.default)(new Date,{start:new Date(t.dstStartDate),end:new Date(t.dstEndDate)})}(t)?t.totalHours+1:t.totalHours}},2196:function(t,e,i){"use strict";var n=i(1107);e.default=function(t,e){return Object(n.zonedTimeToUtc)(t,e)}},2197:function(t,e,i){"use strict";var n=i(1107);e.default=function(t,e){return Object(n.utcToZonedTime)(t,e)}},2198:function(t,e,i){"use strict";e.default=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone}},2199:function(t,e,i){"use strict";i(1712),i(607)},2201:function(t,e,i){"use strict";var n=i(74),o=i(9),s=i(1488);e.default=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return Object(s.default)(n.sprintf.apply(void 0,[Object(o.getTranslation)(t)].concat(i)))}},2202:function(t,e,i){"use strict"},2203:function(t,e,i){"use strict";function n(t){return null==t?"":String(t).replace(/'/g,"%27")}i.d(e,"default",(function(){return n}))},2204:function(t,e,i){"use strict"},2205:function(t,e,i){"use strict";function n(t){return null==t?"":String(t).replace(/[\-\[\]\/\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}i.d(e,"default",(function(){return n}))},2206:function(t,e,i){"use strict";i.d(e,"default",(function(){return s}));var n=i(2020),o=i(1449);function s(t){if(!t.length)return null;var e=o.default.unescapeHTML(t).match(n.default.link);return e&&e.length?e.map((function(t){var e=t;return")"===t.charAt(t.length-1)&&(e=e.substring(0,e.length-1)),e.match(/^HTTP/i)||e.match(/^FILE/i)||e.match(/^MAILTO/i)?e.replace(/&amp;/gi,"&"):"http://".concat(e)})):null}},2207:function(t,e,i){"use strict";e.default=function(t){return"string"==typeof t&&t.startsWith("/")}},2208:function(t,e,i){"use strict";e.default=function(t){return"string"==typeof t&&new RegExp(/^(?:\w+:)?\/\/(\S+)$/).test(t)}},2209:function(t,e,i){"use strict";function n(t,e){return t.length>e.length?-1:t.length<e.length?1:0}i.d(e,"default",(function(){return n}))},2210:function(t,e,i){"use strict";function n(t,e){return t.replace(new RegExp("^".concat(e,"+"),"g"),"").replace(new RegExp("".concat(e,"+$"),"g"),"")}i.d(e,"default",(function(){return n}))},2211:function(t,e,i){"use strict";e.default=function(t){var e=t.iframeDocument,i=t.html,n=t.css,o='<!DOCTYPE html><html><head><meta charset="utf-8"><style>'.concat(n,"</style></head><body/></html>");e.open("text/html",""),e.write(o),e.close(),e.body.appendChild(i)}},2212:function(t,e,i){"use strict";var n=i(1454);e.default=function(t){if(t){var e=function(){return t.select()};Object(n.default)().isEdge()?setTimeout((function(){return e()}),10):e()}}},2213:function(t,e,i){"use strict";i.d(e,"dispatchEvent",(function(){return n}));var n=function(t,e){return document.dispatchEvent(new CustomEvent(t,{detail:e}))}},2214:function(t,e,i){"use strict";e.default=function(){for(var t="",e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i&&i.forEach((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t="".concat(t.trim()," ").concat(e.trim())})),t=t.split(" ").filter((function(t,e,i){return i.indexOf(t)===e})).join(" ").trim()}},2215:function(t,e,i){"use strict";var n=i(1490);e.default=function(){var t=Object(n.default)();if(!t.siteServerRelativeUrl)return document.location.origin;var e=t.siteAbsoluteUrl.lastIndexOf(t.siteServerRelativeUrl),i=t.siteAbsoluteUrl;return e>-1&&"/"!==t.siteServerRelativeUrl&&(i=t.siteAbsoluteUrl.slice(0,e)),i}},2216:function(t,e,i){"use strict";e.default=function(){return"/_layouts/15"}},222:function(t,e,i){"use strict";i.d(e,"DESKTOP",(function(){return n}));var n={regularCard:{key:"desktop_regularCard_big",size:{width:378,height:210}},tileSite:{key:"desktop_siteTiles_big",size:{width:380,height:380}},articleHeader:{key:"article_header"}}},2222:function(t,e,i){"use strict";var n=i(43),o=i.n(n),s=i(599);e.default=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=Object(s.hextToRgb)(t),n=i.replace(/[()rgb]/g,"").split(","),r=s.rgbToHsl.apply(void 0,o()(n)),a=(r[0]-10||r[0]+10)>360||(r[0]-10||r[0]+10)<0,l=Object(s.hslToRgb)(a?20:r[0]-10,r[1],r[2]),c=Object(s.hslToRgb)(a?10:r[0]+10,r[1],r[2]),u="rgb(".concat(l[0],", ").concat(l[1],", ").concat(l[2],")"),d="rgb(".concat(c[0],", ").concat(c[1],", ").concat(c[2],")");return e?"radial-gradient(ellipse farthest-corner at center bottom, ".concat(u," 0%,").concat(d," 100%)"):[u,d]}},2223:function(t,e,i){"use strict";var n=i(1450);e.default=function(){var t=Object(n.getBeezyColors)();return t&&t[0]&&t[0].name}},2224:function(t,e,i){"use strict";e.default=function(){return window.beezySettings&&window.beezySettings.BeezyColors?JSON.parse(window.beezySettings.BeezyColors):[]}},2225:function(t,e,i){"use strict";var n=i(1450);e.default=function(t){var e=t.backgroundColor,i=Object(n.getBeezyColors)().find((function(t){return t.name===e}));return i&&i.value}},2226:function(t,e,i){"use strict";var n=i(35),o=i.n(n),s=i(23),r=i.n(s),a=i(2401);function l(){return(l=o()(r.a.mark((function t(e){var i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.from(e).getPalette();case 2:return i=t.sent,t.abrupt("return",i.Vibrant.getHex()||i.LightVibrant.getHex()||i.DarkVibrant.getHex()||i.DarkMuted.getHex()||i.Muted.getHex()||i.LightMuted.getHex());case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.default=function(t){return l.apply(this,arguments)}},2252:function(t,e,i){"use strict";var n=i(43),o=i.n(n);e.default=function(t){var e=!1,i=t.slice(t.startsWith("#")?1:0);return 3===i.length?i=o()(i).map((function(t){return t+t})).join(""):8===i.length&&(e=!0),i=parseInt(i,16),"rgb".concat(e?"a":"","(").concat(i>>>(e?24:16),", ").concat((i&(e?16711680:65280))>>>(e?16:8),", ").concat((i&(e?65280:255))>>>(e?8:0)).concat(e?", ".concat(255&i):"",")")}},2253:function(t,e,i){"use strict";e.default=function(t,e,i){var n=0,o=0,s=0,r=t,a=e/100,l=i/100;r<0&&(r=0),a<0&&(a=0),l<0&&(l=0),r>=360&&(r=359),a>1&&(a=1),l>1&&(l=1);var c=(1-Math.abs(2*l-1))*a,u=r/60,d=c*(1-Math.abs(u%2-1)),h=l-c/2;return u>=0&&u<1?(n=c,o=d):u>=1&&u<2?(n=d,o=c):u>=2&&u<3?(o=c,s=d):u>=3&&u<4?(o=d,s=c):u>=4&&u<5?(n=d,s=c):(n=c,s=d),[n=Math.round(255*(n+h)),o=Math.round(255*(o+h)),s=Math.round(255*(s+h))]}},2254:function(t,e,i){"use strict";e.default=function(t,e,i){var n,o,s=t/255,r=e/255,a=i/255,l=Math.max(s,r,a),c=Math.min(s,r,a),u=l-c,d=(l+c)/2;if(l===c)n=0,o=0;else{switch(o=u/(1-Math.abs(2*d-1)),l){case s:n=(r-a)/u+(r<a?6:0);break;case r:n=(a-s)/u+2;break;case a:n=(s-r)/u+4}n*=60}return[n,100*o,100*d]}},2255:function(t,e,i){"use strict";e.default=function(t){return"radial-gradient(ellipse farthest-corner at center bottom, ".concat(t[0]," 0%,").concat(t[1]," 100%)")}},2286:function(t,e,i){"use strict";var n=i(9);e.default=function(){return"(".concat(Object(n.getTranslation)("opens new browser tab"),")")}},2289:function(t,e,i){"use strict";var n=i(114),o=i.n(n),s=i(11),r=i.n(s),a=i(85),l=i.n(a),c=i(1),u=i.n(c),d=i(0),h=i.n(d),f=i(1036),p=i(32),m=i(899),g=i(900),v=i(901),b=i(902),y=i(395),C=i(9),w=i(229),T=i(2428),x=i(1713),O=void 0;var S={footer:x.default["container--centered"]},I=function(t){var e=t.buttonConfirmCategory,i=t.cancelMessage,n=t.centered,s=t.children,a=t.confirmMessage,d=t.descriptionHeader,h=t.disable,y=t.error,I=t.extraClasses,A=t.extraMargin,k=t.footer,P=t.header,E=t.loading,_=t.modalElem,j=t.modalType,D=t.onCancel,U=t.onClickOutside,M=t.onClose,L=t.onConfirm,N=t.onReturnFocus,R=t.scrollable,z=t.show,F=t.size,B=t.svgImage,$=t.title,V=t.typeIcon,H=t.viewBox,G=l()(t,["buttonConfirmCategory","cancelMessage","centered","children","confirmMessage","descriptionHeader","disable","error","extraClasses","extraMargin","footer","header","loading","modalElem","modalType","onCancel","onClickOutside","onClose","onConfirm","onReturnFocus","scrollable","show","size","svgImage","title","typeIcon","viewBox"]),W=Object(c.useState)(z),K=r()(W,2),q=K[0],J=K[1];Object(c.useEffect)((function(){z!==q&&J(z)}),[z,q]);var Q=function(t){t.stopPropagation(),"alert"===j?(M(t,O),J(!1)):M?M(t,O):J(!1)},Y=Object(f.default)(S,I),Z=u.a.createElement(u.a.Fragment,null,!!V&&u.a.createElement(p.I,{extraClasses:{icon:I.icon},typeIcon:V,viewBox:H}),!!B&&u.a.createElement(w.default,{extraClasses:{svg:I.svgImage},image:B}),!!$&&u.a.createElement("h3",{className:(I.title?I.title+" ":"")+"bz-title--1S3JGi"},$),!!d&&u.a.createElement("p",{className:(I.description?I.description+" ":"")+"bz-description--1S3JGi"},d)),X=u.a.createElement(T.default,{buttonConfirmCategory:e,cancelMessage:i,confirmMessage:a,disable:h,extraClasses:{button:I.button},loading:E,modalType:j,onCancel:function(t){t.stopPropagation(),D(t,O)},onConfirm:function(t){t.stopPropagation(),L(t,O)}});return q&&u.a.createElement(m.default,o()({},G,{extraClasses:Y,modalElem:_,onClickOutside:U,onClose:Q,onReturnFocus:N,size:F||"default"}),u.a.createElement(g.default,{error:y,extraClasses:{header:I.header},onClose:Q,showClose:!0,closeButtonTitle:Object(C.getTranslation)("Close")},P?P({styles:x.default,title:$}):Z),!!s&&u.a.createElement(v.default,{centered:n,extraClasses:{body:I.body},extraMargin:A,scrollable:R},s),u.a.createElement(b.default,{extraClasses:{footer:Y.footer}},k?k({defaultFooter:X}):X))};I.propTypes={buttonConfirmCategory:h.a.string,cancelMessage:h.a.string,centered:h.a.bool,children:h.a.oneOfType([h.a.arrayOf(h.a.node),h.a.node]),confirmMessage:h.a.string,descriptionHeader:h.a.string,disable:h.a.bool,error:h.a.string,extraClasses:h.a.shape({body:h.a.string,button:h.a.string,container:h.a.string,description:h.a.string,footer:h.a.string,header:h.a.string,icon:h.a.string,svgImage:h.a.string,title:h.a.string,wrapper:h.a.string}),extraMargin:h.a.bool,footer:h.a.func,header:h.a.func,loading:h.a.bool,modalElem:Object(y.HTMLElement)({isRequired:!0}),modalType:h.a.string,onCancel:h.a.func,onClickOutside:h.a.func,onClose:h.a.func,onConfirm:h.a.func,onReturnFocus:h.a.oneOfType([h.a.func,h.a.shape({})]),scrollable:h.a.bool,show:h.a.bool,size:h.a.string,svgImage:h.a.shape({url:h.a.string.isRequired,viewBox:h.a.string.isRequired}),title:h.a.string,typeIcon:h.a.string,viewBox:h.a.string},I.defaultProps={buttonConfirmCategory:"primary",cancelMessage:"",centered:!1,children:[],confirmMessage:"",descriptionHeader:"",disable:!1,error:"",extraClasses:{body:"",button:"",container:"",description:"",footer:x.default["container--centered"],header:"",icon:"",svgImage:"",title:"",wrapper:""},extraMargin:!1,footer:void 0,loading:!1,modalType:"base",onCancel:function(){},onClickOutside:function(){},onClose:function(){},onConfirm:function(){},onReturnFocus:null,scrollable:!1,show:!1,size:"",svgImage:null,title:"",typeIcon:"",viewBox:"0 0 24 24"},e.default=I},229:function(t,e,i){"use strict";var n=i(2415);e.default=n.default},2290:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(135),l=i(83),c=i(963),u=i(994);var d=function(t){var e=t.onChange,i=t.options;return o.a.createElement(a.default,{extraClasses:{list:u.default.list}},i.map((function(t){return o.a.createElement(l.default,{key:t.id,extraClasses:{listitem:u.default.item},data:{test:"[modals-alertModal].checkboxList-listItem"}},o.a.createElement(c.default,{checked:t.checked,extraClasses:{checkboxElement:u.default.checkbox,container:u.default["container--width"],label:u.default.label,input:u.default.input},id:"".concat(t.id),labelPosition:"right",labelText:t.text,onChange:function(i,n){return e(n,t.id)}}))})))};d.propTypes={onChange:r.a.func.isRequired,options:r.a.arrayOf(r.a.shape({id:r.a.number.isRequired,checked:r.a.bool.isRequired,text:r.a.string.isRequired})).isRequired},e.default=d},233:function(t,e,i){"use strict";i.r(e);var n={getObserverBackgroundImage:function(t){var e=t.root,i=void 0===e?null:e,n=t.rootMargin,o=void 0===n?"0px":n,s=t.threshold;return new IntersectionObserver((function(t,e){t.forEach((function(t){if(t&&t.isIntersecting){var i=t.target;i.style.backgroundImage=i.dataset.src,e.unobserve(i)}}))}),{root:i,rootMargin:o,threshold:void 0===s?0:s})},getObserverImage:function(t){var e=t.root,i=void 0===e?null:e,n=t.rootMargin,o=void 0===n?"0px":n,s=t.threshold;return new IntersectionObserver((function(t,e){t.forEach((function(t){if(t&&t.isIntersecting){var i=t.target;i.src=i.dataset.src,e.unobserve(i)}}))}),{root:i,rootMargin:o,threshold:void 0===s?0:s})}};e.default=n},234:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(1861),u=i(1863),d=i(2),h=i(773),f=i(293),p=i(1268),m=i(52),g=i(1105),v=i(166),b=i(294),y=i(12),C=i(7),w=i(303),T=i(8),x=i(46),O=i(956),S=i(295),I=i(15),A=i(5),k=i(37),P=i(38),E=i(350),_=i(17),j=i(51),D=i(306),U=i(30),M=i(88),L=i(53),N=i(281),R=i(1108);function z(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function F(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?z(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):z(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var B={texts:{confirmDelete:Object(d.translate)("This activity will be permanently deleted, OK?"),confirmDeleteComment:Object(d.translate)("This comment will be permanently deleted, OK?"),confirmDeleteLink:Object(d.translate)("You are about to remove the link. This action cannot be undone. Are you OK with that?"),confirmMoveToRecycleBin:Object(d.translate)("You are about to move this file to the Recycle Bin, which is restricted to Admin Access only. \r\n\r\nAre you really OK with this?"),confirmHide:Object(d.translate)("Hide this activity from newsfeed?"),confirmHideWithLikesAndComments:Object(d.translate)("Hide this activity from newsfeed? \n\n\nAll the related likes, files and comments will disappear too."),confirmHideAttachment:Object(d.translate)("Hide this file from newsfeed? \n\n\nAll the related likes and comments will disappear too."),votes:Object(d.translate)("See results"),results:Object(d.translate)("See votes"),resultsInit:Object(d.translate)("See votes"),myresults:Object(d.translate)("See my vote"),voteAndResults:Object(d.translate)("Vote and results"),loading:Object(d.translate)("Loading...")},domTool:{iconFeedbackAnimation:".icon-feedback-animation",more:".activity-tools__more",animationIcon:".js-animation-icon",animationIconPin:".js-animation-pin-icon",commentCount:".js-activity-tools-comments-count",likecount:".js-like-count",likeinfo:".js-like-icon",voteinfo:".js-info-votes",bestanswerinfo:".js-info-bestanswer",commentinfo:".js-comment-icon",tagCount:".js-activity-tools-tag-count",tagCountLabel:".js-tag-count",taginfo:".js-tag-icon",pollinfo:".js-poll-icon",pincommentinfo:".js-info-pincomment",pollButtonText:".js-pollbuttontext",commentsCount:".js-comments-count",votesCount:".js-votes-count"},classesTools:{voteClass:"vote-nonpoll-count",iconFeedbackAnimation:"icon-feedback-animation",iconToolHeart:"icon--tools-heart",iconToolHeartAct:"icon--tools-heart-active",isOpen:"is-open",iconToolChampion:"icon--tools-champion",iconToolChampionAct:"icon--tools-champion-active",iconToolPinComment:"icon--tools-pin",iconToolPinCommentAct:"icon--tools-pin-active"},toolsEvents:{altText:"altText",bookmark:"bookmark",edit:"edit",hideFromNews:"hideFromNews",highlight:"highlight",remove:"clear",report:"report",share:"share",createTask:"createTask"},events:{"click .js-tooltip-votes":"vote","click .js-tooltip-likes":"like","click .js-like-count":"showLikersDialog","click .js-comment-icon":"comments","click .js-comment-text":"comments","click .js-tag-icon":"tags","click .js-tagfilter":"filter","click .js-tooltip-pincomment":"pinComment","hover .js-info-votes":"getInfoVote","focus .js-info-votes":"getInfoVote","hover .js-info-bestanswer":"getInfoBestAnswer","focus .js-info-bestanswer":"getInfoBestAnswer","hover .js-like-icon":"getInfo","focus .js-like-icon":"getInfo","hover .js-comment-icon":"getInfoComment","focus .js-comment-icon":"getInfoComment","hover .js-poll-icon":"getInfoComment","focus .js-poll-icon":"getInfoComment","hover .js-like-count":"getLikes","focus .js-like-count":"getLikes","hover .js-tag-icon":"getInfoTag","focus .js-tag-icon":"getInfoTag","hover .js-info-pincomment":"getInfoPinComment","focus .js-info-pincomment":"getInfoPinComment","click [data-region=poll-button]":"toggle"},addMessage:function(t){var e=Object(L.sprintf)({string:Object(d.translate)("Newsfeed has been filtered by %filterName"),replacements:[t],pattern:/%filterName/gi});Object(M.addAssertiveMessage)(e)},filter:function(t){t.preventDefault(),t.stopPropagation();var e=t.currentTarget.title;this.addMessage(e),y.default.publish("drop","HideAllDrops"),y.default.publish("tagcloud","filter",e)},initializeFeedTools:function(t){this.likeProperty=this.model.has("CurrentUserLikedComment")?"CurrentUserLikedComment":"CurrentUserLikedActivity",this.likers=[],this.options=t||{},this.options.readOnly=this.options.readOnly||T.default.isToolReadOnly(this.model.get("Type")),this.model.attributes=l.a.extend(this.model.attributes,{showTextCommentLike:!0}),this.isSetModel=!1,this.helperActivity=new g.default(this.model.toJSON()),this.configTools(undefined)},initializeActivityTools:function(t){var e;if(this.helperActivity=new g.default(this.model.toJSON()),this.likeProperty=this.model.has("CurrentUserLikedComment")?"CurrentUserLikedComment":"CurrentUserLikedActivity",this.likers=[],this.options=t||{},!this.options.readOnly&&this.model.has("Group")&&this.model.get("Group").IsActive?this.options.readOnly=!this.model.attributes.Group.IsActive:this.options.readOnly=!1,this.destroyActivityCallback=this.options.destroyActivityCallback||this.destroyActivityCallback,this.model.isColleague()&&(e={comment:!1,like:!1,share:this.hasShare()}),this.options.parentActivity){var i=F(F({},this.options.parentActivity.context.tools),e);this.configToolsComments(i)}else this.configTools(e);y.default.subscribe("SignalR","commentAdded".concat(this.model.get("Id")),l.a.bind((function(t){var e=this._commentsView;e?e.collection.add(t.comment):this.incrementCommentsCount()}),this))},createTooltip:function(){this.likesTooltip=new k.default({el:this.$el.find(this.domTool.likecount).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"left"}),this.infoTooltip=new k.default({el:this.$el.find(this.domTool.likeinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.voteTooltip=new k.default({el:this.$el.find(this.domTool.voteinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.markBestAnswerTooltip=new k.default({el:this.$el.find(this.domTool.bestanswerinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.pinCommentTooltip=new k.default({el:this.$el.find(this.domTool.pincommentinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.commentTooltip=new k.default({el:this.$el.find(this.domTool.commentinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.tagTooltip=new k.default({el:this.$el.find(this.domTool.taginfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"}),this.pollTooltip=new k.default({el:this.$el.find(this.domTool.pollinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"})},recreatePinCommentTooltip:function(){this.pinCommentTooltip=new k.default({el:this.$el.find(this.domTool.pincommentinfo).get(0),text:'<span class="spinner-loading"></span>',horizontalPosition:"right"})},configTools:function(t){if(t=t||{},this.options.tools=this.options.tools||{},this.options.readOnly)this.context.tools=this.getExtendedTools({calendar:this.context.Type===C.default.Type.calendar,comment:!this.options.parentActivity&&(t.comment||this.options.tools.comment),share:this.hasShare(),tag:!0});else if("link"===this.options.feedType)this.context.tools=this.getExtendedTools({remove:T.default.isGroupOwner()||I.default.isBeezyAdministrator()||this.helperActivity.isActivityOwner(I.default.getCurrentUser())});else{var e;this.context.tools=F(F(F({},this.getExtendedTools({altText:null===(e=this.model.get("Attachments"))||void 0===e?void 0:e.some((function(t){return"image"===t.Subtype})),bookmark:!0,calendar:this.context.Type===C.default.Type.calendar,comment:!0,createTask:v.default.isAppsCloud()&&A.default.isEnableO365Tasks(),edit:this._hasEdit(),group:this.inGlobalPage,hideFromNews:this.displayHideTool,highlight:(T.default.isGroupOwner()||I.default.isBeezyAdministrator())&&this.isHighlightAllowed(this.context.Type),like:!0,remove:this.hasDelete(),report:beezySettings.EnableReportAbuse,share:this.hasShare(),tag:!0,timeago:!0})),t),this.options.tools)}this.context.toolsLabels={remove:"link"===this.options.feedType?"Remove":"Delete"},this.context.tools.hasChampion=this._hasChampion(this.model._type)},_hasEdit:function(){var t=this.model.get("Type");return t!==C.default.Type.DISCUSSION&&t!==C.default.Type.SHARE&&t!==C.default.AttachmentType.MEDIA&&t!==C.default.AttachmentType.DOCUMENT&&t!==C.default.Type.SHARE_APP&&((!Object(U.isSharepointModern)()||t!==C.default.Type.BLOG&&t!==C.default.Type.WIKI&&t!==C.default.Type.QUESTION&&t!==C.default.Type.COMMUNITY_QUESTION&&t!==C.default.Type.EXTENDEDIDEA)&&(this.helperActivity.isActivityOwner(I.default.getCurrentUser())||A.default.isEnableOwnerCanEditOtherActivities()&&(this.helperActivity.isGroupOwner()||T.default.isGroupOwner())||I.default.isBeezyAdministrator()))},hasDelete:function(){return this.helperActivity.isActivityOwner(I.default.getCurrentUser())||I.default.isBeezyAdministrator()||T.default.isGroupOwner()},hasShare:function(){return this.model.get("Type")!==C.default.Type.SHARE_APP||null},_hasChampion:function(t){return t===C.default.Type.EXTENDEDIDEA||t===C.default.Type.IDEA},isHighlightAllowed:function(t){var e=[C.default.Type.PRAISES,C.default.Type.EXTENDEDIDEA,C.default.Type.LINK,C.default.Type.POST,C.default.Type.SHARE,C.default.Type.SHARE_APP];return!l.a.some(e,(function(e){return e===t}))},getCommonTools:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{altText:t.altText||!1,bookmark:t.bookmark||!1,comment:t.comment||!1,createTask:t.createTask||!1,edit:t.edit||!1,group:t.group||!1,hasChampion:t.hasChampion||!1,highlight:t.highlight||!1,like:t.like||!1,markAsBestAnswer:t.markAsBestAnswer||!1,pinComment:t.pinComment||!1,remove:t.remove||!1,report:t.report||!1,share:t.share||!1,tag:t.tag||!1,timeago:t.timeago||!1,vote:t.vote||!1}},getExtendedTools:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return F(F({},this.getCommonTools(t)),{},{calendar:t.calendar||!1,hideFromNews:t.hideFromNews||!1})},configToolsComments:function(t){if(t=t||{},this.options.tools=this.options.tools||{},this.options.readOnly)this.context.tools=this.getCommonTools();else{var e=F(F(F({},t),this.getCommonTools({edit:this._hasEdit(),group:this.inGlobalPage,like:!0,pinComment:this.options.parentActivity&&(this.options.parentActivity.model.get("Owner").Id===I.default.getCurrentUserId()||I.default.isBeezyAdministrator())&&beezySettings.EnablePinnedComments&&!this.model.isCommunityAnswer(),remove:!0,report:beezySettings.EnableReportAbuse,timeago:!0})),this.options.tools);this.context.tools=this.getCommonTools(e)}},renderTools:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.context.toolsLabels?this.context.toolsLabels.remove||(this.context.toolsLabels.remove="Delete"):this.context.toolsLabels={remove:"Delete"},l.a.extend(this.context,t.tools={}),this.model.get("Type")===C.default.Type.POLL&&(this.context.TotalOfVotes=S.default.getTotalOfPeopleVoted(this.model)),this.tools=new c.default({el:this.region("tools").first(),activityView:this,context:this.context,model:this.model,hideMoreTools:t.hideMoreTools}),this.addToolsListeners(this.tools),this.tools.render(),this.updateLikeA11y(),this.updateCommentsA11y(),this.updateTagA11y(),this.updateVotesA11y(),this.listenTo(this,"vote",this.updateVotesA11y),this.model.hasChanged()){var e=this.tools.$el.find(".js-activity-tools-button");e&&(this.moreOptionsButton=e)}},addToolsListeners:function(t){l.a.each(this.toolsEvents,(function(e,i){this.listenTo(t,i,this[e])}),this)},createTags:function(){var t=new u.default({el:this.viewPlaceholder("tags"),model:this.model});return this.addView("tags",t),this.listenTo(t,"filterTag",this.filterTag),t},like:function(t){if(t.preventDefault(),t.stopPropagation(),I.default.isReadOnly())return _.default.showReadOnlyModal();this.model.get("Activity")&&this.setModelActivity(),this._like(t.currentTarget),this.updateLike(),this.model.get("isViewPinComment")?this.model.get("likedFromComment")||this.trigger("liked",this.model):this.model.get("likedFromPin")||this.trigger("likedPin",this.model.get("ActivityId"),this.model.get("Id"),this.model.isLiked(),this.model.get("TotalOfLikes"))},vote:function(t){if(t.preventDefault(),t.stopPropagation(),I.default.isReadOnly())return _.default.showReadOnlyModal();this._like(t.currentTarget),this.updateVote()},pinComment:function(t){if(t.preventDefault(),t.stopPropagation(),I.default.isReadOnly())return _.default.showReadOnlyModal();this._pinComment(!1),this.updatePinComment()},comments:function(t){if(t.preventDefault(),t.stopPropagation(),!this.model.commentsCount()>0&&I.default.isReadOnly())return _.default.showReadOnlyModal();this.model.get("Activity")&&this.setModelActivity(),this.isDetail?this.toggleComment():(this._tagsView&&(this._tagsView.hide(),this.removeIsOpen(this.domTool.tagCount)),this.updateComment())},setModelActivity:function(){if(!this.isSetModel){var t=m.default.ActivityRepository(this.model.get("Activity"));this.model=t,this.isSetModel=!0}},tags:function(t){t.preventDefault(),t.stopPropagation(),this.model.get("Activity")&&this.setModelActivity(),this._commentsView&&(this._commentsView.hide(),this.removeIsOpen(this.domTool.commentCount)),this.afterUpdateTagRender()},removeIsOpen:function(t){this.$el.find(t).removeClass(this.classesTools.isOpen)},afterUpdateTagRender:function(){this.updateTagAnimation()},updateTagAnimation:function(t){var e=this._tagsView;e?(e[e.hidden?"show":"hide"](),e.hidden?this.$(this.domTool.tagCount).removeClass(this.classesTools.isOpen):this.$(this.domTool.tagCount).addClass(this.classesTools.isOpen)):((e=this.createTags()).render(),this.$(this.domTool.tagCount).addClass(this.classesTools.isOpen)),t&&this.trackEvent(this.model,"tag",t.currentTarget),this.$el.find(this.domTool.taginfo).attr("aria-expanded",!e.hidden)},updateTagA11y:function(){var t=this.model.get("TotalOfTags"),e=this.$el.find(this.domTool.tagCountLabel);this.updateCountMessage("js-message-tag-count-hidden","%d tags",t,e)},updateComment:function(){this.afterUpdateCommentRender()},afterUpdateCommentRender:function(){this.updateCommentAnimation()},updateCommentAnimation:function(t){var e=this._commentsView;e?(e[e.hidden?"show":"hide"](),e.hidden?this.$(this.domTool.commentCount).removeClass(this.classesTools.isOpen):this.$(this.domTool.commentCount).addClass(this.classesTools.isOpen)):(this.createComments(),this._commentsView.fetch(),this.$(this.domTool.commentCount).addClass(this.classesTools.isOpen),(e=this._commentsView).show(),e.on("reply:loaded",(function(t){t.focus()}))),t&&this.trackEvent(this.model,"comment",t.currentTarget),this.$el.find(this.domTool.commentinfo).attr("aria-expanded",!e.hidden)},createComments:function(){throw new Error("createComments must be implemented")},updateLike:function(){this.$(this.domTool.animationIcon).first().addClass(this.classesTools.iconFeedbackAnimation),this.afterUpdateLikeRender()},afterUpdateLikeRender:function(){var t=this;!this.$(this.domTool.iconFeedbackAnimation).length||r.a.browser.msie&&Number(r.a.browser.version)<10?(t.updateLikeAnimation(),t.updateLikeA11y()):setTimeout((function(){t.$(t.domTool.iconFeedbackAnimation).one("webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend",(function(){t.$(t.domTool.animationIcon).removeClass(t.classesTools.iconFeedbackAnimation),t.updateLikeAnimation(),t.updateLikeA11y()}))}),10)},updateLikeAnimation:function(){this.$like=this.region("like-count").first(),this.$liketext="start"===beezyContext.CurrentPageKey&&"card"===this.activityViewMode?"":this.region("like-text").first();var t=this.model.get("TotalOfLikes"),e=this.model.get(this.likeProperty),i=t>0?t:"",n=this.$(this.domTool.animationIcon).first();if(this.context.tools.hasChampion?e?(n.removeClass(this.classesTools.iconToolChampion),n.addClass(this.classesTools.iconToolChampionAct)):(n.removeClass(this.classesTools.iconToolChampionAct),n.addClass(this.classesTools.iconToolChampion)):e?(n.removeClass(this.classesTools.iconToolHeart),n.addClass(this.classesTools.iconToolHeartAct)):(n.removeClass(this.classesTools.iconToolHeartAct),n.addClass(this.classesTools.iconToolHeart)),this.$like.html(i),""!==this.$liketext)if(this.context.tools.hasChampion){var o=Object(d.translate)(e?"Unchampion":"Champion");this.$liketext.html(o)}else{var s=Object(d.translate)(e?"Unlike":"Like");this.$liketext.html(s)}},updateLikeA11y:function(){this.$like=this.region("like-count").first();var t=this.model.get("TotalOfLikes"),e=this.model.get(this.likeProperty),i=t>0?t:"",n=this.$el.find(this.domTool.likeinfo);if(n.length){if(n.attr("aria-pressed",e?e.toString():"false"),this.context.tools.hasChampion){var o=Object(d.translate)(e?"Unchampion":"Champion");n.attr("aria-label",o)}else{var s=Object(d.translate)(e?"Unlike":"Like");n.attr("aria-label",s)}this.context.tools.hasChampion?this.updateCountMessage("js-message-like-count-hidden","%d champions",i,this.$like):this.updateCountMessage("js-message-like-count-hidden","%d likes",i,this.$like)}},updateVote:function(){this.$(this.domTool.animationIcon).addClass(this.classesTools.iconFeedbackAnimation),this.afterUpdateVoteRender()},afterUpdateVoteRender:function(){var t=this;!this.$(this.domTool.iconFeedbackAnimation).length||r.a.browser.msie&&Number(r.a.browser.version)<10?(t.updateVoteAnimation(),t.updateVotesA11y(),t.trigger("voted",this.model)):setTimeout((function(){t.$(t.domTool.iconFeedbackAnimation).one("webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend",(function(){t.$(t.domTool.animationIcon).removeClass(t.classesTools.iconFeedbackAnimation),t.updateVoteAnimation(),t.updateVotesA11y(),t.trigger("voted",t.model)}))}),10)},getVotes:function(){var t=0;return this.model.get("_type")===C.default.Type.POLL?t=S.default.getTotalOfPeopleVoted(this.model):this.model.get("_type")===C.default.Type.ACTIVITY_ANSWER&&(t=this.model.get("TotalOfLikes")),t},updateVoteAnimation:function(){var t=this.region(this.classesTools.voteClass).first(),e=this.getVotes(),i=this.model.get(this.likeProperty),n=e>0?e:"";t.html("".concat(n," ").concat(Object(d.translate)(i?"Unvote":"Vote up")))},updateVotesA11y:function(t){var e=void 0!==t?t:this.getVotes(),i=this.$el.find(this.domTool.likecount);this.updateCountMessage("js-message-votes-count-hidden","%d votes",e,i);var n=this.$el.find(this.domTool.voteinfo),o=this.model.get(this.likeProperty);n.length&&n.attr("aria-label",Object(d.translate)(o?"Unvote":"Vote")).attr("aria-pressed",o.toString()).trigger("blur")},updatePinComment:function(){this.$(this.domTool.animationIconPin).addClass(this.classesTools.iconFeedbackAnimation),this.$(this.domTool.pincommentinfo).attr("aria-label",Object(d.translate)(this.isPinComment?"Unpin":"Pin")).trigger("blur"),this.afterUpdatePinCommentRender()},afterUpdatePinCommentRender:function(){var t=this;!this.$(this.domTool.iconFeedbackAnimation).length||r.a.browser.msie&&Number(r.a.browser.version)<10?t.updatePinCommentAnimation():setTimeout((function(){t.$(t.domTool.iconFeedbackAnimation).one("webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationend",(function(){t.$(t.domTool.animationIconPin).removeClass(t.classesTools.iconFeedbackAnimation),t.updatePinCommentAnimation()}))}),10)},updatePinCommentAnimation:function(){this.$pintext=this.region("pincomment-text").first(),this.isPinComment?(this.$(this.domTool.animationIconPin).first().removeClass(this.classesTools.iconToolPinComment),this.$(this.domTool.animationIconPin).first().addClass(this.classesTools.iconToolPinCommentAct)):(this.$(this.domTool.animationIconPin).first().removeClass(this.classesTools.iconToolPinCommentAct),this.$(this.domTool.animationIconPin).first().addClass(this.classesTools.iconToolPinComment)),this.$pintext.html(Object(d.translate)(this.isPinComment?"Unpin":"Pin")),this.trigger("pinComment",this.model.get("ActivityId"),this.isPinComment,this.model.id)},_like:function(t){var e,i=this.model.get(this.likeProperty),n=this.model.get("TotalOfLikes"),o={};i?((!beezySettings.EnablePinnedComments||!this.context.tools.pinComment&&beezySettings.EnablePinnedComments||!this.isPinComment&&!this.model.get("isViewPinComment")||this.model.get("isViewPinComment"))&&this.model.unlike(),o.TotalOfLikes=n&&n-1,e="unlike",this.removeSelfLiker(),"ideadetails"!==beezyContext.CurrentPageKey||r()(t).hasClass("icon--tools-heart")||y.default.publish("ideascampaigndetails","championChange",{championed:!1})):((!beezySettings.EnablePinnedComments||!this.context.tools.pinComment&&beezySettings.EnablePinnedComments||!this.isPinComment&&!this.model.get("isViewPinComment")||this.model.get("isViewPinComment"))&&this.model.like(),o.TotalOfLikes=n+1,e="like",this.addSelfLiker(),"ideadetails"!==beezyContext.CurrentPageKey||r()(t).hasClass("icon--tools-heart")||y.default.publish("ideascampaigndetails","championChange",{championed:!0})),o[this.likeProperty]=!i,this.model.set(o,{silent:!0}),y.default.publish("activity",e,this.model.get("Type")),this.trackEvent(this.model,e,t)},_pinComment:function(t){this.isPinComment=!this.isPinComment;var e=this.options.parentActivity;e&&e.model.setMetadata("pinComment",this.isPinComment?this.model.id:0),t||(this.isPinComment?this.model.pinComment():this.model.unpinComment())},addSelfLiker:function(){this.likers.unshift(I.default.getCurrentUser())},removeSelfLiker:function(){var t=l.a.find(this.likers,(function(t){return t.Id===I.default.getCurrentUserId()}));this.likers=l.a.without(this.likers,t)},bookmark:function(t){this.publish(t?"bookmark":"unbookmark")},edit:function(t){var e=this,i=t.onCloseModal,n=this;new O.default({model:this.model,partialOptions:{numberOptions:this.model.get("Type")===C.default.Type.POLL?this.model.get("Comments").length:null,isFormReadOnly:this.model.get("Type")===C.default.Type.POLL},onClose:function(){return i(e.moreOptionsButton)}}).on("success",(function(t){e._commentsView&&(e._commentsView.hide(),e._commentsView.remove(),e._commentsView=null),l.a.extend(e.model,{_metadata:t._metadata||{},_metadataProperties:t._metadataProperties||[]}),e.model.set(t),"calendar"===n.feedType&&n.render(),e.model.get("isPinComment")&&y.default.publish("pinComment","edit",t,e.model.get("isViewPinComment"))}))},highlight:function(t){this.publish(t?"highlight":"unhighlight")},share:function(t){var e=t.onCloseModal,n=document.getElementById("modal-share"),o=this.model.toJSON(),s=this,r=o=o.SharedActivity?o.SharedActivity:o,a=r.Activity,l=r.Attachments,c=r.Authors,u=r.BackgroundImageUrl,h=r.Channels,f=r.Created,p=r.FileName,m=r.Group,g=r.Id,v=r.ImageCroppingIds,b=r.LCID,C=r.Mentions,w=r.Message,x=r.MetadataProperties,O=r.Owner,S=r.Title,I=r.Type,A=r.VideoUrl,k=this.keyCloseModal.bind(this),U=E.default.parseMessageAsPlainText(w,C),M="poll"!==I?U:null;var L,N=F(F(F(F(F(F({id:"document"===I&&null!=a&&a.Id?a.Id:g,title:function(){var t;switch(I){case"document":return(null==l||null===(t=l[0])||void 0===t?void 0:t.FileName)||p;case"poll":return U;default:return S}}(),message:M,url:_.default.getShareFullUrl(o),lcid:b,author:function(){if(m&&("EditorialModule"===m.Type||"CorporateModule"===m.Type)){var t=c.find((function(t){return t.IsPublic}));return t?{fullName:t.FullName,id:t.Id,pictureUrl:t.PictureUrl}:null}return O?{fullName:O.FullName,id:O.Id,lastUpdated:O.LastUpdated,pictureUrl:O.PictureUrl}:null}(),createDate:Object(j.getDateFromJSON)(f)},h&&{channels:(L=h,L.map((function(t){return{id:t.Id,title:t.Title,isRestricted:t.IsRestricted}})))}),m&&"EditorialModule"!==m.Type&&"CorporateModule"!==m.Type&&{place:{title:m.Title,url:m.Url}}),m&&h&&h.length&&("EditorialModule"===m.Type||"CorporateModule"===m.Type)&&{place:{title:h[0].Title,url:"CorporateModule"===m.Type?"".concat(h[0].Url,"/SitePages/Topic.aspx?topicId=").concat(h[0].Id):"".concat(h[0].Url,"/SitePages/Channel.aspx?ChannelId=").concat(h[0].Id)}}),{},{type:I,backgroundImageUrl:u},x&&{metadataProperties:x.map((function(t){return{name:t.Name,value:t.Value}}))}),A&&{videoUrl:A}),v&&{imageCroppingIds:v});T.default&&s.context.Group&&(T.default.isPublic()||T.default.isModerated()||s.context.Group.IsModerated||s.context.Group.IsPublic)?i.e(171).then(i.bind(null,1185)).then((function(t){var i=t.default;P.default.renderComponent(n,i,{sharedData:N,activityDetailUrl:N.url,onCloseModal:function(){return P.default.unMountComponent(document.getElementById("modal-share"))},onConfirm:function(){return y.default.publish("share","shared")},handleCreateMicrobox:D.createRenderMicrobox,onReturnFocus:e})})):i.e(171).then(i.bind(null,3711)).then((function(t){var e=t.default;P.default.renderComponent(n,e,{onKeyClose:k,onCancel:function(){return P.default.unMountComponent(document.getElementById("modal-share"))},textInfo:Object(d.translate)("This content is restricted. Be mindful when sharing."),onClickOutside:function(){return P.default.unMountComponent(document.getElementById("modal-share"))},enableCloseOnEsc:!0,sharedDataUrl:N.url})}))},altText:function(t){var e=this,n=t.onCloseModal,o=this.model.toJSON(),s=o.Attachments.filter((function(t){return"image"===t.Subtype})).map((function(t){var e=t.Id;return{description:t.Description,id:e,url:t.Url}})),r={id:o.Id,images:s,type:"activities"};if(this.handleConfirm=l.a.bind((function(t){var i=e.model.get("Attachments").map((function(e){var i=null==t?void 0:t.find((function(t){return t.id===e.Id}));return F(F({},e),i&&{Description:i.description})}));e.model.set("Attachments",i),y.default.publish("altText","SetModel",i)}),this),s){var a=document.getElementById("modal-alt-text");i.e(8).then(i.bind(null,2126)).then((function(t){var i=t.default;P.default.renderComponent(a,i,{activity:r,onCancel:function(){return P.default.unMountComponent(document.getElementById("modal-alt-text"))},onConfirm:function(t){return e.handleConfirm(t)},onReturnFocus:n})}))}},createTask:function(t){var e=this,n=t.onCloseModal;function o(t){var e,i=t.get("Type"),n=t.get("Mentions")||[];switch(i){case C.default.Type.ACTIONCARD:case C.default.Type.ADAPTIVECARD:e=Object(d.translate)("Action card follow up task");break;case C.default.Type.BLOG:case C.default.Type.CALENDAR:case C.default.Type.DISCUSSION:case C.default.Type.EXTENDEDIDEA:case C.default.Type.IDEA:case C.default.Type.ITEM:case C.default.Type.QUESTION:case C.default.Type.TASK:case C.default.Type.WIKI:e=t.get("Title");break;case C.default.Type.DOCUMENT:e=t.get("FileName")||t.get("Attachments")[0].FileName;break;case C.default.Type.POLL:case C.default.Type.POST:case C.default.Type.PRAISES:case C.default.Type.SHARE:case C.default.Type.SHARE_APP:e=t.get("Message");break;default:e=t.get("Title")||t.get("Message")}return null!=n&&n.length?E.default.parseMessageAsPlainText(e,n):e}var s=Object(N.createModalContainer)({id:"modal-create-task-container"}),r=Object(R.getGraphAuthHandlerUrl)();i.e(39).then(i.bind(null,3077)).then((function(t){var i,a=t.default;P.default.renderComponent(s,a,{microsoftGraphAuthHandlerUrl:r,onCancel:function(){P.default.unMountComponent(s),n()},taskData:{activityId:e.model.get("Id"),title:o(e.model),activityUrl:_.default.getShareFullUrl(null===(i=e.model)||void 0===i?void 0:i.attributes)}})}))},keyCloseModal:function(){this.$el.find(this.domTool.more).get(0).focus()},hideFromNews:function(){var t=this.context.TotalOfComments+this.context.Attachments.length+this.context.TotalOfLikes>0?this.texts.confirmHideWithLikesAndComments:this.texts.confirmHide;t="document"!==this.context.Type?t:this.texts.confirmHideAttachment,window.confirm(t)&&(this.model.hideFromNews(),this.dispose(),this.trigger("clear"))},getWikiRootPage:function(){return null!==beezyCurrentGroup?l.a.find(beezyCurrentGroup.NavigationLinks,(function(t){return t.ActivityType===C.default.Type.WIKI})):""},clear:function(t){var e=this,i=t.onCloseModal,n=this.model.get("Type"),o=Object(d.translate)("activityComment"===this.model.get("_type")?this.texts.confirmDeleteComment:this.texts.confirmDelete);if(this.isPinComment)window.confirm(o)&&(this._pinComment(!0),this.trigger("pinComment",this.model.get("ActivityId"),this.isPinComment,this.model.id),this.trigger("deletePin"));else if("activityComment"!==this.model.get("_type")&&"activityAnswer"!==this.model.get("_type")){var s,r,a,l;if(n===C.default.Type.WIKI&&this.getWikiRootPage()===beezyContext.BaseSiteHost+this.model.get("RelatedItem").Url)alert(Object(d.translate)("The wiki page is the root of your wiki and cannot be deleted."));else if(w.default.isLinksPage()){var c={data:JSON.stringify({Id:this.model.get("Id")}),attachmentId:this.model.id,visibility:!0};this.model.validateAndDestroy(c,this.texts.confirmDeleteLink,(function(){e.$el.remove()}))}else if("document"===this.feedType||"directory"===this.feedType&&null!=this&&null!==(s=this.model)&&void 0!==s&&null!==(r=s.collection)&&void 0!==r&&r.filtered){var u={data:JSON.stringify({Id:this.model.get("ActivityId")}),attachmentId:this.model.id};this.model.validateAndDestroy(u,this.texts.confirmMoveToRecycleBin,(function(){e.dispose(),e.trigger("clear")}))}else if("directory"!==this.feedType||null!=this&&null!==(a=this.model)&&void 0!==a&&null!==(l=a.collection)&&void 0!==l&&l.filtered){var h=Object(b.default)({model:this.model,listPageUrl:this.isDetail?this.getListPage(T.default.getNavigationLinks(),n):"",componentItems:n===C.default.AttachmentType.MEDIA||n===C.default.AttachmentType.DOCUMENT?[{value:0,label:Object(d.translate)("All newsfeed activity will be deleted (comments, likes and tags)"),checked:!1}]:void 0,onClose:i});h.on("itemRemoved",(function(){e.dispose(),e.trigger("clear"),h.dialog.hide()}))}else{var f,p,m={data:JSON.stringify({Id:null===(f=this.model.get("Activity"))||void 0===f?void 0:f.Id}),attachmentId:null===(p=this.model.get("Attachment"))||void 0===p?void 0:p.Id};this.model.validateAndDestroy(m,this.texts.confirmMoveToRecycleBin,(function(){e.dispose(),e.trigger("clear")}))}}else window.confirm(o)&&this.destroyActivity()},getListPage:function(t,e){var i="";l.a.each(t,(function(t){e===t.ActivityType&&(i=t.Url)}));var n=this.model.get("Group")?this.model.get("Group").Url:"";return""!==i?i:A.default.getBaseSiteHost()+n},report:function(t){var e=t.onCloseModal,i=F(F({},this.options),{},{onCloseModal:e});Object(p.default)(I.default.getCurrentUser(),this.model.toJSON(),i)},destroyActivity:function(){var t={Id:this.model.id};this.options.parentActivity&&l.a.extend(t,{ActivityId:this.options.parentActivity.model.id}),this.model.get("Type")===C.default.Type.DOCUMENT&&this.model.get("Activity")&&this.model.get("Activity").Type!==C.default.Type.DOCUMENT&&l.a.extend(t,{attachmentId:t.Id});var e=l.a.bind(this.destroyActivityCallback,this);this.model.validateAndDestroy({data:JSON.stringify(t)},null,e,!0)},destroyActivityCallback:function(){beezyContext.CurrentActivity?"activityComment"!==this.model.get("_type")?(window.history.length>1?function(){window.history.back()}:function(){window.location=x.default.getGroupUrl()})():this.$el.remove():(y.default.publish("activity","destroy",this.model),this.dispose(),this.trigger("clear"))},getLikes:function(t){var e=this;t.stopPropagation(),this.model.get("Activity")&&this.setModelActivity(),this.model.getlikes().then((function(t){e.likers=l.a.pluck(t,"Owner"),e.showLikers(e.likers)}))},getInfo:function(t){t.stopPropagation();var e=this.model.get(this.likeProperty);this.showInfo(this.model.get("Type"),e)},getInfoComment:function(t){t.stopPropagation();var e=this.model.get("Type"),i=e===C.default.Type.QUESTION?Object(d.translate)("Answer"):e===C.default.Type.POLL?""===this.$el.find(this.domTool.pollButtonText).text().trim()?Object(d.translate)("See votes"):this.$el.find(this.domTool.pollButtonText).text().trim():Object(d.translate)("Comment");"poll"===e?this.pollTooltip&&(this.pollTooltip.message(i),this._recalculateTooltipPosition("pollTooltip")):this.commentTooltip&&(this.commentTooltip.message(i),this._recalculateTooltipPosition("commentTooltip"))},getInfoTag:function(t){t.stopPropagation(),this.tagTooltip&&(this.tagTooltip.message(Object(d.translate)("Tag")),this._recalculateTooltipPosition("tagTooltip"))},getInfoPinComment:function(t){var e,i;t.stopPropagation();var n=(null===(e=this.model.get("parentActivity"))||void 0===e?void 0:e.MetadataProperties)||this.model.get("MetadataProperties"),o=parseInt(null===(i=n.find((function(t){return"pinComment"===t.Name})))||void 0===i?void 0:i.Value,10)||0;this.recreatePinCommentTooltip(),this.pinCommentTooltip.message(Object(d.translate)(0!==o?"Unpin":"Pin")),this._recalculateTooltipPosition("pinCommentTooltip")},getInfoVote:function(t){t.stopPropagation();var e=this.model.get(this.likeProperty);this.voteTooltip&&(this.voteTooltip.message(Object(d.translate)(e?"Unvote":"Vote")),this._recalculateTooltipPosition("voteTooltip"))},getInfoBestAnswer:function(t){t.stopPropagation();var e=this.model.get("parentActivity").MetadataProperties,i=!1;e.length>0&&(i=l.a.find(e,(function(t){return"bestAnswer"===t.Name})).Value),this.markBestAnswerTooltip&&(this.markBestAnswerTooltip.message(Object(d.translate)(i.toString()===this.model.id.toString()?"Unmark as best answer":"Mark as best answer")),this._recalculateTooltipPosition("markBestAnswerTooltip"))},showInfo:function(t,e){var i=t&&this._hasChampion(t)?Object(d.translate)(e?"Unchampion":"Champion"):Object(d.translate)(e?"Unlike":"Like");this.infoTooltip&&(this.infoTooltip.message(i),this._recalculateTooltipPosition("infoTooltip"))},showLikersDialog:function(t){if(t.stopPropagation(),this.likers.length>0){var e={};if(this.model.get("Type")===C.default.Type.IDEA)e={title:Object(d.translate)("People who champion this idea")};Object(h.default)(this.likers,e,this.$el.find(this.domTool.likecount))}},showLikers:function(t){t=t.concat();var e=r()("<ul/>"),i=t.splice(10,t.length-10);t.forEach((function(t){r()("<li/>").text(t.FullName).appendTo(e)})),i.length&&r()("<li/>").text(Object(d.sprintf)(Object(d.translate)("and %d more..."),i.length)).appendTo(e),this.likesTooltip&&(this.likesTooltip.message(e),this._recalculateTooltipPosition("likesTooltip"))},toggleComment:function(){this.trigger("toggleComment")},commentsCount:function(){return this.model.commentsCount()},incrementCommentsCount:function(){this.updateCommentsCount(this.commentsCount()+1)},decrementCommentsCount:function(){this.updateCommentsCount(this.commentsCount()-1)},updateCommentsCount:function(t){this.model.set({TotalOfComments:t},{silent:!0}),this.model.get("showTextCommentLike")?t?(this.$commentsCount.find(this.domTool.commentsCount).html(t),this.$commentsCount.show()):(this.$commentsCount.find(this.domTool.commentsCount).html(""),this.$commentsCount.show()):this.$commentsCount.find(this.domTool.commentsCount).html(t||""),this.updateCommentsA11y(t)},updateCommentsA11y:function(t){var e=t||this.model.get("TotalOfComments"),i=this.$el.find(this.domTool.commentsCount);this.model.get("Type")===C.default.Type.QUESTION?this.updateCountMessage("js-message-answers-count-hidden","%d answers",e,i):this.updateCountMessage("js-message-comments-count-hidden","%d comments",e,i)},updateCountMessage:function(t,e,i,n){if(i){var o=n.parent().find(".".concat(t));o&&0!==o.length||(o=r()("<span>").addClass("visually-hidden ".concat(t))),o.text(Object(d.sprintf)(Object(d.translate)(e),i)),n.before(o),n.attr("aria-hidden","true")}else this.deleteCountMessage(".".concat(t))},deleteCountMessage:function(t){var e=this.$(t);e&&e.length>0&&e.remove()},_recalculateTooltipPosition:function(t){if(!t)throw Error("You must provide a toolTipType");this[t].active&&this[t].showTool()}};l.a.defaults(B,f.default),e.default=B},2358:function(t,e,i){"use strict";var n=i(113),o=i(2359),s=i.n(o),r=i(13).default.extend({template:s.a,events:{"click .js-request":"requestMembership"},initialize:function(t){this.options=t,this.model=this.model?this.model:new n.default(this.options),this.requestSent=!1,this.spinnerTemplate='<span class="comm-feed-spinner js-feed-spinner"><span class="spinner-typing--grey"></span></span>'},render:function(){var t=this.template({requestSent:this.requestSent});return this.$el.html(t),this},getEntity:function(){return!1},requestMembership:function(t){var e=this;t.preventDefault(),this.$(".js-feed-options").append(this.spinnerTemplate),this.model.requestMembership().then((function(){e.requestSent=!0,e.render(),e.trigger("request")}),(function(){e.$(".js-feed-spinner").remove()}))}});e.default=r},2360:function(t,e,i){"use strict";var n=i(24),o=i.n(n),s=i(3),r=i.n(s),a=i(4),l=i.n(a),c=i(2),u=i(7),d=i(107),h=i(267),f=i(2361),p=i.n(f),m=i(13),g=i(15),v=i(17),b=i(954),y=i(5);function C(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function w(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?C(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var T=u.default.Type,x=m.default.extend({template:p.a,events:{"click .js-altText":"altText","click .js-bookmark":"bookmark","click .js-calendar":"calendar","click .js-edit":"edit","click .js-edit-tags":"editTags","click .js-hide":"hideFromNews","click .js-highlight":"highlight","click .js-remove":"remove","click .js-create-task":"createTask","click .js-report":"report","click .js-share":"share"},initialize:function(t){this.options=t,this.renderer=!1,this.collection=this.getCollection(),this.type=this.options.context.parentActivity?T.POST:"activity","comment"===this.type?this.collection.activityId=this.options.context.parentActivity.Id:(this.collection.activityId=this.options.context.Activity?this.options.context.Activity.Id:this.options.context.Id,this.options.context.Type===T.DOCUMENT&&this.options.context.Activity&&this.options.context.Activity.Id!==this.options.context.Id&&(this.collection.attachmentId=this.options.context.Id))},altText:function(){var t=this;if(g.default.isReadOnly())return v.default.showReadOnlyModal();this.trigger("altText",{onCloseModal:function(){return t.options.targetOrigin.focus()}})},bookmark:function(t){if(t.preventDefault(),g.default.isReadOnly())return v.default.showReadOnlyModal();var e;e=this.model._type===T.DOCUMENT?!this.model.get("Activity").CurrentUserMarkAsFavorite:!this.model.get("CurrentUserMarkAsFavorite"),this.model.set({CurrentUserMarkAsFavorite:e},{silent:!0}),this.model.bookmark(),this.toggleBookmark(e),this.trackEvent(this.model,"bookmark",t.currentTarget)},calendar:function(){if(g.default.isReadOnly())return v.default.showReadOnlyModal();this.trigger("calendar")},edit:function(t){var e=this;if(t.preventDefault(),g.default.isReadOnly())return v.default.showReadOnlyModal();this.trigger("edit",{onCloseModal:function(t){return t?t.focus():e.options.targetOrigin.focus()}}),this.trackEvent(this.model,"edit",t.currentTarget)},editTags:function(t){if(t.preventDefault(),g.default.isReadOnly())return v.default.showReadOnlyModal();this.trigger("editTags")},getCollection:function(){return"document"===this.options.context.Type&&this.options.context.Activity&&this.options.context.Activity.Id!==this.options.context.Id?new d.default.Document:new d.default.Community},hideFromNews:function(t){if(t.preventDefault(),t.stopPropagation(),g.default.isReadOnly())return v.default.showReadOnlyModal();this.trackEvent(this.model,"hideActivity",t.currentTarget),this.trigger("hideFromNews")},highlight:function(t){if(t.preventDefault(),g.default.isReadOnly())return v.default.showReadOnlyModal();var e=!this.model.get("Highlighted");this.model.set({Highlighted:e},{silent:!0}),this.model.highlight(),this.toggleHighlight(e),this.trackEvent(this.model,"highlight",t.currentTarget)},share:function(t){var e=this;if(t.preventDefault(),g.default.isReadOnly())return v.default.showReadOnlyModal();this.trigger("share",{onCloseModal:function(){return e.options.targetOrigin.focus()}}),this.trackEvent(this.model,"share",t.currentTarget)},remove:function(t){var e=this;if(t.preventDefault(),t.stopPropagation(),g.default.isReadOnly())return v.default.showReadOnlyModal();this.trackEvent(this.model,"deleteActivity",t.currentTarget),this.trigger("remove",{onCloseModal:function(){return e.options.targetOrigin.focus()}})},createTask:function(t){var e=this;t.preventDefault(),this.trigger("createTask",{onCloseModal:function(){return e.options.targetOrigin.focus()}})},report:function(t){var e=this;if(t.preventDefault(),g.default.isReadOnly())return v.default.showReadOnlyModal();var i=l()(t.currentTarget).offset().top;y.default.isSharepointApp()?this.trigger("report",{topCurrentElement:i,onCloseModal:function(){return e.options.targetOrigin.focus()}}):this.trigger("report",{onCloseModal:function(){return e.options.targetOrigin.focus()}})},render:function(t){var e=t.toJSON();e.Group=e.Group||beezyCurrentGroup,this.options.context.UrlLayout=y.default.getBaseWebUrl()+y.default.getUrlLayout(),this.options.context.ApiQueryString=y.default.isSharepointApp()?"&".concat(beezySettings.ApiServiceV2QueryString):"";var i=g.default.isReadOnly(),n=w(w({},this.options.context),{},{isReadOnly:i});"mysite"===beezyContext.CurrentPageKey&&"media"===n.Type||(n=r.a.extend(this.options.context,e)),"document"===n.Type&&"files"!==beezyContext.CurrentPageKey&&(n.Attachments.length>0?n.Highlighted=n.Attachments[0].Highlighted:(n.tools.bookmark=!1,n.tools.share=!1,n.tools.highlight=!1)),n.Owner||(n.Owner=n.Activity.Owner),n.Group&&-1!==n.Group.GroupId||(n.Group=n.Activity&&n.Activity.Group),"start"!==beezyContext.CurrentPageKey&&"mysite"!==beezyContext.CurrentPageKey||(n.tools.calendar=!1);var o=this.template(n);return this.$el.html(o),this.listenTo(this.model,"change:CurrentUserMarkAsFavorite",this.publishBookmark),this.listenTo(this.model,"change:Highlighted",this.publishHighlight),this.renderer=!0,this},getEntity:function(){var t=this,e=this.collection.fetch(),i=l.a.Deferred();return e.then((function(e){var n=new t.collection.model(e);"comment"===t.type?new b.default.SingleComment({Id:t.options.context.Id}).fetch({cache:!0}).done((function(t){n.set(r.a.extend(t,{RelatedItem:null}),{silent:!0}),i.resolve(n)})):i.resolve(n)})),i},publishBookmark:function(t,e){this.toggleBookmark(e),this.trigger("bookmark",e)},publishHighlight:function(t,e){this.toggleHighlight(e),this.trigger("highlight",e)},toggleBookmark:function(t){this.$(".js-bookmark").html(Object(c.translate)(t?"Unbookmark":"Bookmark"))},toggleHighlight:function(t){this.$(".js-highlight").html(Object(c.translate)(t?"Unhighlight":"Highlight"))}});r.a.extend(x.prototype,h.default),e.default=x},2383:function(t,e,i){"use strict";var n=i(15),o=i(195);e.default=function(t){return o.default.getProfileImage(t,n.default.getLastUpdated())}},239:function(t,e,i){"use strict";var n=i(30),o=i(4),s=i.n(o);function r(t){this.relatedItem=Object(n.sharePointItems)().content,this.timerRefresh=null,this.el=s()("<div />").addClass("bz-webpart quicktip ".concat(t)).css({position:"absolute",marginLeft:20,opacity:0,visibility:"hidden",top:0}).appendTo(this.relatedItem)}r.prototype={show:function(t,e){var i=this;if(t.is(":visible")){var n=this.getCoordinates(t);this.el.html(e).css({top:n.top,left:n.left,visibility:"visible"}).animate({opacity:1},{duration:300,queue:!1,easing:"linear"}),this._autorefresh(t)}else var o=0,s=setInterval((function(){t.is(":visible")||o>3?(clearInterval(s),i.show(t,e)):o++}),200)},_autorefresh:function(t){var e=this;t.is(":visible")&&setTimeout((function(){t.is(":visible")&&(e.refresh(t),e._autorefresh(t))}),300)},hide:function(){this.el.animate({visibility:"hidden",opacity:0},300)},getCoordinates:function(t){var e=t.offset();return{top:e.top+t.outerHeight()/2-24+this.relatedItem.scrollTop()-n.sharePointSizes.ribbon.height(),left:e.left+t.outerWidth()}},refresh:function(t){var e=this.getCoordinates(t);this.el.css({top:e.top,left:e.left})}},e.default=r},240:function(t,e,i){"use strict";var n=i(2178);i.d(e,"getBeezySettings",(function(){return n.default}));var o=i(2179);i.d(e,"getEditorVideosConfiguration",(function(){return o.default}))},2413:function(t,e,i){"use strict";var n=i(2414);e.default=n.default},2414:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(1),r=i.n(s),a=i(21),l=i(9),c=i(0),u=i.n(c),d=i(83),h=i(44),f=i(229),p=i(2416),m=i(2417),g=i(2418),v=i(2419),b=i(125),y=i(623);var C=function(t){var e=t.tags,i=t.onClick,n=t.selectedTabValue,c=t.isPopoverOpen,u=t.onClickPopoverOpen,C=Object(s.useRef)(),w=Object(s.useState)(c),T=o()(w,2),x=T[0],O=T[1],S=Object(s.useState)(n),I=o()(S,2),A=I[0],k=I[1],P=function(){O(!x),u(!x)},E=function(t){27===t.keyCode&&O(!1)},_=function(t){x&&C.current&&!C.current.contains(t.target)&&O(!1)},j=function(){O(!1)};Object(s.useEffect)((function(){return window.addEventListener("openFilterActivities",j),function(){window.removeEventListener("openFilterActivities",j)}})),Object(s.useEffect)((function(){return document.addEventListener("click",_),function(){document.removeEventListener("click",_)}}),[x]),Object(s.useEffect)((function(){var t=function(){return k(Object(l.getTranslation)("Places"))};return window.addEventListener("closeBookmarks",t),window.addEventListener("closeTask",t),document.addEventListener("keydown",E),function(){window.removeEventListener("closeBookmarks",t),window.removeEventListener("closeTask",t),document.removeEventListener("keydown",E)}}),[]);var D=function(t,e,n){t.preventDefault(),P(),i(n,e)},U=function(t){return t===Object(l.getTranslation)("Places")?p.default:t===Object(l.getTranslation)("People")?m.default:t===Object(l.getTranslation)("Discover")?g.default:v.default};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:y.default["popover-tab"],ref:C},r.a.createElement("button",{className:"bz-button--Z1LKNYi",type:"button",onClick:P,"aria-haspopup":"menu","aria-pressed":x},r.a.createElement(f.default,{image:U(A),extraClasses:{svg:y.default.button__icon}}),r.a.createElement("span",{className:"bz-button__text--Z1LKNYi"},A)),x&&r.a.createElement("div",{className:y.default.dropdown},r.a.createElement(b.PopoverList,{id:"popover-content",role:"tablist",extraClasses:{list:y.default.dropdown__list}},e.map((function(t){return r.a.createElement(d.default,{key:t.id},r.a.createElement(h.default,{category:"flat",onClick:function(e){return D(e,t.label,t.id)},title:t.label,badge:t.count,role:"tab",selected:t.id===A,extraClasses:{button:A===t.label?Object(a.unionClassNames)(y.default["list-item__button"],y.default["list-item__button--active"]):y.default["list-item__button"]}},r.a.createElement(f.default,{extraClasses:{svg:y.default["list-item__button-icon"]},image:U(t.label)}),r.a.createElement("span",{className:y.default["list__item-text"]},t.label),t.count>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:y.default["list-item__badge"],"aria-hidden":"true"},t.count>=10?"9+":t.count),r.a.createElement("span",{className:y.default["list-item__sr-only"]},"".concat(t.count," activities")))))}))))))};C.defaultProps={isPopoverOpen:!1},C.propTypes={tags:u.a.arrayOf(u.a.shape({id:u.a.string.isRequired,label:u.a.string.isRequired,count:u.a.number.isRequired})),onClick:u.a.func,onClickPopoverOpen:u.a.func,isPopoverOpen:u.a.bool,selectedTabValue:u.a.string},e.default=C},2415:function(t,e,i){"use strict";var n=i(596),o=i.n(n),s=i(494),r=i.n(s),a=i(1),l=i.n(a),c=i(0),u=i.n(c),d=function(t){var e=t.extraClasses,i=t.image,n=r()(t,["extraClasses","image"]);return l.a.createElement("svg",o()({className:e.svg,viewBox:i.viewBox},n),l.a.createElement("use",{href:"#".concat(i.id)}))};d.propTypes={extraClasses:u.a.shape({svg:u.a.string}),image:u.a.shape({id:u.a.string.isRequired,url:u.a.string.isRequired,viewBox:u.a.string.isRequired}).isRequired},d.defaultProps={extraClasses:{svg:""}},e.default=d},2416:function(t,e,i){"use strict";e.default={id:"places-usage",viewBox:"0 0 24 25",url:i.p+"../images/beezy/sprite-react.svg?v=4.7.0.18004#places-usage",toString:function(){return this.url}}},2417:function(t,e,i){"use strict";e.default={id:"people-usage",viewBox:"0 0 24 25",url:i.p+"../images/beezy/sprite-react.svg?v=4.7.0.18004#people-usage",toString:function(){return this.url}}},2418:function(t,e,i){"use strict";e.default={id:"discover-usage",viewBox:"0 0 24 25",url:i.p+"../images/beezy/sprite-react.svg?v=4.7.0.18004#discover-usage",toString:function(){return this.url}}},2419:function(t,e,i){"use strict";e.default={id:"hashtag-usage",viewBox:"0 0 24 25",url:i.p+"../images/beezy/sprite-react.svg?v=4.7.0.18004#hashtag-usage",toString:function(){return this.url}}},2428:function(t,e,i){"use strict";var n=i(2429);e.default=n.default},2429:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(44),l=i(21),c=i(9),u=i(1937);var d=function(t){var e=t.buttonConfirmCategory,i=t.cancelMessage,n=t.confirmMessage,s=t.disable,r=t.extraClasses,d=t.loading,h=t.modalType,f=t.onCancel,p=t.onConfirm;return o.a.createElement(o.a.Fragment,null,o.a.createElement(a.default,{category:e,data:{test:"modal-".concat(h,"-footer-confirm-button")},disabled:s,extraClasses:{button:Object(l.unionClassNames)(u.default["button--margin"],r.button)},loading:d,onClick:p},n||Object(c.getTranslation)("Save")),o.a.createElement(a.default,{category:"secondary",data:{test:"modal-".concat(h,"-footer-cancel-button")},extraClasses:{button:Object(l.unionClassNames)(u.default["button--margin"],r.button)},onClick:f},i||Object(c.getTranslation)("Cancel")))};d.propTypes={buttonConfirmCategory:r.a.string,cancelMessage:r.a.string,confirmMessage:r.a.string,disable:r.a.bool,extraClasses:r.a.shape({button:r.a.string}),loading:r.a.bool,modalType:r.a.string,onCancel:r.a.func,onConfirm:r.a.func},d.defaultProps={buttonConfirmCategory:"primary",cancelMessage:"",confirmMessage:"",disable:!1,extraClasses:{button:""},loading:!1,modalType:"base",onCancel:function(){},onConfirm:function(){}},e.default=d},243:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(1405),r=i(962);e.default=function(t){var e={__setFilter:o.a.bind(t.setFilter,t),__setFilterByHashtag:o.a.bind(t.setFilterByHashtag,t),__setFilterMetadata:o.a.bind(t.setFilterMetadata,t),__createFeedView:o.a.bind(t.createFeedView,t),__reset:o.a.bind(t.reset,t),__changeOrder:o.a.bind(t.changeOrder,t),__onShareboxDialogClose:o.a.bind(t.onShareboxDialogClose,t)};return t.initializeDecorator=function(){this.initializeTextSearch()},t.initializeTextSearch=function(){if(this.collection=this.options.collection=Object(r.default)(this.options.collection),this.textSearchTab=o.a.find(this.tabItems,(function(t){return t.id===s.default.tabs.id||!1})),!this.textSearchTab)throw new Error("feed-manager: If you define a textSearch capable collection, you must add a textsearch tab");this.options.textSearch=this.options.textSearch||{}},t.renderTextSearch=function(){var t=this;this.options.collection.textSearch&&(this.textSearch=new s.default({feed:this.feed,el:this.options.textSearch.container?this.options.textSearch.container:this.$(".js-detail-header-search"),maxLength:this.options.textSearch.maxLength,placeholder:this.options.textSearch.placeholder,minLength:this.options.textSearch.minLength,redirectOnSearch:this.options.textSearch.redirectOnSearch}),this.textSearch.on("search",(function(e){if(t.startLoading(t.$el.find(".js-aggregated-header").get(0)),t.trigger("localsearch"),e.text){var i=t._getTab(t.textSearchTab.id);t.orderBy!=s.default.tabs.id&&t.textSearch.setBackToFeed(t._getTab(t.orderBy)),t.orderBy=t.textSearchTab.id,t._changeTab(i),t.textSearch.setFeed(t.feed)}else{var n,o;t.changeOrder(t._getTab(null===(n=t.textSearch)||void 0===n||null===(o=n.getBackToFeed())||void 0===o?void 0:o.data("id")),!0)}})),this.on("reset",(function(t){this.feed.reset||(t.stop=!0)})),this.textSearch.render())},t.clearTextSearch=function(){this.options.collection.textSearch&&this.textSearch.isFiltering&&this.textSearch.clear()},t.clearTextSearchAndRestoreLastFilter=function(){if(this.options.collection.textSearch&&this.textSearch.isFiltering&&(this.textSearch.clear(),this._hasTaps())){var t=this._getTab(this.textSearch.getBackToFeed().data("id")),e=this._getTabOptions(t);this._changeTab(t),this._changeFeed(e),this.feed.reset&&this._cancelNextRefresh(),this._setupOrder(t,e)}},t.onShareboxDialogClose=function(){this.clearTextSearchAndRestoreLastFilter&&this.clearTextSearchAndRestoreLastFilter(),e.__onShareboxDialogClose()},t.setFilter=function(t){this.clearTextSearchAndRestoreLastFilter(),e.__setFilter(t)},t.setFilterByHashtag=function(t,i){this.clearTextSearchAndRestoreLastFilter(),e.__setFilterByHashtag(t,i)},t.setFilterMetadata=function(t){this.clearTextSearchAndRestoreLastFilter(),e.__setFilterMetadata(t)},t.createFeedView=function(){e.__createFeedView(),this.renderTextSearch()},t.updateFeedView=function(){var t=this;this.textSearch.setFeed(this.feed),this.feed.on("removeFilter",(function(){t.textSearch.clear()}))},t.reset=function(t){this.clearTextSearchAndRestoreLastFilter(),e.__reset(t)},t.changeOrder=function(t,i){e.__changeOrder(t,i),this.clearTextSearch()},t}},244:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(13),l=i(1912),c=i(2406),u=i.n(c),d=i(12),h=(i(309),a.default.extend({template:u.a,selectedItem:null,initialize:function(t){this.options=t,this.options.selectedClass=t.selectedClass||"selected",this.$moreLayout=o()({}),this._initialize(),d.default.subscribe("horizontalMenu","change",this.changeNodeHref,this)},render:function(){return r.a.each(this.model,(function(t){t.TitleClass=t.Title.indexOf(" ")>-1?t.Title.replace(/\s/g,""):t.Title})),this.context=r.a.extend({NavigationLinks:this.model},this.options),this.$el.html(this.template(this.context)),this.setSelectedMenu(this._getSelectedMenuData()),this.resizeLinks(),this},onMoreOptionsRendered:function(){},changeNodeHref:function(t){var e=this.$el.find(".js-header-menu-".concat(t.type," > a"));e&&(e.attr("href")!==t.url&&e.attr("href",t.url))},resizeLinks:function(){var t=this;this.moreLayout=l.default.moreOptions(this.$(".js-header-menu"),{textMore:"...",classMore:".js-morelink",bindEvent:function(){t.onMoreOptionsRendered()}})},gotoMenuItem:function(t){var e=this.$el.find('a[href="#'.concat(t,'"]'));if(!e.length)throw new Error("Horizontal Menu: Id doesn't exist");e.click()},setSelectedMenu:function(t){var e=window.location.href,i=null;if(t){var n=r.a.find(t,(function(t){return e.toLowerCase().indexOf(encodeURI(t.Url).toLowerCase())>-1||beezyContext.CurrentActivity&&null!==beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Type===t.ActivityType}));(i=n?this.$el.find(".js-header-menu-".concat(n.TitleClass)):this.checkOtherPages(e)).addClass(this.options.selectedClass),i.find("a").attr("aria-current",!0),this.selectedItem=i.find("a")}},checkOtherPages:function(t){var e=r.a.find([{Title:"Tasks",Url:"/Tasks"},{Title:"Calendar",Url:"/Calendar"},{Title:"Wiki",Url:"/SitePages/Wiki.aspx"}],(function(e){return t.toLowerCase().indexOf(encodeURI(e.Url).toLowerCase())>-1}));return e?this.$el.find(".js-header-menu-".concat(e.Title)):this.$el.find(".js-header-menu-overview")},_getSelectedMenuData:function(){return this.context.NavigationLinks},_initialize:function(){}}));e.default=h},2444:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(1036),l=i(395),c=i(9),u=i(188),d=i(1716);var h={body:d.default["container--margin"],container:d.default["box--centered"],footer:"",icon:d.default["icon--alert"]},f=function(t){var e=t.cancelMessage,i=t.children,n=t.confirmMessage,s=t.disable,r=t.error,l=t.extraClasses,d=t.footer,f=t.loading,p=t.modalElem,m=t.onCancel,g=t.onClickOutside,v=t.onClose,b=t.onConfirm,y=t.scrollable,C=t.show,w=t.size,T=t.title,x=t.typeIcon,O=t.viewBox,S=Object(a.default)(h,l);return o.a.createElement(u.default,{buttonConfirmCategory:"danger",cancelMessage:e||Object(c.getTranslation)("Cancel"),confirmMessage:n||Object(c.getTranslation)("Yes"),disable:s,error:r,extraClasses:S,footer:d,loading:f,modalElem:p,modalType:"alert",onCancel:m,onClickOutside:g,onClose:v,onConfirm:b,scrollable:y,show:C,size:w,title:T,typeIcon:x,viewBox:O},i)};f.propTypes={cancelMessage:r.a.string,children:r.a.oneOfType([r.a.arrayOf(r.a.node),r.a.node]),confirmMessage:r.a.string,disable:r.a.bool,error:r.a.string,extraClasses:r.a.shape({body:r.a.string,header:r.a.string,icon:r.a.string,title:r.a.string,wrapper:r.a.string}),footer:r.a.func,loading:r.a.bool,modalElem:Object(l.HTMLElement)({isRequired:!0}),onCancel:r.a.func,onClickOutside:r.a.func,onClose:r.a.func,onConfirm:r.a.func,scrollable:r.a.bool,show:r.a.bool,size:r.a.string,title:r.a.string,typeIcon:r.a.string,viewBox:r.a.string},f.defaultProps={cancelMessage:"",children:[],confirmMessage:"",disable:!1,error:"",extraClasses:{body:"",header:"",icon:"",title:"",wrapper:""},footer:void 0,loading:!1,onCancel:function(){},onClickOutside:function(){},onClose:function(){},onConfirm:function(){},scrollable:!1,show:!1,size:"small",title:void 0,typeIcon:"Alert",viewBox:"0 0 48 48"},e.default=f},245:function(t,e,i){"use strict";var n=i(2286);i.d(e,"addOpenNewTabLiteral",(function(){return n.default}))},2457:function(t,e,i){"use strict";var n=i(2458);e.default=n.default},2458:function(t,e,i){"use strict";var n=i(82),o=i.n(n),s=i(1),r=i.n(s),a=i(0),l=i.n(a),c=i(2459),u=i(2460),d=i(2461),h=function(t){var e=t.checkBranding,i=void 0===e||e,n=Object(s.useState)(!i),a=o()(n,2)[1];return Object(s.useEffect)((function(){i&&function t(){window.__brandingCSSLoaded?a(!0):setTimeout(t,50)}()}),[i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.default,null),r.a.createElement(u.default,null),r.a.createElement(d.default,null))};h.propTypes={checkBranding:l.a.bool},e.default=h},2459:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34),a=i(193),l=Object(r.createGlobalStyle)(n||(n=s()(["\n\t:root {\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\n\t\t",";\n\t\t",";\n\n\t\t",";\n\t\t",";\n\t\t",";\n\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\t\t",";\n\n\t\t",";\n\n\t\t",";\n\n\t\t--as-discovery-background: linear-gradient(45deg, var(--as-accent-1) -57%, var(--as-primary) 100%);\n\t}\n"])),(function(){return Object(a.createColorVariables)("--as-primary","#0a5beb")}),(function(){return Object(a.createColorVariables)("--as-accent-1","#002169")}),(function(){return Object(a.createColorVariables)("--as-accent-2","#01153f")}),(function(){return Object(a.createColorVariables)("--as-accent-3","#4f596e")}),(function(){return Object(a.createColorVariables)("--as-white","#ffffff")}),(function(){return Object(a.createColorVariables)("--as-dark","#2e313f")}),(function(){return Object(a.createColorVariables)("--as-slate","#5a5f79")}),(function(){return Object(a.createColorVariables)("--as-grey","#8e93ab")}),(function(){return Object(a.createColorVariables)("--as-light","#e6e7ec")}),(function(){return Object(a.createColorVariables)("--as-ghost","#f4f5f7")}),(function(){return Object(a.createColorVariables)("--as-pale","#f3f7ff")}),(function(){return Object(a.createColorVariables)("--as-positive","#008672")}),(function(){return Object(a.createColorVariables)("--as-negative","#ed0039")}),(function(){return Object(a.createColorAlias)("--as-links","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-button-primary","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-active-tab","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-label-background","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-editor-quote","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-navi-node-text-hover","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-navi-node-text-active","--as-primary")}),(function(){return Object(a.createColorAlias)("--as-button-accent","--as-accent-1")}),(function(){return Object(a.createColorAlias)("--as-comms-joined-label","--as-accent-1")}),(function(){return Object(a.createColorAlias)("--as-navi-text-and-icons","--as-accent-2")}),(function(){return Object(a.createColorAlias)("--as-footer","--as-accent-2")}),(function(){return Object(a.createColorAlias)("--as-user-menu","--as-accent-2")}),(function(){return Object(a.createColorAlias)("--as-navi-background","--as-white")}),(function(){return Object(a.createColorAlias)("--as-button-text","--as-white")}),(function(){return Object(a.createColorAlias)("--as-megamenu-background-and-navi-active-node","--as-white")}),(function(){return Object(a.createColorAlias)("--as-footer-text","--as-white")}),(function(){return Object(a.createColorAlias)("--as-discovery-text","--as-white")}),(function(){return Object(a.createColorAlias)("--as-navi-node-hover-and-search-background","--as-ghost")}),(function(){return Object(a.createColorAlias)("--as-search-elements","--as-slate")}));e.default=l},246:function(t,e,i){"use strict";var n=i(2034);i.d(e,"getAppMapped",(function(){return n.default}));var o=i(2035);i.d(e,"getSvgIcon",(function(){return o.default}));var s=i(2036);i.d(e,"isEllipsisActive",(function(){return s.default}));var r=i(2037);i.d(e,"isSvgIcon",(function(){return r.default}))},2460:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34),a=i(77),l=Object(r.createGlobalStyle)(n||(n=s()(["\n\t:root {\n\t\t--as-border-radius-global: ",";\n\t\t--as-border-radius-buttons: var(--as-border-radius-global);\n\t\t--as-border-radius-hero-blocks: var(--as-border-radius-global);\n\t\t--as-border-radius-cards: var(--as-border-radius-global);\n\t\t--as-border-radius-popover: var(--as-border-radius-global);\n\t\t--as-border-radius-tags: var(--as-border-radius-global);\n\n\t\t--as-border-radius-large: ",";\n\t\t--as-border-radius-modals: var(--as-border-radius-large);\n\t\t--as-border-radius-navi-node: var(--as-border-radius-large);\n\n\t\t--as-border-radius-rounded: ",";\n\t\t--as-border-radius-pill: var(--as-border-radius-rounded);\n\t}\n"])),Object(a.rem)(8),Object(a.rem)(16),Object(a.rem)(1e4));e.default=l},2461:function(t,e,i){"use strict";var n,o=i(62),s=i.n(o),r=i(34),a=i(77),l=Object(r.createGlobalStyle)(n||(n=s()(["\n\t:root {\n\t\t--as-font-family-default: 'Inter', inter-fallback, sans-serif;\n\t\t--as-font-family-titles: 'Poppins', poppins-fallback, sans-serif;\n\n\t\t--as-font-weight-regular: 400;\n\t\t--as-font-weight-semibold: 600;\n\t\t--as-font-weight-bold: 700;\n\n\t\t--as-font-size-hero-label: ",";\n\t\t--as-line-height-hero-label: ",";\n\t\t--as-letter-spacing-hero-label: 10%;\n\t\t--as-font-family-hero-label: var(--as-font-family-default);\n\n\t\t--as-font-size-caption: ",";\n\t\t--as-line-height-caption: ",";\n\t\t--as-letter-spacing-caption: 0;\n\t\t--as-font-family-caption: var(--as-font-family-default);\n\n\t\t--as-font-size-body-small: ",";\n\t\t--as-line-height-body-small: ",";\n\t\t--as-letter-spacing-body-small: 0;\n\t\t--as-font-family-body-small: var(--as-font-family-default);\n\n\t\t--as-font-size-body: ",";\n\t\t--as-line-height-body: ",";\n\t\t--as-letter-spacing-body: 0;\n\t\t--as-font-family-body: var(--as-font-family-default);\n\n\t\t--as-font-size-medium: ",";\n\t\t--as-line-height-medium: ",";\n\t\t--as-letter-spacing-medium: 0;\n\t\t--as-font-family-medium: var(--as-font-family-default);\n\n\t\t--as-font-size-large: ",";\n\t\t--as-line-height-large: ",";\n\t\t--as-letter-spacing-large: 0;\n\t\t--as-font-family-large: var(--as-font-family-titles);\n\n\t\t--as-font-size-hero-l: ",";\n\t\t--as-line-height-hero-l: ",";\n\t\t--as-letter-spacing-hero-l: 0;\n\t\t--as-font-family-hero-l: var(--as-font-family-titles);\n\n\t\t--as-font-size-xlarge: ",";\n\t\t--as-line-height-xlarge: ",";\n\t\t--as-letter-spacing-xlarge: 0;\n\t\t--as-font-family-xlarge: var(--as-font-family-titles);\n\n\t\t--as-font-size-xxlarge: ",";\n\t\t--as-line-height-xxlarge: ",";\n\t\t--as-letter-spacing-xxlarge: -",";\n\t\t--as-font-family-xxlarge: var(--as-font-family-titles);\n\n\t\t--as-font-size-jumbo: ",";\n\t\t--as-line-height-jumbo: ",";\n\t\t--as-letter-spacing-jumbo: 0;\n\t\t--as-font-family-jumbo: var(--as-font-family-titles);\n\t}\n"])),Object(a.rem)(11),Object(a.rem)(11),Object(a.rem)(12),Object(a.rem)(15),Object(a.rem)(14),Object(a.rem)(19),Object(a.rem)(16),Object(a.rem)(21),Object(a.rem)(18),Object(a.rem)(24),Object(a.rem)(22),Object(a.rem)(28),Object(a.rem)(28),Object(a.rem)(32),Object(a.rem)(30),Object(a.rem)(34),Object(a.rem)(40),Object(a.rem)(42),Object(a.rem)(.4),Object(a.rem)(50),Object(a.rem)(60));e.default=l},2463:function(t,e,i){"use strict";var n=i(2464);e.default=n.default},2464:function(t,e,i){"use strict";var n=i(11),o=i.n(n),s=i(1),r=i.n(s),a=i(0),l=i.n(a),c=i(74),u=i(44),d=i(32),h=i(186),f=i(9),p=i(245),m=i(1944);var g=function(t){var e=t.ribbonOpenAppContainer,i=Object(s.useState)(!0),n=o()(i,2),a=n[0],l=n[1];Object(s.useEffect)((function(){document.getElementById("s4-workspace")&&document.getElementById("s4-workspace").classList.add("s4-workspace--has-ribbon")}),[]),Object(s.useEffect)((function(){!a&&document.getElementById("s4-workspace")&&document.getElementById("s4-workspace").classList.remove("s4-workspace--has-ribbon")}),[a]);var g=Object(h.getCurrentLocationUrl)().replace(window.location.protocol,"beezy:");return a&&r.a.createElement("div",{className:"bz-ribbon-open-app--Z14z9yR"},r.a.createElement("section",{className:"bz-close-info--Z14z9yR"},r.a.createElement(u.default,{category:"plain",type:"button",extraClasses:{button:m.default["button--close"]},onClick:function(){l(!1),document.querySelector(e).remove()}},r.a.createElement(d.I,{key:"icon-close",typeIcon:"Close",extraClasses:{icon:m.default["icon--close"]}})),r.a.createElement("p",{className:"bz-text--Z14z9yR"},Object(f.getTranslation)("Open in the Beezy app"))),r.a.createElement("a",{href:g,className:"bz-button--open--Z14z9yR",target:"_blank",rel:"noreferrer noopener"},Object(c.sprintf)(Object(f.getTranslation)("Open %s"),""),r.a.createElement("span",{className:"visually-hidden"},Object(p.addOpenNewTabLiteral)())))};g.propTypes={ribbonOpenAppContainer:l.a.string.isRequired},e.default=g},2465:function(t,e,i){"use strict";e.default=function(t){var e=t.queryString;return function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var o=[].concat(i),s=o.map((function(t){var i=new RegExp("[?&](?:".concat(t,")=([^&#]*)"),"gi").exec(e);return i&&i[1]?decodeURIComponent(i[1].replace(/\+/g," ")):""}));return s}}},2466:function(t,e,i){"use strict";var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(13),u=i(1158),d=i(2468),h=i(2470),f=i.n(h),p=i(2471),m=i.n(p),g=i(2472),v=i.n(g),b=i(12),y=i(5),C=i(30),w=i(51),T=i(2),x=i(712),O=i(768),S=i(2473);function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function A(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var k=c.default.extend({classes:{active:"active",open:"open"},dom:{megamenu:".js-beezy-megamenu",toolbarId:"#js-beezy-toolbar",footerId:"#js-beezy-footer",menuContainer:".menu-container",menuContainerWrapper:".menu-container-wrapper",menuItemButton:".js-show-section",activeClass:".active",appsSection:".js-apps-section",toggleMenu:".js-responsive-toggle-menu",backButton:".js-header-menu__button-back"},layout:{25:"megamenu__column--1-4",33:"megamenu__column--1-3"},initialize:function(t){this.options=t||{},this.context=y.default.getNavigationNodes(),this.internalClick=!1,this.ondocumentclick=l.a.bind(this.ondocumentclick,this),this.onmegamenuclick=l.a.bind(this.onmegamenuclick,this),this.handleKeyDown=l.a.bind(this.handleKeyDown,this),this.toggleMenu=l.a.bind(this.toggleMenu,this),this.closeNodes=l.a.bind(this.closeNodes,this),r()(this.dom.toggleMenu).on("click",this.toggleMenu),this.context&&this.prerender()},prerender:function(){var t=this,e=this,i=l.a.groupBy(this.context,(function(t){return t.PlaceHolder.toLowerCase()}));b.default.subscribe("megamenu","Hide",(function(){t.ondocumentclick()})),l.a.each(i,(function(t,i){t=l.a.sortBy(t,(function(t){return t.Order})),t=l.a.filter(t,(function(t){var e=!t.ConfigurationDependency||(beezySettings[t.ConfigurationDependency]||!1);return t.Enabled&&e})),e.renderMegaMenu(t,i)}))},renderMegaMenu:function(t,e){var i=this;void 0!==window.contentLoader&&window.contentLoader.ajaxAndSettingsReady.promise.then((function(){var n=i.getDefault(e,t);i.$node=r()(n.selector).find(i.dom.megamenu),i.$node.append(n.template(n.nodes)),i.subscribeEscEvent(),n.isModeTabs&&n.nodes&&l.a.each(n.nodes,(function(t){"apps"===t.Type?(i.subscribeEvents(t),r()(i.dom.appsSection).on("mouseover focus",(function(){return i.renderApps(r()(n.selector).find(i.dom.megamenu),t)}))):t.Enabled&&t.Sections&&(i.subscribeEvents(t),t.Sections=l.a.sortBy(t.Sections,(function(t){return t.Order})),l.a.each(t.Sections,(function(e){i.renderSection(e,t.Id)})))}))}))},subscribeEvents:function(t){var e=this,i=this.classes.open;this.$node.find(".js-navigation-".concat(t.Order," ").concat(this.dom.menuItemButton)).on("click",(function(t){t.preventDefault(),t.stopPropagation(),e.clickedNode=r()(t.currentTarget).parent(),e.clickedNode.hasClass(i)?e.closeNodes():(e.closeNodes(),e.openClickedNode())}))},subscribeEscEvent:function(){var t=this;this.$node.on("keydown",(function(e){var i=t.clickedNode&&t.clickedNode.hasClass("open");Object(x.isEscKey)(e)&&i&&(e.stopPropagation(),t.closeNodes(),t.clickedNode.find(".js-show-section").trigger("focus"))}))},bindEvents:function(){r()(Object(C.sharePointItems)().content).on("click",this.ondocumentclick),r()("".concat(this.dom.megamenu," li ").concat(this.dom.menuContainer)).on("click",this.onmegamenuclick)},unbindEvents:function(){r()(Object(C.sharePointItems)().content).off("click",this.ondocumentclick),r()("".concat(this.dom.megamenu," li ").concat(this.dom.menuContainer)).off("click",this.onmegamenuclick)},ondocumentclick:function(t){var e=document.getElementById("appsPopover");e&&e.contains(t.target)&&(this.internalClick=!0),this.internalClick?this.internalClick=!1:this.closeNodes()},onmegamenuclick:function(){this.internalClick=!0},closeNodes:function(){var t=r()(this.dom.megamenu),e=this.classes,i=e.active,n=e.open;r()(this.dom.megamenu).removeClass(n),t.find("li.".concat(n)).removeClass(n),t.find("div".concat(this.dom.menuContainerWrapper,".").concat(i)).removeClass(i),t.find("div".concat(this.dom.menuContainer,".").concat(i)).removeClass(i).hide(),t.find("button".concat(this.dom.menuItemButton)).attr("aria-expanded",!1),this.unbindEvents()},openClickedNode:function(){var t=this.classes,e=t.active,i=t.open,n=r()(this.dom.megamenu);this.publishToMediator(),n.addClass(i),this.clickedNode.addClass(i),this.clickedNode.find("div".concat(this.dom.menuContainerWrapper)).addClass(e),this.clickedNode.find("div".concat(this.dom.menuContainer)).addClass(e).show(),this.clickedNode.find("button".concat(this.dom.menuItemButton)).attr("aria-expanded",!0),n.find(this.dom.backButton).on("click",this.closeNodes),this.bindEvents(),Object(O.createFocusTrap)({element:document.querySelector(this.dom.megamenu),active:window.matchMedia("(max-width: 760px)").matches,elementToFocus:".js-header-menu__button-close"})},getDefault:function(t,e){var i=this,n=e[0];switch(t.toLowerCase()){case"header":return{template:f.a,selector:this.dom.toolbarId,isModeTabs:!0,nodes:e};default:return n.ApplicationTitle=y.default.getApplicationTitle(),n.CurrentYear=Object(w.getFormattedDate)(new Date,"yyyy"),n.Sections=n.Sections.map((function(t){return i.setMetadata(t)})),{template:m.a,selector:this.dom.footerId,isModeTabs:!1,nodes:n}}},renderApps:function(t,e){var i=this;r()(".js-apps-section").off("mouseover");var n=t.find("".concat(this.dom.menuContainer,"__").concat(e.Id)).get(0);new S.default(n,(function(){return i.closeNodes()})).render()},renderSection:function(t,e){switch((t=this.setMetadata(t)).Type){case"options":this.setOptionSection(t,e);break;case"featured":this.setFeaturedSection(t,e);break;case"personalized":this.setPersonalizedSection(t,e)}},publishToMediator:function(){b.default.publish("sidebar","Hide",!1),b.default.publish("drop","HideAllDrops")},setOptionSection:function(t,e){new u.default({context:t,el:this.$node.find("".concat(this.dom.menuContainer,"__").concat(e)),usingContext:!0}).render()},setFeaturedSection:function(t,e){new u.default({context:t,el:this.$node.find("".concat(this.dom.menuContainer,"__").concat(e)),template:v.a,usingContext:!0}).render()},setPersonalizedSection:function(t,e){var i=A(A({},t),{},{Title:Object(T.translate)(t.Title)});new d.default({context:i,el:this.$node.find("".concat(this.dom.menuContainer,"__").concat(e))}).render()},setMetadata:function(t){return l.a.each(t.Metadata,(function(e){"true"===e.Value||"false"===e.Value?t[e.Name]="true"===e.Value:t[e.Name]=e.Value})),l.a.extend({layoutClass:this.layout[t.Layout]},t)},setSelectedNode:function(t){var e=window.location.href;if(this.context){var i=l.a.find(this.context,(function(t){var i=t.Placeholder&&t.Placeholder.toLowerCase();return"header"===i&&(void 0===t.Sections||t.Sections.length<1)?void 0!==t.LinkUrl&&null!==t.LinkUrl&&""!==t.LinkUrl&&"#"!==t.LinkUrl&&e.toLowerCase().indexOf(encodeURI(t.LinkUrl).toLowerCase())>-1:!("header"!==i||!t.Sections)&&l.a.find(t.Sections,(function(t){if(t.Items)return l.a.find(t.Items,(function(t){return void 0!==t.LinkUrl&&null!==t.LinkUrl&&""!==t.LinkUrl&&"#"!==t.LinkUrl&&e.toLowerCase().indexOf(t.LinkUrl.toLowerCase())>-1}))}))}));i&&(t.removeClass("selected"),t.find(".js-navigation-".concat(i.Order)).addClass("selected"))}},toggleMenu:function(t){t&&t.preventDefault();var e,i=r()(this.dom.megamenu);i.hasClass("show")?(i.removeClass("show"),r()(document).off("keydown",this.handleKeyDown),i.find(".js-header-menu__button-close").off("click",this.toggleMenu),null===(e=document.querySelector(this.dom.toggleMenu))||void 0===e||e.focus()):(i.addClass("show"),r()(document).on("keydown",this.handleKeyDown),i.find(".js-header-menu__button-close").on("click",this.toggleMenu),Object(O.createFocusTrap)({element:document.querySelector(this.dom.megamenu),elementToFocus:".js-header-menu__button-close"}))},handleKeyDown:function(t){"Esc"!==t.key&&"Escape"!==t.key||r()(this.dom.megamenu).hasClass("show")&&!r()(".js-navigation.open").length&&this.toggleMenu()}});e.default=k},2468:function(t,e,i){"use strict";var n=i(10),o=i(13),s=i(1158),r=i(2469),a=i.n(r),l=i(5),c=o.default.extend({initialize:function(t){this.options=t||{},this.context=this.options.context,this.idSelector="js-beezy-".concat(this.context.Component).concat(this.cid)},render:function(){this.getDataPersonalize(this.context.Component)},getDataPersonalize:function(t){switch(t){case"usertools":new s.default({context:this.context,collection:n.default.getJSON(l.default.getApiUrlv2()+this.context.ApiUrl,{skip:0,take:parseInt(this.context.MaxItems,10)+1}),el:this.$el,template:a.a,options:{idSelector:this.idSelector}}).render();break;case"options":new s.default({context:this.context,collection:n.default.getJSON(l.default.getApiUrlv2()+this.context.ApiUrl,{skip:0,take:parseInt(this.context.MaxItems,10)+1}),el:this.$el,options:{showMore:!1,idSelector:this.idSelector,isRelativeUrl:!0}}).render()}}});e.default=c},2473:function(t,e,i){"use strict";var n=i(38),o=i(5),s=i(306),r=function(){return i.e(10).then(i.bind(null,3725))};function a(t,e){this.el=t,this.closeMegamenu=e}a.prototype={render:function(){n.default.renderComponent(this.el,r,{baseSiteCollection:o.default.getBaseSiteCollection(),closeMegamenu:this.closeMegamenu,labelTextId:"a11y-microblog-share-app-modal-description",handleCreateMicrobox:s.createRenderMicrobox},!0,!0)}},e.default=a},2474:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(50),r=i.n(s),a=i(5),l=i(16),c=i(412),u=i(30),d=i(768),h=i(3),f=i.n(h),p=i(13),m=i(20),g=i(311),v=i(2475),b=i.n(v),y=i(2476),C=i.n(y),w=i(7),T=i(1323),x=i(56),O=i(774),S=i(2),I=i(306),A=i(1108),k=(i(682),p.default.extend({template:b.a,itemListTemplate:C.a,dom:{closeButton:".js-notifications__button-close",container:".js-notification-popup-container"},events:{"click .js-notification-modal":"handleClickNotification"},initialize:function(t){var e=this,i={animated:!0,verticalPosition:w.default.DropVerticalPosition.BOTTOM,position:w.default.DropPosition.CENTER,parent:t.parent,classNames:"popover-notifications",shouldFlipVertical:!1,hasResponsive:!0};if(this._button=t.button,this._popover=new g.default(i),this._popover.on("show",(function(){e.fetchNotifications(),e.trigger("show"),Object(d.createFocusTrap)({element:document.querySelector(e.dom.container),active:Boolean(window.matchMedia("(max-width: 760px)").matches)})})),this._popover.on("hide",(function(){e.trigger("hide"),window.matchMedia("(max-width: 760px)").matches&&e.handleFocusNotification()})),this.collection=new T.default.PopupNotificationsCollection,this.listenTo(this.collection,"reset",this.renderItems),Object(u.isSharepointModern)()){var n=document.querySelector('.mainContent [data-is-scrollable="true"]')||document.querySelector('[data-is-scrollable="true"][data-automationid="content"]');n&&n.addEventListener("scroll",(function(){if(n.scrollTop>=300)return e._popover.hide()}))}this.onClickButton=f.a.bind(this.onClickButton,this),t.button.on("click",this.onClickButton)},render:function(){return this.$el.html(this.template({viewAllNotificationsUrl:"".concat(a.default.getCollectionUrl(),"/SitePages/Notifications.aspx")})),this},renderItems:function(t){this.stopLoading();var e=t.toJSON(),i=f.a.map(e,(function(t){return"groupinvite"===t.Reason&&(t.activityUrl="".concat(a.default.getCollectionUrl(),"/SitePages/Notifications.aspx?tab=groupinvite")),"corporatepageapprovalrequest"===t.Reason&&(t.activityUrl="".concat(a.default.getSiteHost()+a.default.getCorporateModule().Url,"/SitePages/Page.aspx#View/").concat(t.Activity.Id)),"guestauthoradded"===t.Reason&&(t.activityUrl="".concat(a.default.getSiteHost()+a.default.getCorporateModule().Url,"/SitePages/Page.aspx?guestauthor=true#Edit/").concat(t.Activity.Id)),"corporatepagereject"!==t.Reason&&"corporatepageapprove"!==t.Reason||(t.activityUrl="".concat(a.default.getSiteHost()+a.default.getCorporateModule().Url,"/SitePages/Page.aspx#Edit/").concat(t.Activity.Id)),"storyapprovalrequest"!==t.Reason&&"storyapprovalrequestreminder"!==t.Reason||(t.activityUrl="".concat(a.default.getSiteHost()+a.default.getEditorialModule().Url,"/SitePages/Story.aspx#View/").concat(t.Activity.Id)),"storyapprove"!==t.Reason&&"storyreject"!==t.Reason||(t.activityUrl="".concat(a.default.getSiteHost()+a.default.getEditorialModule().Url,"/SitePages/Story.aspx#Edit/").concat(t.Activity.Id)),t.showGroupInfo=t.Reason===x.default.getReason("GroupCreated")||t.Reason===x.default.getReason("LeaveCommunity")||t.Reason===x.default.getReason("DeclineInvitation")||t.Reason===x.default.getReason("MemberAdded"),t}));this.$(".js-notifications-list").html(this.itemListTemplate(i)),this.$(".js-timeago").timeago(!0),this.$(".js-regular-timeago").timeago(!1)},renderDropDialog:function(){this._popover.inject(this.render().$el),this.renderDropDialog=function(){}},bindDropDialogEvents:function(){var t=this;this.$el.find(this.dom.closeButton).on("click",(function(){t._popover.hide()}))},fetchNotifications:function(){return this.startLoading(this.$(".js-loader-container")),this.collection.fetch({reset:!0})},resetNotifications:function(){return this.startLoading(this.$(".js-loader-container")),this.collection.fetch({reset:!0,cache:!1})},onClickButton:function(t){t.stopPropagation(),t.preventDefault();var e=this;this.renderDropDialog(),this.bindDropDialogEvents(),this.trigger("open"),void 0!==this._newNotifications&&this._newNotifications===window.beezyContext.notificationsCount.Notifications||this.setNewNotifications(window.beezyContext.notificationsCount||0),this._newNotifications?(this.$el.find(".js-unread-notifications").html(this._newNotifications),this.resetNotifications().then((function(){e.collection.markAsRead()})),this._newNotifications=0,window.beezyContext.notificationsCount.Notifications=this._newNotifications):(this.$el.find(".js-unread-notifications").empty(),this.markAllAsRead()),this._popover.toggle(),this.delegateEvents()},setNewNotifications:function(t){this._newNotifications=t.Notifications},markAllAsRead:function(){this.$(".js-notifications-list li").removeClass("is-unread")},handleClickNotification:function(t){t.preventDefault(),document.querySelector("body").classList.add("body--notification");var e=parseInt(t.currentTarget.dataset.id,10),i=this.collection.toJSON(),n=i.findIndex((function(t){return t.Id===e}));return a.default.enableNotificationModals()&&window.matchMedia("(min-width: 1024px)").matches?this.showNotificationModal(i,n):this.redirectToNotification(i,n)},handleFocusNotification:function(){this._button[0].focus()},redirectToNotification:function(t,e){var i=t[e].activityUrl;window.location.href=i},showNotificationModal:function(t,e){var n=this,s=document.getElementById("node-slider-notification-modal"),d=a.default.getCorporateModule(),h=d?d.Url:"",f=a.default.getBaseSiteCollection(),p=a.default.getBaseSiteHost(),m=a.default.getEditorialModule(),g=m?m.Url:"",v=Object(A.getGraphAuthHandlerUrl)();this.handleFocusNotification=this.handleFocusNotification.bind(this),i.e(152).then(i.bind(null,3726)).then((function(i){var d=i.default;r.a.render(o.a.createElement(l.ApolloProvider,{client:Object(c.getApolloClient)()},o.a.createElement(d,{currentIndex:e,notifications:t,onMicroboxRefIsReady:function(t,e){return Object(I.handleRenderMicrobox)({placeholderText:e||Object(S.translate)("Add a comment...")})(t)},handleCreateMicrobox:I.createRenderMicrobox,onReplyMicrobox:I.handleReplyMicrobox,onFocusMicrobox:I.handleFocusMicrobox,onReturnFocus:n.handleFocusNotification,handlegetDataMicrobox:I.handleGetDataMicrobox,handleResetMicrobox:I.handleResetMicrobox,handleInitTextMicrobox:I.handleInitTextMicrobox,blurMicrobox:I.handleBlurMicrobox,isModalOpen:!0,profileUrl:a.default.getProfileUrl(),inactiveUserLiteral:a.default.getSettingByName("InactiveUserLiteral"),corporateModuleUrl:h,editorialModuleUrl:g,baseSiteCollection:f,baseSiteHost:p,isSharepointModern:Object(u.isSharepointModern)(),handleGetDataMessageMicrobox:I.handleGetDataMessageMicrobox,ReportAbuseModel:O.default,microsoftGraphAuthHandlerUrl:v})),s)}))}}));m.default.loaderMixin(k.prototype),e.default=k},2477:function(t,e,i){"use strict";var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(13),u=i(2),d=i(768),h=i(311),f=i(5),p=i(15),m=i(303),g=i(185),v=i(2478),b=i.n(v),y=i(2479),C=i.n(y),w=i(2480),T=i.n(w),x=i(39),O=i(18),S=i(7),I=i(10),A=i(655),k=i(490),P=i(78),E=(i(122),i(129),i(30));function _(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var D=c.default.extend({dom:{network:".js-select-network",linkNetwork:".js-quicklink-network",manage:".js-quicklink-manage",container:".js-quickLinks-container",toolbarButton:".js-toolbar-quicklink"},events:{"click .js-redirect":"redirect","click .js-header-quickLinks__button-close":"handleClose"},template:b.a,initialize:function(t){var e=this;this.options=t,this.template=t.template||this.template,this.editable=t.editable||!1,this.templateItems=C.a,this.templateManage=T.a,this.editorialModules=[],this.corporateModules=[],this.administrableLocalEntities=[];var i={animated:!0,verticalPosition:S.default.DropVerticalPosition.BOTTOM,position:S.default.DropPosition.CENTER,parent:t.parent,role:"menu",classNames:"popover-quicklinks",hasResponsive:!0};if(this._popover=new h.default(i),this._popover.on("show",(function(){e.trigger("show"),Object(d.createFocusTrap)({element:document.querySelector(e.dom.container),active:Boolean(window.matchMedia("(max-width: 760px)").matches)})})),this._popover.on("hide",(function(){var t;(e.trigger("hide"),window.matchMedia("(max-width: 760px)").matches)&&(null===(t=document.querySelector(e.dom.toolbarButton))||void 0===t||t.focus())})),Object(E.isSharepointModern)()){var n=document.querySelector('.mainContent [data-is-scrollable="true"]')||document.querySelector('[data-is-scrollable="true"][data-automationid="content"]');n.addEventListener("scroll",(function(){if(n.scrollTop>=50)return e._popover.hide()}))}this.onClickButton=l.a.bind(this.onClickButton,this)},fetchAdminData:function(){var t=this,e=new A.default;e&&e.administrableModules().then((function(e){var i=e.find((function(t){return"editorialModules"===t.Key})).Value,n=e.find((function(t){return"corporateModules"===t.Key})).Value;t.editorialModules=P.default.getGlobalModules(i,"StoriesModuleEnabled"),t.corporateModules=P.default.getGlobalModules(n,"PagesModuleEnabled"),t.addContext(),t.renderTemplateItem()})),e&&e.administrableLocalEntities().then((function(e){t.administrableLocalEntities=e,t.addContext()}))},addContext:function(){this.context=j(j({Title:Object(u.translate)("Quick Links"),hasManageModules:k.default.hasCorporateModule()||k.default.hasEditorialModule()||k.default.hasEditorialSettings()||this.administrableLocalEntities.length||this.editorialModules.length||this.corporateModules.length,hasCreateNew:k.default.isCommunityCreator()||k.default.isCorporateGuestWriter()||k.default.isKnowledgeCenterCreator()||k.default.isIdeasCampaignCreator()||k.default.isStandAloneBlogEnabled()||k.default.isStandAloneWikiEnabled()||k.default.isStandAloneForumEnabled()},beezyCurrentUser),beezySettings),this.$el.html(this.template(this.context)),this.context.Networks&&this.context.Networks.length<2&&this.renderTemplateItem()},render:function(){var t=this;return this.fetchAdminData(),this.administrableLocalEntities.length||this.addContext(),this.options.button.on("hover",(function(){t.getNetworkConfigurations()})),this.options.button.on("click",this.onClickButton),this},createSelector:function(){var t=this;if(this.context.Networks.length>1){var e=this.context.Networks.map((function(t){return{Value:t.Id,Title:t.Title}}));this.$el.find(this.dom.network).html(""),this.selector=new g.default({className:"selector__network",el:this.$el.find(this.dom.network),options:e,showTitleComponent:!1}),this.selector.render(),this.selector.setValueSelected(m.default.getCurrentNetworkId()),this.selector.on("change",(function(){t.renderTemplateItem()})),this.networkConfig||this.selector.disable(),this.renderTemplateItem()}},getNetworkConfigurations:function(){var t=this;this.networkConfig||I.default.get("".concat(f.default.getApiUrlv2(),"/Network/AllowedGroups")).then((function(e){t.networkConfig=e;var i=t.context.CurrentNetwork?t.context.CurrentNetwork.Id:m.default.getCurrentNetworkId(),n=t.networkConfig.find((function(t){return t.Key===i}));Object.assign(t.context,n?n.Value:0),t.renderTemplateItem(),t.selector&&t.selector.enable()}))},redirect:function(t){t.stopPropagation(),t.preventDefault();var e=r()(t.currentTarget).data("url");this.clearCache(),O.default.redirectToUrl(e)},clearCache:function(){x.default.remove("jobId"),x.default.remove("groupAsyncTemp")},addHash:function(){if(f.default.showLocalEntitiesInManageSettings()&&!p.default.localEntityAdminHasEditorialSettings()&&p.default.isBeezyAdministrator())return S.default.ManageSettingsHashes.localEntities;if(p.default.localEntityAdminHasEditorialSettings()||this.administrableLocalEntities.length){var t=P.default.getEditorialSettingsHash(this.administrableLocalEntities.length?this.administrableLocalEntities[0]:p.default.getLocalEntity());return t&&t.key}return S.default.ManageSettingsHashes.orgStructure},renderTemplateItem:function(){var t=this;if(this.context.CurrentNetwork=this.getCurrentNetwork(),this.networkConfig){var e=this.networkConfig.find((function(e){return e.Key===(t.context.CurrentNetwork.Id||0)}));Object.assign(this.context,e?e.Value:0)}this.$el.find(this.dom.linkNetwork).html(this.templateItems(this.context)),this.$el.find(this.dom.manage).html(this.templateManage({hasEditorialModule:k.default.hasEditorialModule()||!!this.editorialModules.length,hasCorporateModule:k.default.hasCorporateModule()||!!this.corporateModules.length,hasEditorialSettings:k.default.hasEditorialSettings()||!!this.administrableLocalEntities.length,hash:this.addHash(),UrlEditorial:this.editorialModules.length?this.editorialModules[0].Url:"",UrlCorporate:this.corporateModules.length?this.corporateModules[0].Url:""}))},renderDropDialog:function(){this._popover.inject(this.$el),this.renderDropDialog=function(){}},handleClose:function(){this._popover.hide()},onClickButton:function(t){t.stopPropagation(),t.preventDefault(),this.renderDropDialog(),this._popover.toggle(),this.createSelector()},getCurrentNetwork:function(){var t=this.selector?this.selector.getValue():m.default.getCurrentNetworkId();return this.context.Networks.find((function(e){return e.Id===parseInt(t,10)}))}});e.default=D},26:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(27),r=i.n(s),a=r.a.Model.extend({idAttribute:"Id",destroy:function(t){var e=o.a.extend(t||{},{contentType:"application/json"});r.a.Model.prototype.destroy.call(this,e)},sync:function(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=n&&n.url?n.url:"function"==typeof this.url?this.url():this.url,o.a.extend(n,{url:this.getUrlWithToken(i,t)}),a.__super__.sync.call(this,t,e,n)},getUrlWithToken:function(t,e){return t="function"==typeof t?t():t,!beezySettings.ApiServiceV2QueryString||"create"!==e&&"delete"!==e&&"update"!==e?t:t+(encodeURI(t).indexOf("?")>-1?"&":"?")+beezySettings.ApiServiceV2QueryString}});e.default=a},260:function(t,e,i){"use strict";i.d(e,"TIME_FORMAT_12_HOURS",(function(){return n}));var n="h:mm aa",o="HH:mm",s=[{name:"Catalan",code:"ca-es",lcid:1027,dateFnsLocaleName:"ca",timeFormat:o},{name:"Chinese",code:"zh-cn",lcid:2052,dateFnsLocaleName:"zhCN",timeFormat:"aa h:mm"},{name:"Chinese (traditional)",code:"zh-tw",lcid:1028,dateFnsLocaleName:"zhTW",timeFormat:"aa h:mm"},{name:"Czech",code:"cs-cz",lcid:1029,dateFnsLocaleName:"cs",timeFormat:o},{name:"Danish",code:"da-dk",lcid:1030,dateFnsLocaleName:"da",timeFormat:o},{name:"Dutch",code:"nl-nl",lcid:1043,dateFnsLocaleName:"nl",timeFormat:o},{name:"English",code:"en-us",lcid:1033,dateFnsLocaleName:"enUS",timeFormat:n},{name:"Finnish",code:"fi-fi",lcid:1035,dateFnsLocaleName:"fi",timeFormat:o},{name:"French",code:"fr-fr",lcid:1036,dateFnsLocaleName:"fr",timeFormat:o},{name:"German",code:"de-de",lcid:1031,dateFnsLocaleName:"de",timeFormat:o},{name:"Hungarian",code:"hu-hu",lcid:1038,dateFnsLocaleName:"hu",timeFormat:o},{name:"Indonesian",code:"id-id",lcid:1057,dateFnsLocaleName:"id",timeFormat:o},{name:"Italian",code:"it-it",lcid:1040,dateFnsLocaleName:"it",timeFormat:o},{name:"Japanese",code:"ja-jp",lcid:1041,dateFnsLocaleName:"ja",timeFormat:o},{name:"Korean",code:"ko-kr",lcid:1042,dateFnsLocaleName:"ko",timeFormat:o},{name:"Norwegian",code:"nb-no",lcid:1044,dateFnsLocaleName:"nb",timeFormat:o},{name:"Polish",code:"pl-pl",lcid:1045,dateFnsLocaleName:"pl",timeFormat:o},{name:"Portuguese",code:"pt-pt",lcid:2070,dateFnsLocaleName:"pt",timeFormat:o},{name:"Portuguese - Brazil",code:"pt-br",lcid:1046,dateFnsLocaleName:"ptBR",timeFormat:o},{name:"Romanian",code:"ro-ro",lcid:1048,dateFnsLocaleName:"ro",timeFormat:o},{name:"Russian",code:"ru-ru",lcid:1049,dateFnsLocaleName:"ru",timeFormat:o},{name:"Serbian (Former)",code:"sr-latn-cs",lcid:2074,dateFnsLocaleName:"srLatn",timeFormat:o},{name:"Serbian",code:"sr-latn-rs",lcid:9242,dateFnsLocaleName:"srLatn",timeFormat:o},{name:"Spanish",code:"es-es",lcid:3082,dateFnsLocaleName:"es",timeFormat:o},{name:"Swedish",code:"sv-se",lcid:1053,dateFnsLocaleName:"sv",timeFormat:o},{name:"Turkish",code:"tr-tr",lcid:1055,dateFnsLocaleName:"tr",timeFormat:o},{name:"Ukrainian",code:"uk-ua",lcid:1058,dateFnsLocaleName:"uk",timeFormat:o}];e.default=s},261:function(t,e,i){"use strict";i.r(e);var n=i(2147),o=i(1444);i.d(e,"AccountLimitation",(function(){return o.default}));var s=i(1445);i.d(e,"Privacy",(function(){return s.default})),e.default=n.default},264:function(t,e,i){"use strict";i.d(e,"AppsProfileUrl",(function(){return n})),i.d(e,"CalendarDetailUrl",(function(){return o})),i.d(e,"CorporatePageEditUrl",(function(){return s})),i.d(e,"CorporatePageViewUrl",(function(){return r})),i.d(e,"CorporatePageTopicUrl",(function(){return a})),i.d(e,"CorporatePagesAllTopics",(function(){return l})),i.d(e,"IdeaDetailUrl",(function(){return c})),i.d(e,"PollDetailUrl",(function(){return u})),i.d(e,"StartpageUrl",(function(){return d})),i.d(e,"TasksDetailUrl",(function(){return h})),i.d(e,"ChannelDetailUrl",(function(){return f})),i.d(e,"WspProfileUrl",(function(){return p}));var n="/SitePages/Profile.aspx?IdUser=",o="/SitePages/Calendar Detail.aspx?ActivityId=",s="/SitePages/Page.aspx#edit",r="/SitePages/Page.aspx#view",a="/SitePages/Topic.aspx?topicId=",l="/SitePages/All Topics.aspx",c="/SitePages/Idea Detail.aspx?ActivityId=",u="/SitePages/Poll Detail.aspx?ActivityId=",d="/SitePages/Start.aspx",h="/SitePages/Tasks Detail.aspx?ActivityId=",f="/SitePages/Channel.aspx?ChannelId=",p="/SitePages/Profile.aspx?IdUser="},267:function(t,e,i){"use strict";i.r(e);var n=i(194),o={getGroup:function(t){return beezyCurrentGroup||t.get("Group")},trackEvent:function(t,e,i){var o,s=this.getGroup(t),r={activityId:t.id};s?r[o="communityName"]=s.Title:r[o]="without group",(new n.default).trackPageEvent(e,{obj:i,props:r})}};e.default=o},268:function(t,e,i){"use strict";var n={delayCallback:function(t,e){setTimeout(t,e)}};e.default=n},269:function(t,e,i){"use strict";i.r(e);var n=i(2),o={getWebpartTitles:function(t){return Object(n.translate)(this.getWebpartProperties(t,"Title"))||""},getWebpartProperties:function(t,e){return beezyContext.WebParts&&beezyContext.WebParts[t]&&beezyContext.WebParts[t][e]||""}};e.default=o},272:function(t,e,i){"use strict";var n=i(2054);i.d(e,"borderRadius",(function(){return n.default}));var o=i(2055);i.d(e,"colors",(function(){return o.default}));var s=i(2056);i.d(e,"fontSizes",(function(){return s.default}));var r=i(2057);i.d(e,"fontWeights",(function(){return r.default}));var a=i(2058);i.d(e,"lineHeights",(function(){return a.default}));var l=i(2059);i.d(e,"fontFamilies",(function(){return l.default}));var c=i(2060);i.d(e,"gaps",(function(){return c.default}))},273:function(t,e,i){"use strict";var n=i(2030);i.d(e,"getBeezyLanguageByCode",(function(){return n.default}));var o=i(2031);i.d(e,"getBeezyLanguageByLCID",(function(){return o.default}));var s=i(2032);i.d(e,"getLanguageShortCodeByCode",(function(){return s.default}));var r=i(2033);i.d(e,"sortLanguages",(function(){return r.default}))},276:function(t,e,i){"use strict";var n=i(3),o=i.n(n),s=i(2),r=i(1032),a=i(47),l=i(1579),c={GroupInvite:l.default,GroupRecommend:l.default},u={create:function(t,e){var i=function(n){var s=o.a.extend({},e,n),l=a.default.createDialogContainer(s.dialogClass),u=o.a.extend({closeOnEscape:!0,width:300,dialogClass:"form-dialog"},s.extend),d=new r.default({extend:u,selector:l,onShow:s.onShow||function(){},onHide:s.onHide||function(){}}),h=new c[t](o.a.extend({el:l,dialog:d},s.extend));h.on("cancel",d.hide,d),h.on("show",d.show,d),d.show(),i=o.a.bind(d.show,d)};return function(){return i.apply(void 0,arguments)}}};u.Recommend=new u.create("GroupRecommend",{extend:{width:600,title:Object(s.translate)("Recommend people to join this community"),buttonsExtend:[{id:"recommend",label:Object(s.translate)("Recommend"),disabled:!0,primary:!0},{id:"cancel",label:Object(s.translate)("Cancel")},{id:"ok",label:"Ok",hidden:!0}],optionsTemplate:{ShowOptionalMessage:!0},successText:Object(s.translate)("The recommendation emails were sent successfully")}}),u.GroupInvite=new u.create("GroupInvite",{extend:{width:600,title:Object(s.translate)("Invite people to join this community"),buttonsExtend:[{id:"invite",label:Object(s.translate)("Invite"),disabled:!0,primary:!0},{id:"cancel",label:Object(s.translate)("Cancel")},{id:"ok",label:"Ok",hidden:!0}],optionsTemplate:{ShowOptionalMessage:!1}}}),e.default=u},277:function(t,e,i){"use strict";i.r(e);var n=i(98),o=i.n(n),s=i(24),r=i.n(s),a=i(4),l=i.n(a),c=i(3),u=i.n(c),d=i(7),h=i(116),f=i(20),p=i(178);function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function g(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){r()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function v(t){t.preventDefault()}var b=h.default.extend({classes:{list:"",item:"",placeholder:"placeholder",itemToolsPopup:"js-beezy-dropItemTools"},dom:{removeIcon:".js-removeItem",toolsIcon:".js-item-tools"},registeredEvents:["click","selectstart"],init:function(t){var e=this;this.options=t||{},this.listAriaAttrs=t.listAriaAttrs||'role="tablist"',this.itemAriaAttrs=t.itemAriaAttrs||'role="presentation"',this.template=this.options.template||this._defaultTemplate;var i=0;this.list=l()("<ul ".concat(this.listAriaAttrs,">")).addClass(this.classes.list).on("keydown",(function(t){"ArrowRight"!==t.key&&"ArrowLeft"!==t.key&&"ArrowUp"!==t.key&&"ArrowDown"!==t.key||(e._$items[i].find("a").attr("tabindex",-1).attr("aria-selected",!1),"ArrowRight"===t.key||"ArrowDown"===t.key?++i>=e._$items.length&&(i=0):"ArrowLeft"!==t.key&&"ArrowUp"!==t.key||--i<0&&(i=e._$items.length-1),e._$items[i].find("a").attr("tabindex",0).attr("aria-selected",!0),e._$items[i].find("a").focus(),t.preventDefault())})),this.multiple=!!this.options.multiple,this.reset(this.options.items||[]),this.removeSelectedItem=u.a.bind(this.removeSelectedItem,this),this.itemsNotClickables=t.itemsNotClickables||!1,this.hasToolsPopup=t.hasToolsPopup||!1,this.templateToolsPopup=t.templateToolsPopup,this.tools=t.tools||[],this.hasToolsPopup&&this.templateToolsPopup&&this.tools.length&&(this.createToolsPopup=u.a.bind(this.createToolsPopup,this)),this.options.placeholder&&this.setPlaceholder(this.options.placeholder),this.hasRemoveIcon=t.hasRemoveIcon||!1,this.unbindClick=t.unbindClick||!1},setPlaceholder:function(t){this.placeholderItem=this._getItemContainer(this.classes.placeholder).text(t),this.count()||this.showPlaceholder()},showPlaceholder:function(){this.placeholderItem&&this.list.append(this.placeholderItem)},hidePlaceholder:function(){this.placeholderItem&&this.placeholderItem.remove()},setSize:function(t){this.list.css({width:t})},count:function(){return this._items.length},at:function(t){return this._items[t]},get:function(t){return this._itemsById[t]},getItems:function(){return this._items},removeSelectedItem:function(t){t.preventDefault();var e=l()(t.currentTarget).parents("li.js-list-item").index();this.setSelected(e),this.emit("removeSelected",t)},getTools:function(){return this.tools},updateItem:function(t,e,i){var n=g(g({},t),{},r()({},e,i)),o=this._items.findIndex((function(t){return t.Id===n.Id}));this._items[o]=n,this.refresh()},createToolsPopup:function(t){var e=this;t.preventDefault(),t.stopPropagation();var i=l()(t.currentTarget).parents("li.js-list-item"),n=this._items[i.index()];if(!n.isDisabled){var o=i.find(this.dom.toolsIcon);this.toolsPopup=new p.default(g({el:o,animated:!0,fixed:!0,showDelay:d.default.dropDefaultDelayShow,classContainer:this.classes.itemToolsPopup,insideOtherDrop:!0},p.default.Configurations.toolsRight)),this.toolsPopup.append(this.templateToolsPopup({tools:this.getTools(n)})),this.toolsPopup.on("render",(function(){return e.bindEventsToolsPopup(t,n)})),this.toolsPopup.render(),this.toolsPopup.show()}},bindEventsToolsPopup:function(t,e){var i=this;this.options.tools.forEach((function(n){"removeSelected"===n.eventName?l()(i.toolsPopup.drop.el).find(".".concat(n.dom)).click((function(e){e.preventDefault(),e.stopPropagation(),i.toolsPopup.hide(),i.removeSelectedItem(t)})):l()(i.toolsPopup.drop.el).find(".".concat(n.dom)).click((function(t){t.preventDefault(),t.stopPropagation(),i.toolsPopup.hide(),i.emit(n.eventName,e)}))}))},reset:function(t){this.list.html(""),this._$items=[],this._items=[],this.selectedItem=[],this.emit("reset",t),this.dispose(),this.set(t),this.bindEvents()},refresh:function(){this.reset(this._items),this.hasToolsPopup&&this.templateToolsPopup&&this.tools.length&&this.list.on("click",this.dom.toolsIcon,this.createToolsPopup)},set:function(t){if(t)if((t.length||void 0!==(null==t?void 0:t.Id)&&null!==(null==t?void 0:t.Id))&&this.hidePlaceholder(),u.a.isArray(t))u()(t).forEach(this.set,this);else{var e=this._items.length;this.emit("add",t),this._items.push(t),this.renderItem(t,e,this.options)}},_removeItemByItem:function(t,e){t.splice(u.a.indexOf(t,e),1)},_removeItem:function(t){this._removeItemByItem(this._items,t)},_removeNodeItem:function(t){this._removeItemByItem(this._$items,t)},_removeNode:function(t){this._$items[t].remove(),this.count()-1==0&&this.showPlaceholder()},_removeAllSelected:function(){u.a.each(this.getSelected(),this._removeItem,this),u.a.each(this._getSelectedNodes(),this._removeNodeItem,this),this.resetSelectedIndex()},_removeAllSelectedNodes:function(){u.a.each(this.getSelectedIndex(),this._removeNode,this)},removeAt:function(t){this._removeNode(t),this._items.splice(t,1),this._$items.splice(t,1)},removeSelected:function(){this.multiple?(this._removeAllSelectedNodes(),this._removeAllSelected()):this.removeAt(this.getSelectedIndex())},has:function(t){return!!this.get(t)},find:function(t,e){return u.a.find(this._items,t,e)},bindEvents:function(){this.onClickItem=u.a.bind(this.onClickItem,this),this.list.on("click","li",this.onClickItem),this.list.on("selectstart","li",v)},render:function(){return this.unbindClick||(this.list.on("click","li",this.onClickItem),this.list.on("selectstart","li",v)),this.hasRemoveIcon&&this.list.on("click",this.dom.removeIcon,this.removeSelectedItem),this.hasToolsPopup&&this.templateToolsPopup&&this.tools.length&&this.list.on("click",this.dom.toolsIcon,this.createToolsPopup),this.list.appendTo(this.el),this},onClickItem:function(t){if(!(this.isDisabled||l()(t.currentTarget).hasClass("is-disabled")||this.itemsNotClickables)){t.preventDefault();var e=l()(t.currentTarget);if(!e.hasClass(this.classes.placeholder)){var i=e.index();this.emit("select",this._items[i]),this.multiple&&t.ctrlKey?(this.isAlreadySelected(i)?this.withoutSelected(i):this.addSelected(i),this._selectedPivot=i):this.multiple&&t.shiftKey?this.addSelectedMultiple(i):(this.setSelected(i),this._selectedPivot=i),this.emit("selected",this.getSelectedIndex())}}},renderItem:function(t,e,i){var n=g(g({},i),t);i.hasToolsPopup&&(t.hasToolsPopup=i.hasToolsPopup),i.roleName&&(t.roleName=i.roleName);var o=this.template(n),s=this._$items[e]=this._getItemContainer();this.list.append(s.html(o)),0===e?this._$items[0].find("a").attr("tabindex",0).attr("role","tab").attr("aria-selected",!0):this._$items[e].find("a").attr("role","tab").attr("aria-label",t.tooltip).attr("tabindex",-1).attr("aria-selected",!1),t.isDisabled&&f.default.disable(s)},getItemOffsetHeight:function(){return this._$items.length&&this._$items[0][0].offsetHeight},move:function(t){var e=this.getSelectedIndex();e>-1?"prev"===t?e&&e--:e<this._items.length-1&&e++:"next"===t&&this._items.length>0&&e++,this.setSelected(e)},selectFirst:function(){this._items.length&&this.setSelected(0)},hasSelected:function(){var t=this.getSelectedIndex();return!!(this.multiple?t.length:t)},getSelected:function(){return this.selectedItem.length?this.multiple?u.a.map(this.selectedItem,(function(t){return this._items[t]}),this):this._items[this.selectedItem[0]]:null},_getSelectedNodes:function(){return this.selectedItem.length?this.multiple?u.a.map(this.selectedItem,(function(t){return this._$items[t]}),this):this._$items[this.selectedItem[0]]:null},getSelectedIndex:function(){return this.multiple?this.selectedItem:this.selectedItem.length>0?this.selectedItem[0]:-1},resetSelectedIndex:function(){this.selectedItem=[]},resetSelected:function(){for(var t;(t=this.selectedItem.pop())>=0;)this._removeSelectedClass(t)},setSelected:function(t){this.resetSelected(),this.addSelected(t)},addSelected:function(t){this.selectedItem.push(t),this.hasRemoveIcon||this._addSelectedClass(t),this.emit("itemfocus",this._items[t],t,this._$items[t])},addSelectedMultiple:function(t){var e,i;for(this.selectedItem.length||(this._selectedPivot=0),this._selectedPivot>t?(e=t,i=this._selectedPivot):(e=this._selectedPivot,i=t),this.resetSelected();e<=i;e++)this.addSelected(e)},changeClasses:function(t,e){this.getSelectedIndex()>-1&&(e?this._$items[this.getSelectedIndex()].addClass(t):this._$items[this.getSelectedIndex()].removeClass(t))},withoutSelected:function(t){this.selectedItem=u.a.without(this.selectedItem,t),this._removeSelectedClass(t)},_setSelectedClass:function(t,e){var i=this._$items[t];i&&(i["".concat(e?"add":"remove","Class")]("is-selected selected"),i.attr("aria-selected",e))},_addSelectedClass:function(t){this._setSelectedClass(t,!0)},_removeSelectedClass:function(t){this._setSelectedClass(t,!1)},isAlreadySelected:function(t){return u.a.indexOf(this.selectedItem,t)>-1},focusItem:function(t){var e=this._$items[t];this.list.animate({scrollTop:e.position().top},"slow")},_getItemContainer:function(t){return l()("<li ".concat(this.itemAriaAttrs,">")).addClass(t||this.classes.item)},_defaultTemplate:function(t){var e=o()(t);return"string"===e?t:"object"===e&&t.label?t.label:""},enable:function(){f.default.enable(this.list),this.isDisabled=!1},disable:function(){f.default.disable(this.list),this.isDisabled=!0},dispose:function(){var t=this;u.a.each(this.registeredEvents,(function(e){t.list.off(e)}))},each:function(t,e){"function"==typeof t&&u.a.each(this._items,(function(i,n){t.call(e,i,this._$items[n])}),this)}});e.default=b},28:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(19),u=i.n(c);function d(t){var e=[],n=[],s=null,a=this;function c(){var t;return a.loadingContext=t=u.a.defer(),u.a.all([window.contentLoader.getPromiseObject("beezySettings").promise,window.contentLoader.getPromiseObject("beezyContext").promise]).then((function(){r.a.cachedScript("".concat(beezySettings.BaseSiteCollectionUrl,"/Style%20Library/beezy/js/page.productcontext").concat(window.beezyContext.IsDebugJs?".js":".min.js"),{success:function(){t.resolve()},error:function(){t.reject()}})})),t.promise}function d(t){try{return t.extLib?i(t.extLib)(t.id):i(t.id)}catch(e){t.extLibId||(i.c[t.id]=null)}return null}function h(t){var e=d(t),i=/^Javascript\/debug\/models\//gi,n=/^Javascript\/debug\/collections\//gi,o=/^Javascript\/debug\/utils\//gi,r=/^Javascript\/debug\/components\//gi,a=/^Javascript\/debug\/helpers\//gi,l=/^Javascript\/debug\/views\/activity\//gi,c=/^Javascript\/debug\/views\/attachments\//gi,u=/^Javascript\/debug\/views\/components\//gi,h=/^Javascript\/debug\/views\/dialogs\//gi,f=/^Javascript\/debug\/views\/forms\//gi,p=/^Javascript\/debug\/views\/microblog\//gi,m=/^Javascript\/debug\/views\/mixins\//gi,g=/^Javascript\/debug\/views\/mysite\//gi,v=/^Javascript\/debug\/views\/partials\//gi,b=/^Javascript\/debug\/views\/wall\//gi,y=/^Javascript\/debug\/views\/webparts\//gi,C=/^Javascript\/debug\/views\/widgets\//gi,w=/^Javascript\/debug\/views\//gi,T=/^Javascript\/debug\/main\//gi;if(e)return e;if(!s)throw Error("[ERROR]: Product context not ready. Try with define instead");if(l.test(t.path))return s.Views.Activities.get(t.path.replace(l,"./"));if(c.test(t.path))return s.Views.Attachments.get(t.path.replace(c,"./"));if(u.test(t.path))return s.Views.Components.get(t.path.replace(u,"./"));if(h.test(t.path))return s.Views.Dialogs.get(t.path.replace(h,"./"));if(f.test(t.path))return s.Views.Forms.get(t.path.replace(f,"./"));if(p.test(t.path))return s.Views.Microblog.get(t.path.replace(p,"./"));if(m.test(t.path))return s.Views.Mixin.get(t.path.replace(m,"./"));if(g.test(t.path))return s.Views.MySite.get(t.path.replace(g,"./"));if(v.test(t.path))return s.Views.Partial.get(t.path.replace(v,"./"));if(b.test(t.path))return s.Views.Walls.get(t.path.replace(b,"./"));if(y.test(t.path))return s.Views.Webparts.get(t.path.replace(y,"./"));if(C.test(t.path))return s.Views.Widgets.get(t.path.replace(C,"./"));if(w.test(t.path))return s.Views.get(t.path.replace(w,"./"));if(i.test(t.path))return s.Models.get(t.path.replace(i,"./"));if(n.test(t.path))return s.Collections.get(t.path.replace(n,"./"));if(o.test(t.path))return s.Utils.get(t.path.replace(o,"./"));if(r.test(t.path))return s.Components.get(t.path.replace(r,"./"));if(a.test(t.path))return s.Helpers.get(t.path.replace(a,"./"));if(T.test(t.path))return s.Main.get(t.path.replace(T,"./"));throw Error("[ERROR]: Can not resolve this path: ".concat(t.path))}function f(t,e,i,n){try{var s=e.apply(void 0,o()(function(t){return l.a.sortBy(t,(function(t){return t.ndx})).map((function(t){return t.resource}))}(n)));i.resolve(s)}catch(e){p(e,t,!0),i.reject(a.unresolved)}}function p(t,e,i){i?console.info("[ERROR] Some error ocurred inside the module ".concat(e,":")):a.unresolved&&a.unresolved.length?(console.info("[ERROR] Some modules can not be resolved in module ".concat(e,":")),console.info("Afected modules are: ".concat(JSON.stringify(a.unresolved,null,2)))):console.info("[ERROR] Some unexpected error ocurred in module ".concat(e,":")),console.info("Exception thrown: ".concat(t))}this.isLoaded=!0,this.mappings=t,this.setContext=function(t){s=t},this.areAllWaitsResolved=function(){return!0===window.__brandingJSLoaded&&!0===window.__DOMLoaded&&(!n.length||null==l.a.find(n,(function(t){return t.promise.isPending()})))},this.addEntryPoint=function(t,i,n){e.push({initCallback:t,promiseNames:i,priority:n})},this.getPromisesObjects=function(t,e){return l.a.pluck(l.a.filter(t,(function(t){return l.a.contains(e,t.key)})),"promiseServer")},this.getModulesByPriority=function(t){return t?l.a.filter(e,(function(e){return e.priority===t})):l.a.filter(e,(function(t){return void 0===t.priority}))},this.init=function(t,e){var i=this.getModulesByPriority(e);l.a.each(i,(function(e){var i=a.getPromisesObjects(t,e.promiseNames);e.initCallback.apply(this,i)}))},this.define=function(t,e,i,o){var r,m=u.a.defer();if(o)if(l.a.isFunction(o)){if(!o())return}else if(!function(t){return!beezyContext.CurrentPageKey||null!=l.a.find(t,(function(t){return t.toLowerCase()===beezyContext.CurrentPageKey.toLowerCase()}))}(o=l.a.isArray(o)?o:[o]))return;r=m,n.push(r);try{var g=[],v=[],b=[];(e=l.a.isArray(e)?e:[e]).push(window.contentLoader.getPromiseObject("beezyCurrentUser")),e.push(window.contentLoader.getPromiseObject("beezySettings")),e.push(window.contentLoader.getPromiseObject("beezyCurrentGroup")),e.push(window.contentLoader.getPromiseObject("beezyContext")),e.push(window.contentLoader.getPromiseObject("beezyContent"));for(var y=0,C=e.length;y<C;y++){var w=e[y];if(w.promise)b.push({promise:w.promise,ndx:y});else if(w.path&&w.id){var T=d(w);T?g.push({resource:T&&T.default?T.default:T,ndx:y}):v.push({request:w,ndx:y,fail:!1})}else g.push({resource:w,ndx:y})}if(b.length||v.length&&!s){if(this.loadingContext?b.unshift({promise:a.loadingContext.promise,isLoading:!0}):!this.loadingContext&&v.length&&b.unshift({promise:c(),isLoading:!0}),u.a.allSettled(l.a.map(b,(function(t){return t.promise}))).then((function(e){for(var n=0,o=e.length;n<o;n++)b[n].ndx&&g.push({resource:e[n].value,ndx:b[n].ndx});a.unresolved=function(t,e,i){for(;null!=l.a.find(i,(function(t){return!1===t.fail}));){var n=null;try{n=h(i[0].request)}catch(t){i[0].exception=t}var o=i.shift();n?e.push({resource:n&&n.default?n.default:n,ndx:o.ndx}):(o.fail=!0,i.push(o))}return i}(0,g,v),v.length?p(new Error("Can not resolve some modules"),t):f(t,i,m,g)}),(function(e){throw a.unresolved=v,p(new Error("Can not resolve some modules: ".concat(e)),t),e})),a.unresolved&&a.unresolved.length)throw new Error("Can not resolve some modules")}else f(t,i,m,g)}catch(e){p(e,t),m.reject(a.unresolved)}return m},r.a.cachedScript=function(t,e){return e=r.a.extend(e||{},{dataType:"script",cache:!0,url:"".concat(t,"?v=").concat(beezySettings.CurrentVersion)}),r.a.ajax(e)}}window.BeezyApp||(window.BeezyApp=new d),window.BeezyApp&&!window.BeezyApp.isLoaded&&window.BeezyApp.mappings&&(window.BeezyApp=new d(window.BeezyApp.mappings),r()(window.document).trigger("appcreated")),e.default=window.BeezyApp},281:function(t,e,i){"use strict";var n=i(138);i.d(e,"createModalContainer",(function(){return n.createModalContainer}));var o=i(2213);i.d(e,"dispatchEvent",(function(){return o.dispatchEvent}))},293:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(3),r=i.n(s),a=i(889),l=i(295),c=i(15),u=i(8),d=i(17),h=i(2366),f=i.n(h),p=i(1266),m=i(1865),g=i(1267);function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function b(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var y={dom:{votes:".js-votes-count",votesText:".js-vote-icon",mainContent:".js-content-main",pollButtonText:".js-pollbuttontext"},viewsId:{EMPTY:"voteAndResults",VOTES:"votes",RESULTS:"results"},initializeWithOptions:function(){this.configureDisplayView(),this.calculatePercentage()},initializeWithoutOptions:function(){this.initializeWithOptions(),this.renderOptions(),this.delegateEvents(this.extendEventsPoll("toggle")),this.enablePollButton(this.texts[this.displayedView])},initializePolls:function(){var t;this.isMultiOption=l.default.isMultiOption(this.model),this.inDashboard=!this.model.has("Comments"),this.collection=this.isMultiOption?new a.PollMultiOptions([],{activityId:this.model.id}):new a.PollOptions([],{activityId:this.model.id}),this.inDashboard?(t="show",this.displayedView=this.viewsId.EMPTY,this.listenToOnce(this.collection,"reset",this.initializeWithoutOptions)):(t="toggle",this.collection.reset(this.model.get("Comments")),this.initializeWithOptions()),this.delegateEvents(this.extendEventsPoll(t))},extendEventsPoll:function(t){var e={"click [data-region=poll-button]":t};return b(b({},this.events),e)},configureDisplayView:function(){var t=u.default.isModerated()&&!u.default.isCurrentUserMember();this.collection.isAlreadyVoted()||c.default.isReadOnly()||t?(this.displayedView=this.viewsId.RESULTS,this.hiddenView=this.viewsId.VOTES):(this.displayedView=this.viewsId.VOTES,this.hiddenView=this.viewsId.RESULTS)},renderOptions:function(){var t=this,e={collection:this.collection},i=!1;this.$(this.dom.mainContent).append(f()()),this.poll=this.isMultiOption?new m.default(e).render():new p.default(e).render(),this.collection.isAlreadyVoted()?(this.texts.results=this.texts.myresults,i=!0):c.default.isReadOnly()?(this.texts.results=this.texts.resultsInit,i=!0):this.texts.results=this.texts.resultsInit;var n=new g.default(e).render(),o=b({},this._childViewsId);r.a.each(o,(function(e){t.removeView(e)})),this.addView(this.viewsId.VOTES,this.poll,!0),this.addView(this.viewsId.RESULTS,n,!0),this.getView(this.displayedView).show(),this.listenTo(this.getView("votes"),"vote",this.onVote),this.setPollButtonText(i?this.texts.results:this.texts.votes),this.updateTotalVotes()},addTmplAttribute:function(t,e,i){var n;if(r.a.isString(t))(n={})[t]=e;else{if(!r.a.isObject(t))throw new Error("Invalid attribute ".concat(t));n=t}i&&(this.context=i),r.a.extend(this.context,n)},noop:function(){},show:function(){var t=this;this.delegateEvents(this.extendEventsPoll("noop")),this.disablePollButton(this.texts.loading),this.collection.fetch({reset:!0}).done((function(){t.updateTotalVotes()}))},toggle:function(){if(c.default.isReadOnly())return d.default.showReadOnlyModal();this.swapViews()},swapViews:function(){var t=this.displayedView;this.displayedView=this.hiddenView,this.hiddenView=t,this.updateViews()},updateViews:function(){this.getView(this.hiddenView).hide(),this.getView(this.displayedView).show(),this.setPollButtonText(this.texts[this.displayedView])},updateChart:function(){this.calculatePercentage(),this.getView(this.viewsId.RESULTS).updatePercentages(),this.swapViews()},_normalizePercentages:function(t,e){var i,n,o,s,a=100-t;if(a){o=(n=this._getArrayOfDecimals(e)).slice().sort();do{s=r.a.lastIndexOf(n,o.pop()),(i=this.collection.at(s)).set("percentage",i.get("percentage")+1),n.splice(s,1),a--}while(a)}},_getArrayOfDecimals:function(t){var e;return t.map((function(t){return(e=String(t).split(".")).length>1?parseInt(e[1],10):0}))},disablePollButton:function(t){this.region("poll-button").attr("disabled","true").addClass("disabled"),this.setPollButtonText(t)},enablePollButton:function(){this.region("poll-button").removeAttr("disabled").removeClass("disabled")},setPollButtonText:function(t){t&&(this.$el.find(this.dom.pollButtonText).text(t),this.$el.find(this.dom.votesText).attr("aria-label",t))},onVote:function(t){this.collection.isAlreadyVoted()?this.texts.results=this.texts.myresults:this.texts.results=this.texts.resultsInit,this.updateChart(),this.updateTotalVotes(t),this.trigger("vote",t)},updateTotalVotes:function(t){var e=t;e||0===e||(e=this.model.get("TotalOfPeopleLiked")||l.default.getTotalOfPeopleVoted(this.model)),e>0?this.$(this.dom.votes).text(e):this.$(this.dom.votes).text(""),this.region("vote-count").show()},calculatePercentage:function(){var t,e,i=this,n=0,o=r.a.pluck(this.collection.toJSON(),"TotalOfLikes"),s=r.a.reduce(o,(function(t,e){return t+e}),0),a=o.map((function(o,r){return t=s?100*o/s:0,e=Math.floor(t),i.collection.at(r).set("percentage",e),n+=e,t}));s&&this._normalizePercentages(n,a)}};e.default=y},294:function(t,e,i){"use strict";i.r(e);var n=i(1932),o=i(5),s=i(18),r=i(7),a=i(196),l=i(57),c=i(47),u=i(2),d=function(t){var e=new a.default({el:c.default.createDialogContainer("modal--delete-alert modal--delete-item"),listPageUrl:t.listPageUrl,showCheckboxList:!0,title:Object(u.translate)("Delete item?"),description:Object(u.translate)("You are about to remove this item. Please check the statements below to make sure you understand the consequences."),buttons:[{id:"confirm",label:Object(u.translate)("Yes, delete"),class:"full-width",ariaDisabled:!0}],componentItems:[{id:"dialog-delete-option-".concat(Object(n.v4)()),value:0,label:Object(u.translate)("All newsfeed activity will be deleted (comments, likes and tags)"),checked:!1},{id:"dialog-delete-option-".concat(Object(n.v4)()),value:1,label:Object(u.translate)("All related files will be deleted"),checked:!1}]});e.on("close",(function(){i.hide()})),e.on("confirm",(function(t){var e=this,n=o.default.getQueryString().AttachmentId?Number(o.default.getQueryString().AttachmentId):null,a=!!n;if(t){if(this.confirmButtonEnabled())if(this.model._type===r.default.AttachmentType.MEDIA)this.model.id=n||this.model.get("Attachments")[0].Id,this.model.destroyWithoutValidation({data:JSON.stringify({Id:this.model.get("Activity").Id}),attachmentId:this.model.get("Id")},this.listPageUrl,this.$el.find(".js-confirm")),this.model.on("attachmentDestroyed",(function(){s.default.redirectToUrl(e.listPageUrl)}));else if(this.model._type===r.default.Type.DOCUMENT){this.model.id=n||this.model.get("Attachments").length>0?this.model.get("Attachments")[0].Id:this.model.id;var l="".concat(this.model.get("Group").Url,"/SitePages/Files.aspx");this.model.destroyWithoutValidation({},this.listPageUrl,this.$el.find(".js-confirm")),this.model.on("removed",(function(){a?s.default.redirectToUrl(o.default.getBaseSiteHost()+l):e.trigger("itemRemoved")}))}else this.model._type===r.default.Type.EXTENDEDIDEA?(this.model.destroyWithoutValidation({data:JSON.stringify({Id:this.model.id})},"",this.$el.find(".js-confirm")),this.model.on("removed",(function(){e.trigger("itemRemoved")}))):(this.model.destroyWithoutValidation({data:JSON.stringify({Id:this.model.id})},this.listPageUrl,this.$el.find(".js-confirm")),this.model.on("removed",(function(){e.trigger("itemRemoved")})))}else i.hide()}));var i=new l.default(e,{dialogClass:"close-dialog",extend:{width:600,showCrossButton:!0},buttons:[],onClose:t.onClose});return e.setDialog(i),(d=function(t){return e.setModel(t.model),e.render(),e.postRender(),i.show(),e})(t)};e.default=d},295:function(t,e,i){"use strict";i.r(e);var n=i(7);e.default={getTotalOfPeopleVoted:function(t){var e=("function"==typeof t.get?t.get("MetadataProperties"):t.MetadataProperties).find((function(t){return t.Name===n.default.MetadataProperties.TotalOfPeopleVoted}));return e?parseInt(e.Value,10):void 0},isMultiOption:function(t){var e=t.get("MetadataProperties").find((function(t){return t.Name===n.default.MetadataProperties.IsMultiOption}));return!(!e||!0!==JSON.parse(e.Value))}}},30:function(t,e,i){"use strict";i.r(e),i.d(e,"checkOutPage",(function(){return f})),i.d(e,"deletePage",(function(){return p})),i.d(e,"getCurrentLCID",(function(){return g})),i.d(e,"getCurrentUICultureName",(function(){return v})),i.d(e,"getSharePointItem",(function(){return m})),i.d(e,"isSharepointModern",(function(){return a})),i.d(e,"prepareSharePointLeftBar",(function(){return h})),i.d(e,"sharePointItems",(function(){return c})),i.d(e,"sharePointModernItems",(function(){return u})),i.d(e,"sharePointSizes",(function(){return d}));var n=i(4),o=i.n(n),s=i(7),r=i(18),a=function(){return void 0!==window.beezyModernEnvironment&&window.beezyModernEnvironment},l=function(){return a()?o()('.mainContent [data-is-scrollable="true"]').length?o()('.mainContent [data-is-scrollable="true"]'):o()('[data-is-scrollable="true"][data-automationid="content"]'):-1!==s.default.PagesWithoutMaster.indexOf(beezyContext.CurrentPageKey)?o()("body"):o()("#s4-workspace")},c=function(){return{topBar:o()("#suiteBar"),topBarCloud:o()("#suiteBarTop"),ribbon:o()("#s4-ribbonrow"),ribbonBox:o()("#ribbonBox"),titlerow:o()("#titlerow"),content:l(),innerElement:o()("#contentRow"),search:o()("#searchInputBox input"),bodyContainer:o()("#s4-bodyContainer"),getContentElement:l,iframeContent:o()("body"),mainContainer:o()("#s4-workspace"),s4titlerow:o()("#s4-titlerow")}},u=function(){return{commandBar:o()(".commandBarWrapper"),toolbar:o()('[class*="md-toolbar"]'),navBar:o()("#O365_NavHeader"),appBar:o()("#sp-appBar")}},d={ribbon:{height:function(){var t=c().ribbon.outerHeight()||c().ribbonBox.outerHeight(),e=c().topBar.length?c().topBar.outerHeight()+t:c().topBarCloud.length?c().topBarCloud.outerHeight()+t:t;return o()("".concat(c().ribbon.selector,":visible")).length||(e-=c().ribbon.height()),o()("".concat(c().topBar.selector,":visible")).length||(e-=c().topBar.height()),o()("".concat(c().topBarCloud.selector,":visible")).length||(e-=c().topBarCloud.height()),e}},ribbonModern:{height:function(){var t=u().commandBar.outerHeight()+u().toolbar.outerHeight(),e=u().navBar.length?u().navBar.outerHeight()+t:t;return o()("".concat(u().navBar.selector,":visible")).length||(e-=u().navBar.height()),o()("".concat(u().commandBar.selector,":visible")).length||(e-=u().commandBar.height()),o()("".concat(u().toolbar.selector,":visible")).length||(e-=u().toolbar.height()),e}},appBarModern:{width:function(){return u().appBar.outerWidth()}}},h=function(){var t=o()("#leftactions"),e=o()("#MSO_ContentTable");if(t.length&&e.length){var i=t.children().length;!i||1===i&&t.find(".s4-recentchanges").length||(SP.SOD.executeOrDelayUntilScriptLoaded((function(){var t=SP.UI.ApplicationPages.CalendarInstanceRepository.firstInstance();t&&t.getActiveScope()===SP.UI.ApplicationPages.CalendarScope.monthly&&MoveView("month")}),"SP.UI.ApplicationPages.Calendar.js"),e.find(".ms-srch-siteSearchResults").length?(t.removeClass("left-actions-container").addClass("search-results-parameters"),e.addClass("search-results-data")):(t.removeClass("left-actions-container").addClass("left-side-actions-panel"),e.addClass("right-side-results-panel")))}},f=function(t,e,i,n,o){var s=o?new SP.ClientContext(o):SP.ClientContext.get_current(),a=s.get_site().openWeb(n),l=a.getFileByServerRelativeUrl(i||window.location.pathname);s.load(l);var c=a.get_lists().getById(e||window._spPageContextInfo.pageListId);s.load(c),s.executeQueryAsync((function(){c.get_enableMinorVersions()&&c.get_forceCheckout()&&0!==l.get_checkOutType()?(l.checkOut(),s.load(l),s.executeQueryAsync((function(){r.default.redirectToUrl(t)}))):r.default.redirectToUrl(t)}))},p=function(t){var e=SP.ClientContext.get_current(),i=e.get_web().getFileByServerRelativeUrl(window.location.pathname);e.load(i),e.executeQueryAsync((function(){i.deleteObject(),e.executeQueryAsync((function(){r.default.redirectToUrl(t)}))}))},m=function(t){return c()[t]},g=function(){return _spPageContextInfo.currentLanguage},v=function(){return _spPageContextInfo.currentUICultureName}},303:function(t,e,i){"use strict";i.r(e),e.default={isCurrentPageDetail:function(){return["publishing","filesdetails","calendardetails","pollsdetails","tasksdetails"].indexOf[beezyContext.CurrentPageKey]>-1},isCurrentPageFilesDetail:function(){return"filesdetails"===beezyContext.CurrentPageKey},isCurrentPageStory:function(){return"article"===beezyContext.CurrentPageKey||"publicArticle"===beezyContext.CurrentPageKey},isCurrentPageCorporateSite:function(){return"corporatesite"===beezyContext.CurrentPageKey},getCurrentNetworkId:function(){return beezyContext.CurrentNetworkId||0},isLinksPage:function(){return"links"===beezyContext.CurrentPageKey},hasCurrentActivityAttachments:function(){return!!(beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Attachments)&&beezyContext.CurrentActivity.Attachments.length>0}}},305:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(26),s=i(63),r=i(10),a=i(3),l=i.n(a),c=o.default.extend({url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId,"/Hashtags")},initialize:function(t){this.activityId=t.IdActivity,this.userId=t.userId||void 0},_delete:function(t){var e=this;r.default.del("".concat(n.default.getApiUrlv2(),"/Activities/").concat(t.activityId,"/Hashtags/").concat(t.hashtagId)).done((function(){e.trigger("success")}))},follow:function(){return r.default.postJSON("".concat(n.default.getApiUrlv2(),"/Users/Current/Hashtags?hashTag=").concat(encodeURIComponent(this.get("Name"))))},unFollow:function(){return r.default.del("".concat(n.default.getApiUrlv2(),"/Users/Current/Hashtags?hashTag=").concat(encodeURIComponent(this.get("Name"))))},getValue:function(){return r.default.get("".concat(n.default.getApiUrlv2(),"/Hashtags/Activities/Count?hashtag=").concat(this.get("Name")))},getValueGroup:function(t){return r.default.get("".concat(n.default.getApiUrlv2(),"/Groups/").concat(t,"/Hashtags/Activities/Count?hashtag=").concat(encodeURIComponent(this.get("Name"))))}}),u=o.default.extend({initialize:function(t){var e=new s.default;this.activityId=t.IdActivity||e.getId()},urlRoot:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Editorials/").concat(n.default.getEditorialModule().GroupId,"/Stories/").concat(this.activityId,"/Hashtags")},_delete:function(){var t=this;this.destroy({success:function(){t.trigger("success")}})}}),d=o.default.extend({initialize:function(t){var e=new s.default;this.activityId=t.IdActivity||e.getId()},urlRoot:function(){var t=n.default.getApiUrlv2MSC(),e=n.default.getCorporateModule().GroupId;return"".concat(t,"/CorporateModules/").concat(e,"/CorporatePages/").concat(this.activityId,"/Hashtags")},_delete:function(){var t=this;this.destroy({success:function(){t.trigger("success")}})}}),h=o.default.extend({initialize:function(t){this.topicId=t.topicId},urlRoot:function(){var t=n.default.getApiUrlv2MSC(),e=n.default.getCorporateModule().GroupId;return"".concat(t,"/CorporateModules/").concat(e,"/Topics/").concat(this.topicId,"/Hashtags")}}),f=o.default.extend({url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId,"/Hashtags")},follow:function(){return r.default.postJSON("".concat(n.default.getApiUrlv2(),"/Users/Current/Hashtags?hashTag=").concat(encodeURIComponent(this.get("Name"))))},unFollow:function(){return r.default.del("".concat(n.default.getApiUrlv2(),"/Users/Current/Hashtags?hashTag=").concat(encodeURIComponent(this.get("Name"))))},getValue:function(){return r.default.get("".concat(n.default.getApiUrlv2(),"/Hashtags/Activities/Count?hashtag=").concat(encodeURIComponent(this.get("Name"))))},getValueGroup:function(){return r.default.get("".concat(n.default.getApiUrlv2(),"/Groups/").concat(this.get("GroupId"),"/Hashtags/Activities/Count?hashtag=").concat(encodeURIComponent(this.get("Name"))))}}),p=f.extend({getValueGroup:function(){return r.default.get("".concat(n.default.getApiUrlv2(),"/Editorials/").concat(n.default.getEditorialModule().GroupId,"/Stories/Search/Count?hashtag=").concat(encodeURIComponent(this.get("Name"))))}}),m=f.extend({getValueGroup:function(){return r.default.get("".concat(n.default.getApiUrlv2(),"/CorporateModules/").concat(n.default.getCorporateModule().GroupId,"/CorporatePages/Search/Count?hashtag=").concat(encodeURIComponent(this.get("Name"))))}}),g=p.extend({idAttribute:"Name",initialize:function(){},urlRoot:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Editorials/").concat(n.default.getEditorialModule().GroupId,"/Users/Current/Hashtags")},sync:function(t,e,i){return l.a.extend(i,{url:"".concat(this.urlRoot(),"/").concat(encodeURIComponent(this.get("Name")),"/Follow")}),g.__super__.sync.call(this,t,e,i)}}),v=o.default.extend({url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId,"/Hashtags")},addSkill:function(t){return r.default.postJSON("".concat(n.default.getApiUrlv2(),"/Users/Current/Skills"),{Name:t})},delSkill:function(t){return r.default.del("".concat(n.default.getApiUrlv2(),"/Users/Current/Skills"),{Name:t})},validateSkill:function(t){return r.default.postJSON("".concat(n.default.getApiUrlv2(),"/Users/").concat(this.get("userId"),"/Skills"),{Name:t})},deleteEndorsement:function(t){return r.default.del("".concat(n.default.getApiUrlv2(),"/Users/").concat(this.get("userId"),"/Skills"),{Name:t})}});e.default={Tag:c,MicroTag:f,Skill:v,StoryTag:u,ActivityHashtagStoryCountModel:p,CurrentStoriesTags:g,ActivityHashtagPagesCountModel:m,CorporateTag:d,TopicTag:h}},306:function(t,e,i){"use strict";i.d(e,"createRenderMicrobox",(function(){return d})),i.d(e,"handleRenderMicrobox",(function(){return h})),i.d(e,"handleFocusMicrobox",(function(){return f})),i.d(e,"handleBlurMicrobox",(function(){return p})),i.d(e,"handleReplyMicrobox",(function(){return m})),i.d(e,"handleGetDataMicrobox",(function(){return g})),i.d(e,"handleGetDataMessageMicrobox",(function(){return v})),i.d(e,"handleResetMicrobox",(function(){return b})),i.d(e,"handleInitTextMicrobox",(function(){return y}));var n,o=i(4),s=i.n(o),r=i(584),a=i(33),l=i(7),c=i(2),u="a11y-microbox",d=function(t){var e=t.isTall,i=void 0!==e&&e,n=t.placeholderText,o=void 0===n?Object(c.translate)("Say something about this..."):n,d=t.labelText,h=void 0===d?"".concat(Object(c.translate)("Add details")," *"):d,f=t.labelTextId,p=t.initialValue,m=void 0===p?"":p;return function(t){var e=s()(t),n=f||u,c=r.default.init(e,{labelText:h,labelTextId:n,placeholderText:o,MaximumUsers:l.default.maximumDisplayableUsersDropdown,UserSearchAdapter:a.default.searchAdapter("Users"),HashtagSearchAdapter:a.default.searchAdapter("Hashtags"),isTall:i});return h&&c.createLabelText(h,n),m&&c.initText(m),c}},h=function(t){var e=t.isTall,i=void 0!==e&&e,o=t.labelText,d=t.labelTextId,h=t.placeholderText,f=void 0===h?Object(c.translate)("Say something about this..."):h,p=t.isRequired,m=void 0!==p&&p;return function(t){var e=s()(t),c=d||u;n=r.default.init(e,{placeholderText:f,labelTextId:c,MaximumUsers:l.default.maximumDisplayableUsersDropdown,UserSearchAdapter:a.default.searchAdapter("Users"),HashtagSearchAdapter:a.default.searchAdapter("Hashtags"),isTall:i,isRequired:m}),o&&n.createLabelText(o,c)}},f=function(){n&&n.focusInLastCharacter()},p=function(){n&&n.blur()},m=function(){var t=n.getData().message;return n.disable(),n.reset(),t},g=function(){return n&&n.getData()},v=function(){return n&&n.getData().message},b=function(){return n&&n.reset()},y=function(t,e,i){n.setUsers(i),n.setHashtags(e),n.initText(t,e,i)}},310:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n);function s(t){return void 0!==t}function r(){}r.prototype={on:function(t,e,i){var n=this.listeners(t);return function(t,e){for(var i,n=t.length;n--;){if((i=t[n][0])===e||i.listener&&i.listener===e)return n;if(i.toString()===e.toString()||i.listener&&i.listener===e)return n}return-1}(n,e)<0&&n.push([e,i]),this},off:function(t,e){var i=e?"".concat(t,":").concat(e):t,n=this.listeners(i);return n.length>0&&this.listeners(i).splice(0,n.length-1),this},emit:function(t){var e=this.listeners(t).slice(),i=1===arguments.length,n=Array.prototype.slice,o=0,r=e.length;for(this.emitKeyEvent(t,arguments,i,n);o<r;o++)i?s(e[o][1])?e[o][0].call(e[o][1]):e[o][0]():e[o][0].apply(e[o][1],n.call(arguments,1))},filterKeyListeners:function(t){return this._keyListeners=this._keyListeners||[],o.a.filter(this._keyListeners,(function(e){return e.event===t}))},findKeyListener:function(t,e){this._keyListeners=this._keyListeners||[];var i=-1,n=o.a.find(this._keyListeners,(function(n){return i++,n.event===t&&n.key===e}));return n?{listener:n,ndx:i}:null},tryUpdateListener:function(t,e,i,n){var o=this.findKeyListener(t,n);o?this._keyListeners[o.ndx]={key:n,event:t,listener:e,scope:i}:this._keyListeners.push({key:n,event:t,listener:e,scope:i})},emitKeyEvent:function(t,e,i,n){var s=this.filterKeyListeners(t);s&&s.length&&o.a.each(s,(function(t){i?t.listener.call(t.scope):t.listener.apply(t.scope,n.call(e,1))}))},onByKey:function(t,e,i,n){this.tryUpdateListener(t,e,i,n)},offByKey:function(t,e){var i=this.findKeyListener(t,e);i&&this._keyListeners.slice(i.ndx,1)},dispose:function(){this._events={},this._keyListeners=[]},once:function(t,e,i){var n=this;function o(){e.apply(this,arguments),n.off(t,o)}return o.listener=e,this.on(t,o,i),this},when:function(t,e,i){var n=this;function o(){e.apply(this,arguments)&&n.off(t,o)}return o.listener=e,this.on(t,o,i),this},listeners:function(t){var e=this._events||(this._events={});return e[t]||(e[t]=[])}},r.mixin=function(t){for(var e=["on","off","emit","once","when","listeners","onByKey","offByKey","filterKeyListeners","emitKeyEvent","tryUpdateListener","findKeyListener","dispose"],i=e.length;i--;)t[e[i]]=r.prototype[e[i]]},e.default=r},311:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(116),l=i(7),c=i(12),u=i(2357),d=i.n(u),h=i(5),f=i(30),p=(i(120),[]),m=a.default.extend({classes:{open:"relativepopover--open",animationShow:"relativepopover--animation-show",animationHide:"relativepopover--animation-hide"},dom:{container:".js-relativepopover-container",content:".js-relativepopover-content"},template:d.a,init:function(){var t,e,i,n=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=s,this.hideOnBlur=this.options.hideOnBlur,this.parent=s.parent,this.$parent=o()(s.parent),this.position=s.position||l.default.DropPosition.CENTER,this.verticalPosition=s.verticalPosition||l.default.DropVerticalPosition.TOP,this.animated=s.animated||!1,this.triangle=null===(t=s.triangle)||void 0===t||t,this.shouldFlipVertical=null===(e=s.shouldFlipVertical)||void 0===e||e,this.shouldFlipHoritzontal=null===(i=s.shouldFlipHoritzontal)||void 0===i||i,this.role=s.role||"tooltip",this.id=s.id,this.classNames=s.classNames||"",this.fixed=s.fixed||!1,this.hasResponsive=s.hasResponsive||!1,this.mobileBreakpoint=s.mobileBreakpoint||"760",this.shown=!1,this.hidding=!1,this.handleAnimationEnd=r.a.bind(this.handleAnimationEnd,this),this.handleClick=r.a.bind(this.handleClick,this),this.handleKeyDown=r.a.bind(this.handleKeyDown,this),this.positionFixedIfNeeded=r.a.bind(this.positionFixedIfNeeded,this),c.default.subscribe("drop","HideAllDrops",(function(t){n.hideAll(t)})),p.push(this)},isResponsive:function(){return window.matchMedia("(max-width: ".concat(this.mobileBreakpoint,"px)")).matches},getContext:function(){return{role:this.role,id:this.id,hasId:void 0!==this.id,triangle:this.triangle,classNames:this.classNames,fixed:this.fixed}},getContainer:function(){return this.fixed?this.el.find(this.dom.container):this.el},render:function(){this.el=o()(this.template(this.getContext()));var t=this.getContainer();return t.hide(),t.on("animationend",this.handleAnimationEnd),this.parent.append(this.el),this},inject:function(t){this.node||(this.node=t,this.render(),this.el.find(this.dom.content).append(t))},show:function(){this.shown||(this.applyPositionsToBeVisible(),this.shown=!0,c.default.publish("drop","HideAllDrops",this),this.handleAnimationEnd(),this.animated&&this.getContainer().addClass(this.classes.animationShow),this.el.addClass(this.classes.open),this.getContainer().show(),this.emit("show"),o()(document).on("click",this.handleClick),o()(document).on("keydown",this.handleKeyDown),this.fixed&&(o()(window).on("resize",this.positionFixedIfNeeded),document.addEventListener("scroll",this.positionFixedIfNeeded,!0))),this.applyPositionsToBeVisible(),this.positionFixedIfNeeded()},hide:function(){this.shown=!1,this.animated&&(!this.hasResponsive||this.hasResponsive&&!this.isResponsive())?(this.hidding=!0,this.getContainer().addClass(this.classes.animationHide)):this.getContainer().hide(),this.el.removeClass(this.classes.open),this.emit("hide"),o()(document).off("click",this.handleClick),o()(document).off("keydown",this.handleKeyDown),this.fixed&&(o()(window).off("resize",this.positionFixedIfNeeded),document.removeEventListener("scroll",this.positionFixedIfNeeded))},hideAll:function(t){p.forEach((function(e){return e!==t&&e.shown&&e.hide()}))},toggle:function(){this.shown?this.hide():this.show()},clearDrop:function(){},handleAnimationEnd:function(){this.hidding&&(this.getContainer().removeClass(this.classes.animationHide),this.hidding=!1,this.shown=!1,this.getContainer().hide())},handleClick:function(t){this.hasResponsive&&(!this.hasResponsive||this.isResponsive())||!t.srcElement||o()(t.srcElement).hasClass(this.dom.container)||0!==o()(t.srcElement).parents(this.dom.container).size()?this.emit("click"):(this.hide(),this.hideOnBlur&&this.hideOnBlur())},handleKeyDown:function(t){"Esc"!==t.key&&"Escape"!==t.key||this.hide()},positionFixedIfNeeded:function(){if(this.fixed){var t=this.el[0].getBoundingClientRect(),e=this.getContainer();e.css("top",t.top);var i=e[0].getBoundingClientRect().width;e.css("left",t.left-i)}},applyPositionsToBeVisible:function(){var t=this,e=this.calculatePostionsToBeVisible(),i=e.position,n=e.verticalPosition,o={};o[l.default.DropPosition.LEFT]="relativepopover--left",o[l.default.DropPosition.CENTER]="relativepopover--center",o[l.default.DropPosition.RIGHT]="relativepopover--right";var s={};s[l.default.DropVerticalPosition.TOP]="relativepopover--top",s[l.default.DropVerticalPosition.BOTTOM]="relativepopover--bottom",Object.keys(o).forEach((function(e){t.el.removeClass(o[e])})),Object.keys(s).forEach((function(e){t.el.removeClass(s[e])})),this.el.addClass(o[i]),this.el.addClass(s[n])},calculatePostionsToBeVisible:function(){var t=this.position,e=this.verticalPosition;return this.hasResponsive&&this.isResponsive()||(this.shouldFlipVertical&&(this.verticalPosition===l.default.DropVerticalPosition.TOP&&this.outOfUpperBounds()?e=l.default.DropVerticalPosition.BOTTOM:this.verticalPosition===l.default.DropVerticalPosition.BOTTOM&&this.outOfLowerBounds()&&(e=l.default.DropVerticalPosition.TOP)),this.shouldFlipHoritzontal&&(this.position!==l.default.DropPosition.LEFT&&this.position!==l.default.DropPosition.CENTER||!this.outOfLeftBounds()?this.position!==l.default.DropPosition.RIGHT&&this.position!==l.default.DropPosition.CENTER||!this.outOfRightBounds()||(t=l.default.DropPosition.LEFT):t=l.default.DropPosition.RIGHT)),{position:t,verticalPosition:e}},outOfUpperBounds:function(){return(h.default.isInsideSharepointContainer()?this.$parent.offset().top-f.sharePointSizes.ribbon.height()-l.default.dropthreshold:this.$parent.offset().top-o()(document).scrollTop()-l.default.dropthreshold)<this.getContainer().outerHeight()},outOfLowerBounds:function(){return(h.default.isInsideSharepointContainer()?o()("html").height()-this.$parent.offset().top-l.default.dropthreshold:o()("html").height()-(this.$parent.offset().top-o()(document).scrollTop())-l.default.dropthreshold)<this.getContainer().outerHeight()},outOfRightBounds:function(){var t=this.el[0].getBoundingClientRect().right;return this.position===l.default.DropPosition.RIGHT?t+=this.getContainer().outerWidth():this.position===l.default.DropPosition.CENTER&&(t+=this.getContainer().outerWidth()/2),t>(window.innerWidth||document.documentElement.clientWidth)},outOfLeftBounds:function(){var t=this.el[0].getBoundingClientRect().left;this.position===l.default.DropPosition.LEFT?t-=this.getContainer().outerWidth():this.position===l.default.DropPosition.CENTER&&(t-=this.getContainer().outerWidth()/2);return t<0}});m.create=function(t,e){var i=new m({parent:t});return i.inject(e),i.render(),i},e.default=m},3112:function(t,e,i){var n,o;(function(){n=[i(4)],void 0===(o=function(t){!function(t){var e=/(\s*\S+|\s)$/;t.truncate=function(e,i){return t("<div></div>").append(e).truncate(i).html()},t.fn.truncate=function(i){t.isNumeric(i)&&(i={length:i});var n=t.extend({},t.truncate.defaults,i);return this.each((function(){var i=t(this);n.noBreaks&&i.find("br").replaceWith(" ");var o=i.text(),s=o.length-n.length;n.stripTags&&i.text(o),n.words&&s>0&&(s=o.length-o.slice(0,n.length).replace(e,"").length-1),s<0||!s&&!n.truncated||t.each(i.contents().get().reverse(),(function(e,i){var o=t(i),r=o.text().length;return r<=s?(n.truncated=!0,s-=r,void o.remove()):3===i.nodeType?(t(i.splitText(r-s-1)).replaceWith(n.ellipsis),!1):(o.truncate(t.extend(n,{length:r-s})),!1)}))}))},t.truncate.defaults={stripTags:!1,words:!1,noBreaks:!1,length:1/0,ellipsis:"…"}}(t)}.apply(e,n))||(t.exports=o)}).call(window)},313:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(95),r=i(17);e.default=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=o()(t||document.body).find(".js-mention");i.each((function(){var t=o()(this);if(!t.data("processed-profile")){var i=r.default.getUser(t.data("id"));i.attributes.IsReadOnly||(s.default.create(t,t,t.parent().find(".js-activity-header-quickprofile"),i,{popoverOptions:{fixed:e}}),t.data("processed-profile","true"))}}))}},317:function(t,e,i){"use strict";var n=i(2018);e.default=n.default},33:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(3),s=i.n(o),r=i(10),a=i(1876),l=i(303),c=i(1104),u={searchAdapter:function(t,e,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Search",u=function(){return"".concat(n.default.getApiUrlv2(),"/{Service}/").concat(o)},d=new a.default;return function(n,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=u().replace("{Service}",t),f=a,p=f.onlyEula,m=void 0===p||p;(a=s.a.extend(a,{take:e||20,cache:!1,networkId:a.networkId||l.default.getCurrentNetworkId(),type:a.type,onlyEula:m}))[i||"text"]=n,d.process(r.default.getJSON(h,a).done(o).fail((function(e){c.default.log("Failed microbox ",t," search for `",n,"`. ",e.responseText)})))}},searchUser:function(){var t=function(){return"".concat(n.default.getApiUrlv2(),"/Users/{idUser}")};return function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t().replace("{idUser}",e);n=s.a.extend(n,{cache:!1,networkId:n.networkId||l.default.getCurrentNetworkId(),type:n.type}),r.default.getJSON(o,n).done(i).fail((function(t){c.default.log("Failed microbox ",t.responseText)}))}}};e.default=u},3327:function(t,e,i){},333:function(t,e,i){"use strict";i.r(e);var n=i(13),o=i(19),s=i.n(o),r=i(2256),a=i.n(r),l=i(2257),c=i.n(l),u=i(20),d=i(2),h=n.default.extend({template:c.a,events:{"click .js-close":"close","click .js-confirm":"confirm"},dom:{errorText:".js-error-apicall"},initialize:function(t){this.options=t||{},this.notDialog=this.options.notDialog||!1,this.notDialog&&(this.template=a.a),this.stayOpenOnConfirm=this.options.stayOpenOnConfirm||!1,this.deferred=s.a.defer()},render:function(){return this.$el.html(this.template({title:this.title,text:this.text,confirm:this.confirm,cancel:this.cancel})),this},getPromise:function(){return this.deferred.promise},setTitle:function(t){this.title=t},setText:function(t){this.text=t},changeText:function(t){this.$(".js-text").html(t)},setConfirm:function(t){this.confirm=t},setCancel:function(t){this.cancel=t},setDialog:function(t){this.dialog=t},confirm:function(){this.deferred.resolve("confirm"),this.trigger("apply",!0),this.notDialog||this.stayOpenOnConfirm||this.dialog.hide(),this.deferred=s.a.defer()},close:function(){this.deferred.resolve("close"),this.notDialog||this.dialog.hide(),this.trigger("apply",!1),this.deferred=s.a.defer()},setLoading:function(t){this.disable(),this.restoreTextButton=this.$(t).text(),this.$("".concat(t,"-text")).text("".concat(Object(d.translate)("Sending"),"...")),this.$("".concat(t,"-spinner")).removeClass("is-hidden")},unsetLoading:function(t){this.enable(),this.$(t).text(this.restoreTextButton),this.$("".concat(t,"-spinner")).addClass("is-hidden")},enable:function(){this.isDisabled=!1,u.default.enable(this.$(".js-close")),u.default.enable(this.$(".js-confirm"))},disable:function(){this.isDisabled=!0,u.default.disable(this.$(".js-close")),u.default.disable(this.$(".js-confirm"))},setError:function(t){this.$(this.dom.errorText).html(t),this.$(this.dom.errorText).show(),u.default.disable(this.$(".js-confirm"))}});e.default=h},350:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(49),r=i(498),a=i(56),l=i(17),c=i(2),u=i(1933),d=i.n(u),h=i(351),f=i(1106),p=i.n(f),m=i(7),g=i(5),v=function(t){var e=t.MetaData;return Object(c.sprintf)(Object(c.translate)("%s has been related to %s"),e.ChildGroup,e.ParentGroup)},b=function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.a,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=m.default.MentionsRegExp,r=s.exec(t),a=[];null!==r;)a.push(r[1]),r=s.exec(t);var l=t;if(a.length>0)for(var c,u,d,h,f=(a=o.a.uniq(a)).length;f--;)for(d=o.a.str.trim(a[f]),u=new RegExp("".concat(d,"\\b"),"gi"),h=e.length;h--;)c=e[h],String(c.Id)===d.substring(1)&&(c.PersonalSpace=g.default.getProfileUrl()+c.Id,c.hasLink=n,l=l.replace(u,i(c)));return l},y=function(t,e){var i=document.createElement("span"),n=document.createElement("a");return n.setAttribute("target","_blank"),n.setAttribute("class","activity-link"),n.setAttribute("data-interception","off"),n.setAttribute("href",t),n.setAttribute("aria-label","".concat(e," ").concat(m.default.A11yLiterals.opensNewTab)),n.innerText=e,i.appendChild(n),i.outerHTML},C=function(t,e){for(var i,n=/@\d+/g,s=function(){var n=parseInt(i[0].substring(1),10),s=o.a.find(e,(function(t){return function(t,e){return t.Id===e}(t,n)}));s&&(t=t.replace(i[0],s.FullName))};null!==(i=n.exec(t));)s();return t};e.default={parseMentions:b,parseMessage:function(t){var e=t.message,i=t.theMentions,n=t.tags,a=void 0===n?[]:n,c=t.isSnippet,u=void 0!==c&&c,f=t.hasLink,p=void 0===f||f,m=r.default.escapeHTMLXSS(e);return u||(m=function(t){var e,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t,a=s.default.getLinks(n);if(a){for(a.sort(s.default.sortByLengthDesc),e=0;e<a.length;e++){a[e]=o.a.str.trim(a[e]);var l=r.default.escapeHTMLXSS(a[e]),c=l.replace(/^HTTP:(\/\/|&#47;&#47;)/i,"");n=n.indexOf(l)>-1?n.replace(l,"{{".concat(e,"}}")):n.replace(c,"{{".concat(e,"}}"))}var u,d=/(https?|news|file)\:\/\/|mailto\:/i;for(e=a.length;e--;){var h=a[e],f=s.default.cutText(h,30);if(i){var p=(d.test(h)?"":"http://")+h;u=y(p,f)}else u=f;n=n.replace("{{".concat(e,"}}"),u)}}return n}(m),m=h.default.parseHashtag(m,p,a)),i&&i.length&&o.a.each(i,l.default.saveUser),m=(m=b(m,i,d.a,p)).replace(/\n/g,"<br>")},parseMessageAsPlainText:function(t,e){return b(t,e,d.a,!1).replace(/\n/g," ")},parseRelatedCommunities:v,parseNotification:function(t){var e=t,i=g.default.getSiteHost(),n=g.default.getCorporateModule(),o=g.default.getEditorialModule();if(a.default.getReason("RelatedCommunities")===t.Reason?e.Message=v(t):a.default.getReason("FollowingUser")===t.Reason?e.Message=Object(c.translate)(t.Reason):a.default.getReason("SkillAdded")===t.Reason?e.Message=t.MetaData.SkillName:a.default.getReason("UpcomingImpactOwner")===t.Reason||a.default.getReason("UpcomingImpactMember")===t.Reason?(e.LastParticipant={},e.LastParticipant.IsBot=!0,e.LastParticipant.FullName="BeezyBot",t.Activity&&(e.Message=t.Activity.RelatedItem.Description)):a.default.getReason("GroupCreated")===t.Reason?(e.LastParticipant={},e.LastParticipant.IsBot=!0,e.LastParticipant.FullName="BeezyBot",e.Message=t.Group.Title):a.default.getReason("StoryEditorAdded")===t.Reason||a.default.getReason("StoryWriterAdded")===t.Reason||a.default.getReason("CorporatepageEditorAdded")===t.Reason||a.default.getReason("CorporatepageWriterAdded")===t.Reason||a.default.getReason("CorporatepageGuestWriterAdded")===t.Reason?e.Message=Object(c.sprintfWithPattern)(Object(c.translate)("%moduleName settings"),[t.Group.Title],/%moduleName/g):a.default.getReason("StoryApprovalRequest")===t.Reason||a.default.getReason("StoryApprovalRequestReminder")===t.Reason||a.default.getReason("StoryReject")===t.Reason||a.default.getReason("StoryApprove")===t.Reason||a.default.getReason("CorporatepageApprovalRequestReminder")===t.Reason||a.default.getReason("CorporatepageReject")===t.Reason||a.default.getReason("CorporatepageApprove")===t.Reason?(e.CustomMessage=t.Message,t.Activity&&t.Activity.RelatedItem&&t.Activity.RelatedItem.Description&&(e.Message="article title"===t.Activity.RelatedItem.Description.toLowerCase()?Object(c.translate)("Title to be defined"):t.Activity.RelatedItem.Description)):t.Activity?t.Activity.RelatedItem&&t.Reason!==a.default.getReason("LikeInComment")?e.Message=t.Activity.RelatedItem.Description:e.Message=C(t.Message,t.Activity.Mentions):a.default.getReason("GroupInvite")===t.Reason?(0===t.Participants.length&&(e.LastParticipant={},e.LastParticipant.IsBot=!0,e.LastParticipant.FullName="BeezyBot"),e.Message=2===t.MetaData.Role?"".concat(Object(c.translate)("Become a member of")):"".concat(Object(c.translate)("Become an owner of"))):a.default.getReason("LeaveCommunity")===t.Reason||a.default.getReason("DeclineInvitation")===t.Reason?e.Message=t.Group?t.Group.Title:"":a.default.getReason("MemberAdded")===t.Reason?(e.LastParticipant={},e.LastParticipant.IsBot=!0,e.LastParticipant.FullName="BeezyBot",e.Message=t.Group.Title):a.default.getReason("OwnerAdded")===t.Reason?e.Message="".concat(Object(c.sprintf)(Object(c.translate)("You are now an owner of groupname"),t.Group&&t.Group.Title)," ").concat(l.default.getTitleByType(t.Group.Type).toLowerCase()):a.default.getReason("HeadOwnerAdded")===t.Reason?e.Message=Object(c.sprintf)(Object(c.translate)("You are now a head of sitename site"),t.Group&&t.Group.Title):a.default.getReason("Apps")===t.Reason?(e.AppTitle=e.Message,e.Message="".concat(Object(c.translate)("View")," ").concat(e.Message)):e.Message=Object(c.sprintf)(Object(c.translate)(t.Message),t.Group&&t.Group.Title),e.Message=t.Message.replace(/&quot;/g,'"').replace(/&amp;/g,"&"),e.actionText=l.default.getNotificationAction(t),t.Reason===a.default.getReason("SkillAdded")||t.Reason===a.default.getReason("LeaveCommunity")||t.Reason===a.default.getReason("DeclineInvitation"))e.activityUrl="".concat(g.default.getCollectionUrl(),"/SitePages/Notifications.aspx");else if(a.default.getReason("StoryEditorAdded")===t.Reason||a.default.getReason("StoryWriterAdded")===t.Reason)e.activityUrl="".concat(g.default.getSiteHost()+g.default.getEditorialModule().Url,"/SitePages/Editorial%20Dashboard.aspx#manage/user");else if(a.default.getReason("CorporatepageEditorAdded")===t.Reason||a.default.getReason("CorporatepageWriterAdded")===t.Reason||a.default.getReason("CorporatepageGuestWriterAdded")===t.Reason)e.activityUrl="".concat(g.default.getSiteHost()+g.default.getCorporateModule().Url,"/SitePages/Dashboard.aspx#manage/user");else if(t.Reason===a.default.getReason("GroupInvite"))e.activityUrl="".concat(g.default.getCollectionUrl(),"/SitePages/Notifications.aspx?tab=groupinvite");else if(a.default.getReason("FollowingUser")===t.Reason){var s=g.default.getProfileUrl();t.LastParticipant?s+=t.LastParticipant.Id:t.Participants&&t.Participants.length>0&&(s+=t.Participants[0].Id),e.activityUrl=s}else if(t.Reason===a.default.getReason("UpcomingImpactMember"))e.activityUrl=l.default.getIdeaCampaignEdition(t.Activity,"advanced");else if(t.Reason===a.default.getReason("ExtendedIdeaGraduated"))e.activityUrl="".concat(g.default.getBaseSiteHost()).concat(t.Activity.Group.Url,"/SitePages/Idea Detail.aspx?ActivityId=").concat(t.Activity.Id);else if(t.Reason===a.default.getReason("Apps"))e.activityUrl="".concat(g.default.getBaseSiteCollection(),"/SitePages/Apps/Detail.aspx?appId=").concat(e.AppId);else if(t.Activity){e.activityUrl=l.default.getShareFullUrl(t.Activity,!1,!0),a.default.getReason("CorporatepageApprove")!==t.Reason&&a.default.getReason("CorporatepageApprovalRequest")!==t.Reason&&a.default.getReason("CorporatepageApprovalRequestReminder")!==t.Reason||!n||(e.activityUrl="".concat(i).concat(n.Url,"/SitePages/Page.aspx#view/").concat(t.Activity.Id)),a.default.getReason("CorporatepageReject")===t.Reason&&n&&(e.activityUrl="".concat(i).concat(n.Url,"/SitePages/Page.aspx#edit/").concat(t.Activity.Id)),a.default.getReason("StoryApprove")!==t.Reason&&a.default.getReason("StoryApprovalRequest")!==t.Reason&&a.default.getReason("StoryApprovalRequestReminder")!==t.Reason||!o||(e.activityUrl="".concat(i).concat(o.Url,"/SitePages/Story.aspx#view/").concat(t.Activity.Id)),a.default.getReason("StoryReject")===t.Reason&&o&&(e.activityUrl="".concat(i).concat(o.Url,"/SitePages/Story.aspx#edit/").concat(t.Activity.Id))}else e.activityUrl=t.Group&&t.Group.Url||"";return e},parseAjaxError:function(t,e){return"".concat(e,": \n Status: ").concat(t.status,"(").concat(t.statusText,") \n Error: ").concat(t.responseText)},nicefyText:function(t){return t.replace(/&amp;/gi,"&").replace(/%20/gi," ").replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/g,'"')}}},351:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(10),l=i(49),c=i(7),u=i(5),d={parseHashtag:function(t,e,i){return t.replace(c.default.HashtagRegExp,(function(t,n,s){s=l.default.escapeQuotes(o.a.str.unescapeHTML(s));var r,a=i&&i.length&&i.some((function(t){return t.Name.toLowerCase()===s.toLowerCase()}));if(a&&e&&window.Wall)r=["<a href=\"javascript:Wall.ByHashtag('",s,'\')" class="js-taglauncher activity-tag" data-interception="off">',n,"</a>"].join("");else if(a&&beezyCurrentGroup&&"EditorialModule"===beezyCurrentGroup.Type){var c="".concat(u.default.getSiteHost()+beezyCurrentGroup.Url,"/SitePages/Editorial Tag.aspx?hashtag=").concat(s);r=['<a href="'.concat(c,'" class="js-taglauncher activity-tag" data-interception="off">'),n,"</a>"].join("")}else if(a&&beezyCurrentGroup){var d="".concat(u.default.getSiteHost()+beezyCurrentGroup.Url,"?hashtag=").concat(s);r=['<a href="'.concat(d,'" class="js-taglauncher activity-tag" data-interception="off">'),n,"</a>"].join("")}else r=['<span class="js-modified-tag activity-tag">',n,"</span>"].join("");return t.replace(n,r)}))},getHashtagIFollow:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.shouldRefreshCurrentUserHashtags()&&this.regenerateUserCurrentHashtags();var i="article"===beezyContext.CurrentPageKey||"publicArticle"===beezyContext.CurrentPageKey||e;if(t&&("pending"===window.promiseHashtagsIFollow.state()&&window.makingRequestHashtagIFollow&&!i||"resolved"===window.promiseHashtagsIFollow.state()&&!window.makingRequestHashtagIFollow))return window.promiseHashtagsIFollow;var n=u.default.getApiUrlv2();return window.makingRequestHashtagIFollow=!0,a.default.getJSON(i?"".concat(n,"/Editorials/").concat(u.default.getEditorialModule().GroupId,"/Users/Current/Hashtags"):"".concat(n,"/Users/Current/Hashtags"),{cache:!1}).then((function(t){var e=t.map((function(t){return t.Name}));window.promiseHashtagsIFollow.resolve(e),window.makingRequestHashtagIFollow=!1})),window.promiseHashtagsIFollow},regenerateUserCurrentHashtags:function(){window.promiseHashtagsIFollow=r.a.Deferred()},shouldRefreshCurrentUserHashtags:function(){return void 0===window.promiseHashtagsIFollow},refreshCurrentUserHashtags:function(){window.promiseHashtagsIFollow=void 0},isCurrentUserFollower:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=r.a.Deferred();return this.getHashtagIFollow(e).then((function(e){i.resolve(e.some((function(e){return e.toLowerCase()===t.toLowerCase()})))})),i}};e.default=d},353:function(t,e,i){"use strict";var n=i(2016);e.default=n.default},36:function(t,e,i){"use strict";var n=i(3),o=i.n(n),s=i(27),r=i.n(s),a=i(48),l=i(19),c=i.n(l),u=i(30),d=r.a.View.extend({classes:{error:"has-error",disabled:"is-disabled"},initialize:function(t){this.options=t||{},this.options.template&&(this.template=this.options.template),this.notShowBubble=this.options.notShowBubble||!1,this.options.validators=this.options.validators||[],this._initValidator(),this.asyncValidations=[],this.valid=!0},addValidation:function(t){this.options.validators.push(t),this._initValidator()},_initValidator:function(){this.validator=Object(a.default)(this.options.validators)},addAsyncValidation:function(t){this.asyncValidations.push(t)},checkValidations:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.validator&&this.validator.validators&&0===this.validator.validators.length)return!0;var e=!0,i=this.getValue(e),n=this.validator.run(i);return t||this.checkError(n.valid,n.message),n.valid},checkAllValidations:function(){var t=c.a.defer();return this.validationStarted=!0,this.checkValidations()?(this.checkAsyncValidations(t),this.trigger("enablebutton")):(t.resolve(!1),this.trigger("disablebutton")),t.promise},checkAsyncValidations:function(t){if(!this.asyncValidations.length)return t.resolve(!0);var e=o.a.map(this.asyncValidations,(function(t){return t(this)}),this);c.a.all(e).done((function(e){t.resolve(o.a.every(e,o.a.identity))}))},checkError:function(t,e){this.valid=t,t?this.trigger("valid",this):this.trigger("invalid",this,e)},focus:function(){var t=this.focusItem;Object(u.sharePointItems)().content.animate({scrollTop:t.position().top},"fast",(function(){t.focus()}))},reset:function(){},getValue:function(){},setValue:function(){},getJSON:function(){},setError:function(){},unsetError:function(){},attachError:function(){},enable:function(){},disable:function(){},hideBubble:function(){if(this.asyncValidations.length){var t=o.a.map(this.asyncValidations,(function(t){return t(this,!0)}),this);c.a.all(t).done((function(){}))}}});e.default=d},361:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(27),s=i.n(o),r=i(1018),a=s.a.Collection.extend({model:r.default,initialize:function(t,e){this.groupId=e.groupId,this.attachmentType=e.attachmentType},url:function(){var t="".concat(n.default.getApiUrlv2(),"/Groups/").concat(this.groupId,"/Terms");return this.attachmentType&&(t="".concat(t,"?attachmentType=").concat(this.attachmentType)),t}}),l=[],c=a.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Groups/").concat(this.groupId,"/Terms/Available")},fetch:function(){var t=this;if(l[this.groupId])l[this.groupId].then((function(e){t.add(e)}));else{var e=c.__super__.fetch;l[this.groupId]=e.apply(this,arguments)}return l[this.groupId]}}),u=s.a.Collection.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Groups/TermSets")}}),d=s.a.Collection.extend({model:r.default});e.default={Metadata:a,TermSetsAvailable:c,TermSets:u,MetadataTerms:d}},368:function(t,e,i){"use strict";e.default=function(t){var e=t.elementType,i=void 0===e?"div":e,n=t.attributes,o=void 0===n?[]:n,s=document.createElement(i);return o.length&&o.forEach((function(t){s.setAttribute(t.name,t.value)})),s}},37:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(5),r=i(116),a=i(30),l=i(15);window.currentTooltip={id:null,isFixed:!1};var c="TOP",u="BOTTOM",d="left",h="center",f=r.default.extend({classes:{container:"tooltip bz-webpart",tooltipTop:"tooltip--top",tooltipBottom:"tooltip--bottom",tooltipLeft:"tooltip--left",tooltipCenter:"tooltip--center"},dom:{container:".tooltip"},defaults:{offset:100,horizontalPosition:h},init:function(t){var e;this.offset=t.offset||this.defaults.offset,this.horizontalPosition=t.horizontalPosition||this.defaults.horizontalPosition,this.alwaysShow=t.alwaysShow,this.delay=t.delay||600,this.insideModal=t.insideModal,this.customClasses=t.customClasses,this.createNew=t.createNew||!1,this.hasAriaLabel=null!==(e=t.hasAriaLabel)&&void 0!==e&&e,this.options=t||{},this.$el=o()(this.el);var i=new Date;return this.id="".concat(i.getTime()).slice(5)+Math.floor(1e3*Math.random()+1e3),this.isFixed=t.fixed||!1,!o()(this.dom.container).length||this.alwaysShow||this.createNew?this._tooltip=o()("<div/>").css({position:"absolute",display:"none"}).addClass(this.classes.container).addClass(void 0!==this.customClasses?this.customClasses:"").appendTo(Object(a.sharePointItems)().getContentElement(l.default.isProfile())).attr("role","tooltip").attr("id","bz-tooltip"):this._tooltip=o()(this.dom.container).addClass(void 0!==this.customClasses?this.customClasses:""),this.insideModal&&this._tooltip.css({"z-index":9999}),this.message(t.text),this.hasAriaLabel&&this.setAriaLabel(t.text),this.bindEvents(),this.alwaysShow&&this.show(),this._tooltip},bindEvents:function(){this.onmouseenter=this.onmouseenter.bind(this),this.onmouseleave=this.onmouseleave.bind(this),this.$el.on("mouseenter",this.onmouseenter),this.$el.on("mouseleave",this.onmouseleave),this.$el.on("focus",this.onmouseenter),this.$el.on("blur",this.onmouseleave),this._tooltip.on("click",this.oncontainerclick),o()(document).on("keydown",this.ondocumentkeydown.bind(this))},unbindEvents:function(){this.$el.off("mouseenter",this.onmouseenter),this.$el.off("mouseleave",this.onmouseleave),this.$el.off("focus",this.onmouseenter),this.$el.off("blur",this.onmouseleave),this._tooltip.off("click",this.oncontainerclick),o()(document).off("keydown",this.ondocumentkeydown.bind(this))},onmouseenter:function(){window.currentTooltip.isFixed||(window.currentTooltip.id=this.id,window.currentTooltip.isFixed=this.isFixed,this.active=!0,this.showTool())},onmouseleave:function(t){t.preventDefault(),this.options.avoidStopPropagation||t.stopPropagation(),this.alwaysShow||window.currentTooltip.id===this.id&&(this.hide(),this.active=!1,window.currentTooltip.isFixed=!1)},_getCoordinates:function(){var t=this.$el,e=t.offset(),i=o()("#js-beezy-ribbon-open-app"),n=i.length?i.outerHeight():0,r=this._relativePosition===u?e.top-this._tooltip.outerHeight()-5:e.top+t.outerHeight()+5;r-=n;var l=s.default.isInsideSharepointContainer()?Object(a.sharePointItems)().content.scrollTop()-a.sharePointSizes.ribbon.height():0;return{left:e.left+t.outerWidth()/2-(this.horizontalPosition===d?3*this._tooltip.outerWidth()/4:this._tooltip.outerWidth()/2)-(Object(a.isSharepointModern)()&&window.innerWidth>=1024?a.sharePointSizes.appBarModern.width():0),top:r+(Object(a.isSharepointModern)()?Object(a.sharePointItems)().content.scrollTop()-a.sharePointSizes.ribbonModern.height():l)}},oncontainerclick:function(t){t.stopPropagation()},showTool:function(){this._tooltip.html(this.message()),this._tooltip.removeClass(this.classes.tooltipLeft).removeClass(this.classes.tooltipCenter),this._tooltip.addClass(this.horizontalPosition===d?this.classes.tooltipLeft:this.classes.tooltipCenter),this.checkDirection(),this.position(this._getCoordinates()),'<span class="spinner-loading"></span>'===this.message().toString()||!this.message().length||this.message().length>1||0!==this.message().find("li").length?this.show():this.hide()},position:function(t){if(void 0===t)return this._position;this._position=t,this._tooltip.css(this._position)},checkDirection:function(){var t=this.$el.offset().top,e=o()(window).scrollTop();t-this._tooltip.height()<e+this.offset?(this._relativePosition=c,this._tooltip.removeClass(this.classes.tooltipBottom),this._tooltip.addClass(this.classes.tooltipTop)):(this._relativePosition=u,this._tooltip.removeClass(this.classes.tooltipTop),this._tooltip.addClass(this.classes.tooltipBottom))},show:function(){this._tooltip.delay(this.options.delay).show("fade")},hide:function(){this._tooltip.stop(!0,!0),this._tooltip.hide()},message:function(t){if(void 0===t)return this._message;this._message=t,this._tooltip&&this._tooltip.html(t)},setAriaLabel:function(t){this.$el.attr("aria-label",t)},ondocumentkeydown:function(t){27===t.which&&this.hide()},destroy:function(){this._tooltip.remove()}});e.default=f},375:function(t,e,i){"use strict";var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(52),l=i(417),c=/{{embed-activity id=(\d*)}}/g,u=function(t,e){this.options=r.a.extend({remove:!1,activityClass:"activity-embedded bz-webpart"},e),this.el=t},d=function(){return o()("<div/>").append(o()("<span/>").addClass("spinner-loading"))};u.prototype={getActivity:function(t,e){new a.default.SingleActivity({Id:t,forceGenericService:!0}).fetch().done((function(i){e(i,t)}))},replace:function(){for(var t,e=[],i=c.exec(this.el.html()),n=this;i;){var s="";!this.options.remove&&e.indexOf(i[1])<0&&(e.push(i[1]),this.getActivity(i[1],(function(t,e){var i={model:new a.default.Activity(t),tools:{comment:!1,remove:!1,share:!1,follow:!1},tagName:"div",className:"activity ".concat(n.options.activityClass)},o=Object(l.default)(t.Type,i);o.render(),n.el.find(".embed-activity-".concat(e)).html(o.$el)})),s=(t=i[1],o()("<div/>").addClass("embed-container embed-activity-".concat(t))).append(d)[0].outerHTML),this.el.html(this.el.html().replace(i[0],s)),i=c.exec(this.el.html())}}},e.default=u},38:function(t,e,i){"use strict";i.r(e);var n=i(50),o=i.n(n),s=i(791),r={renderComponent:function(t,e,i,n,o){var r=new s.default({reactComponent:e,props:i,el:t,isStateless:n,isLazy:o});return r.render(),r},unMountComponent:function(t){o.a.unmountComponentAtNode(t)}};e.default=r},384:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(13),r=i(15),a=i(17),l=i(37),c=i(276),u=i(2),d=i(2403),h=i.n(d),f=(i(369),s.default.extend({template:h.a,dom:{leaveButton:".js-toggle-join",followButton:".js-toggle-follow"},events:{"hover .js-toggle-join":"addTooltipLeave","hover .js-toggle-follow":"addTooltipUnFollow","click .js-invite":"invite","click .js-dialog-email":"toggleMail","click .js-item-closable":"toggleDropDown","click .js-toggle-join":"toggleJoin","click .js-toggle-follow":"toggleFollow","click .js-export-members":"exportMembers"},initialize:function(t){this.model=t.context,this.options=t||{},this.options.context=this.model.toJSON(),this.options.context.texts=t.texts,this.options.context.settingsUrl=t.settingsUrl,this.options.context.settingsTitle=t.settingsTitle,this.options.context.isReadOnly=r.default.isReadOnly(),this.inviteDialog=t.inviteDialog||c.default.GroupInvite},render:function(){var t=this.options.context.IsCurrentUserWebAdmin&&o.a.every(this.options.context.Administrators,(function(t){return t.Id!==r.default.getCurrentUserId()}))||!this.options.context.IsCurrentUserWebAdmin&&!this.options.context.isGroupOwner;return o.a.extend(this.options.context,{canLeave:t}),this.$el.html(this.template(this.options.context)),this},invite:function(t){if(t.preventDefault(),r.default.isReadOnly())return a.default.showReadOnlyModal();this.trigger("invite")},toggleMail:function(t){if(t.preventDefault(),r.default.isReadOnly())return a.default.showReadOnlyModal();this.trigger("toggleMail")},toggleDropDown:function(){if(r.default.isReadOnly())return a.default.showReadOnlyModal();this.trigger("toggleDropDown")},toggleFollow:function(t){if(t.preventDefault(),r.default.isReadOnly())return a.default.showReadOnlyModal();this.options.context.IsCurrentUserMemberFromAudience||this.trigger("toggleFollow")},toggleJoin:function(t){if(t.preventDefault(),r.default.isReadOnly())return a.default.showReadOnlyModal()},exportMembers:function(t){if(t.preventDefault(),r.default.isReadOnly())return a.default.showReadOnlyModal();this.trigger("toggleExport")},addTooltipLeave:function(){this.options.context.IsCurrentUserMemberFromAudience&&(this.tooltipLeave=new l.default({el:this.$(this.dom.leaveButton),text:this.options.context.texts.tooltipLeave||Object(u.translate)("You cannot leave, this is an audience-based community")}),this.tooltipLeave.onmouseenter())},addTooltipUnFollow:function(){this.options.context.IsCurrentUserMemberFromAudience&&(this.tooltipUnfollow=new l.default({el:this.$(this.dom.followButton).get(0),text:this.options.context.texts.tooltipUnfollow||Object(u.translate)("You cannot unfollow, this is an audience-based community")}),this.tooltipUnfollow.onmouseenter())}}));e.default=f},385:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(13),l=i(2412),c=i.n(l),u=i(12),d=i(305),h=i(351),f=i(2),p=i(53),m=i(88),g=i(38),v=i(2413);function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var C=d.default.MicroTag,w=a.default.extend({template:c.a,initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this.context=t.context||{tabs:[]},this.selectedClass=t.selectedClass||"is-selected",this.showFilterClass=t.showFilterClass||"is-showFilter",this.classes=t.classes||"",this._count={},this.hideCount=t.hideCount||!1},events:{"click a":"selectTab","click .js-notification-count":"selectTab","click .js-unfollow-hashtag-tab":"unfollow"},render:function(t){var e;return t&&this.$selected&&(e=this.$selected.attr("id")),this.bookmarkSelected?this.$selected=null:(this.renderPopoverTab(),this.$el.html(this.template(this.context)),this.$selected=this.$(".".concat(this.selectedClass))),e&&(this.$selected.removeClass(this.selectedClass),this.getTabElement(e).find("a").attr("aria-selected",!0),this.$selected=this.getTabElement(e).addClass(this.selectedClass)),this.$el.addClass(this.classes),this},setContext:function(t){t&&(this.context=t,this.render())},selectTab:function(t){t.preventDefault();var e="LI"===t.target.parentNode.tagName?t.target.parentNode:t.target.parentNode.parentNode,i=this.$selected;this.trigger("tabClick",e.id),i&&e===i[0]?this.trigger("refreshTab"):(this.switchTo(e.id),this.trigger("switch",e.id))},getAssertiveMessage:function(t){var e=Object(p.sprintf)({string:Object(f.translate)("Newsfeed has been filtered by %filterName"),replacements:[t],pattern:/%filterName/gi});Object(m.addAssertiveMessage)(e)},switchTo:function(t){if(this.$selected&&(this.$selected.find("a").attr("aria-selected",!1),this.$selected.removeClass(this.selectedClass)),t){var e=Object(f.translate)(t);this.getAssertiveMessage(e),this.$selected=this.getTabElement(t).addClass(this.selectedClass),this.$selected.find("a").attr("aria-selected",!0),this.$selected.hasClass(this.showFilterClass)?(r()(".filter-activities").show(),r()(".filter-activities").parent().show()):(r()(".filter-activities").hide(),r()(".filter-activities").parent().hide()),this.bookmarkSelected=!1}else this.$selected=null,this.bookmarkSelected=!0,this.getAssertiveMessage(Object(f.translate)("Bookmarks"))},setCount:function(t,e){if(!this.hideCount){var i=this.getTabElement(t).find(".js-notification-count");if(this._count[t]=e,e)this.getTabElement(t).find(".js-activities-hidden-count").text(Object(f.sprintf)(Object(f.translate)("%d new activities"),e)),i.text(e>9?"9+":e).show();else i.hide()}},setSelectedCount:function(t,e){this.getTabElement(t).find(".js-notification-count")[e?"addClass":"removeClass"]("is-selected")},getCount:function(t){return this._count[t]||0},getTabElement:function(t){return this.$("[id='".concat(t,"']"))},unfollow:function(t){var e=r()(t.currentTarget).parent().find("span.c-tabs__item__text").text();return new C({Name:e}).unFollow().then((function(){h.default.refreshCurrentUserHashtags(),u.default.publish("microtag","unfollow".concat(e.toLowerCase()),e)}),(function(){h.default.getHashtagIFollow(!1)}))},getSelectedTabId:function(){return this.$selected.attr("id")},handleClick:function(t,e){this.selectedTabValue=e,this.trigger("tabClick",t),this.trigger("switch",t),this.switchTo(t)},onClickPopoverOpen:function(t){this.isPopoverOpen=t},renderPopoverTab:function(){var t,e=this,i=document.querySelector("#js-beezy-header-tabs-container"),n=null===(t=this.context.tabs)||void 0===t?void 0:t.map((function(t){return y(y({},t),{},{count:e.getCount(t.id)})}));n.length&&g.default.renderComponent(i,v.default,{tags:n,onClick:this.handleClick.bind(this),isPopoverOpen:this.isPopoverOpen,selectedTabValue:this.selectedTabValue||n[0].label,onClickPopoverOpen:this.onClickPopoverOpen.bind(this)})}});e.default=w},386:function(t,e,i){"use strict";i.r(e);var n=i(26),o=i(10),s=i(8),r=i(47),a=i(5),l=n.default.extend({url:function(){return s.default.getGroupServiceV2Url()},urlSubscribe:function(){return"".concat(a.default.getApiUrlv2(),"/Communities/").concat(null!==s.default.getCurrentGroup()?s.default.getGroupId():"")},dataS:function(){return{Id:beezyCurrentUser.Id}},join:function(){return this.clearCache(),o.default.get("".concat(this.url(),"/join")).then((function(){s.default.isModerated()||window.location.reload()}))},leave:function(){return this.clearCache(),o.default.get("".concat(this.url(),"/leave")).then((function(){s.default.isPublic()?window.location.reload():window.location.href=a.default.getSiteCollectionUrl()}))},follow:function(){return this.clearCache(),o.default.post("".concat(this.url(),"/followers"))},unfollow:function(){return this.clearCache(),o.default.del("".concat(this.url(),"/followers"))},subscribe:function(){this.clearCache(),o.default.postJSON("".concat(this.urlSubscribe(),"/SubscribeEmailDigest"),this.dataS()).fail((function(){r.default.showGenericError()}))},unsubscribe:function(){this.clearCache(),o.default.del("".concat(this.urlSubscribe(),"/UnsubscribeEmailDigest"),this.dataS()).fail((function(){r.default.showGenericError()}))},clearCache:function(){void 0!==window.contentLoader&&(window.contentLoader.clearCacheObject("beezyCurrentUser"),"undefined"!=typeof _spPageContextInfo&&window.contentLoader.clearCacheObject("beezyCurrentGroup",_spPageContextInfo.webServerRelativeUrl))}});e.default=l},387:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(18),s=i(2),r=i(13),a=i(2451),l=i.n(a),c=r.default.extend({template:l.a,events:{"click .js-redirect":"redirectToUrl"},initialize:function(t){this.iconClass=t.iconClass,this.title=t.title,this.text=t.text,this.showButton=t.showButton||!1,this.buttonText=t.buttonText||Object(s.translate)("Got it"),this.url=t.url||n.default.getSiteCollectionUrl()},render:function(){var t={iconClass:this.iconClass,title:this.title,text:this.text,buttonText:this.buttonText,showButton:this.showButton,url:this.url};return this.$el.html(this.template(t)),this},redirectToUrl:function(){o.default.redirectToUrl(this.url)}});e.default=c},39:function(t,e,i){"use strict";e.default={set:function(t,e,i){var n=e;i&&(n=JSON.stringify(e)),sessionStorage.setItem(t,n)},get:function(t,e){return e&&sessionStorage.getItem(t)?JSON.parse(sessionStorage.getItem(t)):sessionStorage.getItem(t)},remove:function(t){sessionStorage.removeItem(t)},exist:function(t){return null!==sessionStorage.getItem(t)},clearCache:function(t){var e;for(var i in t)e=t[i],this.exist(e.key)&&this.remove(e.key)},getItem:function(t,e){if(this.exist(e))for(var i=this.get(e,!0),n=0;n<i.length;n++)if(i[n].Key===t)return JSON.parse(i[n].Value)},indexOfItem:function(t,e){if(this.exist(e))for(var i=this.get(e,!0),n=0;n<i.length;n++)if(i[n].Key===t)return n;return-1},setItem:function(t,e,i){var n=[];this.exist(i)&&(n=this.get(i,!0)),n.push({Key:t,Value:JSON.stringify(e)}),this.set(i,n,!0)},clearItem:function(t,e){if(this.exist(e)){var i=this.get(e,!0);this.indexOfItem(t,e)>-1&&i.splice(this.indexOfItem(t,e),1),this.set(e,i,!0)}}}},395:function(t,e,i){"use strict";i.d(e,"HTMLElement",(function(){return c}));var n=i(380),o=i.n(n),s=i(0),r=i.n(s),a=r.a.oneOf(["left","middle","right"]),l=r.a.oneOf(["top","center","bottom"]);function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.isRequired,i=void 0!==e&&e;return function(t,e,n){return i&&void 0===t[e]?new Error("The prop `".concat(e,"` is marked as required in `").concat(n,"`, but its value is `undefined`.")):Object.prototype.hasOwnProperty.call(t,e)&&null!==t[e]&&t[e]instanceof Element==!1?new Error("Invalid prop `".concat(e,"` of type `").concat(o()(t[e]),"` supplied to `").concat(n,"`, expected `HTMLElement`.")):null}}r.a.shape({horizontal:a,vertical:l})},398:function(t,e,i){"use strict";var n=i(98),o=i.n(n),s=i(4),r=i.n(s);e.default={JSON2CSV:function(t,e,i){var n="object"!==o()(t)?JSON.parse(t):t,s="",a=beezyContext&&beezyContext.Language&&"de"===beezyContext.Language.substring(0,2)?";":",";if(i){var l="";for(var c in n[0])l+=c+a;l=l.slice(0,-1),s+="".concat(l,"\r\n")}for(var u=0;u<n.length;u++){var d="";for(var h in n[u])d+='"'.concat(n[u][h],'"').concat(a);d.slice(0,d.length-1),s+="".concat(d,"\r\n")}if(""!==s){var f="";if(f+=e.replace(/ /g,"_"),window.navigator.msSaveOrOpenBlob){var p=new Blob([s]);window.navigator.msSaveBlob(p,"".concat(f,".csv"))}else if(r.a.browser.msie){var m=window.open();m.document.write("sep=,\r\n".concat(s)),m.document.close(),m.document.execCommand("SaveAs",!0,"".concat(f,".csv")),m.close()}else{var g="data:application/csv;charset=utf-8,".concat(escape(s)),v=document.createElement("a");v.href=g,v.style="visibility:hidden",v.download="".concat(f,".csv"),document.body.appendChild(v),v.click(),document.body.removeChild(v)}}else alert("Invalid data")}}},40:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(13),l=i(123),c=i(375),u=i(2427),d=i.n(u),h=i(215),f=i.n(h),p=i(7),m=i(2),g=i(133),v=a.default.extend({template:d.a,mode:p.default.Feeds.Modes.PAGINATED,filterTemplate:f.a,initialize:function(t){this.feedType=t.feedType,this.noTools=t.noTools||!1,this.showSnippetFeed=t.showSnippetFeed||!1,this._filter={},this.orderBy=t.orderBy||"PublishedDate",this.type=t.type||"",this.mode=t.mode||this.mode,this.template=t.template||this.template,this.isPaginated=this.mode===p.default.Feeds.Modes.PAGINATED,this.titleLines=t.titleLines||3,this.collection=new t.collection(null,{communityId:t.communityId,take:t.take,currentData:r.a.extend({orderby:this.orderBy,type:this.type,start:t.start,grouptype:t.grouptype,status:t.status,desc:t.desc},t.collectionOptions)}),this.notLoadDataOnInit=t.notLoadDataOnInit,this.emptyState=t.emptyState,this.hideNewItem=t.hideNewItem,this._templateItem=t.templateItem,this._render=this._render.bind(this),this.emptyStateDOM=t.emptyStateDOM||"",this.showEmptyState=t.showEmptyState||!1,this.hideDotDotDot=t.hideDotDotDot||!1},render:function(){this.notLoadDataOnInit||this.loadData()},_render:function(){return this.context={total:this.collection.total,totalPages:this.collection.pages,currentPage:this.collection.currentPage,itemsPerPage:this.collection.itemsPerPage,emptyState:this.emptyState,hideNewItem:this.hideNewItem,get items(){var t=this.itemsPerPage*this.currentPage%this.total;return t<this.itemsPerPage?this.itemsPerPage-t:t}},this.shouldRenderFeed()?(this.$el.html(this.template(this.context)),this.collection.filtered&&this.renderFilter(),this.$(".js-feed-items").css("visibility","hidden"),this.renderItems(),r.a.each(this.$(".js-feed-items > li"),(function(t){Object(g.default)(o()(t).find(".js-body"),{lines:4,ellipsis:"...",showMore:!1,isOnlyShow:!0,withoutDelay:!0}),Object(g.default)(o()(t).find(".js-title"),{lines:2,ellipsis:"...",showMore:!1,isOnlyShow:!0,withoutDelay:!0})})),this.$(".js-feed-items").css("visibility","visible")):(this.trigger("noItemsLoaded"),this.$el.html(this.emptyStateDOM||"")),this},shouldRenderFeed:function(){return this.collection.models.length>0||this.collection.filtered||void 0!==this.collection.currentData.folderPath},loadData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,i={collection:this.collection,cancel:!1};this.trigger("loading",i),i.cancel||(this.isPaginated?this.collection.load(t).then(this._render,(function(t){e._onFail(t)})):this.isLoadMore?this.collection.more(t).then(this._render,(function(t){e._onFail(t)})):this.collection.fetch(t).then(this._render,(function(t){e._onFail(t)})))},_onFail:function(t){this.trigger("failed",t)},refresh:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loadData(t)},clearHtml:function(){this.$(".js-feed-items").html("")},renderItems:function(){var t=this;this.clearHtml(),this.trigger("loaded"),this.collection.each(this.renderItem,this),this.$(".js-feed-items").find(".js-feed-item-link").on("click",(function(e){e.preventDefault(),e.stopPropagation();var i=o()(this);t.trigger("selected",{value:i.data("linkValue")})}))},renderItem:function(t){var e=this;new l.default({model:t,template:e._templateItem,feedType:this.feedType,titleLines:this.titleLines,hideDotDotDot:this.hideDotDotDot||!1}).render().$el.appendTo(this.$(".js-feed-items")),setTimeout((function(){new c.default(e.$(".js-feed-items"),{remove:!0}).replace()}),10)},renderFilter:function(){this.$("li.filter").length||o.a.isEmptyObject(this._filter)||(this.trigger("filtering"),this.filterEl=o()("<li>").addClass("filter").addClass("js-filter"),this.filterEl.html(this.filterTemplate(this._filter)),this.$el.prepend(this.collection.models.length?this.filterEl:'<div class="alert alert--error">\n\t\t\t\t\t\t\t'.concat(Object(m.translate)("No results found"),'\n\t\t\t\t\t\t\t<div class="alert__close js-alert-close">\n\t\t\t\t\t\t\t\t<span class="alert__close__icon icon icon--cross-stroke-white"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>')))},reset:function(){this.collection.reset(),this.removeFilter(),this.refresh()},removeFilter:function(){this.trigger("removeFilter"),this.resetFilters()},resetFilters:function(){this._filter={},this.collection.filtered=!1,this.filterEl&&this.filterEl.remove()},setOrder:function(t){this.collection.setOrder(t.data("order")),this.collection.setGroupType(t.data("grouptype")),this.collection.setStatus(t.data("status")),this.refresh()},setOrderFilter:function(t){this.collection.setOrder(t),this.collection.setGroupType(""),this.collection.setStatus(""),this.refresh()},setTab:function(t){this.collection.setOrder(t.id),this.collection.setGroupType(t.grouptype),this.collection.setStatus(t.status),this.refresh()},setType:function(t){this.collection.setType(t),this.refresh()},setFilter:function(t){this.collection.setUser(t.user),this.collection.setDateStart(t.start),this.collection.setDateEnd(t.end),this.collection.filtered=t.user||t.start||t.end,this._filter={user:t.user?{filter:t.user.Id,label:t.user.FullName}:"",start:t.start?{filter:this.collection.currentData.start,label:this.collection.currentData.start}:"",end:t.end?{filter:this.collection.currentData.end,label:this.collection.currentData.end}:""},this.refresh()},setFilterByHashtag:function(t,e,i){this.collection.setHashtag(t),this.collection.filtered=!!t,this._filter={hashtag:{filter:t,label:t},skill:"people"===this.feedType};var n=i?{orderby:i}:{};this.refresh(n)},setFilterSearch:function(t){this.collection.filtered=!1,this.collection.setFilter(t),this.refresh()},setFilterMetadata:function(t){var e,i,n=[],o=[];t.forEach((function(t){var e=t.Id,i=t.Name;n.push(e),o.push(i)})),e=n.join(","),i=o.join(", "),this.collection.setFilterTerms(e),this.collection.filtered=!0,this._filter={terms:{filter:e,label:i}},this.refresh()}});e.default=v},402:function(t,e,i){"use strict";e.default={main__container:"bz-main__container--1PK36e",main__container__link:"bz-main__container__link--1PK36e",profile__img:"bz-profile__img--1PK36e","profile__img--avatar":"bz-profile__img--avatar--1PK36e",user__info__container:"bz-user__info__container--1PK36e","user__info__container--user-name":"bz-user__info__container--user-name--1PK36e","user__info__container--user-role":"bz-user__info__container--user-role--1PK36e",actions__container:"bz-actions__container--1PK36e","btn--icon--color":"bz-btn--icon--color--1PK36e","btn--message":"bz-btn--message--1PK36e","btn--message--disabled":"bz-btn--message--disabled--1PK36e","btn--message--text":"bz-btn--message--text--1PK36e","btn--following":"bz-btn--following--1PK36e","link--profile":"bz-link--profile--1PK36e","link--profile--text":"bz-link--profile--text--1PK36e",icons__container:"bz-icons__container--1PK36e","icons__container--icon":"bz-icons__container--icon--1PK36e","icons__container--extra-space":"bz-icons__container--extra-space--1PK36e","tooltip__container--size":"bz-tooltip__container--size--1PK36e",icons__link:"bz-icons__link--1PK36e","tooltip--animation":"bz-tooltip--animation--1PK36e",fadeIn:"bz-fadeIn--1PK36e"}},412:function(t,e,i){"use strict";i.r(e),i.d(e,"createApolloClient",(function(){return h})),i.d(e,"getApolloClient",(function(){return f}));var n=i(1009),o=i.n(n),s=i(677),r=i.n(s),a=i(16),l=i(3706),c=i(2365),u=i(166),d=i(1931);var h=function(t,e){if(void 0===window.beezyApolloClient){var i=new l.BatchHttpLink({uri:t,fetch:function(i,n){var o=Object.assign(n,{method:"post",headers:{}});return u.default.isAppsCloud()||(o=Object.assign(o,{credentials:"include"})),fetch("".concat(t).concat(function(t){return t?"Api/GraphQL?".concat(beezySettings.ApiServiceV2QueryString):"_layouts/15/Spenta.Beezy/GraphQL.ashx"}(e)),o)}}),n=Object(c.onError)((function(t){var e=t.graphQLErrors,i=t.networkError;e&&e.forEach(function(){var t=o()(r.a.mark((function t(e){var i,n,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.message,n=e.locations,o=e.path,console.error("[GraphQL error]: Message: ".concat(i,", Location: ").concat(n,", Path: ").concat(o));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),i&&console.error("[Network error]: ".concat(i))})),s=new a.InMemoryCache({typePolicies:d.typePolicies,possibleTypes:d.possibleTypes});window.beezyApolloClient=new a.ApolloClient({link:n.concat(i),cache:s})}return window.beezyApolloClient},f=function(){return window.beezyApolloClient}},415:function(t,e,i){"use strict";i.r(e);var n=i(27),o=i.n(n),s=i(10),r=i(214),a=i(5),l=o.a.Collection.extend({model:r.default,url:function(){return"".concat(a.default.getApiUrlv2(),"/Users")},fetchByEmail:function(t){var e=this;s.default.postJSON("".concat(this.url(),"/ByEmail"),t).then((function(t){e.reset(t)}))},findByEmail:function(t){return this.find((function(e){return e.get("Email")===t}))}});e.default=l},416:function(t,e,i){"use strict";i.r(e);var n=i(13),o=i(2396),s=i.n(o),r=i(49),a=i(7),l=i(273),c=n.default.extend({name:"activitySnippet",dom:{title:".js-snippet-title",description:".js-snippet-description"},className:"js-activity-snippet",template:s.a,context:{SharedActivity:{}},initialize:function(t){var e,i;if(!t.SharedActivity)throw new Error("Cannot create activity snippet without an activity object");this.context.SharedActivity=this.SharedActivity=t.SharedActivity,this.context.IsCard=t.IsCard||!1,this.context.IsPoll=this.SharedActivity.Type===a.default.Type.POLL,this.snippetLcid=null===(e=this.context)||void 0===e||null===(i=e.SharedActivity)||void 0===i?void 0:i.LCID,this.snippetLanguageCode=this.snippetLcid?Object(l.getBeezyLanguageByLCID)(this.snippetLcid).code:null},render:function(){this.context.SharedActivity=this.SharedActivity,this.$el.html(this.template(this.context)).attr("lang",this.snippetLanguageCode);var t=this.getObserverBackgroundImage({}),e=this.$el.get(0).querySelector(".js-beezy-profileload");e&&t.observe(e);var i=this.getObserverImage({}),n=this.$el.get(0).querySelector(".js-observer__img");return n&&i.observe(n),r.default.ellipsis(this.$el.find(this.dom.title),1),r.default.ellipsis(this.$el.find(this.dom.description),2),this}});e.default=c},417:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(481),r=i(7),a=function(t,e){return new t(e||{})},l=function(t,e){var i=s.default,n={ANNOUNCEMENT:i.Announcement,BLOG:i.Blog,CALENDAR:i.Calendar,COLLEAGUES:i.Post,COMMUNITY:i.Post,COMMUNITY_QUESTION:i.Question,DISCUSSION:i.Discussion,DOCUMENT:i.Document,IDEA:i.Idea,ITEM:i.Item,POLL:i.Poll,POST:i.Post,PRAISE:i.Praise,QUESTION:i.Question,TASK:i.Task,STICKYANNOUNCEMENT:i.Announcement,WIKI:i.Wiki,STORY:i.Story,SHARE:i.Share,SHARE_APP:i.Share,CORPORATEPAGE:i.CorporatePage},c=function(t,i){var n=null;return o.a.each(r.default.Type,(function(e,i){e==t&&(n=i)})),"poll"===t&&o.a.extend(e,{isPoll:!0}),{type:n,options:i}};l=function(t,e){var i=c(t,e);return a(n[i.type],i.options)};var u=c(t,e);return a(n[u.type],u.options)};e.default=l},421:function(t,e,i){"use strict";i.r(e),i.d(e,"CommunitiesSidebar",(function(){return h})),i.d(e,"CommunitiesDiscover",(function(){return f})),i.d(e,"RelatedCommunities",(function(){return p})),i.d(e,"RealRelatedCommunities",(function(){return g})),i.d(e,"ParentGroup",(function(){return m}));var n=i(24),o=i.n(n),s=i(3),r=i.n(s),a=i(27),l=i.n(a),c=i(5);function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var h=l.a.Collection.extend({url:function(){return"".concat(c.default.getApiUrlv2(),"/Communities/Navigation")},initialize:function(t,e){this.options=r.a.defaults(e||{},{skip:0,take:300})},fetch:function(t){return(t=t||{}).data=r.a.extend({skip:this.options.skip,take:this.options.take},t.data),h.__super__.fetch.call(this,t)}}),f=l.a.Collection.extend({initialize:function(t){this.options=r.a.defaults(t||{},{skip:0,take:3}),this.UrlExtend=t.UrlExtend||"MostActive"},url:function(){return"".concat(c.default.getApiUrlv2(),"/Communities/Unsubscribed/").concat(this.UrlExtend)},parse:function(t,e){r.a.isArray(t)||(t=[t]);var i=e.data&&e.data.take;return t.length<(i||3)?(this.remaining=!1,t):(this.remaining=!0,t.splice(-1,1),t)},fetch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign(t);return e.data=d({skip:this.options.skip,take:this.options.take,start:this.options.start},t.data),f.__super__.fetch.call(this,e)}}),p=l.a.Collection.extend({communityId:0,initialize:function(t){this.options=r.a.defaults(t||{},{skip:0,take:4,communityId:0}),this.communityId=this.options.communityId},url:function(){return"".concat(c.default.getApiUrlv2(),"/Groups/").concat(this.communityId,"/RelatedGroups")},fetch:function(t){return(t=t||{}).data=r.a.extend({skip:this.options.skip,take:this.options.take},t.data),p.__super__.fetch.call(this,t)}}),m=p.extend({initialize:function(t){this.options=r.a.defaults(t||{},{skip:0,take:1,communityId:0}),this.communityId=this.options.communityId},url:function(){return"".concat(c.default.getApiUrlv2(),"/Groups/").concat(this.communityId,"/ParentGroup")}}),g=l.a.Collection.extend({initialize:function(t){this.options=r.a.defaults(t||{},{skip:0,take:4}),this.activityId=this.options.activityId},url:function(){return"".concat(c.default.getApiUrlv2(),"/ExtendedIdeas/").concat(this.activityId,"/RelatedCommunities")},fetch:function(t){return(t=t||{}).data=r.a.extend({skip:this.options.skip,take:this.options.take},t.data),p.__super__.fetch.call(this,t)}})},422:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(7),r={getStringIdsFromRoles:function(t){return t.map((function(t){return t.id})).toString()},getValueById:function(t){return o.a.find(s.default.Roles,(function(e){return e.id===t})).value}};e.default=r},426:function(t,e,i){"use strict";var n=i(2043);e.default=n.default},46:function(t,e,i){"use strict";i.r(e);var n=i(8),o=i(5),s={hasCurrentUserAccesToCommunity:function(t){return t.HasCurrentUserAccess},getCommunityLogoUrl:function(t){return null!=t.LogoUrl&&""!==t.LogoUrl&&this.hasCurrentUserAccesToCommunity(t)?t.LogoUrl:"".concat(o.default.getSiteCollectionUrl(),"/style library/Images/beezy/groupheader.default-image.svg")},getGroupSecurity:function(t){return t.IsPublic?t.IsModerated?"Moderated":"Public":"Private"},getGroupStatus:function(t){return t.IsActive?"Active":"Archived"},getGroupUrl:function(t){return(t=t||n.default.getCurrentGroup())&&t.Url?o.default.getSiteHost()+t.Url:o.default.getSiteCollectionUrl()},isPublicAndNotOpen:function(t){return t&&t.IsPublic&&!o.default.isPublicCommunitiesOpen()},isModerated:function(t){return t&&t.IsModerated},isPrivate:function(t){return t&&!t.IsPublic}};e.default=s},47:function(t,e,i){"use strict";i.r(e);var n=i(98),o=i.n(n),s=i(4),r=i.n(s),a=i(5),l=i(2),c=i(57),u=i(38),d=i(10),h=i(711),f=function(){return i.e(54).then(i.bind(null,367))},p=function(){return i.e(169).then(i.bind(null,3718))},m=function(){return i.e(169).then(i.bind(null,3719))},g=function(){return i.e(169).then(i.bind(null,3720))},v={showEulaDisclaimer:function(){var t=document.getElementById("user-eula");t||(t=Object(h.default)("div",[{name:"id",value:"user-eula"}])),u.default.renderComponent(t,p,{isAllowReject:a.default.isAllowRejectTermsOfUse(),onError:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=a.default.getApiUrlv2()+(t?"/Users/AcceptCompliance":"/Users/RejectCompliance");d.default.get(e).then((function(){document.location.reload(!0)}),(function(t){console.error("Failed to accept compliance. ".concat(t))}))}},!0,!0)},showLicenseError:function(){var t=document.getElementById("license-error");t||(t=Object(h.default)("div",[{name:"id",value:"license-error"}])),u.default.renderComponent(t,g,{modalElem:t,licenseUrl:"".concat(a.default.getBaseSiteCollection(),"/SitePages/Settings.aspx")},!0,!0)},showNoUserError:function(){var t=document.getElementById("nouser-error");t||(t=Object(h.default)("div",[{name:"id",value:"nouser-error"}])),this.showModalError=!0,u.default.renderComponent(t,m,{modalElem:t,title:Object(l.translate)("We are sorry"),description:Object(l.translate)("The current user does not have a Beezy user profile.")},!0,!0)},closeModalError:function(){var t=document.getElementById("modal-error");this.showModalError=!1,u.default.unMountComponent(t),t.remove()},showGenericError:function(){var t=document.getElementById("modal-error");t||(t=Object(h.default)("div",[{name:"id",value:"modal-error"}])),this.showModalError=!0,u.default.renderComponent(t,f,{show:this.showModalError,onClose:this.closeModalError.bind(this)},!0,!0)},createDialogContainer:function(t){return r()("<div />").css("display","none").addClass(t||"")},createDialogComponent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t,n="object"===o()(e.position)&&e.position instanceof Object;i.dialog=new c.default(i,{dialogClass:e.dialogClass||"close-dialog",buttons:e.buttons||{},extend:{position:{my:n?e.position.my:"center",at:n?e.position.at:"center",of:window},showCrossButton:!0}}),t.on("close",(function(){t.dialog.hide()}))}};e.default=v},48:function(t,e,i){"use strict";var n=i(5),o=i(2076),s=i(1010),r=i(2077),a=i(3),l=i.n(a),c=i(239),u=i(19),d=i.n(u),h=i(10),f=i(2),p=i(2134),m=i.n(p),g=i(2135),v=i.n(g),b=i(7),y=function(t){return l.a.extend({run:function(t){var e;return{valid:l.a.every(this.validators,(function(i){return!!i.fn(t)||(e=i.message,!1)}),this),message:e}}},{validators:t||[]})};y.isEmpty={fn:function(t){return!!t&&((!Array.isArray(t)||0!==t.length)&&(t instanceof Date||!!t.length))},message:b.default.textErrors.fieldRequired},y.isEmailOrEmpty={fn:function(t){return/^$|[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(t)},message:Object(f.translate)("Invalid format email")},y.isNumber={fn:function(t){return!isNaN(t)},message:Object(f.translate)("This field must be a number")},y.specialChars={fn:function(t){return/^[^~^<>;|{}"]*$/.test(t)},message:Object(f.translate)('No special characters like ~^<>;|{}" are allowed')},y.isImageOrEmpty={fn:function(t){return/^$|^.+(\.(jpg|jpeg|png|gif))$/i.test(t)},message:Object(f.translate)("Only .jpg, .jpeg, .gif and .png are allowed")},y.isDate={fn:function(t){return!t||Object(o.default)(t)},message:Object(f.translate)("Invalid format date")};y.shouldBeBeforeThan={componentToCompare:null,rangeInDays:0,fn:function(t){return!this.componentToCompare||!t||(!this.componentToCompare.getValue()||t instanceof Date&&this.componentToCompare.getValue()instanceof Date&&t<Object(r.default)(this.componentToCompare.getValue(),this.rangeInDays))},message:Object(f.translate)("Invalid date")},y.shouldBeAfterThan={componentToCompare:null,rangeInDays:0,fn:function(t){return!this.componentToCompare||!t||(!this.componentToCompare.getValue()||t instanceof Date&&this.componentToCompare.getValue()instanceof Date&&t>Object(s.default)(this.componentToCompare.getValue(),this.rangeInDays))}},y.isNotPages={fn:function(t){return"pages"!==t.toLowerCase()},message:Object(f.translate)("The Path '/Pages' is not allowed.")},y.checkTitle=function(t,e){var i,o,s,r,a=new c.default("quicktip--info");if(!e)return i=m.a,o=v.a,s="".concat(n.default.getApiUrlv2(),"/Groups/Availability"),r=t.getValue(),d.a.promise((function(e){h.default.get(s,{title:r}).then((function(n){var s,c;n.length&&(c=r,n.every((function(t){return t.Title.toLowerCase()!==c.toLowerCase()})))?(a.show(t.attachError(),o(n)),e(!0)):(Array.from(document.querySelectorAll(".quicktip--info")).forEach((function(t){t.parentElement.removeChild(t)})),n.length&&t.filterValue&&l.a.some(n,t.filterValue)?e(!0):(n.length&&(s=i(r).replace("%s",Object(f.translate)(n[0].Type))),t.checkError(!n.length,s),e(!n.length)))}))}));var u=d.a.defer();return Array.from(document.querySelectorAll(".quicktip--info")).forEach((function(t){t.parentElement.removeChild(t)})),u.resolve(!0)},y.setOptions=function(t,e){return l.a.extend(t,e)},y.createNewValidator=function(t,e){if(void 0!==t.fn)return this.setOptions(l.a.clone(t),e);throw new Error("pvalidator[fn] is required")},e.default=y},481:function(t,e,i){"use strict";i.r(e);var n=i(1273),o=i(960),s=i(961),r=i(1882),a=i(1883),l=i(1267),c=i(1884),u=i(1885),d=i(1274),h=i(1886),f=i(1887),p=i(1888),m=i(1889),g=i(1266),v=i(1890),b=i(1891),y=i(1892),C=i(1893),w=i(1894),T=i(1895),x=i(1896),O=i(1897),S=i(1898),I=i(1908),A=i(1860),k={};k.ActivityAnswer=n.default,k.Announcement=s.default,k.Answer=o.default.Answer,k.Blog=r.default,k.Calendar=a.default,k.Chart=l.default,k.Discussion=c.default,k.Document=u.default,k.Idea=d.default,k.Item=h.default,k.KnowledgeCenter=f.default,k.None=p.default,k.Poll=m.default,k.PollVote=g.default,k.Post=v.default,k.Praise=b.default,k.Question=y.default,k.Task=C.default,k.Wiki=w.default,k.ExtendedIdea=T.default,k.Story=x.default,k.CorporatePage=O.default,k.Share=S.default,k.AdaptiveCard=I.default,k.ActionCard=A.default,e.default=k},482:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s={insideBeezyMaster:function(){return!!o()("#ctl00_StylesheetContainer").length}};e.default=s},483:function(t,e,i){"use strict";i.r(e);var n=i(27),o=i.n(n),s=i(3),r=i.n(s),a=i(1911),l=i(8),c=o.a.Collection.extend({model:a.default,url:function(){return"".concat(l.default.getGroupServiceV2Url(),"/Members")},parse:function(t,e){r.a.isArray(t)||(t=[t]);var i=e.data&&e.data.take;return t.length<(i||10)?(this.remaining=!1,t):(this.remaining=!0,t)}});e.default=c},49:function(t,e,i){"use strict";i.r(e);i(99);var n=i(498),o={link:/((www\.|((ht|f)tp(s?)|file):\/\/|mailto:){1}\S[-A-Za-zÀ-ÿ0-9+&@#/%?$=~_()[\]{}|!:,.;'’£]*[-A-Za-zÀ-ÿ0-9+&@#/%=~_()[\]{}|])/gi,singleNewLine:/([^\u000d\u000a])(\u000d\u000a)/g,doubleNewLine:/\u000d\u000a\u000d\u000a/g,url:/((www\.|((ht|f)tp(s?)|file):\/\/|mailto:){1}\S[-A-Za-zÀ-ÿ0-9+&@#/%?=~_()[\]{}|!:,.;']*[-A-Za-zÀ-ÿ0-9+&@#/%=~_()[\]{}|])/i};e.default={getLinks:function(t){if(!t.length)return null;var e=n.default.unescapeHTML(t).match(o.link);return e&&e.length?e.map((function(t){return")"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t.match(/^HTTP/i)||t.match(/^FILE/i)||t.match(/^MAILTO/i)?t.replace(/&amp;/gi,"&"):"http://".concat(t)})):null},compactNewLines:function(t){return t?t.replace(o.singleNewLine,"$1").replace(o.doubleNewLine,"\n"):t},escapeQuotes:function(t){return t?t.replace(/'/g,"\\'").replace(/"/g,'\\"'):t},unescapeQuotes:function(t){return t?t.replace(/\\'/g,"'").replace(/\\"/g,'"'):t},sliceBlankSpace:function(t,e){var i;for(i=e;i<0;i++)if(" "===t[t.length+i])return t.slice(0,i);return t.slice(0,i)},ellipsis:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};setTimeout((function(){t.dotdotdot(Object.assign(i,{height:Math.round(parseFloat(t.css("lineHeight"),10))*e}))}),0)},checkUrlProtocol:function(t){return/^https?:\/\//.test(t)||(t="http://".concat(t)),t},isURL:function(t,e){return e?o.url.test(t):o.link.test(t)},trimCharacter:function(t,e){return t.replace(new RegExp("^".concat(e,"+"),"g"),"").replace(new RegExp("".concat(e,"+$"),"g"),"")},nicefyText:function(t){return t.replace(/&amp;/gi,"&").replace(/%20/gi," ").replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/g,'"')},cutText:function(t,e,i){return"string"==typeof t&&t.length>e?(i="boolean"!=typeof i||i)?"".concat(t.substring(0,e-3),"..."):t.substring(0,e):t},toClassText:function(t){return t.replace(/ /g,"").replace("&","").trim().toLowerCase()},escapeRegExpSnippets:function(t){return null==t?"":String(t).replace(/[\-\[\]\/\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},sortByLengthDesc:function(t,e){return t.length>e.length?-1:t.length<e.length?1:0},transformFirstLetterToUppercase:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},removeLastCharacterIfExist:function(t,e){var i=t;return i.substring(i.length-1)===e&&(i=i.substring(0,i.length-1)),i},replaceAll:function(t,e,i){return t.replace(e,i)},cleanNewLinesInJson:function(t){var e=this;return this.replaceAll(t,/"([\s\S]*?)"/g,(function(t){return e.replaceAll(e.replaceAll(e.replaceAll(t,/\r/g,"\\r"),/\n/g,"\\n"),/\t/g,"\\t")}))},isString:function(t){return"string"==typeof t},duplicatedQuestionMarks:function(t){return t.replace(/\?{2,}/g,"?")},cleanUrlSpaces:function(t){return t.replace(/ /g,"%20")},trimWhitespace:function(t){return t.trim().replace(/\s/g,"")}}},490:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(15),s={hasCorporateModule:function(){var t=n.default.getCorporateModule();return t&&(t.IsCurrentUserWebAdmin||t.IsCurrentUserMember)},hasEditorialModule:function(){var t=n.default.getEditorialModule();return t&&(t.IsCurrentUserWebAdmin||t.IsCurrentUserMember)},hasEditorialSettings:function(){return o.default.isBeezyAdministrator()||o.default.isBeezyCommunityManager()||o.default.localEntityAdminHasEditorialSettings()},isCorporateGuestWriter:function(){var t=n.default.getCorporateModule();return t&&t.IsCurrentUserGuestWriter},isCommunityCreator:function(){return o.default.isCommunityCreator()},isKnowledgeCenterCreator:function(){return o.default.isKnowledgeCenterCreator()&&n.default.isEnableKnowledgeCenters()},isIdeasCampaignCreator:function(){return o.default.isIdeasCampaignCreator()&&n.default.isEnableIdeasCampaigns()},isStandAloneBlogEnabled:function(){return n.default.isEnableStandaloneBlog()},isStandAloneWikiEnabled:function(){return n.default.isEnableStandaloneWiki()},isStandAloneForumEnabled:function(){return n.default.isEnableStandaloneForum()},hasAnyQuicklinks:function(){var t=this,e=!1;return Object.getOwnPropertyNames(this).forEach((function(i){"function"==typeof t[i]&&"hasAnyQuicklinks"!==i&&(e=e||t[i].call())})),n.default.isQuickLinksEnabled()&&e}};e.default=s},497:function(t,e,i){"use strict";i.d(e,"beezyDefaultLanguage",(function(){return n}));var n={name:"English",code:"en-us",lcid:1033,dateFnsLocaleName:"enUS",timeFormat:i(260).TIME_FORMAT_12_HOURS}},498:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=(i(3112),function(t){if(t.createTextRange){var e=t.createTextRange();e.collapse(!0),e.moveEnd("character",0),e.moveStart("character",0),e.select()}else t.setSelectionRange&&t.setSelectionRange(0,0)}),r={createIEPlaceHolders:function(t){o.a.browser.msie&&(t instanceof o.a?t:o()(t)).find("input[placeholder]").each((function(){!function(t){var e=t instanceof o.a?t:o()(t),i=e.val(),n=e.attr("placeholder");n&&(i?e.data("hasPlaceholder",!1):(e.val(n),s(e[0]),e.data("hasPlaceholder",!0)),e.on("blur",(function(){var t=o()(this),e=t.attr("placeholder");t.val()||(t.val(e),t.data("hasPlaceholder",!0))})),e.on("focus",(function(){o()(this).data("hasPlaceholder")&&s(e[0])})),e.on("keydown",(function(){var t=o()(this);t.data("hasPlaceholder")&&(t.val(""),t.data("hasPlaceholder",!1))})),o()(document).find(".btn.btn--primary").on("focus",(function(){o()(document).find("input[placeholder]").each((function(){var t=o()(this);t.data("hasPlaceholder")&&t.val("")}))})))}(o()(this))}))},keepYCoordRatio:function(t){t.find(".js-image-keep-ycoord-ratio").each((function(){var t=o()(this),e=t.data("coords"),i=t.width();if(e.width){var n=i*e.y/e.width;t.css("background-position","".concat(e.x,"px ").concat(n,"px"))}}))},escapeHTML:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\//g,"&#47;").replace(/'/g,"&#39;")},escapeHTMLXSS:function(t){return String(t).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\//g,"&#47;").replace(/'/g,"&#39;")},unescapeHTML:function(t){return String(t).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&#47;/g,"/").replace(/&#39;/g,"'").replace(/&#123;/g,"{").replace(/&#125;/g,"}").replace(/&#58;/g,":")},htmlTruncate:function(t,e){return o()("<div></div>").append(t).truncate({length:e}).html()}};e.default=r},5:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(15),r=(i(2165),i(7)),a=function(t){if("undefined"!=typeof beezySettings&&void 0!==beezySettings[t])return beezySettings[t];console.error("[Error in Settings config module]: Property ".concat(t," does not exist"))},l={getApiQueryStringv2:function(){return a("ApiServiceV2QueryString")},getApiUrlv2:function(){return this.getBaseWebUrl()+a("ApiServiceV2Url")},getApiUrlv2MSC:function(){return this.getBaseWebUrl()+a("ApiServiceV2Url")},getApiUrlv2Admin:function(){return this.getBaseWebUrl()+a("AdminApiServiceV2Url")},getBaseSiteHost:function(){return a("BaseSiteHost")},getBaseSiteCollection:function(){return a("BaseSiteCollectionUrl")},getMySiteSiteCollection:function(){return a("MySiteSiteCollection")},getBaseWebUrl:function(){return a("BaseWebUrl")},getCollectionUrl:function(){return s.default.isProfile()?this.getBaseSiteCollection():this.getSiteCollectionUrl()},getAbsoluteUrlLayout:function(){return this.getBaseWebUrl()+this.getUrlLayout()},getBeezyThumbnail:function(t,e,i){var n="/Spenta.Beezy/ImageThumbnail.ashx?url=".concat(encodeURIComponent(t),"&height=").concat(i,"&width=").concat(e,"&cover=1"),o=beezySettings.ApiServiceMainSiteQueryString+(window.sessionStorage.getItem("contextToken")?"&SPAppToken=".concat(window.sessionStorage.getItem("contextToken")):"");return s.default.isProfile()?"".concat(this.getAbsoluteUrlLayout()+n,"&").concat(o):"".concat(this.getAbsoluteUrlLayout()+n,"&").concat(beezySettings.ApiServiceV2QueryString)},getSPThumbnail:function(t){var e=t.substring(t.lastIndexOf("/")+1).split("?")[0],i=t.split(e)[0].startsWith("http")?t.split(e)[0]:a("SiteHost")+t.split(e)[0],n=/\.((\w|\d){3,5})$/.exec(e);return n?"".concat(i,"_w/").concat(e.substring(0,n.index),"_").concat(n[1],".jpg"):""},getLargeImageThumbnail:function(t){return this.getBeezyThumbnail(t,750,500)},getMediumImageThumbnail:function(t){return this.isUseSharePointImageRenditions()?"".concat(t,"?Width=").concat(500,"&Height=").concat(350):this.getBeezyThumbnail(t,500,350)},getDefaultImageThumbnail:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.isUseSharePointImageRenditions()&&e){var i=350,n=250;return"".concat(t,"?Width=").concat(i,"&Height=").concat(n)}return this.getSPThumbnail(t)},getImagesPath:function(){return"".concat(this.getBaseSiteCollection(),"/Style%20Library/images/beezy/")},getDefaultLinkImage:function(){return"".concat(this.getImagesPath(),"link-placeholder.svg")},getProfileImage:function(){return"".concat(a("BaseSiteCollectionUrl")+this.getUrlLayout(),"/images/").concat(this.isSharepoint15()||this.isSharepointApp()?"PersonPlaceholder.96x96x32.png":"O14_person_placeHolder_192.png")},getProfileUrl:function(){return a("ProfileUrl")},getApplicationTitle:function(){return a("ApplicationTitle")},getQueryString:function(){var t="";this.isSharepointApp()&&(t=beezySettings.ApiServiceMainSiteQueryString);var e,i={},n="".concat(location.search.substring(1),"&").concat(t),o=/([^&=]+)=([^&]*)/g;if(s.default.isProfile()&&location.hash)for(;e=o.exec(n);)"accountname"===e[1]&&(i[decodeURIComponent(e[1])]=escape(decodeURIComponent(decodeURIComponent(e[2])+window.location.hash)));else for(;e=o.exec(n);)i[decodeURIComponent(e[1])]=decodeURIComponent(e[2]);return i},getQueryStringParam:function(t){var e=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]").toLowerCase(),i=new RegExp("[\\?&]".concat(e,"=([^&#]*)")).exec(window.location.search.toLowerCase());return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))},getSiteHost:function(){return a("SiteHost")},getSiteCollectionUrl:function(){return a("SiteCollectionUrl")},getUrlLayout:function(){return"/_layouts".concat(this.isSharepoint15()||this.isSharepointApp()?"/15":"")},getDisabledTools:function(){return a("DisabledTools")},getNavigationNodes:function(){return a("NavigationNodes")},getProductInstalledDate:function(){return a("ProductInstalledDate")},isNewsfeedLayout:function(){return a("EnableStartTwoColumnLayout")},isLicenseValid:function(){return a("IsLicenseValid")},isSharepoint15:function(){return o.a.str.startsWith(a("SharePointVersion"),"15")||o.a.str.startsWith(a("SharePointVersion"),"16")},isSharepointApp:function(){return"SharePointApp"===a("SharePointVersion")},isInsideSharepointContainer:function(){return!o.a.contains(r.default.PagesWithoutMaster,beezyContext.CurrentPageKey)},isEnableKnowledgeCenters:function(){return a("EnableKnowledgeCenters")},isEnableStandaloneForum:function(){return a("EnableStandaloneForum")},isEnableStandaloneBlog:function(){return a("EnableStandaloneBlog")},isEnableStandaloneWiki:function(){return a("EnableStandaloneWiki")},isEnableAccessLiteral:function(){return a("EnableAccessLiteral")},isDefaultSubscribeToWeeklyDigestWhenFollow:function(){return a("DefaultSubscribeToWeeklyDigestWhenFollow")},getEditorialModule:function(){return a("EditorialModule")},getCorporateModule:function(){return a("CorporateModule")},isCorporateModuleEnabled:function(){return null!==a("CorporateModule")},isPublicCommunitiesOpen:function(){return a("PublicCommunitiesOpen")},isOfficePreviewEnabled:function(){return a("EnableOfficePreview")},isSignalREnabled:function(){return a("EnableSignalR")},getCreationSiteCollection:function(t){return a(r.default.CreationSiteCollections[t])},isQuickLinksEnabled:function(){return a("EnableQuickLinks")},getDefaultSiteQuota:function(){return a("DefaultSiteQuota")},getSettingByName:function(t){return a(t)},getTimezoneDefault:function(){return a("TimezoneDefault")},getChannelId:function(){return a("ChannelName")},getUserProfilePropsSync:function(){return a("UserProfilePropsSync")},isEnableMyBookmarksTab:function(){return a("EnableMyBookmarksTab")},getIdeasMetadataProperties:function(){return a("IdeasMetadataProperties")},isEnableDiscoveryCards:function(){return a("EnableDiscoveryCards")},isPublicCommunitiesEnabled:function(){return a("EnablePublicCommunities")},getDelveProfilePicture:function(){return a("DelveProfilePicture")},isModeratedCommunitiesEnabled:function(){return a("EnableModeratedCommunities")},isRestrictedCommunitiesEnabled:function(){return a("EnableRestrictedDiscoverableCommunities")||a("EnableRestrictedHiddenCommunities")},isHiddenRestrictedCommunitiesEnabled:function(){return a("EnableRestrictedHiddenCommunities")},isDiscoverableRestrictedCommunitiesEnabled:function(){return a("EnableRestrictedDiscoverableCommunities")},getEveryoneCanCreateCommunities:function(){return a("EveryoneCanCreateCommunities")},isEnableTermsOfUse:function(){return a("EnableTermsOfUse")},isAllowRejectTermsOfUse:function(){return a("AllowRejectTermsOfUse")},getExternalUsersOwners:function(){return a("ExternalUsersOwners")},isEnableOwnersInvite:function(){return a("EnableOwnersInvite")},getPraiseIcons:function(){return a("PraiseIcons")},isEnableHashtagsTabs:function(){return a("EnableHashtagsTabs")},getNewsfeedCustomTab:function(){return a("NewsfeedCustomTab")},isEnableOwnerCanEditOtherActivities:function(){return a("EnableOwnerCanEditOtherActivities")},isEnablePeopleIFollowTab:function(){return a("EnablePeopleIFollowTab")},isEnableDiscoverTab:function(){return a("EnableDiscoverTab")},getMapsProvider:function(){return a("MapsProvider")},getMapsSdkKey:function(){return a("MapsSdkKey")},getEmbedlySdkKey:function(){return a("EmbedlySdkKey")},isSkypeEnabled:function(){return a("EnableSkypeIntegration")},isMapEnabled:function(){return a("MapsSdkKey")},getMapsConfiguration:function(){return{type:a("MapsProvider"),key:a("MapsSdkKey")}},notAllowedCharacters:function(){return a("NotAllowedCharacters")},isUseSharePointImageRenditions:function(){return a("UseSharePointImageRenditions")},isAllowRetrieveUsersNoEula:function(){return a("AllowRetrieveUsersNoEula")},isEnableIdeasCampaigns:function(){return a("EnableIdeasCampaigns")},enableAutosave:function(){return a("EnableAutoSave")},isUserProfilesFromAzureAD:function(){return"AzureAD"===a("ExternalUserProfilesProvider")},startPageUrl:function(){return a("StartPageUrl")},enableNotificationModals:function(){return a("EnableNotificationModals")},showLocalEntitiesInManageSettings:function(){return a("EnableLocalEntities")},isLocalEntitiesEnabled:function(){return a("EnableLocalEntitiesEditorialConfirmation")},getNotificationPopupSize:function(){return a("NotificationPopupSize")},isFoldersEnabled:function(){return a("EnableFoldersInCommunities")},isEnableO365Tasks:function(){return a("EnableO365Tasks")},getEditorVideosConfiguration:function(){var t=[];return JSON.parse(a("EditorVideosConfiguration")).forEach((function(e){t.push({urlsDefault:e.url,videoThumbnail:e.APIVideoThumbnail,srcTemplateDefault:e.srcIframe})})),t}};e.default=l},502:function(t,e,i){"use strict";var n=i(4),o=i.n(n),s=i(36),r=i(333),a=i(1491),l=i.n(a),c=i(277),u=i(1761),d=i(33),h=i(2),f=s.default.extend({dom:{LIST:".js-list",PICKER:".js-picker",REMOVE:".js-remove",REMOVE_ITEM:".js-removeItem",emptyState:".js-hasEmptyState",ERROR:".js-error-title"},context:{},listClasses:{list:"item-list",item:"item-list__item js-list-item"},events:function(){var t={};return t["click ".concat(this.dom.REMOVE)]="removeSelectedItem",t},initialize:function(t){this.options=t||{},this.options.itemList=t.itemList||c.default,this.options.searchAdapterString=this.options.searchAdapterString||"",this.options.pickerValueSelector=this.options.pickerValueSelector||"",this.options.pickerItemTemplate=this.options.pickerItemTemplate||"",this.options.hasPicker=void 0===t.hasPicker||t.hasPicker,this.excludeItems=this.options.excludeItems||[],this.emptyStateTemplate=l.a,this.listClasses=t.listClasses||this.listClasses,f.__super__.initialize.call(this,t)},render:function(){return"function"==typeof this.context&&(this.context=this.context()),this.context=this.options,this.$el.append(this.template(this.context)),this._createList(),!0!=!this.options.hasPicker&&this._createPicker(),this.hideList(),this.renderEmptyState(),this.$error=this.$el.find(this.dom.ERROR),this.focusItem=this.$el.find(this.dom.PICKER),this.trigger("rendered"),this},renderEmptyState:function(){this.context.hasEmptyState&&!this.itemList._$items.length&&(this.$(this.dom.LIST).hide(),this.$(this.dom.REMOVE).hide(),this.$el.find(this.dom.emptyState).html(this.emptyStateTemplate({icon:this.options.emptyStateParameters.icon,notFoundText:this.options.emptyStateParameters.notFoundText,addText:this.options.emptyStateParameters.addText})))},setEmptyState:function(){this.options.hasEmptyState&&(this.itemList._$items.length?(this.$(this.dom.LIST).show(),this.$(this.dom.REMOVE).show(),this.$el.find(this.dom.emptyState).hide()):(this.$(this.dom.LIST).hide(),this.$(this.dom.REMOVE).hide(),this.$el.find(this.dom.emptyState).show()))},_createList:function(){var t=this,e=this.options,i=e.hasConfirmationRemoveItem,n=e.hasRemoveIcon,o=e.showInvitationsType,s=e.showRole,r=e.templateItemList,a=e.itemsNotClickables,l=e.hasToolsPopup,c=e.templateToolsPopup,u=e.roleName,d=e.itemListTools,h=e.listPlaceholder;this.itemList=new this.options.itemList({el:this.$(this.dom.LIST),template:r||this.templateItemList,classes:this.listClasses,placeholder:h,multiple:!0,showInvitationsType:o,itemsNotClickables:a,hasRemoveIcon:n,hasToolsPopup:l,templateToolsPopup:c,roleName:u,tools:d,hasConfirmationRemoveItem:i,showRole:s,threshold:this.options.threshold}).render(),this.itemList.on("selected",this.checkSelected,this),this.itemList.on("removeSelected",(function(e){i?t.displayConfirmDialog(e.currentTarget):t.removeSelectedItem()})),d&&d.length>0&&d.forEach((function(e){"selected"!==e.eventName&&"removeSelected"!==e.eventName&&t.itemList.on(e.eventName,(function(i){t.trigger(e.eventName,i)}))}))},hideList:function(){this.options.hideEmptyList&&(this.$(this.dom.LIST).hide(),this.$(this.dom.REMOVE).hide())},showList:function(){this.$(this.dom.LIST).show()},addItem:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Array.isArray(t)&&!t.length||(this.trigger("beforeAdd",t,i),this.itemList.set(t),e&&this.itemList.focusItem(this.itemList.count()-1),this.showList(),this.trigger("add",t,this.itemList._$items.length),this.setEmptyState())},displayConfirmDialog:function(t){var e=this,i=new r.default({notDialog:!0});i.setTitle(this.options.confirmationRemoveItemDialog.title),i.setText(this.options.confirmationRemoveItemDialog.text),i.setConfirm(this.options.confirmationRemoveItemDialog.confirmText),i.setCancel(this.options.confirmationRemoveItemDialog.cancelText);var n=this.$el.find(this.options.confirmationRemoveItemDialog.containerClass);n.find(this.options.confirmationRemoveItemDialog.confirmationContainerClass).append(i.render().$el),n.find(t).parent().parent().hide(),o()(n.find(this.options.confirmationRemoveItemDialog.confirmationContainerClass).get(0)).addClass("is-open"),i.getPromise().done((function(t){"confirm"===t&&e.removeSelectedItem(),n.find(e.options.confirmationRemoveItemDialog.confirmationContainerClass).removeClass("is-open"),n.find(e.options.confirmationRemoveItemDialog.confirmationContainerClass).html(""),i={},n.find(e.options.confirmationRemoveItemDialog.itemDetailClass).show()}))},removeSelectedItem:function(){var t=this,e=[];this.itemList.selectedItem.forEach((function(i){e.push(t.itemList._items[i])})),this.itemList.removeSelected(),this.checkSelected(),this.trigger("remove",e,this.itemList._$items.length),this.setEmptyState(),this.checkAllValidations()},checkSelected:function(){this.itemList.getSelectedIndex().length?(this.$(this.dom.REMOVE).show(),this.bindRemoveSelectedItems()):(this.$(this.dom.REMOVE).hide(),o()(document).off("mouseup"))},bindRemoveSelectedItems:function(){var t=this;o()(document).mouseup((function(e){var i=t.$(t.dom.LIST),n=t.$(t.dom.REMOVE);i.is(e.target)||0!==i.has(e.target).length||n.is(e.target)||t.removeSelected()}))},removeSelected:function(){this.itemList.resetSelected(),this.checkSelected()},isInItemList:function(){throw new Error("component/list: You must implement abstract method isInItemList")},getValue:function(){return this.itemList.getItems()},setValue:function(t){this.itemList.set(t),t.length&&this.showList()},setValues:function(t){var e=this;t.forEach((function(t){e.itemList.set(t)}),this)},_createPicker:function(){var t=this;this.picker=new u.default({el:this.$(this.dom.PICKER),classes:{button:"btn btn--primary",autocomplete:{input:"full-width",container:"autocomplete autocomplete--bottom bz-webpart",list:"",item:"autocomplete__item"}},template:this.options.pickerItemTemplate,searchAdapter:d.default.searchAdapter(this.options.searchAdapterString,this.options.maxItems,this.options.requestParameterName,this.options.searchAdapterSuffix),valueSelector:this.options.pickerValueSelector,buttonText:Object(h.translate)("Add"),adapterOptions:this.options.adapterOptions,placeholder:this.options.pickerPlaceholder,removeAfterAdd:!0,zIndex:this.options.zIndex,listInsertItems:this.itemList,keyParameter:this.options.keyParameter,excludeItems:this.excludeItems,dependent:this.options.dependent,insideOtherDrop:this.options.insideOtherDrop,threshold:this.options.threshold}),this.picker.on("selectItem",(function(e){t.checkPickerSelected(e),t.checkAllValidations()})),this.picker.on("add",this.addItem,this),this.picker.on("focus",(function(e){t.trigger("focus",e)}),this),this.picker.on("blur",(function(e){t.trigger("blur",e),t.checkAllValidations()}),this),this.on("addExcludeItem",(function(e){var i=t;e.forEach((function(t){i.excludeItems.push(t)}))})),this.on("removeExcludeItem",(function(e){var i=t;e.forEach((function(t){var e=Array.isArray(t)?t[0]:t;i.excludeItems.forEach((function(t,n){t===e&&i.excludeItems.splice(n,1)}))}))})),this.checkSelected()},checkPickerSelected:function(t){var e=this;if(t)return this.isInItemList(t)?(this.picker.resetSelectedItem(),this.trigger("invalid",this,this.texts.invalidSelectedItem),void setTimeout((function(){e.trigger("valid",e)}),1e3)):void this.addItemToList(t);this.trigger("valid",this)},addItemToList:function(t){this.addItem(t),this.trigger("newItemAdded")},reset:function(){this.picker.reset(),this.itemList.reset()},attachError:function(){return this.picker.getInput()},getJSON:function(){return this.getValue()},enable:function(){this.isDisabled=!1,this.picker.enable(),this.itemList.enable()},disable:function(){this.isDisabled=!0,this.picker.disable(),this.itemList.disable()},setError:function(t){this.$(this.dom.LIST).addClass(this.classes.error),this.$error.length>0&&(this.$error.html(t),this.$error.show())},unsetError:function(){this.$(this.dom.LIST).removeClass(this.classes.error),this.$error&&this.$error.length>0&&(this.$error.html(),this.$error.hide())}});e.default=f},503:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(955),l=i(2363),c=i.n(l),u=i(12),d=i(7),h=i(2),f=i(351),p=a.default.extend({className:"microtag bz-webpart",template:c.a,dom:{latestActivity:".js-latest-activity",loading:".js-loading",follow:".js-follow",followers:".js-followers",contributors:".js-contributors",numberFollower:".js-number-follower",numberContributor:".js-number-contributor",progressBar:".js-progressbar",bar:".js-bar",popupClass:"js-microtag-iframe",microtagvalue:".js-microtag-value",classContainer:"js-beezy-microtag"},events:{mouseenter:"showPopover",mouseleave:"hide","click .js-latest-activity":"showLatestActivity"},initialize:function(t){var e=this;this.options=t,this.options.showActivityText=t.showActivityText||Object(h.translate)("View activity for this tag"),this.isHashtag=void 0===this.options.isHashtag||this.options.isHashtag,this.initializeDrop(t.elementBound,t.elementKeyboard),this.show=r.a.bind(this.show,this),this.hide=r.a.bind(this.hide,this),this.options.hasButton=void 0===this.options.hasButton||this.options.hasButton,this.addStoryHashTags=t.addStoryHashTags||!1,this.templateMicroTag=t.templateMicroTag||this.template,this.isFollowingUnfollowing=!1,this.isEditorialScope="article"===beezyContext.CurrentPageKey||"publicArticle"===beezyContext.CurrentPageKey,this.options.showDelay||(this.options.showDelay=400),this.options&&this.options.offset&&(this.$el.addClass("js-microtag-iframe"),o()("head").append("<style>.js-microtag-iframe:before { left:30px !important; } .js-microtag-iframe:after { left:30px !important; }</style>")),this.options.popoverOptions||(this.options.popoverOptions={}),this.options.popoverOptions.classNames="popover-microtag",u.default.subscribe("microtag","follow".concat(e.model.get("Name").toLowerCase()),(function(t){e.updateModelIfNeeded(t,!1)}),this),u.default.subscribe("microtag","unfollow".concat(e.model.get("Name").toLowerCase()),(function(t){e.updateModelIfNeeded(t,!1)}),this)},render:function(){return this.initializeButtonFollow(),this.$el.html(this.template(r.a.extend(this.model.toJSON(),this.options,{isIE:o.a.browser.msie}))),this.options.hasButton&&this.$(this.dom.follow).append(this.buttonFollow.render()),this},showPopover:function(){this.shouldHide=!1},bindEvents:function(){this.delegateEvents(),this.buttonFollow&&this.buttonFollow.bindEvents()},setValueAndProperties:function(){return this.showValue(this.model.get("Value")),this._setExtendedProperties()},getExtendedProperties:function(){var t=this,e=o.a.Deferred();return this.$(this.dom.image).addClass(this.classes.isLoading),this.buttonFollow.toggleLoading(),this.model.get("Value")?t._setExtendedProperties().then((function(){e.resolve()})):this.isHashtag?beezyCurrentGroup?"function"==typeof this.model.getValueGroup?this.model.getValueGroup(beezyCurrentGroup.GroupId).then((function(i){t.model.set({Value:i}),t.setValueAndProperties().then((function(){e.resolve()}))})):t.setValueAndProperties().then((function(){e.resolve()})):this.model.getValue().then((function(i){t.model.set({Value:i}),t.setValueAndProperties().then((function(){e.resolve()}))})):t._setExtendedProperties().then((function(){e.resolve()})),e},updateModelIfNeeded:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this;f.default.isCurrentUserFollower(t,e).then((function(t){i.options.IsFollowing=t}))},_setExtendedProperties:function(){var t=this,e=o.a.Deferred();if(this.isHashtag&&!this.isFollowingUnfollowing)f.default.isCurrentUserFollower(this.model.get("Name").toLowerCase()).then((function(i){t.options.IsFollowing=i,t.model.get("Followers")&&t.showContributors(t.model.get("Followers")),t.model.get("Contributors")&&t.showFollowers(t.model.get("Contributors")),e.resolve(i).then((function(){t.showFollowButton({isCollegue:i})}))}));else{var i=this.model.get("CurrentUserFollowing");this.options.IsFollowing=i,this.showFollowButton({isCollegue:i}),e.resolve(i)}return e},showValue:function(t){this.$(this.dom.microtagvalue).html("(".concat(t,")"))},showFollowers:function(t){var e=Object(h.pluralise)("Total number of praises","Total number of praises",t);this.$(this.dom.numberFollower).text(t),this.$(this.dom.followers).attr("title",e),this.$(this.dom.followers).removeClass(this.classes.hidden)},showContributors:function(t){var e=Object(h.pluralise)("Among the top contributors in %d community","Among the top contributors in %d communities",t),i=Object(h.sprintf)(e,t);this.$(this.dom.numberContributor).text(t),this.$(this.dom.contr).attr("title",i),this.$(this.dom.contributors).removeClass(this.classes.hidden)},follow:function(){var t=this,e=this;e.show(),e.isFollowingUnfollowing=!0,this.isHashtag?this.isEditorialScope?this.model.save(null,{success:function(){e.isFollowingUnfollowing=!1,f.default.refreshCurrentUserHashtags(),e.setButtonUnFollow()}}):"function"==typeof this.model.follow?this.model.follow().then((function(){e.isFollowingUnfollowing=!1,f.default.refreshCurrentUserHashtags(),e.setButtonUnFollow(),u.default.publish("microtag","follow",{Name:e.model.get("Name"),Value:0,Weight:0})}),(function(){f.default.getHashtagIFollow(!1)})):this.model.save(null,{success:function(){e.isFollowingUnfollowing=!1,f.default.refreshCurrentUserHashtags(),e.setButtonUnFollow(),f.default.getHashtagIFollow(!1,t.addStoryHashTags).done((function(){u.default.publish("microtag","follow",{Name:e.model.get("Name"),Value:0,Weight:0})}))}}):this.model.save(null,{success:function(){e.isFollowingUnfollowing=!1,t.setButtonUnFollow(),t.model.set("CurrentUserFollowing",!0)}})},unFollow:function(){var t=this,e=this;e.show(),e.isFollowingUnfollowing=!0,this.isHashtag?this.isEditorialScope?this.model.destroy({success:function(){e.isFollowingUnfollowing=!1,f.default.refreshCurrentUserHashtags(),e.setButtonFollow()}}):"function"==typeof this.model.unFollow?this.model.unFollow().then((function(){e.isFollowingUnfollowing=!1,f.default.refreshCurrentUserHashtags(),e.setButtonFollow(),u.default.publish("microtag","unfollow".concat(e.model.get("Name").toLowerCase()),e.model.get("Name"))}),(function(){f.default.getHashtagIFollow(!1)})):this.model.destroy({success:function(){e.isFollowingUnfollowing=!1,f.default.refreshCurrentUserHashtags(),e.setButtonFollow(),f.default.getHashtagIFollow(!1,t.addStoryHashTags).done((function(){u.default.publish("microtag","unfollow".concat(e.model.get("Name").toLowerCase()),e.model.get("Name"))}))}}):this.model.destroy({success:function(){e.isFollowingUnfollowing=!1,e.setButtonFollow(),t.model.set("CurrentUserFollowing",!1)}})},showLatestActivity:function(){var t=beezyCurrentGroup&&beezyCurrentGroup.Type;"IdeasCampaign"===t||"StandAloneBlog"===t||"StandAloneForum"===t||"StandAloneWiki"===t||"CorporateSite"===t?u.default.publish("tagcloud","filter",this.model.get("Name")):u.default.publish("microtag","show-latest-activity",this.model),this.hide()}});function m(t,e,i,n){var s=i||{};return s.notTriangule=!0,s.offset={top:7,left:0},s.vAlign=d.default.DropVerticalPosition.TOP,s.zIndex=3,s.IsFollowing=n,new p(r.a.extend({model:t,showDelay:d.default.microtagDelay,elementBound:e,elementKeyboard:e,parent:o()(e.parentElement)},s||{}))}p.position={TOP:"top-left",RIGHT:"top-right",LEFT:"bottom-right",BOTTOM:"bottom-left"},p.create=function(t,e,i){if(!(void 0===i||void 0===i.isHashtag||i.isHashtag))return m(e,t,i,e.get("CurrentUserFollowing"));f.default.isCurrentUserFollower(e.get("Name")).then((function(n){return m(e,t,i,n)}))},e.default=p},51:function(t,e,i){"use strict";i.r(e),i.d(e,"convertDateToDotNet",(function(){return E})),i.d(e,"convertDateToDotNetUTC",(function(){return k})),i.d(e,"createDateUTC",(function(){return U})),i.d(e,"getASPDatetime",(function(){return j})),i.d(e,"getAbsoluteDateFromJSON",(function(){return T})),i.d(e,"getDateFromJSON",(function(){return x})),i.d(e,"getDateLastXMonths",(function(){return m})),i.d(e,"getDateLastXYears",(function(){return g})),i.d(e,"getDateStringFromJSON",(function(){return I})),i.d(e,"getDateWithFormatFromJSON",(function(){return A})),i.d(e,"getDiffDays",(function(){return M})),i.d(e,"getDiffDaysWithCurrentDateInUTC",(function(){return L})),i.d(e,"getFormatedDate",(function(){return C})),i.d(e,"getFormattedDate",(function(){return y})),i.d(e,"getMonthName",(function(){return v})),i.d(e,"getDateRoundedToInterval",(function(){return p})),i.d(e,"getStringLocalTimezone",(function(){return z})),i.d(e,"getTimeZoneOffset",(function(){return _})),i.d(e,"isCurrentTimeBetween",(function(){return N})),i.d(e,"isDateLessThan",(function(){return w})),i.d(e,"isSameOrBefore",(function(){return P})),i.d(e,"setOffsetUTC",(function(){return R})),i.d(e,"toUTC",(function(){return S})),i.d(e,"getUTCDatetime",(function(){return D}));var n=i(607),o=i(71),s=i(521),r=i(1867),a=i(2200),l=i(1486),c=i(1712),u=i(1487),d=i(2),h=i(189);i.d(e,"getLocalDateFromJSON",(function(){return h.getLocalDateFromJSON}));var f=["January","February","March","April","May","June","July","August","September","October","November","December"];function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(c.default)(t,{nearestTo:e})}function m(t){var e=new Date,i=new Date;return i.setMonth(e.getMonth()-t),i}function g(t){var e=new Date,i=new Date;return i.setFullYear(e.getFullYear()-t),i}function v(t){return Object(d.translate)(f[t])}var b="d MMMM yyyy",y=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b;return Object(o.default)(Object(s.default)(t)?t:I(t),e)};function C(t){var e=t.getFullYear().toString(),i=(t.getMonth()+1).toString(),n=t.getDate().toString();return"".concat(i[1]?i:"0".concat(i[0]),"/").concat(n[1]?n:"0".concat(n[0]),"/").concat(e)}function w(t,e,i){var n=i?S(t):new Date(t),o=i?S(e):new Date(e);return Object(r.default)(n,o)}function T(t){var e=Object(h.getLocalDateFromJSON)(t);return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())}function x(t){var e=Object(h.parseDotNetDate)(t);return new Date(Number(e[1]))}function O(t){var e=Object(s.default)(t)?t:I(t);return e?e.getTimezoneOffset():null}function S(t){var e=Object(s.default)(t)?t:I(t),i=e?e.getTimezoneOffset():null;return i?-1!==Math.sign(i)?Object(n.default)(e,i):Object(u.default)(e,Math.abs(i)):null}function I(t){return t?new Date(parseInt(t.replace(/\/Date\((\d+|\d+\+\d+|\d+\-\d+)\)\//gi,"$1"),10)):""}function A(t,e){return t?Object(o.default)(Object(h.getLocalDateFromJSON)(t),e):""}function k(t){var e=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return"/Date(".concat(e,"+0000)/")}function P(t,e){return Object(a.default)(t,e)||Object(r.default)(t,e)}function E(t){return"/Date(".concat(t.getTime(),"+0000)/")}function _(){return(new Date).getTimezoneOffset()/60}function j(t){var e=Object(o.default)(S(new Date(t)),"XX");return"/Date(".concat(t).concat(e,")/")}function D(t){var e=Object(h.getUserTimeZone)(),i=Object(h.getUTCDate)(t,e);return"/Date(".concat(i.getTime(),")/")}function U(t,e){var i=Object(h.parseDotNetDate)(t);return Object(h.getDateFromUTC)(Number(i[1]),e)}function M(t,e){return Math.round(Math.abs((t.getTime()-e.getTime())/864e5))}function L(t){return t?M(S(t),new Date):void 0}function N(t){return Object(l.default)(new Date,{start:I(t.DstStartDate),end:I(t.DstEndDate)})}function R(t){return t.HasTimezoneDst&&N(t)?t.TotalHours+1:t.TotalHours}function z(){var t=new Date;return O(t)/60==0?"":O(t)/60>=0?"+".concat(O(t)/60):O(t)/60}},511:function(t,e,i){"use strict";var n=i(2002);i.d(e,"getProfileBackgroundImage",(function(){return n.default}));var o=i(1431);i.d(e,"getProfileImage",(function(){return o.default}));var s=i(1430);i.d(e,"getSPThumbnail",(function(){return s.default}));i(2003)},52:function(t,e,i){"use strict";i.r(e);var n=i(19),o=i.n(n),s=i(5),r=i(18),a=i(3),l=i.n(a),c=i(26),u=i(10),d=i(2),h=i(17),f=i(49),p=i(7),m=i(8),g=p.default.Type,v=c.default.extend({defaults:function(){return{Message:"",Group:{GroupId:-1,Type:""},Attachments:[],CurrentUserMarkAsFavorite:!!(beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.CurrentUserMarkAsFavorite)&&beezyContext.CurrentActivity.CurrentUserMarkAsFavorite,Highlighted:!!(beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Highlighted)&&beezyContext.CurrentActivity.Highlighted}},initialize:function(t,e){e||(e={}),this._normalizeGroup(t),this._setType(e),this._extend(e),this._bindEvents(),this._parseMetadata(),e&&e.isRepost&&(this._parseAttachments(),this._parseRelatedItem())},_parseAttachments:function(){this.attributes.Group.isCurrentGroup||(this.attributes.Attachments=[])},_parseRelatedItem:function(){this.attributes.Group.isCurrentGroup||(this.attributes.RelatedItem=null)},_normalizeGroup:function(t){this.attributes.Type===g.POST&&t.Group&&!t.Group.GroupId&&(this.attributes.Group=null)},_extend:function(){this._type===g.DOCUMENT&&this.attributes.Activity&&(this.attributes.CurrentUserMarkAsFavorite=this.attributes.Activity.CurrentUserMarkAsFavorite)},_setType:function(t){var e=this.attributes;if(t.isAnswer)this._type=g.ANSWER;else{var i=e.Type||g.ACTIVITY_COMMENT;switch(i){case g.POST:e.Group&&e.Group.Type?(e.Group.GroupId||t.create)&&(this._type=e.Group.Type):this._type=g.POST;break;case p.default.Type.QUESTION:this._type=g.COMMUNITY_QUESTION;break;default:this._type=i}}},_parseMetadata:function(){var t=this,e=this.get("MetadataProperties");this._metadata={},this._metadataProperties=l.a.pluck(e,"Name"),l.a.each(e,(function(e){return t._metadata[e.Name]=e.Value}),this)},setMetadata:function(t){var e,i,n;e=this.has("MetadataProperties")?this.get("MetadataProperties").slice():[],"string"==typeof t&&2===arguments.length?t={Name:i=t,Value:n=arguments[1]}:(i=t.Name,n=t.Value);var o=l.a.indexOf(this._metadataProperties,i);o>-1?e[o].Value=n:(e.push(t),this._metadataProperties.push(i)),this.set({MetadataProperties:e},{silent:!0}),this._metadata[i]=n},setMetadataProperties:function(t,e){return u.default.postJSON("".concat(s.default.getApiUrlv2MSC(),"/Workflow/Task/").concat(t,"/Outcome"),{Outcome:e})},getMetadata:function(t){return this._metadata[t]},_bindEvents:function(){this.on("change:CurrentUserMarkAsFavorite",this.bookmark,this),this.has("Highlighted")&&this.on("change:Highlighted",this.highlight,this)},getServiceUrl:function(){if(this.isComment())return"/Comments";var t={};return t[g.CALENDAR]="/Events",t[g.DISCUSSION]="/Discussions",t[g.BLOG]="/BlogPosts",t[g.WIKI]="/WikiPages",t[g.TASK]="/Tasks",t[g.EXTENDEDIDEA]="/ExtendedIdeas",t[g.STORY]="/Stories",t[g.CORPORATEPAGE]="/CorporatePages",t[this._type]||"/Activities"},getDeleteServiceUrl:function(){var t={};return t[g.POLL]="/Polls/",t[g.CALENDAR]="/Events/",t[g.DISCUSSION]="/Discussions/",t[g.BLOG]="/BlogPosts/",t[g.WIKI]="/WikiPages/",t[g.TASK]="/Tasks/",t[g.EXTENDEDIDEA]="/ExtendedIdeas/",t[g.STORY]="/Stories/",t[g.CORPORATEPAGE]="/CorporatePages/",t[g.DOCUMENT]="/Files/",t[g.COMMUNITY_QUESTION]="/QuestionsActivity/",t[g.IDEA]="/Ideas/",t[this._type]},getHideAttachmentUrl:function(){var t={};return t[g.POLL]="/Polls/",t[g.CALENDAR]="/Events/",t[g.DISCUSSION]="/Discussions/",t[g.BLOG]="/BlogPosts/",t[g.WIKI]="/WikiPages/",t[g.TASK]="/Tasks/",t[g.EXTENDEDIDEA]="/ExtendedIdeas/",t[g.STORY]="/Stories/",t[g.CORPORATEPAGE]="/CorporatePages/",t[g.DOCUMENT]="/Files/",t[g.COMMUNITY_QUESTION]="/QuestionsActivity/",t[g.IDEA]="/Ideas/",t[this._type]||"/Activities/"},url:function(){var t=this.getServiceUrl();return s.default.getApiUrlv2MSC()+t.replace(":id",this.get("id"))},urlRoot:function(){var t=this.getDeleteServiceUrl();if(this.isDeleteOp&&t){t+=this.get("Id");var e=this.get("Translation");e&&e.Id>0&&(t+="/Translations/".concat(e.Id))}else t=this.getServiceUrl();return s.default.getApiUrlv2MSC()+t},sync:function(t,e,i){return"update"!==t&&"delete"!==t||(this.isDeleteOp="delete"===t,l.a.extend(i,{url:"function"==typeof this.urlRoot?this.urlRoot():this.urlRoot})),v.__super__.sync.call(this,t,e,i)},validateAndDestroy:function(t,e,i,n){var o;if(n||window.confirm(e))try{o=t.attachmentId?t.visibility?this.hideAttachment(t.attachmentId,JSON.parse(t.data).Id):this.destroyAttachment(t.attachmentId,JSON.parse(t.data).Id):this.destroy(t),i&&"function"==typeof i&&(o?o.then((function(){return i()})):i())}catch(t){console.error("Unexpected error deleting the activity: ".concat(t))}},destroyWithoutValidation:function(t,e,i){var n=this;i.removeClass("js-confirm button-confirm__alert-enabled");try{t.attachmentId?this.destroyAttachment(t.attachmentId,JSON.parse(t.data).Id).success((function(){n.trigger("attachmentDestroyed")})):this.destroy(l.a.extend(t,{success:function(){""!==e?r.default.redirectToUrl(e):n.trigger("removed")},error:function(t,e){var n=t.get("Type")===p.default.Type.WIKI?e.statusText:"An error occurred deleting the activity";i.addClass("js-confirm button-confirm__alert-enabled"),alert(Object(d.translate)(n))},wait:!0}))}catch(t){console.error("Unexpected error deleting the activity: ".concat(t))}},isActive:function(){return m.default.getCurrentGroup()?!m.default.isGroupDisabled():!this.get("Group")||(this.get("Group").IsModerated?m.default.isGroupMember()&&beezyCurrentGroup.IsActive:this.get("Group").IsActive)},commentsCount:function(){return this.get("TotalOfComments")},isCommunity:function(){return this._type===g.COMMUNITY},isCalendar:function(){return this._type===g.CALENDAR},isTask:function(){return this._type===g.TASK},isDiscussion:function(){return this._type===g.DISCUSSION},isItem:function(){return this._type===g.ITEM},isDocument:function(){return this._type===g.DOCUMENT},isQuestion:function(){return this._type===g.QUESTION},isAnswer:function(){return this._type===g.ANSWER},isColleague:function(){return this._type===g.COLLEAGUES},isCommunityQuestion:function(){return this._type===g.COMMUNITY_QUESTION},isAnnouncement:function(){return this._type===g.ANNOUNCEMENT},isStickyAnnouncement:function(){return this._type===g.STICKYANNOUNCEMENT},isComment:function(){return this._type===g.ACTIVITY_COMMENT||this.isAnswer()||this.isCommunityAnswer()},isCommunityAnswer:function(){return this._type===g.ACTIVITY_ANSWER},isPost:function(){return this._type===g.POST},like:function(){return this.isComment()?u.default.postJSON("".concat(this.url(),"/Like"),{ParentId:this.id}):u.default.postJSON("".concat(s.default.getApiUrlv2MSC(),"/Activities/Like"),{ParentId:this.id})},unlike:function(){return this.isComment()?u.default.get("".concat(this.url(),"/").concat(this.id,"/Unlike")):u.default.get("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.id,"/Unlike"))},markAsBestAnswer:function(){if(this.isComment())return u.default.postJSON("".concat(this.url(),"/").concat(this.id,"/BestAnswer"))},unmarkAsBestAnswer:function(){if(this.isComment())return u.default.del("".concat(this.url(),"/").concat(this.id,"/BestAnswer"))},pinComment:function(){if(this.isComment())return u.default.postJSON("".concat(this.url(),"/").concat(this.id,"/PinComment"))},unpinComment:function(){if(this.isComment())return u.default.del("".concat(this.url(),"/").concat(this.id,"/PinComment"))},getlikes:function(){return this.isComment()?u.default.get("".concat(this.url(),"/").concat(this.id,"/Likes?skip=0&take=").concat(this.get("TotalOfLikes"))):u.default.get("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.id,"/Likes?skip=0&take=").concat(this.get("TotalOfLikes")))},getLikePropertyName:function(){var t=this.has("CurrentUserLikedComment")?"CurrentUserLikedComment":"CurrentUserLikedActivity";return this.getLikePropertyName=function(){return t},t},isLiked:function(){return this.get(this.getLikePropertyName())},toggleLike:function(){var t=!this.isLiked(),e=this.get("TotalOfLikes");this[t?"like":"unlike"](),this.set(this.getLikePropertyName(),t),this.set("TotalOfLikes",t?e+1:e-1)},bookmark:function(){if(this.hasChanged("CurrentUserMarkAsFavorite")){var t=this.changed.CurrentUserMarkAsFavorite?"Follow":"Unfollow";return this.isComment()?u.default.get("".concat(this.url(),"/").concat(this.get("Id"),"/").concat(t)):this._type===g.DOCUMENT?u.default.get("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.get("Activity").Id,"/").concat(t)):u.default.get("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.get("Id"),"/").concat(t))}},hideFromNews:function(){return u.default.del("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.id,"/Visibility"))},highlight:function(){if(this.hasChanged("Highlighted")){var t,e,i=this.changed.Highlighted?"Highlight":"Unhighlight";if("document"===this.get("Type")&&("files"!==beezyContext.CurrentPageKey?(t=this.get("Id"),e=this.get("Attachments")[0].Id):(t=this.get("Activity").Id,e=this.get("Id"))),"Highlight"===i)return"document"===this.get("Type")?u.default.post("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(t,"/Attachments/").concat(e,"/Highlighted")):u.default.post("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.id,"/Highlighted"));if("Unhighlight"===i)return"document"===this.get("Type")?u.default.del("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(t,"/Attachments/").concat(e,"/Highlighted")):u.default.del("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(this.id,"/Highlighted"))}},getOwner:function(){return h.default.saveUser(this.get("Owner"))},repost:function(t){var e=l.a.pick(this.attributes,"MetadataProperties","Type","RelatedItem","Title","Attachments");if(e.MetadataProperties.length&&(e.MetadataProperties=l.a.reject(e.MetadataProperties,(function(t){return"bestAnswer"===t.Name}))),e.Message=f.default.compactNewLines(this.attributes.Message),e.Group={GroupId:t,Type:this.attributes._type,Url:this.attributes.Group.Url,isCurrentGroup:t===this.attributes.Group.GroupId},this._type===g.POLL){if(!this.attributes.Comments||!this.attributes.Comments.length){var i=this,n=o.a.defer();return this.fetch({url:"".concat(this.url(),"/").concat(this.id)}).then((function(){e.Comments=l.a.chain(i.attributes.Comments).pluck("Message").map((function(t){return{Message:t}})).value(),new v(e).save({}).then((function(t){n.resolve(t)}))})),n.promise}e.Comments=l.a.chain(this.attributes.Comments).pluck("Message").map((function(t){return{Message:t}})).value()}return new v(e,{isRepost:!0}).save({})},getNumberTags:function(){return beezyCurrentGroup&&"KnowledgeCenter"===beezyCurrentGroup.Type?this.has("Terms")?this.get("Terms").length:0:this.has("parentActivity")&&this.get("parentActivity").Hashtags?this.get("parentActivity").Hashtags.length:this.get("Hashtags")?this.get("Hashtags").length:this.get("TotalOfTags")?this.get("TotalOfTags"):0},getTags:function(){return beezyCurrentGroup&&"KnowledgeCenter"===beezyCurrentGroup.Type?this.has("Terms")?this.get("Terms"):[]:this.has("Hashtags")?this.get("Hashtags"):[]},destroyAttachment:function(t,e){return u.default.del("".concat(s.default.getApiUrlv2MSC(),"/Activities/").concat(e||this.get("Activity").Id,"/Attachments/").concat(t))},hideAttachment:function(t,e){return u.default.del("".concat(s.default.getApiUrlv2MSC()).concat(this.getHideAttachmentUrl()).concat(e||this.get("Activity").Id,"/Attachments/").concat(t,"/Visibility"))}}),b=v.extend({_setType:function(){this.attributes.Type===g.ANNOUNCEMENT?this._type=g.ANNOUNCEMENT:this._type=g.QUESTION}}),y=v.extend({_setType:function(){this._type=g.ANSWER}}),C=v.extend({_setType:function(){this._type=g.ACTIVITY_ANSWER}}),w=v.extend({_setType:function(){this._type=g.SHARE},initialize:function(t){this.SharedActivityId=t.SharedActivityId||0,w.__super__.initialize.call(this,t)},url:function(){return"".concat(s.default.getApiUrlv2()).concat(this.getServiceUrl(),"/").concat(this.SharedActivityId,"/Share")}}),T=v.extend({_setType:function(){this._type=g.SHARE_APP},initialize:function(t){this.SharedActivityId=t.SharedActivityId||0,w.__super__.initialize.call(this,t)},url:function(){return"".concat(s.default.getApiUrlv2()).concat(this.getServiceUrl(),"/").concat(this.SharedActivityId,"/Share")}}),x={},O=v.extend({initialize:function(t){this.forceGenericService=t.forceGenericService||!1,O.__super__.initialize.call(this,t)},url:function(){return"".concat(s.default.getApiUrlv2()+(this.forceGenericService?"/Activities":this.getServiceUrl()),"/").concat(this.get("Id"))}});e.default={Activity:v,Question:b,Answer:y,CommunityAnswer:C,ActivityRepository:function(t){var e=t.Id,i=x["id_"+e];return i?i.attributes=t:x["id_"+e]=i=new v(t),i},SingleActivity:O,Share:w,ShareApp:T}},523:function(t,e,i){"use strict";i.r(e);var n={isBlockedExtension:function(t){var e=beezySettings.BlockedFileExtensions.join("|");return new RegExp("\\.(".concat(e,")$"),"i").test(t)},canBePreviewed:function(t){return null!==t.match(/\.(docx?|docm|dotx|dotm|xlsx?|xlsb|xlsm|pptx?|pptm|ppsx?|ppsm|potm|ppam|potx|pdf)$/i)},canBeEdited:function(t){return null!==t.match(/\.(docx?|xlsx?|xlsb|pptx?|ppsx?|one)$/i)},isFile:function(t){return/\.[a-zA-Z0-9]{1,5}$/.test(t)},getFileExtension:function(t){return t.match(/\.([\w]{2,})(\?|$)/i)},isImageExtension:function(t){var e=n.getFileExtension(t);return e&&e.length&&e[0].search(/\.(png|jpeg|gif|jpg)$/i)>-1}};e.default=n},527:function(t,e,i){"use strict";e.default={isAppsCloud:function(t){return/sharepoint.(com|us)/i.test(t)}}},53:function(t,e,i){"use strict";var n=i(1449);i.d(e,"HtmlHelper",(function(){return n.default}));i(2202),i(2119);var o=i(2085);i.d(e,"cutText",(function(){return o.default}));var s=i(2203);i.d(e,"encodeQuotes",(function(){return s.default}));i(2204);var r=i(2205);i.d(e,"escapeRegExpSnippets",(function(){return r.default}));var a=i(2206);i.d(e,"getLinksFromText",(function(){return a.default}));var l=i(2207);i.d(e,"isRelativeUrl",(function(){return l.default}));var c=i(2208);i.d(e,"isValidUrl",(function(){return c.default}));var u=i(2209);i.d(e,"sortByLengthDesc",(function(){return u.default}));var d=i(665);i.d(e,"sprintf",(function(){return d.default}));var h=i(2210);i.d(e,"trimCharacter",(function(){return h.default}))},54:function(t,e,i){"use strict";i.r(e),i.d(e,"AllTags",(function(){return h})),i.d(e,"BlogTags",(function(){return f})),i.d(e,"WikiTags",(function(){return g})),i.d(e,"FilesTags",(function(){return v})),i.d(e,"FileDetailTags",(function(){return b})),i.d(e,"QuestionsTags",(function(){return p})),i.d(e,"IdeasTags",(function(){return m})),i.d(e,"PollTags",(function(){return y})),i.d(e,"PollDetailTags",(function(){return C})),i.d(e,"LinkTags",(function(){return w})),i.d(e,"StoryTags",(function(){return S})),i.d(e,"CalendarTags",(function(){return T})),i.d(e,"CalendarDetailTags",(function(){return x})),i.d(e,"TasksTags",(function(){return O})),i.d(e,"ForumTags",(function(){return P})),i.d(e,"TaskDetailTags",(function(){return E})),i.d(e,"Blogs",(function(){return _})),i.d(e,"Forums",(function(){return j})),i.d(e,"Wikis",(function(){return D})),i.d(e,"Ideas",(function(){return U})),i.d(e,"Questions",(function(){return M})),i.d(e,"Links",(function(){return L})),i.d(e,"People",(function(){return N})),i.d(e,"CommunitiesCollection",(function(){return R})),i.d(e,"IdeasCampaignTags",(function(){return z})),i.d(e,"StoryHashtagsCollection",(function(){return I})),i.d(e,"CorporatePageHashtagsCollection",(function(){return A})),i.d(e,"TopicHashtagsCollection",(function(){return k}));var n=i(5),o=i(79),s=i(3),r=i.n(s),a=i(27),l=i.n(a),c=i(305),u=i(8),d=i(269),h=l.a.Collection.extend({model:c.default.Tag,initialize:function(t,e){e=e||{},this.skip=e.skip||0,this.take=e.take||30,this.minimum=e.minimum||0,this.maximum=e.maximum||30},url:function(){var t=d.default.getWebpartProperties("tagcloud","HashtagQueryUrl")?d.default.getWebpartProperties("tagcloud","HashtagQueryUrl"):"/Hashtags";return beezyCurrentGroup?u.default.getGroupServiceV2Url()+t:n.default.getApiUrlv2()+t},fetch:function(t){return t=r.a.extend({data:{skip:this.skip,take:this.take,minimum:this.minimum,maximum:this.maximum}},t),h.__super__.fetch.call(this,t)},comparator:function(t){return t.get("Value")},getSearchAdapterUrl:function(){return"Communities/".concat(u.default.getGroupId(),"/Hashtags")}}),f=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/BlogPosts/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),f.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),p=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Questions/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),p.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),m=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Ideas/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),m.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),g=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/WikiPages/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),g.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),v=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30,this.type=t.type||"document"},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Files/HashTags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum,type:this.type}},t),v.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),b=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||10,this.activityId=t.activityId},url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId)},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),b.__super__.fetch.call(this,t)},parse:function(t){return t.Hashtags},getSearchAdapterUrl:function(){return"Hashtags"}}),y=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30,this.type=t.type||"poll"},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Polls/HashTags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum,type:this.type}},t),y.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),C=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||10,this.activityId=t.activityId},url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId)},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),C.__super__.fetch.call(this,t)},parse:function(t){return t.Hashtags},getSearchAdapterUrl:function(){return"Hashtags"}}),w=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30,this.type=t.type||"link"},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Links/HashTags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum,type:this.type}},t),w.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),T=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30,this.type=t.type||"events"},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Events/HashTags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum,type:this.type}},t),T.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),x=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||10,this.activityId=t.activityId},url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId)},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),x.__super__.fetch.call(this,t)},parse:function(t){return t.Hashtags},getSearchAdapterUrl:function(){return"Hashtags"}}),O=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30,this.type=t.type||"link"},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Tasks/HashTags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum,type:this.type}},t),O.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),S=h.extend({model:c.default.StoryTag,initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"Hashtags"},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),S.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),I=o.default.extend({model:c.default.CurrentStoriesTags,initialize:function(){this.itemsPerPage=20},comparator:function(t){return t.get("Value")},url:function(){return"".concat(n.default.getApiUrlv2(),"/Editorials/").concat(this.groupId||u.default.getGroupId(),"/Stories/Hashtags/Search")}}),A=h.extend({model:c.default.CorporateTag,initialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.skip=e.skip||0,this.take=e.take||30,this.moduleId=e.moduleId,this.userId=e.userId},fetch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.a.extend({skip:this.skip,take:this.take,userId:this.userId},t);return t.data=e,A.__super__.fetch.call(this,t)},url:function(){return"".concat(n.default.getApiUrlv2(),"/CorporateModules/").concat(this.moduleId,"/CorporatePages/Hashtags")},getSearchAdapterUrl:function(){return"Hashtags"}}),k=h.extend({model:c.default.TopicTag,initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.skip=t.skip||0,this.take=t.take||50,this.topicId=t.topicId},fetch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.a.extend({skip:this.skip,take:this.take},t);return t.data=e,k.__super__.fetch.call(this,t)},url:function(){return"".concat(n.default.getApiUrlv2(),"/CorporateModules/").concat(u.default.getGroupId(),"/Topics/").concat(this.topicId,"/Hashtags")}}),P=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Discussions/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),O.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Hashtags"}}),E=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||10,this.activityId=t.activityId},url:function(){return"".concat(n.default.getApiUrlv2MSC(),"/Activities/").concat(this.activityId)},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),E.__super__.fetch.call(this,t)},parse:function(t){return t.Hashtags},getSearchAdapterUrl:function(){return"Hashtags"}}),_=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(n.default.getApiUrlv2(),"/BlogPosts/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),_.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"BlogPosts/Hashtags"}}),j=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(n.default.getApiUrlv2(),"/Discussions/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),j.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Forums/Hashtags"}}),D=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(n.default.getApiUrlv2(),"/WikiPages/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),D.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Wikis/Hashtags"}}),U=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(n.default.getApiUrlv2(),"/Ideas/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),U.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Ideas/Hashtags"}}),M=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(n.default.getApiUrlv2(),"/Questions/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),M.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Questions/Hashtags"}}),L=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||30},url:function(){return"".concat(n.default.getApiUrlv2(),"/Links/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),L.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Links/Hashtags"}}),N=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||10},url:function(){return"".concat(n.default.getApiUrlv2(),"/Users/Skills")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),N.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Users/Skills"}}),R=h.extend({url:function(){return"".concat(n.default.getApiUrlv2(),"/Communities/Tags")},fetch:function(t){return R.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Communities/Tags"}}),z=h.extend({initialize:function(t){t=t||{},this.minimum=t.minimum||0,this.maximum=t.maximum||10},url:function(){return"".concat(u.default.getCommunityServiceV2Url(),"/Impact/Hashtags")},fetch:function(t){return t=r.a.extend({data:{minimum:this.minimum,maximum:this.maximum}},t),z.__super__.fetch.call(this,t)},getSearchAdapterUrl:function(){return"Communities/".concat(u.default.getGroupId(),"/Impact/Hashtags")}})},55:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(5),r=i(15),a=i(39),l=i(268),c=i(18),u=i(4),d=i.n(u),h=i(3),f=i.n(h),p=i(13),m=i(2),g=i(89),v=i(653),b=i(117),y=i(54),C=i(305),w=i(19),T=i.n(w),x=i(49),O=i(2425),S=i.n(O),I=i(374),A=i.n(I),k=i(12),P=i(8),E=i(269),_=i(33),j=i(17),D=i(1491),U=i.n(D),M=i(7),L=C.default.Tag,N="View",R="Edit",z=p.default.extend({template:S.a,adapter:{name:"Name",ocurrences:"Value"},events:{"click .js-add-btn":"_addHashtag","click .js-edit":"edit"},classNames:["is-medium","is-big","is-large"],initialize:function(t){var e,i=this,n=this;this.options=t||{},this.render=f.a.bind(this.render,this),this.collection=t.collection||new y.AllTags,this.template=t.template||this.template,this.usingContext=t.usingContext||!1,this.isEditable=t.isEditable||t.editable&&P.default.isGroupMember()||!1,this.editable=t.editable,this.canAdd=f.a.has(t,"canAdd")?t.canAdd:this.isEditable,this.refreshPage=t.refreshPage||!1,this.showValue=t.showValue||!1,this.isCommunities=t.isCommunities||!1,this.isPeople=t.isPeople||!1,this.isAggregate=t.isAggregate||!1,this.vertical=t.vertical||!1,this.classes=t.classes||this.classes,this.Title=t.Title,this.searchAdapter=t.searchAdapter||"",this.adapterOptions=t.adapterOptions||{},this.showPopup=void 0===t.showPopup||t.showPopup,this.isClickable=void 0===t.isClickable||t.isClickable,this.isSortable=void 0===t.isSortable||t.isSortable,this.placeholder=t.placeholder||Object(m.translate)("AddTag"),this.showEdit="boolean"==typeof t.showEdit?t.showEdit:this.editable&&r.default.canEdit(),this.hasAddButton=void 0===t.hasAddButton||t.hasAddButton,this.autcompleteField=t.autcompleteField||"Name",this.allowNewItems=void 0===t.allowNewItems||t.allowNewItems,this.emptyStateTemplate=U.a,this.model=t.model||L,this.deferred=T.a.defer(),this.mode=this.isEditable?R:N,this.filterFeedOrderBy=t.filterFeedOrderBy||"",this.showSearchHashtagInput=null===(e=t.showSearchHashtagInput)||void 0===e||e,j.default.isToolsPage()&&(this.collection.maximum=30),this.usingContext?(this.activityId=beezyContext.CurrentActivity.Id,this.extendValues=!0,this.prerender()):(this.activityId=this.collection.activityId,this.options.cacheable&&a.default.indexOfItem(this.options.cacheable.name,this.options.cacheable.sessionName)>-1?(this.collection.add(a.default.getItem(this.options.cacheable.name,this.options.cacheable.sessionName)),this.render(),this.searchHashtags(),l.default.delayCallback((function(){i.collection.fetch().then((function(t){a.default.clearItem(n.options.cacheable.name,n.options.cacheable.sessionName),a.default.setItem(n.options.cacheable.name,t,n.options.cacheable.sessionName)}))}),M.default.cacheRefreshDelay)):this.collection.fetch().done((function(t){n.options.cacheable&&a.default.setItem(n.options.cacheable.name,t,n.options.cacheable.sessionName),n.render(),n.searchHashtags()})))},getPromise:function(){return this.deferred.promise},resolveDeferred:function(t){this.deferred.resolve(t)},prerender:function(){this.collection.reset(),this.collection.add(beezyContext.CurrentActivity.Hashtags)},refresh:function(){var t=this;this.collection.fetch().done((function(){t.render()}))},render:function(){if(this.$el.html(""),this.editable||this.collection.length>0){this.isSortable&&(this.collection.sort(),this.collection.models=this.collection.models.reverse()),this.context={Tags:this.collection.models,Title:this.Title||Object(m.translate)("Tags")||Object(m.translate)("Trending Topics"),EditMode:this.mode===R,canAdd:this.canAdd,editable:this.editable,showEdit:this.showEdit,hasEmptyState:this.options.hasEmptyState&&!this.collection.length},this.$el.addClass(this.classes).html(this.template(this.context));var t=this.prop(this.adapter.ocurrences),e=f.a.filter(this.context.Tags,t);if(this.thresholdDistribution(f.a.map(e,t)),!this.vertical&&this.isSortable){var i=f.a.sortBy(this.context.Tags,(function(t){return t.attributes.Name.toLowerCase()}));f.a.each(i,this.renderItem,this)}else f.a.each(this.context.Tags,this.renderItem,this);if(this.context.hasEmptyState&&this.$el.find(".js-hasEmptyState").html(this.emptyStateTemplate({icon:this.options.emptyStateParameters.icon,notFoundText:this.options.emptyStateParameters.notFoundText,addText:this.options.emptyStateParameters.addText})),this.mode===R){var n=this.$(".js-add-hashtag-input");n.append('<div class="js-add-hashtag"></div>'),this._createAutocompleteComponent(n,".js-add-hashtag-input"),this.addHashtags(),this.canAdd&&this.$el.addClass("is-editing"),this.listenTo(this.collection,"add",this.addedHashtag)}else{var o=d()(".js-add-hashtag-input").find(".js-add-hashtag").get(0);this.tagsPlaceholder=o?Object(m.translate)("Add tags"):Object(m.translate)("Search tags"),this.showSearchHashtagInput&&this._createAutocompleteComponent(o,".js-search-hashtag-input")}this.$("#older-activity-loading").hide(),this.trigger("loaded",this.collection.models.length)}return this.resolveDeferred({type:"TAGS",numData:this.collection.models.length}),this},_createAutocompleteComponent:function(t,e){this.ht=new g.default(t,{el:this.$(e),inputTitle:this.tagsPlaceholder,template:A.a,classes:this.autocompleteClasses,adapterOptions:this.adapterOptions,valueSelector:this.autcompleteField,itemsWindowSize:5,allowNewItems:this.allowNewItems,dependent:this.options.dependent,insideOtherDrop:this.options.insideOtherDrop})},renderItem:function(t){this.renderItemExtend(t)},renderItemExtend:function(t){var e=t.toJSON().Value?this.classNames[this.weight(t.toJSON().Value)]:"",i=new v.default({model:t,classNames:e,editable:this.isEditable,canRemove:this.canAdd,isClickable:this.isClickable,showValue:this.showValue,activityId:this.activityId,isCommunities:this.isCommunities,isAggregate:this.isAggregate,showPopup:this.showPopup});i.on("deleted",this.deleteTagCollection,this),i.on("filter",this.filter,this),this.$(".c-tag-list").append(i.render().$el),this.vertical&&this.$(".c-tag-list").addClass("c-tag-list--vertical")},deleteTagCollection:function(t){this.collection.remove(t),this.trigger("removed",t,this.collection.length),this.setEmptyState()},prop:function(t){return function(e){return e.toJSON()[t]}},thresholdDistribution:function(t){var e=Math.max.apply(Math,o()(t)),i=Math.min.apply(Math,o()(t)),n=(e-i)/this.classNames.length;this.threshold=f.a.map(this.classNames,(function(t,e){return i+(e+1)*n}))},weight:function(t){for(var e=this.threshold,i=0,n=e.length;i<n;i++)if(t<=e[i])return i;return 0},getProperties:function(){var t=E.default.getWebpartProperties("tagcloud","HashtagQueryUrlRelativeToGroup"),e=E.default.getWebpartProperties("tagcloud","HashtagQueryUrl");return{minimum:E.default.getWebpartProperties("tagcloud","Minimum"),maximum:E.default.getWebpartProperties("tagcloud","Maximum"),url:t?P.default.getGroupServiceV2Url()+e:s.default.getApiUrlv2()+e,tagUrl:E.default.getWebpartProperties("tagcloud","HashtagPageUrl"),viewMoreUrl:E.default.getWebpartProperties("tagcloud","ViewMoreUrl"),viewMoreTitle:""!==E.default.getWebpartProperties("tagcloud","ViewMoreTitle")?Object(m.translate)(E.default.getWebpartProperties("tagcloud","ViewMoreTitle")):void 0,title:Object(m.translate)(E.default.getWebpartTitles("tagcloud"))}},addHashtags:function(){var t=this;this.ht.searchAdapter=_.default.searchAdapter(this.collection.getSearchAdapterUrl()),this.ht.on("selectitem",(function(t,e){this.addHashtag(t,e),this.ht.reset()}),this),this.$placeholder=b.default.create(this.$("input").addClass("full-width")),this.$placeholder.setPlaceholder(this.placeholder),this.hasAddButton&&this.$el.find(".js-trendingtopics-autocomplete").append('<button class="btn btn--primary js-add-btn" style="margin-top: 10px;display:none;">'.concat(Object(m.translate)("Add"),"</button>")),this.$(".js-add-hashtag-input :input").keydown((function(e){""!==e.currentTarget.value?t.$(".js-add-btn").show():t.$(".js-add-btn").hide()})),this.$el.find(".js-add-hashtag-input :input").focusin((function(){if(r.default.isReadOnly())return j.default.showReadOnlyModal()}))},searchHashtags:function(){if(void 0!==this.ht){this.ht.searchAdapter=this.searchAdapter,this.ht.on("selectitem",(function(t){this.filter(t),this.ht.reset()}),this),this.$placeholder=b.default.create(this.$("input").addClass("full-width")),this.$(".js-search-hashtag-input").append('<span class="icon icon--mag-glass-fill"></span>');var t=this.isPeople?Object(m.translate)("Search skills"):this.tagsPlaceholder;this.$placeholder.setPlaceholder(t),this.trigger("TagComplete",this)}},setSearchAdapterOptions:function(t){this.adapterOptions=t.adapterOptions,this.ht&&this.ht.setAdapterOptions(t)},filter:function(t){this.refreshPage?c.default.redirectToUrl(E.default.getWebpartProperties("tagcloud","HashtagPageUrl")+encodeURIComponent(t)):k.default.publish("tagcloud","filter",x.default.escapeQuotes(t),null,null,this.filterFeedOrderBy)},addHashtag:function(t){new this.model({IdActivity:this.activityId},{create:!0}).save({Name:t},{success:f.a.bind(this._onSuccess,this),error:this._onError}),this.$el.find(".js-add-hashtag-input :input").val("")},_onSuccess:function(t){var e=(t=t.toJSON()).Hashtags[t.Hashtags.length-1];this.collection.findWhere({Id:e.Id})||this.collection.add(new this.model({Id:e.Id,Name:e.Name})),this.$(".js-add-btn").hide()},_onError:function(){},_addHashtag:function(){if(r.default.isReadOnly())return j.default.showReadOnlyModal();var t=this.$("input").val();this.$("input").val(""),this.addHashtag(t)},addedHashtag:function(){this.setEmptyState();var t=this.collection.at(this.collection.length-1);this.renderItem(t),this.trigger("added",this.collection.length,t)},setEmptyState:function(){this.options.hasEmptyState&&this.collection.length?this.$el.find(".js-hasEmptyState").hide():this.$el.find(".js-hasEmptyState").show()},edit:function(t){if(t.preventDefault(),r.default.isReadOnly())return j.default.showReadOnlyModal();this.trigger("edit")}});e.default=z},557:function(t,e,i){"use strict";i.d(e,"getAbsoluteDateFromJSON",(function(){return a}));var n=i(9),o=i(1482),s=i(1481),r=i(1484),a=function(t){var e=Object(r.default)(t);return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())};e.default=function(t,e){var i=e||Object(n.getTranslation)("%d %m %y"),r=t?new Date(t):new Date,a=Object(s.default)().map((function(t){return Object(n.getTranslation)(t.concat("_abbr"))}));return Object(o.default)(i,r,a)}},56:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(10),r=i(12),a=i(1104),l=i(7),c=i(5),u=i(30),d=i(2),h={notificationInterval:6e4,Reasons:{Apps:"appresponsibleadded",GroupInvite:"groupinvite",LeaveCommunity:"leavecommunity",RelatedCommunities:"relatedcommunity",Comment:"comment",Answer:"answer",Like:"like",LikeInComment:"likecomment",VoteUp:"voteup",Mention:"mention",Bookmark:"bookmark",MarkBestAnswer:"markbestanswer",VotePoll:"votepoll",Praise:"praise",Champion:"champion",SkillAdded:"skilladded",ContactAuthorAdded:"contactauthoradded",CorporatepageApprovalRequest:"corporatepageapprovalrequest",CorporatepageApprovalRequestReminder:"corporatepageapprovalrequestreminder",CorporatepageApprove:"corporatepageapprove",CorporatepageEditorAdded:"corporatepageeditoradded",CorporatepageGuestWriterAdded:"corporatepageguestwriteradded",CorporatepageReject:"corporatepagereject",CorporatepageWriterAdded:"corporatepagewriteradded",DeclineInvitation:"declineinvitation",ExtendedIdeaGraduated:"extendedideagraduated",FollowingUser:"followinguser",GroupCreated:"groupcreated",GuestAuthorAdded:"guestauthoradded",HeadOwnerAdded:"headowneradded",MemberAdded:"memberadded",OwnerAdded:"owneradded",SharedActivity:"sharedactivity",StoryApprovalRequest:"storyapprovalrequest",StoryApprovalRequestReminder:"storyapprovalrequestreminder",StoryApprove:"storyapprove",StoryEditorAdded:"storyeditoradded",StoryReject:"storyreject",StoryWriterAdded:"storywriteradded",UpcomingImpactMember:"upcomingimpactmember",UpcomingImpactOwner:"upcomingimpactowner"},getReason:function(t){return this.Reasons[t]},askForPeopleNotificationCount:function(){return-1!==l.default.PageKeysForNotificationsConfig.people.indexOf(beezyContext.CurrentPageKey)||Object(u.isSharepointModern)()},askForHashtagsNotificationCount:function(){return-1!==l.default.PageKeysForNotificationsConfig.hashtags.indexOf(beezyContext.CurrentPageKey)||Object(u.isSharepointModern)()},getNotifications:function(t,e,i){var n=this,o=c.default.getApiUrlv2(),l="".concat(o,"/Notifications/Aggregated/Count?notifications=true&people=").concat(e,"&hashtags=").concat(i);s.default.get(l,{cache:t}).then((function(t){n.updateNotificationsCounter(t.Notifications),t&&(window.beezyContext.notificationsCount=t,r.default.publish("notifications","more",t))}),(function(t){a.default.log("Failed to get notifications count. ",t.responseText)}))},updateNotificationsCounter:function(t){var e,i,n,s=o()("#notificationscounter"),r=s.parent().parent();r.attr("aria-label",""),t?(e="show",i="remove",n="add"):(e="hide",i="add",n="remove"),s.html(t),s[e](),r["".concat(i,"Class")]("sprite-toolbar-no-notification"),r["".concat(n,"Class")]("sprite-toolbar-notification-active"),t>0&&r.attr("aria-label",Object(d.sprintf)(Object(d.translate)("Notifications, %d unread"),t))},getSharedActivityNotificationReasonText:function(t){return l.default.ActivityShareNotificationLabels[t]||"sharedactivity"}};e.default=h},567:function(t,e,i){"use strict";var n=i(114),o=i.n(n),s=i(41),r=i.n(s),a=i(85),l=i.n(a),c=i(1),u=i.n(c),d=i(0),h=i.n(d),f=i(32),p=i(144),m=i(9),g=i(317),v=i(1181);function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){r()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var C={icon:"",button:"",popLayerSpan:"",popoverSpan:"",popoverSpanOpen:"",popLayerContent:""},w=Object(c.forwardRef)((function(t,e){var i=t.extraClasses,n=t.children,s=t.hasTip,r=t.isPopoverOpen,a=t.handlePopover,d=t.align,h=t.verticalAlign,b=t.shouldPosition,w=t.buttonProps,T=t.buttonRef,x=l()(t,["extraClasses","children","hasTip","isPopoverOpen","handlePopover","align","verticalAlign","shouldPosition","buttonProps","buttonRef"]),O=Object(c.useRef)(),S=Object(c.useRef)(),I=Object(p.useCombinedRefs)(e,S),A=Object(p.useCombinedRefs)(T,O);Object(c.useEffect)((function(){var t=function(t){var e=S.current,i=O.current;r&&e&&!e.contains(t.target)&&!i.contains(t.target)&&a()};return document.addEventListener("click",t),function(){document.removeEventListener("click",t)}}),[r,a]);var k=y(y({},C),i);return u.a.createElement("div",{className:"".concat(v.default.container," ").concat(k.popLayerSpan," ").concat(k.popoverSpan," ").concat(r?"".concat(v.default["is-open"]," ").concat(k.popoverSpanOpen):"")},u.a.createElement("button",o()({ref:A,className:"".concat(v.default.button," ").concat(k.button),type:"button",onClick:function(t){t.preventDefault(),a(t)},"aria-pressed":!!r,"aria-expanded":!!r,"aria-label":Object(m.getTranslation)("More options")},w),u.a.createElement(f.I,{extraClasses:{icon:"".concat(v.default["tools__icon--more"]," ").concat(k.icon)},typeIcon:"MoreOptions"})),u.a.createElement(g.default,o()({},x,{ref:I,show:r,hasTip:s,fixed:!0,align:d,verticalAlign:h,shouldPosition:b,containerClassName:k.popLayerContent}),n))}));w.propTypes={extraClasses:h.a.shape({icon:h.a.string,button:h.a.string,popLayerSpan:h.a.string,popoverSpan:h.a.string,popoverSpanOpen:h.a.string,popLayerContent:h.a.string}),align:h.a.oneOf(["left","center","right"]),verticalAlign:h.a.oneOf(["top","bottom"]),children:h.a.node.isRequired,isPopoverOpen:h.a.bool,hasTip:h.a.bool,handlePopover:h.a.func.isRequired,buttonProps:h.a.shape({}),shouldPosition:h.a.bool,buttonRef:h.a.func},w.defaultProps={extraClasses:{icon:"",button:"",popLayerSpan:"",popoverSpan:"",popoverSpanOpen:"",popLayerContent:""},hasTip:!0,align:void 0,verticalAlign:void 0,shouldPosition:void 0,buttonProps:{},buttonRef:function(){}},e.default=w},57:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(310),l=i(1032),c=i(2),u=function t(e,i){var n=this,s=o.a.extend({closeOnEscape:!0,width:300,dialogClass:i.dialogClass||"form-dialog"},i.extend);this.view=e,this.selector=i.selector,this.dialog=new l.default({extend:s,selector:e.$el||i.selector,title:i.title,onShow:i.onShow||function(){},onHide:i.onHide||function(){},buttons:i.buttons||t.Buttons.Close(),onBeforeHide:i.onBeforeHide,dataTest:i.dataTest,onClose:i.onClose||function(){}}),r()(document).keydown((function(t){var e=t.target.nodeName.toLowerCase();("input"!==e&&"textarea"!==e&&"span"!==e&&"div"===e&&!r()(t.target).hasClass("is-input")||r()(t.target).attr("readonly")||"checkbox"===t.target.getAttribute("type"))&&8===t.keyCode&&t.preventDefault(),t.keyCode===r.a.ui.keyCode.ESCAPE&&n.hide(),t.stopPropagation()}))};u.prototype.show=function(){return this.emit("beforeShow",this),this.dialog.show(),this.emit("afterShow",this),this},u.prototype.hide=function(){this.emit("beforeHide",this);var t={stopAction:!1};return r()(this).trigger("beforeShow",t),t.stopAction||(this.dialog.hide(),this.emit("afterHide",this)),this},u.prototype.setTitle=function(t){return this.dialog.setTitle(t),this},u.prototype.onBeforeClose=function(t){return this.dialog.onBeforeClose(t),this},a.default.mixin(u.prototype),(u.Buttons={}).Close=function(t){return[{label:Object(c.translate)("Close"),onClick:function(){t&&t.apply(this,arguments),this.hide()}}]},u.Buttons.SaveOrClose=function(t,e){var i=u.Buttons.Close(e);return i.unshift({label:Object(c.translate)("Save"),onClick:function(){t&&t.apply(this,arguments),this.hide()}}),i},e.default=u},571:function(t,e,i){"use strict";i.r(e);var n=i(19),o=i.n(n),s=i(4),r=i.n(s),a=i(28),l=i(12),c=i(1925),u=i(30);i(572);a.default.addEntryPoint((function(t,e){o.a.all([t.promise,e.promise]).then((function(){var t=Object(u.getSharePointItem)("innerElement");if(t.length&&(r()('<div class="bz-subheader-wrapper bz-subheader-wrapper--fixed-width beezy-community-header"><div id="js-beezy-communityheader" class="bz-webpart"></div></div>').insertBefore(t),null!==beezyCurrentGroup&&"undefined"!=typeof beezyCurrentGroup)){var e=new c.default({el:r()("#js-beezy-communityheader")});e.render(),e.model.on("change:isGroupAttendee",(function(t,e){l.default.publish("peopleextended","updateAttendes",e),l.default.publish("discoverCommunities","updateAttendes",e)}))}})).fail((function(t){console.info("[Error callback promises groupheader module]: ".concat(t.message)),console.info(t.stack)}))}),["beezyCurrentUser","beezyCurrentGroup"],1)},574:function(t,e,i){"use strict";i.r(e);var n=i(18),o=i(27),s=i.n(o),r=i(4),a=i.n(r),l=i(19),c=i.n(l),u=i(3),d=i.n(u),h=i(13),f=i(1760),p=i(158),m=i(2219),g=i.n(m),v=i(2220),b=i.n(v),y=i(12),C=i(137),w=i(7),T=i(17),x=i(8),O=function(t,e){return t.Id===e.Id},S=h.default.extend({template:g.a,templateList:b.a,events:{"click .js-show-button":"onClickShow","click .js-configure-metadata":"redirectToConfigureMetadata"},initialize:function(t){this.options=t,this._views=[],this._checkboxLists=[],this.$el=t.element||this.$el,this.tabs=this.getPropertyTabs(),this.items=this.getPropertyItems(),this.parentName=this.getPropertyParent(),this.context=this.options,this.prepareClassesAccordion(),this.bindExternalListeners()},render:function(){return this.$el.html(this.template(this.context)),this.elementMetadataList=this.$(".js-metadata-list"),this.options.isAccordion&&(this.accordion=new f.default({el:this.elementMetadataList,collapsed:this.options.collapsed,classes:this.options.classesAccordion})),this.fetchData(),this},bindExternalListeners:function(){var t=this;y.default.subscribe("knowledgeCenterWall","filterTag",(function(e){t.reset(),t.setCheckItem(!0,e)}))},bindListenersCollection:function(){this.collection&&this.listenTo(this.collection,"change:metadata",this.setMetadata)},getPropertyByKey:function(t){return this.options.properties.find((function(e){return e.Key===t}))},getPropertyParent:function(){var t=this.getPropertyByKey("parent");return t?t.Value:""},getPropertyItems:function(){var t=this.getPropertyByKey("items");return t?t.Value:""},getPropertyTabs:function(){var t=this.getPropertyByKey("tab");return t?t.Value:""},prepareClassesAccordion:function(){this.options.classesAccordion=d.a.extend({list:"metadata__list",item:"metadata__item",header:"metadata__title"},this.options.classesAccordion)},hasItems:function(){return this.collection&&this.collection.length},fetchData:function(){this.options.hideButton||this.$(".js-show-button").hide(),this.startLoading(),this.options.isAccordion?this.renderAccordion():(this.readyPromise=a.a.Deferred(),this.readyPromise.resolve(),this.renderItemsList())},ready:function(){return this.readyPromise},renderAccordion:function(){var t=this;if(this.accordion.reset(),this.collection)this.readyPromise=this.collection.fetch().then((function(e){t.checkShowEmptyFilter(e.length),t.checkShowFilterButton(e.length),t.renderItemsAccordion(e)}));else{var e=[];d.a.each(this.options.filterTabs,(function(i){i.Collection&&!t.options.usingContext?e.push(i.Collection.fetch()):e.push(i.Collection)})),c.a.allSettled(e).then((function(e){d.a.each(e,(function(e,i){t.renderItemsAccordion(e.value,t.options.filterTabs[i].Name)})),t.checkShowEmptyFilter(e.length),t.checkShowFilterButton(e.length)}))}},checkShowEmptyFilter:function(t){if(t)this.$(".js-empty-filter").hide();else{var e=(new C.default).getTemplateByType(w.default.EmptyStateType.metadataFilter);this.$(".js-empty-filter-container").html(e),this.$(".js-empty-filter").show()}},checkShowFilterButton:function(t){t&&(this.options.hideButton||this.$(".js-show-button").show())},renderTabsList:function(){this.elementMetadataList.append(this.templateList({Metadatas:this.collection.toJSON()})),this.elementCheckboxLists=this.$(".js-metadata-checkboxlist")},renderItemsList:function(){var t=this;this.stopLoading();var e=this.hasItems();e&&(this.renderTabsList(),this.renderCheckboxLists(),this.elementMetadataList.on("click",".js-metadata-item",(function(e){return t.changeTermList(e)}))),this.checkShowEmptyFilter(e)},renderCheckboxLists:function(){var t=this;this.collection.forEach((function(e,i){var n=0===i;t.renderCheckboxList(e,n)}))},renderCheckboxList:function(t,e){var i=t.get(this.tabs)||[],n=t.get("Id"),o=e?"":"is-hidden",s=new p.default.CheckBoxList({el:this.elementCheckboxLists,items:this.parseItems(i),equalFn:O,classes:{column:"js-term-list js-term-list-".concat(n," ").concat(o)}});this._checkboxLists[n]={list:s,parent:this.elementMetadataList.find('*[data-id="'.concat(t.get("Id"),'"]'))},this.bindListenerChangeValues(s)},bindListenerChangeValues:function(t){var e=this;t.off("change"),t.on("change",(function(t){return e.onChangeCheckbox(t)}),this)},changeTermList:function(t){t.preventDefault();var e=a()(t.currentTarget),i=e.data("id"),n=this.collection.findWhere({Id:i});e.parent().parent().find("li").removeClass("is-selected"),e.closest("li").addClass("is-selected"),this.showCurrentList(n.get("Id"))},showCurrentList:function(t){this.elementCheckboxLists.find(".js-term-list").addClass("is-hidden"),this.elementCheckboxLists.find(".js-term-list-".concat(t)).removeClass("is-hidden")},renderItemsAccordion:function(t,e){if(this.stopLoading(),this.options.isTree)this.collection.each(this.createAccordion,this);else{this.title=e;var i=[];d.a.each(t,(function(t){i.push("function"==typeof t.toJSON?t.toJSON():t)}));var n=i||[],o=this.accordion.addItems({title:e,collapsed:!(0===d.a.map(this.options.filterTabs,(function(t){return t.Name})).indexOf(e))});this._checkboxLists[e]={list:new p.default.CheckBoxList({el:o.content,items:this.parseItems(n),equalFn:O,hasShowMore:!0,itemsShowMore:7,classes:{row:"metadata-filter__accordion__list__item",columnJs:".js-metadata-accordion-list",column:"js-metadata-accordion-list metadata-accordion-list"}})},n.length||o.hide()}},createAccordion:function(t,e){var i=t.get(this.tabs)||[],n=this.accordion.addItems({title:t.get(this.items),collapsed:!(0===e)});this._checkboxLists[t.get(this.items)]=new p.default.CheckBoxList({el:n.content,items:this.parseItems(i),equalFn:O,hasShowMore:!0,itemsShowMore:7,classes:{column:"js-metadata-accordion-list"}}),i.length||n.hide()},parseItems:function(t){return d.a.map(t,this.parseItem)},parseItem:function(t){return{label:t.Name,value:t,checked:!1}},onChangeCheckbox:function(t){var e=this._checkboxLists[t.getValue().TermSetId];this.options.onChangeValueItem&&this.options.onChangeValueItem(t.getValue(),t.isChecked()),this.refreshNumberSelectedTerms(e)},refreshNumberSelectedTerms:function(t){var e=t.list.getCheckedValues().length,i="";e>0&&(i=e),t.parent.find(".js-terms-selected").text(i)},onClickShow:function(){this.trigger("filter",this.getValues())},getCheckboxLists:function(){return Object.keys(this._checkboxLists).map((function(t){return this[t]}),this._checkboxLists)},getValues:function(){var t=this,e=[];return this.getCheckboxLists().forEach((function(i){t._getValues(i).forEach((function(t){return e.push(t)}))})),e},_getValues:function(t){return t.list.getCheckedValues()},resetListCheckboxes:function(){return this.getCheckboxLists().forEach((function(t){if(t&&t.list)return t.list.reset()}))},reset:function(){this.resetListCheckboxes(),this.options.collapsed&&this.options.isAccordion&&this.accordion.collapseAll(),this.$el.find(".js-terms-selected").text("")},search:function(t){var e=this.collection.map((function(e){return e.search(t)}));return d.a.flatten(e)},setCheckItem:function(t,e){var i=e instanceof s.a.Model,n=i&&e?e.get("TermSetId"):e.TermSetId,o=i&&e?e.toJSON():e;o&&n&&this._checkboxLists[n]&&this._checkboxLists[n].list.setCheckStatus(t,o)},checkItem:function(t){this.setCheckItem(!0,t)},uncheckItem:function(t){this.setCheckItem(!1,t)},redirectToConfigureMetadata:function(){var t=T.default.getSettingsFullUrl({Type:x.default.getCurrentGroupType()}),e="".concat(t,"?idg=").concat(x.default.getGroupId(),"&tab=METADATA_SETTINGS");n.default.redirectToUrl(e)}});e.default=S},579:function(t,e,i){"use strict";i.r(e);var n={}.hasOwnProperty;e.default=function(t,e){for(var i in e)n.call(e,i)&&(t[i]=e[i]);function o(){this.constructor=t}return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t}},580:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(503),r=i(305),a=function(t,e){var i=e.find((function(e){return e.Name.trim().toLowerCase()===t.trim().toLowerCase()}));return i&&i.Name||t};e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=o()(t||document.body).find(".js-taglauncher");n.each((function(){var t=o()(this);if(!t.data("processed-tag")){var n=a(t.text().substring(1),e),l={};if(beezyCurrentGroup)l=new("EditorialModule"===beezyCurrentGroup.Type?r.default.ActivityHashtagStoryCountModel:"CorporateModule"===beezyCurrentGroup.Type?r.default.ActivityHashtagPagesCountModel:r.default.MicroTag)({Name:n,GroupId:beezyCurrentGroup.GroupId});else l=new r.default.MicroTag({Name:n});s.default.create(t,l,{popoverOptions:{fixed:i}}),t.data("processed-tag","true")}}))}},584:function(t,e,i){"use strict";var n=i(1868);window.BeezyMicroBox={},window.BeezyMicroBox.init=function(t,e){return new n.default(t,e)},e.default=window.BeezyMicroBox},587:function(t,e,i){"use strict";i.r(e);e.default={LEFT:37,UP:38,RIGHT:39,DOWN:40,INTRO:13,TAB:9,ESCAPE:27,SPACE:32}},59:function(t,e,i){"use strict";i.r(e);var n=i(494),o=i.n(n),s=i(15),r=i(17),a=i(2),l=i(4),c=i.n(l),u=i(3),d=i.n(u),h=i(13),f=i(385),p=i(894),m=i.n(p),g=i(2420),v=i.n(g),b=i(2421),y=i.n(b),C=i(2422),w=i.n(C),T=i(2423),x=i.n(T),O=i(89),S=i(37),I=i(8),A=(i(192),{VIEW:"View",EDIT:"Edit"}),k=h.default.extend({baseOptions:{name:"base",title:"",editable:!1,onlyEditMode:!1,usingContext:!1,hasPermissionsToChangeMode:!1,numberOfItems:10,detailLink:"",detailIcon:"...",extensible:!1,extensibleIcon:"...",allowToAdd:!1,emptyState:!1,contentView:{},views:{},filterTabs:{},collectionOptions:{onlyOwner:!1}},listView:{},template:m.a,templateHeader:v.a,templateWall:x.a,templateFooter:y.a,templateTabs:w.a,dom:{extend:".js-extend",detailLink:".js-detail-link",editIconHeaderContainer:".js-edit",cancelIconHeaderContainer:".js-cancel",visibilityButton:".js-toggle-visibility"},events:{"click .js-edit":"edit","click .js-cancel":"cancel","click .js-extend":"extend","click .js-add-btn":"addItem","click .js-toggle-visibility":"toggleVisibility","hover .js-toggle-visibility":"addTooltip","focus .js-toggle-visibility":"addTooltip"},texts:{show:"Show this widget in your public profile",hide:"Hide this widget in your public profile"},modes:A,mode:A.VIEW,initialize:function(t){this.parseOptions(t),this.createContext(),d.a.bind(this.checkItems,this)},handleVisibility:function(){this.visible?this.$el.removeClass("widget--opacity"):this.$el.addClass("widget--opacity")},toggleVisibility:function(t){var e=this;t.preventDefault(),this.visible=!this.visible,this.visible?this.model.showWidget(this.context.name).then((function(){e.handleVisibility(),e.changeTooltipText()})):this.model.hideWidget(this.context.name).then((function(){e.handleVisibility(),e.changeTooltipText()}))},hasAlreadyTooltip:function(){return this.tooltip&&this.tooltip.$el.selector===this.$(this.dom.visibilityButton).selector},addTooltip:function(){if(!this.hasAlreadyTooltip()&&this.options.showVisibiltyButton){var t=this.visible?this.texts.hide:this.texts.show;this.tooltip=new S.default({el:this.$(this.dom.visibilityButton),text:Object(a.translate)(t)}),this.updateVisibilityButtonAriaLabel(t),this.tooltip.onmouseenter()}},changeTooltipText:function(){var t=this.visible?this.texts.hide:this.texts.show;this.tooltip.message(Object(a.translate)(t)),this.updateVisibilityButtonAriaLabel(t)},updateVisibilityButtonAriaLabel:function(t){this.$(this.dom.visibilityButton).attr("aria-label",t)},createContext:function(){this.context=d.a.extend(d.a.omit(this.options,"contentView","views","filterTabs","el")),this.context=d.a.extend(this.context,{contentAreas:[{id:"js-header",classes:"wg__title webpart-title--".concat(this.options.titleClass),content:this.templateHeader(d.a.extend(this.context,{hasPermissionsToChangeMode:this.hasPermissionsToChangeMode,widgetName:this.context.name,showVisibiltyButton:this.context.showVisibiltyButton})),header:!0},{id:"js-tabs",content:this.templateTabs()},{id:"js-filter"},{id:"js-wall",content:this.templateWall(this.context)},{id:"js-footer clearfix",content:this.templateFooter(this.context)}]})},parseOptions:function(t){var e=t.visible,i=void 0===e||e,n=o()(t,["visible"]);n.contentView||(console.info("The widget needs a child list view"),this.$el.hide()),this.options=d.a.omit(d.a.defaults(n||{},this.baseOptions),"el"),this.options.editRulesFunction=n.editRulesFunction||this.editRulesFunction,this.options.editRulesFunction=d.a.bind(this.options.editRulesFunction,this),this.hasPermissionsToChangeMode=this.allowChangeMode(),this.listView=new n.contentView(this.options),this.visible=i},allowEdit:function(){return!!this.options.editable&&this.options.editRulesFunction()},allowChangeMode:function(){return!(!this.options.editable||this.options.onlyEditMode)&&this.options.editRulesFunction()},setAutocomplete:function(t){var e=this;this.autocomplete=new O.default(t),this.autocomplete.on("selectitem",(function(t){e.listView.addItem(t),e.autocomplete.reset(),e.removeEmptyState()})),this.$(".js-add :input").keyup((function(t){""!==t.currentTarget.value?e.$(".js-add-btn").show():e.$(".js-add-btn").hide()})),s.default.isValidUserFromQueryString()||c()(".js-title-add-skill").show()},addItem:function(t){t.preventDefault();var e=this.$(".js-add").find("input").val();this.removeEmptyState(),this.listView.addItem(e),this.autocomplete.reset(),c()(".js-title-add-skill").hide()},renderEmptyState:function(){this.$(".js-empty-state").show(),this.$el.show()},removeEmptyState:function(){this.$(".js-empty-state").hide()},editRulesFunction:function(){return!!I.default.isGroupOwner()||(this.options.usingContext&&beezyContext.CurrentActivity?s.default.isOwnerOrSpeakerOrAdminFromGroup(beezyContext.CurrentActivity.Owner.Id,beezyCurrentGroup):!(!this.options.currentActivity||!this.options.currentActivity.Owner)&&s.default.isOwnerOrSpeakerOrAdminFromGroup(this.options.currentActivity.Owner.Id,beezyCurrentGroup))},setEllipsis:function(t,e){setTimeout((function(){t.dotdotdot(d.a.extend({height:parseInt(t.css("lineHeight"),10)*e}))}),0)},_updateIconMode:function(){this.$(this.dom.cancelIconHeaderContainer).toggle(this.mode!==this.modes.VIEW),this.$(this.dom.editIconHeaderContainer).toggle(this.mode===this.modes.VIEW)},setMode:function(t){this.mode=t,this._updateIconMode()},render:function(){var t=this,e=this;return k.__super__.render.apply(this,this.options),this.$el.addClass("wg wg--".concat(this.options.name)),this.$el.hide(),this.setEllipsis(this.$(".js-header"),2),this.$(".js-header").length&&""===this.$(".js-header").html().trim()&&this.$(".js-header").hide(),this.listView&&(this.renderTabs=d.a.bind(this.renderTabs,this),this.$(".js-wall").append(this.listView.el),this.listView.on("loaded",(function(t,i){e.options.filterTabs&&e.options.filterTabs.tabs&&!t&&(e.options.filterTabs.tabs.shift(),e.renderTabs()),e.checkItems(t,i),(t||!e.options.filterTabs||e.options.filterTabs.tabs&&0===e.options.filterTabs.tabs.lenght)&&e.trigger("loaded",t)})),this.listView.on("attachmentsUpdated",(function(e){return t.trigger("attachmentsUpdated",e)})),this.listView.on("attachmentDeleted",(function(e){return t.trigger("attachmentDeleted",e)})),this.listView.on("uploading",(function(){return t.trigger("uploading")})),this.listView.on("deletingAttachment",(function(){return t.trigger("deletingAttachment")})),this.listView.on("error",(function(){return t.trigger("error")}))),this.renderTabs(),this.options.onlyEditMode&&this.listView.editMode(!0),this.options.showVisibiltyButton&&this.handleVisibility(),this},checkItems:function(t,e){t&&(this.$el.show(),this.removeEmptyState()),this.options.emptyState&&!t?this.renderEmptyState():this.removeEmptyState(),this.options.editable&&this.allowEdit()&&(this.options.showEmptyWidget||t)&&this.$el.show(),this.$(this.dom.detailLink)[e?"show":"hide"](),this.$(this.dom.extend)[e?"show":"hide"]()},renderTabs:function(){var t=this;if(this.options.filterTabs.tabs){this.tabs=new f.default({context:this.options.filterTabs,el:this.$(".js-tabs-container")});var e=d.a.find(this.options.filterTabs.tabs,(function(t){if(t.selected)return!0}));!e&&this.options.filterTabs.tabs.length>0&&((e=this.options.filterTabs.tabs[0]).selected=!0),this.tabs.render(),this.tabs.on("switch",(function(e){t.tabSwitch(e)}),this),this.options.filterTabs.tabs.length>0&&this.tabSwitch(e.id)}else{var i=this.options.collectionOptions&&this.options.collectionOptions.orderby?{orderby:this.options.collectionOptions.orderby}:{};this.listView.refresh(i)}},tabSwitch:function(t){this.listView.refresh({orderby:d.a.find(this.options.filterTabs.tabs,(function(e){return e.id===t})).filter})},extend:function(){this.listView.showAll()},getPromise:function(){this.listView.getPromise()},edit:function(t){if(t.preventDefault(),s.default.isReadOnly())return r.default.showReadOnlyModal();this.mode=this.modes.EDIT,this.trigger("edit"),this.options.redirectOnEdit||(this.listView.editMode(!0),this._updateIconMode())},cancel:function(t){if(t.preventDefault(),s.default.isReadOnly())return r.default.showReadOnlyModal();this.mode=this.modes.VIEW,this.trigger("cancel"),this.listView.editMode&&this.listView.editMode(!0),this._updateIconMode()},isCommunityAdmin:function(){return I.default.isGroupOwner()}});e.default=k},595:function(t,e,i){"use strict";var n=i(2048);i.d(e,"isEscKey",(function(){return n.default}));i(2049);var o=i(2050);i.d(e,"isEnterKey",(function(){return o.default}));var s=i(731);i.d(e,"KEYS",(function(){return s.default}))},599:function(t,e,i){"use strict";var n=i(2222);i.d(e,"getBackgroundColorGradient",(function(){return n.default}));var o=i(2223);i.d(e,"getFirstBeezyColorName",(function(){return o.default}));var s=i(2226);i.d(e,"getColorFromImage",(function(){return s.default}));var r=i(2252);i.d(e,"hextToRgb",(function(){return r.default}));var a=i(2253);i.d(e,"hslToRgb",(function(){return a.default}));var l=i(2254);i.d(e,"rgbToHsl",(function(){return l.default}));var c=i(2255);i.d(e,"setBackgroundColorGradient",(function(){return c.default}))},60:function(t,e,i){"use strict";i.r(e);var n=i(39),o=i(30),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(13),u=i(313),d=(i(682),i(49)),h=i(333),f=i(2),p=i(2424),m=i.n(p),g=i(173),v=i(19),b=i.n(v),y=i(12),C=i(482),w=i(78),T=i(8),x=i(233),O={VIEW:"View",EDIT:"Edit"},S=c.default.extend({baseOptions:{skip:0,take:20,type:"",latest:!1,usingContext:!1,extendedData:!1,classes:"list"},tagName:"ul",template:m.a,events:{"click .js-delete":"_deleteItem","click .js-profile-image":"showProfile"},mode:O.VIEW,modes:O,initialize:function(t){if(this.options=t=t||(t={}),this.skip=t.skip||0,this.take=t&&t.take>=0?t.take:20,this.type=t.type||"",this.latest=t.latest||!1,this.usingContext=t.usingContext||!1,this.contextData=t.contextData||(beezyContext.CurrentActivity?beezyContext.CurrentActivity.Attachments:[]),this.extendedData=t.extendedData||!1,this.itemOptions=t.itemOptions,this.templateW=t.templateW,this.classes=t.classes||"list",this._selectedTerms={},this.itemNodes=[],this.collection=t.collection||this.collection,"people"===t.type){var e=l.a.findWhere(t.filterTabs.tabs,{selected:!0});if(e&&"Owners"===e.id){this.usingContext=!0;var i=[];l.a.each(T.default.getCurrentGroup().Administrators,(function(t){i.push({User:t})})),this.contextData=i}}this.initializeCollection(),this.templateW&&(this.template=this.templateW),this.listenTo(this.collection,"reset",this.render),this.options.cacheable&&n.default.indexOfItem(this.options.cacheable.name,this.options.cacheable.sessionName)>-1||this.listenTo(this.collection,"add",this.appendItem),C.default.insideBeezyMaster()&&this.loadWhenScroll(),y.default.subscribe("metadata","filter",(function(t){this.onFilter(t)}),this,this.options.eventKey),y.default.subscribe("attachmentsFilter","remove",(function(t){this.onRemoveTerm(t)}),this,this.options.eventKey),this.deferred=b.a.defer()},initializeCollection:function(){this.collection=new this.collection(this.options.collectionOptions)},getPromise:function(){return this.deferred.promise},resolveDeferred:function(t){this.deferred.resolve({type:"???",numData:t})},onFilter:function(t){var e=this;this.removeAllTerms(),l.a.each(t,(function(t){e.addTerm(t)})),this.refresh()},onRemoveTerm:function(t){this.removeTerm(t),this.refresh()},addTerm:function(t){this._selectedTerms[t.Guid]||(this._selectedTerms[t.Guid]=t)},removeTerm:function(t){t&&this._selectedTerms[t.Guid]&&delete this._selectedTerms[t.Guid]},removeAllTerms:function(){l.a.each(this._selectedTerms,this.removeTerm,this)},setLoading:function(){this.trigger("loading"),this.$el.append(r()("<li />").addClass("loading"))},unsetLoading:function(){this.$("li.loading").remove()},loadWhenScroll:function(){this.infiniteScroll=Object(o.sharePointItems)().content.loadwhenscroll({threshold:200,innerElement:Object(o.sharePointItems)().innerElement},l.a.bind(this.loadMoreItems,this))},loadMoreItems:function(){if(!this.loadingItems&&(this.infiniteScroll.pause(),this.remaining())){this.loadingItems=!0;var t=this,e=function(){t.remaining()&&t.infiniteScroll.resume(),t.loadingItems=!1,t.afterRender()};this.more().done(e).fail(e)}},render:function(){return this.preRender(),this.collection.each(this.appendItem,this),this.afterRender(),this},afterRender:function(){this.$(".js-timeago").timeago(),d.default.ellipsis(this.$(".js-description"),2)},preRender:function(){this.$el.addClass(this.classes).html(""),this.itemNodes=[]},reset:function(t){this.collection.reset(t)},fetch:function(){this.collection.fetch({reset:!0})},appendItem:function(t,e){this.renderItem(t,e)},_getColor:function(t){return t.attributes.Activity&&t.attributes.Activity.Group?t.attributes.Activity.Group.Color:t.attributes.Group&&t.attributes.Group.Color?t.attributes.Group.Color:t.attributes.Color&&t.attributes.Color?t.attributes.Color:null},renderItem:function(t){var e=l.a.extend(t.attributes,this.itemOptions,{classes:this.classes,extendedData:this.extendedData}),i=this.template(e),n=r()(i);Object(u.default)(n),this.itemNodes.push(n),g.default.applyColors(n,this._getColor(t)),n.appendTo(this.$el);var o=this.getObserverImage({}),s=n.get(0).querySelector(".js-observer__img");return s&&o.observe(s),t.attributes.editing&&this.mode===O.EDIT&&this.$(".js-delete").show(),d.default.ellipsis(n.find(".js-text-shortable"),2),n},refresh:function(t){t=t||{},this.orderby=t?t.orderby:"";var e=l.a.extend({skip:this.skip,take:t.take||this.take,type:this.type,filter:this.getSelectedTermsIds(),latest:this.options.latest,orderby:this.orderby},this.collection.currentData);return this.fetchData(l.a.extend({reset:!0,data:e},t))},getSelectedTermsIds:function(){var t=[];return l.a.each(this._selectedTerms,(function(e){t.push(e.Id)})),t.join(",")},more:function(){return this.skip+=this.take,this.refresh({update:!0,remove:!1})},showAll:function(){var t={skip:0,take:1e3,type:this.type,filter:this.getSelectedTermsIds(),latest:this.options.latest,orderby:this.orderby};this.fetchData({reset:!0,data:t})},fetchData:function(t){var e=this;if(t.hideLoading||this.setLoading(),"Highlighted"===t.data.orderby&&"document"===t.data.type&&(t.data.highlighted=!0),!this.usingContext)return t.reset&&this.collection.reset(),this.options.cacheable&&n.default.indexOfItem(this.options.cacheable.name,this.options.cacheable.sessionName)>-1?(e.unsetLoading(),this.collection.add(n.default.getItem(this.options.cacheable.name,this.options.cacheable.sessionName)),this.resolveDeferred(this.collection.length),this.onDataFetched(this.collection),this.trigger("loaded",this.collection.length,!0),this.collection.fetch(l.a.extend({success:function(t,i){n.default.clearItem(e.options.cacheable.name,e.options.cacheable.sessionName),n.default.setItem(e.options.cacheable.name,i,e.options.cacheable.sessionName)},error:function(){e.resolveDeferred(0)}},t))):this.collection.fetch(l.a.extend({success:function(t,i,o){o.hideLoading||e.unsetLoading(),e.options.cacheable&&n.default.setItem(e.options.cacheable.name,i,e.options.cacheable.sessionName),e.resolveDeferred(t.length),e.onDataFetched(t),e.trigger("loaded",e.collection.length,e.collection.hasMoreItems)},error:function(t,i,n){n.hideLoading||e.unsetLoading(),e.resolveDeferred(0)}},t));this.collection.reset(),l.a.each(this.contextData,(function(t){e.collection.add(t)})),e.trigger("loaded",e.collection.length)},onDataFetched:function(){},remaining:function(){return this.collection.hasMoreItems},editMode:function(){var t=this.$el.parent();this.mode===O.VIEW?(t.addClass("is-editing"),this.$(".js-delete").show(),this.mode=O.EDIT):(t.removeClass("is-editing"),this.$(".js-delete").hide(),t.find(".js-confirmation-container").html(""),this.mode=O.VIEW)},_deleteItem:function(t){var e=this,i=r()(t.currentTarget).closest(".js-file-item");t.preventDefault(),this.confirmationView=new h.default({notDialog:!0}),this.confirmationView.setTitle(""),this.confirmationView.setText(Object(f.translate)("You are about to delete a file. Are you sure?")),this.confirmationView.setConfirm(Object(f.translate)("Yes")),this.confirmationView.setCancel(Object(f.translate)("No")),i.find(".js-confirmation-container").append(this.confirmationView.render().$el),i.find(".js-item-details").hide(),i.find(".js-confirmation-container").addClass("is-open"),this.confirmationView.getPromise().done((function(t){"confirm"===t&&(e.deleteItem(i.data("id"),i.data("name")),i.remove()),i.find(".js-confirmation-container").removeClass("is-open"),i.find(".js-confirmation-container").html(""),e.confirmationView={},i.find(".js-item-details").show()}))},showProfile:function(t){var e=r()(t.currentTarget).data("url");e&&(t.preventDefault(),t.stopPropagation(),w.default.showUserProfilePage(e))},deleteItem:function(){}});S.mixin(x.default),e.default=S},623:function(t,e,i){"use strict";e.default={"popover-tab":"bz-popover-tab--Z1LKNYi",button:"bz-button--Z1LKNYi",button__icon:"bz-button__icon--Z1LKNYi",button__text:"bz-button__text--Z1LKNYi",dropdown:"bz-dropdown--Z1LKNYi",dropdown__list:"bz-dropdown__list--Z1LKNYi","list-item__button":"bz-list-item__button--Z1LKNYi","list-item__button-icon":"bz-list-item__button-icon--Z1LKNYi","list__item-text":"bz-list__item-text--Z1LKNYi","list-item__button--active":"bz-list-item__button--active--Z1LKNYi","list-item__badge":"bz-list-item__badge--Z1LKNYi","list-item__sr-only":"bz-list-item__sr-only--Z1LKNYi"}},625:function(t,e,i){"use strict";e.default={popover:"bz-popover--213FGX","popover--show":"bz-popover--show--213FGX",showPopover:"bz-showPopover--213FGX","popover--hide":"bz-popover--hide--213FGX",hidePopover:"bz-hidePopover--213FGX","popover--right":"bz-popover--right--213FGX","popover--left":"bz-popover--left--213FGX","popover-container--fixed":"bz-popover-container--fixed--213FGX","popover--top":"bz-popover--top--213FGX","popover--center":"bz-popover--center--213FGX","popover-container":"bz-popover-container--213FGX","popover--bottom":"bz-popover--bottom--213FGX"}},627:function(t,e,i){"use strict";var n=i(2444),o=i(2290);i.d(e,"CheckboxList",(function(){return o.default})),e.default=n.default},63:function(t,e,i){"use strict";i.r(e);var n=i(7),o=i(49),s=i(10),r=i(161),a=i(5);function l(){}l.prototype={allowComments:function(){return void 0===beezyContext.CurrentActivity.AllowComments||beezyContext.CurrentActivity.AllowComments},allowLikes:function(){return void 0===beezyContext.CurrentActivity.AllowLikes||beezyContext.CurrentActivity.AllowLikes},isLiked:function(){return beezyContext.CurrentActivity.CurrentUserLikedActivity},isFollowed:function(){return beezyContext.CurrentActivity.CurrentUserIsFollowing},existCurrentActivity:function(){return void 0!==beezyContext.CurrentActivity&&null!==beezyContext.CurrentActivity},getActivity:function(){return beezyContext.CurrentActivity},getAuthors:function(){return beezyContext.CurrentActivity.Authors},getBackgroundImage:function(){return{imageUrl:beezyContext.CurrentActivity.BackgroundImageUrl,offsetX:beezyContext.CurrentActivity.BackgroundImageOffsetX,offsetY:beezyContext.CurrentActivity.BackgroundImageOffsetY,height:beezyContext.CurrentActivity.BackgroundImageHeight,width:beezyContext.CurrentActivity.BackgroundImageWidth}},getComments:function(){return beezyContext.CurrentActivity.Comments},getChannels:function(){return beezyContext.CurrentActivity.Channels||[]},getId:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Id},setImageCroppingId:function(t){beezyContext.CurrentActivity.ImageCroppingIds&&!beezyContext.CurrentActivity.ImageCroppingIds.find((function(e){return e===t}))&&beezyContext.CurrentActivity.ImageCroppingIds.push(t)},getLCID:function(){return beezyContext.CurrentActivity.LCID},getLanguages:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Languages?beezyContext.CurrentActivity.Languages:[]},getMessage:function(){return beezyContext.CurrentActivity.Message},getPendingApprovers:function(){return beezyContext.CurrentActivity.PendingApprovers},getTitle:function(){return o.default.nicefyText(beezyContext.CurrentActivity.Title)},getTranslation:function(){return beezyContext.CurrentActivity.Translation},getTranslationId:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Translation&&beezyContext.CurrentActivity.Translation.Id?beezyContext.CurrentActivity.Translation.Id:null},getTranslationLCID:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Translation&&beezyContext.CurrentActivity.Translation.LCID?beezyContext.CurrentActivity.Translation.LCID:null},getTranslationParentUrl:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.Translation&&beezyContext.CurrentActivity.Translation.ParentUrl?beezyContext.CurrentActivity.Translation.ParentUrl:null},getType:function(){return beezyContext.CurrentActivity.Type},getUrl:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.RelatedItem&&beezyContext.CurrentActivity.RelatedItem.Url?beezyContext.CurrentActivity.RelatedItem.Url:null},getVideoUrl:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.VideoUrl?beezyContext.CurrentActivity.VideoUrl:null},setVideoUrl:function(t){beezyContext.CurrentActivity.VideoUrl=t},isActivityFeatured:function(){return beezyContext.CurrentActivity.Featured},isnewPublishingDraft:function(){return(beezyContext.CurrentActivity.Type===n.default.Type.STORY||beezyContext.CurrentActivity.Type===n.default.Type.CORPORATEPAGE)&&!beezyContext.CurrentActivity.IsPublished},isArticle:function(){return beezyContext.CurrentActivity.Type===n.default.Type.STORY},isPublished:function(){return beezyContext.CurrentActivity.IsPublished},setPublished:function(t){return beezyContext.CurrentActivity.IsPublished=t},setPublishedDate:function(t){beezyContext.CurrentActivity.PublishedDate=t},isFeatured:function(){return beezyContext.CurrentActivity.Featured},getPublishedDate:function(){return beezyContext.CurrentActivity.PublishedDate},getSchedule:function(){return beezyContext.CurrentActivity.Schedule},canBePublished:function(){return beezyContext.CurrentActivity.CanBePublished},canRequestApproval:function(){return null===beezyContext.CurrentActivity.PublishedDate},setPendingApprovers:function(t){beezyContext.CurrentActivity.PendingApprovers=t},setCanBePublished:function(t){beezyContext.CurrentActivity.CanBePublished=t},setSchedule:function(t){beezyContext.CurrentActivity.Schedule=t},getRelatedItem:function(){return beezyContext.CurrentActivity.RelatedItem},isCurrentUserCanUpdate:function(){return beezyContext&&beezyContext.CurrentActivity&&beezyContext.CurrentActivity.CurrentUserCanUpdate},isCurrentUserPendingApprove:function(){return beezyContext.CurrentActivity.CurrentUserPendingApprove},isGuestWriterPage:function(){return beezyContext.CurrentActivity.IsGuestWriterPage},setActivity:function(t){void 0!==t&&(beezyContext.CurrentActivity=t)},hasActivity:function(){return void 0!==beezyContext.CurrentActivity},hasPendingApprovers:function(){return(beezyContext.CurrentActivity.PendingApprovers||[]).length>0},getCurrentActivity:function(){return new Promise((function(t,e){null===beezyContext.CurrentActivity?r.default.getCurrentItemId((function(i,n){var o=i,r=n;return s.default.getJSON("".concat(a.default.getApiUrlv2(),"/Activities/ByItem?listGuid=").concat(o,"&itemId=").concat(r)).then((function(e){beezyContext.CurrentActivity=e,t(e)}),(function(t){e(t)}))})):t(beezyContext.CurrentActivity)}))},isNewPublishing:function(){var t=!1;return[n.default.Type.STORY,n.default.Type.CORPORATEPAGE].indexOf(beezyContext.CurrentActivity.Type)>-1&&(t=!0),t},addChannels:function(t){beezyContext.CurrentActivity.Channels.push(t)}},e.default=l},64:function(t,e,i){"use strict";i.r(e);var n=i(131),o=i.n(n),s=i(4),r=i.n(s),a={getElementWithClass:function(t,e){return r()(e).find(".".concat(t))},createElementWithClass:function(t,e){var i=r()("<div />").addClass(t);return i.appendTo(r()(e)),i},isDescendant:function(t,e){if(e&&e.parentNode)for(var i=e.parentNode;null!=i;){if(i===t)return!0;i=i.parentNode}return!1},findElementClasses:function(t,e){return e.find((function(e){return r()(".".concat(e)).get(0)===t}))},addClassIfNotExist:function(t,e){t.hasClass(e)||t.addClass(e)},removeClassIfExist:function(t,e){t.hasClass(e)&&t.removeClass(e)},isVisible:function(t){return"block"===t.css("display")},changeBackgroundColor:function(t,e){t&&(t.style.backgroundColor=e)},changeBackgroundImage:function(t,e){var i=t;i.style.backgroundImage="",i.style.backgroundImage="url('".concat(e.replace(/'/g,"\\'"),"')")},changeBackgroundImageOpacity:function(t,e){t.style.opacity=e},hideElement:function(t){t&&(t.style.display="none")},showElement:function(t){t&&(t.style.display="block")},changeBackgroundPosition:function(t,e,i){t&&(t.style.backgroundPosition="".concat(e,"px ").concat(i,"px"))},changeBackgroundPositionPercentage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t){var n=t;n.style.backgroundPosition="".concat(e,"% ").concat(i,"%")}},hasBackGroundImage:function(t){return""!==t.style.backgroundImage},destroyElement:function(t){t&&t.parentElement.removeChild(t)},addChildToElement:function(t,e){if(t){var i=document.createElement("DIV");return i.innerHTML=e,t.appendChild(i),i}},selectText:function(t,e){var i;if("string"==typeof t.textContent&&document.createRange&&window.getSelection)i=t.textContent;else if(document.selection&&document.body.createTextRange){var n=document.body.createTextRange();n.moveToElement(t),i=n.text}var o=i.indexOf(e);this.setSelectionRange(t,o,o+e.length)},getTextNodesIn:function(t){var e=[];if(3===t.nodeType)e.push(t);else for(var i=t.childNodes,n=0,s=i.length;n<s;++n)e.push.apply(e,o()(this.getTextNodesIn(i[n])));return e},setSelectionRange:function(t,e,i){if(document.createRange&&window.getSelection){var n=document.createRange();n.selectNodeContents(t);for(var o,s,r=this.getTextNodesIn(t),a=!1,l=0,c=0;s=r[c++];){if(o=l+s.length,!a&&e>=l&&(e<o||e===o&&c<r.length)&&(n.setStart(s,e-l),a=!0),a&&i<=o){n.setEnd(s,i-l);break}l=o}var u=window.getSelection();u.removeAllRanges(),u.addRange(n)}},setFocusLastCharacter:function(t){if(void 0!==window.getSelection&&void 0!==document.createRange){var e=document.createRange();e.selectNodeContents(t.get(0)),e.collapse(!1);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}else if(void 0!==document.body.createTextRange){var n=document.body.createTextRange();n.moveToElementText(t),n.collapse(!1),n.select()}}};e.default=a},652:function(t,e,i){"use strict";i.r(e);var n={isIE:!!window.navigator.userAgent.match(/Trident/g)||!!window.navigator.userAgent.match(/MSIE/g),isEdge:!!window.navigator.userAgent.match(/Edge/g),supportConsoleTable:function(){return void 0!==console.table},supportPerformanceAPI:function(){return void 0!==(window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance)}};e.default=n},653:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(15),s=i(4),r=i.n(s),a=i(13),l=i(2),c=i(503),u=i(333),d=i(53),h=i(88),f=i(1936),p=i.n(f),m=a.default.extend({template:p.a,tagName:"li",events:{"click .js-tagfilter":"filter","click .js-remove-hashtag-item":"_deleteTag","click .js-redirect":"redirectTo"},className:"c-tag-list__item",initialize:function(t){this.options=t,this.classNameW=t.classNames,this.Editable=t.editable,this.isClickable=t.isClickable,this.ShowValues=t.showValue,this.isCommunities=t.isCommunities,this.isAggregate=t.isAggregate,this.activityId=t.activityId,this.showPopup=t.showPopup,this.canRemove=t.canRemove,this.template=t.template||p.a,this.queryString=n.default.getQueryString(),r()(this.el).addClass(this.classNameW)},render:function(){return this.ctx={Tag:this.model.toJSON(),Editable:this.Editable,canRemove:this.canRemove,ShowValues:this.ShowValues,isCommunities:this.isCommunities,isAggregate:this.isAggregate,isClickable:this.isClickable,icon:this.options.icon,isReadOnly:o.default.isReadOnly()},this.$el.html(this.template(this.ctx)),this.showPopup&&c.default.create(this.$(".js-microtag"),this.model,this.options),this},hideTagTooltip:function(){this.$(".js-beezy-microtag").hide()},addMessage:function(t){var e=Object(d.sprintf)({string:Object(l.translate)("Newsfeed has been filtered by %filterName"),replacements:[t],pattern:/%filterName/gi});Object(h.addAssertiveMessage)(e)},filter:function(t){if(t.preventDefault(),t.stopPropagation(),this.isClickable){var e=this.model.toJSON().Name;this.hideTagTooltip(),this.addMessage(e),this.trigger("filter",e)}},_deleteTag:function(t){var e=this,i=r()(t.currentTarget).closest(".c-tag-list__item");t.preventDefault(),this.confirmationView=new u.default({notDialog:!0}),this.confirmationView.setTitle(""),this.confirmationView.setText(Object(l.translate)("You are about to delete a tag. Are you sure?")),this.confirmationView.setConfirm(Object(l.translate)("Yes")),this.confirmationView.setCancel(Object(l.translate)("No")),i.find(".js-confirmation-container").append(this.confirmationView.render().$el),i.find(".js-tag-details").hide(),i.find(".js-confirmation-container").addClass("is-open"),this.confirmationView.getPromise().done((function(t){"confirm"===t&&(e.removeTag(),i.remove()),i.find(".js-confirmation-container").removeClass("is-open"),i.find(".js-confirmation-container").html(""),e.confirmationView={},i.find(".js-tag-details").show()}))},removeTag:function(){var t=this.model.get("Id");this.model._delete({activityId:this.activityId,hashtagId:t}),this.model.on("success",this.removedTag,this),this.trigger("removedTag")},removedTag:function(){this.trigger("deleted",this.model)},redirectTo:function(t){t.preventDefault(),this.trigger("redirect",this.model.get("Id"))}});e.default=m},655:function(t,e,i){"use strict";i.r(e);var n=i(26),o=i(10),s=i(5),r=n.default.extend({url:function(){return"".concat(s.default.getApiUrlv2(),"/Users")},administrableLocalEntities:function(){return o.default.get("".concat(this.url(),"/Current/AdministrableEntities"))},administrableModules:function(){return o.default.get("".concat(this.url(),"/Current/AdministrableModules"))}});e.default=r},665:function(t,e,i){"use strict";e.default=function(t){var e=t.string,i=t.pattern,n=void 0===i?/%d|%s/gi:i,o=t.replacements;if(!e)return"";if(!Array.isArray(o))return e;var s=o;return e.replace(n,(function(t){var e=s[0]||t;return s.shift(),t.replace(t,e)}))}},673:function(t,e,i){"use strict";var n=i(1996);i.d(e,"useSingleOpenContext",(function(){return n.default}));var o=i(1997);i.d(e,"useSingleOpen",(function(){return o.default}))},678:function(t,e,i){"use strict";i.d(e,"AppDirectory",(function(){return n})),i.d(e,"AppStorePage",(function(){return o})),i.d(e,"AppDetailPage",(function(){return s}));var n="/SitePages/Apps",o="/SitePages/Apps/Overview.aspx",s="Detail.aspx?appId="},682:function(t,e,i){var n,o,s=i(219);n=[i(4),i(2)],void 0===(o=function(t,e){!function(t,e,i,n){e.timeago=function(t){return t instanceof Date?u(t,!0):"string"==typeof t?u(e.timeago.parse(t),!0):u(e.timeago.datetime(t))},e.regularTimeago=function(t){return t instanceof Date?u(t,!1):"string"==typeof t?u(e.timeago.parse(t),!1):u(e.timeago.datetime(t))},e.extend(e.timeago,{settings:{refreshMillis:6e4,range:13824e5},inWords:function(t,n){var o={regular:{seconds:i("just now"),minute:i("%d minute ago"),minutes:i("%d minutes ago"),hour:i("%d hour ago"),hours:i("%d hours ago"),day:i("%d day ago"),days:i("%d days ago"),month:i("about a month"),months:i("%d months"),year:i("about a year"),years:i("%d years"),numbers:[]},abbreviated:{seconds:i("just now"),minute:i("%dm ago"),minutes:i("%dm ago"),hour:i("%dh ago"),hours:i("%dh ago"),day:i("%dd ago"),days:i("%dd ago"),month:i("about a month"),months:i("%d months"),year:i("about a year"),years:i("%d years"),numbers:[]}},s=t/1e3,r=s/60,a=r/60,l=a/24,c=l/365;function u(i,s){var r=e.isFunction(i)?i(s,t):i;if(n)var a=o.abbreviated.numbers[s]||s;else a=o.regular.numbers[s]||s;return r.replace(/%d/i,a)}function d(){return n?s<60&&u(o.abbreviated.seconds,Math.round(s))||r<60&&u(o.abbreviated.minutes,Math.round(r))||a<24&&u(o.abbreviated.hours,Math.floor(a))||l<30&&u(o.abbreviated.days,Math.floor(l))||l<60&&u(o.abbreviated.month,1)||l<365&&u(o.abbreviated.months,Math.floor(l/30))||c<2&&u(o.abbreviated.year,1)||u(o.abbreviated.years,Math.floor(c)):s<60&&u(o.regular.seconds,Math.round(s))||r<60&&u(o.regular.minutes,Math.round(r))||a<24&&u(o.regular.hours,Math.floor(a))||l<30&&u(o.regular.days,Math.floor(l))||l<60&&u(o.regular.month,1)||l<365&&u(o.regular.months,Math.floor(l/30))||c<2&&u(o.regular.year,1)||u(o.regular.years,Math.floor(c))}return e.trim(d())},parse:function(t){var i=e.trim(t);return i=(i=(i=(i=i.replace(/\.\d\d\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+-]\d\d)\:?(\d\d)/," $1$2"),new Date(i)},datetime:function(t){var i="time"==e(t).get(0).tagName.toLowerCase()?e(t).attr("datetime"):e(t).attr("title");return o.parse(i)}});var o=e.timeago;function r(t){return Math.abs(c(t))<o.settings.range}function a(t,n){var o=l(t=e(t)).datetime;if(!isNaN(o))if(r(o))e(t).text(u(o,n));else{var a=i("%d %m %y"),c=s.getAbbreviatedMonthNames(),d=s.getDateFromPattern(a,o,c);e(t).text(d)}return t}function l(t){if(!(t=e(t)).data("timeago")){t.data("timeago",{datetime:o.datetime(t)});var i=e.trim(t.text());i.length>0&&t.attr("title",i)}return t.data("timeago")}function c(t){return(new Date).getTime()-t.getTime()}function u(t,e){var i=c(t);return o.inWords(i,e)}e.fn.timeago=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this;e.each((function(e,i){return a(i,t)}));var i=o.settings;return i.refreshMillis>0&&setInterval((function(){e.each((function(e,i){return a(i,t)}))}),i.refreshMillis),e}}(0,t,e.translate)}.apply(e,n))||(t.exports=o)},696:function(t,e,i){"use strict";var n=i(2465);e.default=Object(n.default)({queryString:window.location.search})},7:function(t,e,i){"use strict";i.r(e);var n=i(2),o=i(652),s=i(15),r=window.beezyCurrentUser&&s.default.getLocalEntity(),a=r&&r.DefaultLcid,l={maximumDisplayableUsersDropdown:50,quickProfileDelay:600,dropDefaultDelayShow:150,microtagDelay:600,dropDefaultDelayHide:100,autoCompleteDelayHide:100,dropthreshold:10,chartColors:{background:"#e4e3e3",foreground:"#0090d4"},defaults:{color:"#4560eb",backgroundcolor:"#4560eb",hovercolor:"#ffffff"},HashtagRegExp:/(?:^|\s|\()(#([^\s\t\n\b\f\r\0\x0B\x1B\!\:\?\;\.\,\)\(\<]+))/g,MentionsRegExp:/(?:^|\s|\()(\@\d+)/gi,MentionsPreviousCharRegExp:/[,(\s]/,FileNameRegExp:/[\\"<>|\0\b\t\n\v\f\r:*?\\/]/g,UrlGroupSitePages:"/SitePages/",delayTimeCacheCalls:5e3,delayTimeCacheCallsIE:7e3,cacheRefreshDelay:o.default.isIE?7e3:5e3,delayProcessPresenceIndicator:1e4,delayRenderScrollToTop:7e3,appRedirectUrl:"/_layouts/15/appredirect.aspx",offsetActivitiesStartPage:5,waitTimeEmbedly:5e3,defaultLanguageLCID:a||1033,waitForAutoSave:12e4,show1MinMessage:59e3,clearSavedMessage:6e4,defaultNumberOfComments:8,TypesFileUpload:{image:{acceptAttribute:"image/*",fileExtensionsRegEx:/^image\/(gif|jpe?g|png)$/i}},Colors:{white:"rgb(255,255,255)",gray:"rgb(240,242,244)"},defaultDimensionsCarousel:[{dimensions:[498,751],liClass:"images__item_big",itemClass:"js-beezy-firstImage"},{dimensions:[221,427],liClass:"images__item_medium",itemClass:"js-beezy-secondImage"},{dimensions:[221,427],liClass:"images__item_medium",itemClass:"js-beezy-thirdImage"}],imagesDimensions:{mySite:{background:{width:1180,height:350},profile:{width:136,height:136}},article:{header:{width:1178,height:400}},corporatePage:{header:{width:778,height:240}},community:{banner:{width:1180,height:350},logo:{width:380,height:380}},aggregate:{banner:{width:1180,height:280}},knowledgeCenter:{banner:{width:1180,height:80}},ideasCampaign:{banner:{width:1200,height:350}},corporateSite:{banner:{width:1920,height:344}},channel:{banner:{width:1180,height:280}},topic:{banner:{width:1180,height:280}}},Type:{ACTIVITY_ANSWER:"activityAnswer",ACTIVITY_COMMENT:"activityComment",ANNOUNCEMENT:"announcement",ANSWER:"answer",BLOG:"blogpost",CALENDAR:"calendar",COLLEAGUES:"Colleagues",COMMUNITY:"Community",COMMUNITY_QUESTION:"communityQuestion",CORPORATEPAGE:"corporatepage",DISCUSSION:"discussion",DOCUMENT:"document",EDITORIALMODULE:"EditorialModule",EVENT:"events",IDEA:"idea",ITEM:"item",IMPACT:"item",KNOWLEDGECENTER:"KnowledgeCenter",LINK:"link",POLL:"poll",POST:"comment",PRAISES:"praise",QUESTION:"question",STANDALONE_BLOG:"StandAloneBlog",STANDALONE_FORUM:"StandAloneForum",STANDALONE_QUESTIONS:"StandAloneQuestions",STANDALONE_WIKI:"StandAloneWiki",STICKYANNOUNCEMENT:"stickyannouncement",STORY:"story",TASK:"task",WIKI:"wikipage",IDEAS_CAMPAIGN:"IdeasCampaign",EXTENDEDIDEA:"extendedidea",GROUPSECTIONPAGE:"groupsectionpage",SHARE:"share",SHARE_APP:"shareapp",DELETED:"deleted",DELETED_APP:"deletedApp",ADAPTIVECARD:"adaptivecard",ACTIONCARD:"actioncard",CORPORATESITE:"CorporateSite"}};l.typesActivitiesShowMore=[l.Type.POLL,l.Type.PRAISES,l.Type.COMMUNITY,l.Type.SHARE,l.Type.POST],l.numberLinesMessageActivity={Community:5,poll:4,praise:4,share:5,comment:5,calendar:5},l.NotificationGroupType={StandAloneWiki:"wiki",StandAloneBlog:"blog",StandAloneForum:"forum",Community:"community",IdeasCampaign:"ideas campaign",KnowledgeCenter:"knowledge center"},l.Type.getKey=function(t){return Object.keys(l.Type).map((function(t){return{key:t,value:l.Type[t]}})).find((function(e){return e.value===t})).key},l.ActivityTypesPluralLiterals={blogpost:Object(n.translate)("Blogs"),calendar:Object(n.translate)("Events"),comment:Object(n.translate)("Updates"),discussion:Object(n.translate)("Discussions"),idea:Object(n.translate)("Ideas"),poll:Object(n.translate)("Polls"),praise:Object(n.translate)("Praises"),question:Object(n.translate)("Questions"),task:Object(n.translate)("Tasks"),wikipage:Object(n.translate)("Wikis")},l.ToolsLiterals={blog:Object(n.translate)("Blog"),wiki:Object(n.translate)("Wiki"),ideas:Object(n.translate)("Ideas"),calendar:Object(n.translate)("Calendar"),tasks:Object(n.translate)("Tasks"),discussion:Object(n.translate)("Discussions"),questions:Object(n.translate)("Questions"),polls:Object(n.translate)("Polls"),files:Object(n.translate)("Files"),folders:Object(n.translate)("Folders"),links:Object(n.translate)("Links"),forum:Object(n.translate)("Forum"),praises:Object(n.translate)("Praises"),updates:Object(n.translate)("Updates")},l.A11yLiterals={opensNewTab:"(".concat(Object(n.translate)("opens new browser tab"),")")},l.ToolsUrls={files:"/sitepages/Files.aspx"},l.FilterTypes=function(){return{post:{value:"comment",label:Object(n.translate)("Posts")},question:{value:"question",label:Object(n.translate)("Questions")},praise:{value:"praise",label:Object(n.translate)("Praise")},poll:{value:"poll",label:Object(n.translate)("Polls")},idea:{value:"idea",label:Object(n.translate)("Ideas")},blog:{value:"blogpost",label:Object(n.translate)("Blogs")},wiki:{value:"wikipage",label:Object(n.translate)("Wikis")},discussion:{value:"discussion",label:Object(n.translate)("Discussions")},event:{value:"calendar",label:Object(n.translate)("Calendar")},task:{value:"task",label:Object(n.translate)("Task")}}},l.Tool={DOCUMENT:"files",LINKS:"links",POLL:"polls",DISCUSSION:"forum",QUESTION:"questions",IDEA:"ideas",CALENDAR:"calendar",BLOG:"blog",UPDATES:"updates",WIKI:"wiki",TASK:"tasks",PRAISES:"praises",POST:"post",KNOWLEDGE:"knowledge",STORIES:"stories",STICKYANNOUNCEMENT:"stickyannouncement",CORPORATEPAGES:"corporatepages"},l.ActivityShareNotificationLabels={blogpost:"shared your post",calendar:"shared your event",comment:"shared your update",corporatepage:"shared your page",discussion:"shared your discussion",document:"shared your file",extendedidea:"shared your idea",idea:"shared your idea",item:"shared your item",poll:"shared your poll",praise:"shared your praise",question:"shared your question",story:"shared your article",task:"shared your task",wikipage:"shared your wikipage"},l.ActivityTypeText={blogpost:Object(n.translate)("Blog post"),calendar:Object(n.translate)("Event"),comment:Object(n.translate)("Update"),corporatepage:Object(n.translate)("Page"),discussion:Object(n.translate)("Discussion"),document:Object(n.translate)("File"),extendedidea:Object(n.translate)("Idea"),idea:Object(n.translate)("Idea"),item:Object(n.translate)("item"),poll:Object(n.translate)("Poll"),praise:Object(n.translate)("Praise"),question:Object(n.translate)("Question"),story:Object(n.translate)("Story"),task:Object(n.translate)("Task"),wikipage:Object(n.translate)("Wiki")},l.ActivitySnippetImageClass={comment:"icon--update-big",calendar:"icon--event-big",discussion:"icon--discussion-big",document:"icon--attachment-big",question:"icon--question-big",praise:"icon--praise-big",poll:"icon--poll-big",idea:"icon--idea-big",item:"icon--item-big",blogpost:"icon--blog-post-big",wikipage:"icon--wiki-page-big",task:"icon--task-big",extendedidea:"icon--idea-big",deleted:"icon--deleted-big"},l.Tool.getKey=function(t){var e=Object.keys(l.Tool).map((function(t){return{key:t,value:l.Tool[t]}})).find((function(e){return e.value===t}));return e?e.key:""},l.PublishingTool={wikipage:"wiki",blogpost:"blog",idea:"ideas",question:"questions"},l.Wall={Filters:{HashTags:"HashTags",User:"User",Dates:"Dates"}},l.DiscoverCard={TAGS:".o-card__trending-topics",MostActive:".o-card__MostActive",MostRecent:".o-card__MostRecent",Active:".o-card__Active",Upcoming:".o-card__Upcoming",TopContributors:".o-card__top-contributors",TopPraises:".o-card__top-praised"},l.TypeDiscover={TagCloud:"TagCloud",MostActive:"MostActive",MostRecent:"MostRecent",Active:"Active",Upcoming:"Upcoming",TopContributors:"TopContributors",TopPraises:"TopPraises",SuggestedPeople:"SuggestedPeople",RecommendedComm:"RecommendedComm",SuggestedAnswers:"SuggestedAnswers",NewContent:"NewContent"},l.Tools=function(){return{updates:{label:Object(n.translate)("Posts"),view:"Post",tooltip:Object(n.translate)("Post an update"),classes:"sharebox-post"},blog:{label:Object(n.translate)("Blogs"),view:"Blog",tooltip:Object(n.translate)("Write a blog post"),classes:"sharebox-blog"},wiki:{label:Object(n.translate)("Wikis"),view:"Wiki",tooltip:Object(n.translate)("Create a wiki page"),classes:"sharebox-wiki"},ideas:{label:Object(n.translate)("Ideas"),view:"Idea",tooltip:Object(n.translate)("Share an idea"),classes:"sharebox-idea"},calendar:{label:Object(n.translate)("Calendar"),view:"Calendar",tooltip:Object(n.translate)("Share an event"),classes:"sharebox-event"},tasks:{label:Object(n.translate)("Task"),view:"Task",tooltip:Object(n.translate)("Add a task"),classes:"sharebox-task"},forum:{label:Object(n.translate)("Discussion"),view:"Discussion",tooltip:Object(n.translate)("Add a discussion"),classes:"sharebox-forum"},questions:{label:Object(n.translate)("Questions"),view:"Question",tooltip:Object(n.translate)("Ask a question"),classes:"sharebox-question"},polls:{label:Object(n.translate)("Polls"),view:"Poll",tooltip:Object(n.translate)("Start a poll"),classes:"sharebox-poll"},praises:{label:Object(n.translate)("Praises"),view:"Praise",tooltip:Object(n.translate)("Praise your colleagues"),classes:"sharebox-praise"},comments:{label:Object(n.translate)("Comments"),view:"Comment",tooltip:Object(n.translate)("Add a comment"),classes:"sharebox-comment"}}},l.Feeds={Modes:{PAGINATED:"Paginated",SHOWMORE:"More",LOADMORE:"LoadMore"}},l.Groups={Types:["Moderated","Private","Public"],Status:["Active","Archived"]},l.ActivityViewMode={FEED:"feed",CARD:"card"},l.AttachmentType={DOCUMENT:"document",VIDEO:"video",SLIDESHOW:"slideshow",LINK:"link",MEDIA:"media"},l.ViewByType={ACTIVITYANSWER:"comments",ACTIVITYCOMMENT:"comments",COMMENT:"updates",PRAISE:"praises",POLL:"polls"},l.ViewModes={VIEW:"VIEW",EDIT:"EDIT",OTHER:"OTHER",FILTERED:"FILTERED"},l.PAGE={DASHBOARD:"DASHBOARD",NEWSFEED:"NEWSFEED"},l.FileExtensionsUris={doc:{uri:"ms-word:ofv|u|http://",extensions:[".doc",".docx"]},excel:{uri:"ms-excel:ofv|u|http://",extensions:[".xls",".xlsx"]},ppt:{uri:"ms-powerpoint:ofv|u|http://",extensions:[".ppt",".pptx"]},visio:{uri:"ms-visio:ofv|u|http://",extensions:[".vsd",".vsdx"]},access:{uri:"ms-access:ofv|u|http://",extensions:[".accdb"]},project:{uri:"ms-project:ofv|u|http://",extensions:[".mpp"]},infopath:{uri:"ms-infopath:ofv|u|http://",extensions:[".xsn"]}},l.ManageSettingsHashes={orgStructure:"#orgStructure",audiences:"#audiences",navigation:"#navigation",hero:"#hero",allapps:"#apps/allapps",categories:"#apps/categories",discoveryCards:"#discoveryCards",additionalUPS:"#additionalUPS",localEntities:"#localEntities",tags:"#tags"},l.PagesWithoutMaster=["editorialdashboard","createarticle","createcorporatepage","managesettings","corporatepagedashboard"],l.Dashboard={ALL_DATES:Object(n.translate)("All dates"),ALL_FUNCTIONS_ID:-1,ALL_FUNCTIONS:Object(n.translate)("All roles"),ALL_CHANNELS:Object(n.translate)("All channels"),MY_CHANNELS:Object(n.translate)("My channels"),ALL_AUTHORS:Object(n.translate)("All authors"),MY_TOPICS:Object(n.translate)("My topics"),ALL_TOPICS:Object(n.translate)("All topics")},l.Roles={editor:{id:3,value:Object(n.translate)("Editor"),selectorValue:Object(n.translate)("As editor")},writer:{id:2,value:Object(n.translate)("Writer"),selectorValue:Object(n.translate)("As writer")},guestWriter:{id:1,value:Object(n.translate)("Guest writer"),selectorValue:Object(n.translate)("As guest writer")}},l.Editorial={roles:[l.Roles.editor,l.Roles.writer],guestWriterRequestResponses:{approve:"approve",reject:"reject"},viewDraftUrl:"/SitePages/Story.aspx#view"},l.Corporate={roles:[l.Roles.editor,l.Roles.writer,l.Roles.guestWriter],toolsRelativeUrl:{question:"#Questions",media:"#Files",document:"#Files"},typeWidgets:{relatedcorporatepages:"pages",relatedstories:"stories"},createNewPageUrl:"/SitePages/Page.aspx",editPageUrl:"/SitePages/Page.aspx#edit",viewDraftUrl:"/SitePages/Page.aspx#view",editGuestAuthorUrl:"/SitePages/Page.aspx?guestauthor=true#edit"},l.CreationSiteCollections={blog:"BlogCreationSiteCollection",wiki:"WikiCreationSiteCollection",forum:"ForumCreationSiteCollection",communities:"CommunityCreationSiteCollection"},l.DropPosition={LEFT:"LEFT",CENTER:"CENTER",RIGHT:"RIGHT"},l.DropVerticalPosition={TOP:"TOP",BOTTOM:"BOTTOM"},l.DropOffsetFilter={start:{TOP:20,LEFT:2},other:{TOP:20,LEFT:-10}},l.AutosaveTime=6e4,l.StatusColorLabel={approved:"ed-status-label--approved",rejected:"ed-status-label--rejected",draft:"ed-status-label--draft",scheduled:"ed-status-label--scheduled",published:"ed-status-label--published",pending:"ed-status-label--pending-review",expired:"ed-status-label--expired"},l.Status={schedule:Object(n.translate)("Schedule"),published:Object(n.translate)("Published"),draft:Object(n.translate)("Draft")},l.StoryFilterStatusValues=[{id:-1,value:Object(n.translate)("All status")},{id:0,value:Object(n.translate)("Draft")},{id:1,value:Object(n.translate)("Scheduled")},{id:2,value:Object(n.translate)("Pending review")},{id:3,value:Object(n.translate)("Approved")},{id:4,value:Object(n.translate)("Rejected")},{id:5,value:Object(n.translate)("Published")}],l.CorporatePageFilterStatusValues=[{id:-1,value:Object(n.translate)("All status")},{id:0,value:Object(n.translate)("Draft")},{id:1,value:Object(n.translate)("Pending review")},{id:2,value:Object(n.translate)("Approved")},{id:3,value:Object(n.translate)("Rejected")},{id:4,value:Object(n.translate)("Published")},{id:5,value:Object(n.translate)("Expired")}],l.ArticleStatusProperty={draft:{id:0,value:"draft"},scheduled:{id:1,value:"scheduled"},pendingReview:{id:2,value:"pending"},approved:{id:3,value:"approved"},rejected:{id:4,value:"rejected"},published:{id:5,value:"published"}},l.CorporatePageStatusProperty={draft:{id:0,value:"draft"},pendingReview:{id:1,value:"pending"},approved:{id:2,value:"approved"},rejected:{id:3,value:"rejected"},published:{id:4,value:"published"},expired:{id:5,value:"expired"}},l.Spinners={classWhite:"spinner-typing--white",classGrey:"spinner-typing--grey",classBlue:"spinner-typing--blue"},l.CalendarEditFormUrl="/Lists/Calendar/EditForm.aspx?ID=",l.EmptyStateType={listStories:"listStories",listCategories:"listCategories",listUserStories:"listUserStories",listAudiences:"listAudiences",orgStructure:"orgStructure",wikiRoot:"wikiRoot",allChannels:"allChannels",allTopics:"allTopics",sortableList:"sortableList",defaultFeed:"default-feed",landingCorporatePages:"landingCorporatePages",feedCorporatePagesFeatured:"corporatePagesFeatured",feedCorporatePagesForYou:"corporatePagesForYou",noResultsFound:"noResultsFound",listPages:"listPages",metadataFilter:"metadataFilter",modalMetadata:"modalMetadata",metadataKCSettings:"metadataKCSettings",corporatePagesAddedTopicsMySite:"corporatePagesAddedTopicsMySite",teamCorporateSite:"teamCorporateSite",corporatePages:"corporatePages"},l.CharKey={enter:13,escape:27},l.Key={enter:"Enter"},l.ComparisonOperators=[{Id:"Equals",Value:Object(n.translate)("Equals")},{Id:"StartsWith",Value:Object(n.translate)("StartsWith")},{Id:"EndsWith",Value:Object(n.translate)("EndsWith")},{Id:"Contains",Value:Object(n.translate)("Contains")},{Id:"Greater",Value:Object(n.translate)("Greater")},{Id:"GreaterOrEqual",Value:Object(n.translate)("GreaterOrEqual")},{Id:"Less",Value:Object(n.translate)("Less")},{Id:"LessOrEqual",Value:Object(n.translate)("LessOrEqual")}],l.MaxLevelCreateChildsTree=5,l.ICIdeaStates={GRADUATED:"graduated",REFINED:"refined"},l.SettingsPages={IdeasCampaign:"/SitePages/ideas campaign settings.aspx",KnowledgeCenter:"/SitePages/knowledge center settings.aspx",Community:"/SitePages/Community Settings.aspx",CorporateSite:"/SitePages/Corporate Site Settings.aspx",StandAloneBlog:"/SitePages/Blog Settings.aspx",StandAloneWiki:"/SitePages/Wiki Settings.aspx",StandAloneQuestions:"/SitePages/Questions Settings.aspx",StandAloneForum:"/SitePages/Forum Settings.aspx",extendedidea:"/SitePages/Idea Edit.aspx"},l.EndpointByType={CorporateSite:"/CorporateSites"},l.StartTabs={Places:"Places",People:"People",Discover:"Discover"},l.StartViews={ALL:"Activities",BOOKMARKS:"Bookmarks",DISCOVER:"Discover",FOLLOWTAG:"FollowTag",PEOPLE:"People",TASKS:"Tasks"},l.NotAllowedProviders=["Microsoftonline","Office","Salesforce"],l.PageKeysForNotificationsConfig={people:["start"],hashtags:["start"]},l.textErrors={fieldRequired:Object(n.translate)("This field is required"),unauthorisedTool:Object(n.translate)("This tool is only available for the owners of the community")},l.ClassesPresenceIndicatorByStatus={0:"ms-spimn-img ms-spimn-presence-online-10x10x32",1:"ms-spimn-img ms-spimn-presence-offline-10x10x32",2:"ms-spimn-img ms-spimn-presence-away-10x10x32",3:"ms-spimn-img ms-spimn-presence-busy-10x10x32",4:"ms-spimn-img ms-spimn-presence-away-10x10x32",5:"ms-spimn-img ms-spimn-presence-busy-10x10x32",6:"ms-spimn-img ms-spimn-presence-away-10x10x32",7:"ms-spimn-img ms-spimn-presence-busy-10x10x32",8:"ms-spimn-img ms-spimn-presence-away-10x10x32",9:"ms-spimn-img ms-spimn-presence-donotdisturb-10x10x32",10:"ms-spimn-img ms-spimn-presence-busy-10x10x32",11:"ms-spimn-img ms-spimn-presence-online-oof-10x10x32",12:"ms-spimn-img ms-spimn-presence-offline-oof-10x10x32",13:"ms-spimn-img ms-spimn-presence-away-oof-10x10x32",14:"ms-spimn-img ms-spimn-presence-busy-oof-10x10x32",15:"ms-spimn-img ms-spimn-presence-donotdisturb-oof-10x10x32",16:"ms-spimn-img ms-spimn-presence-away-10x10x32",17:"ms-spimn-img ms-spimn-presence-away-oof-10x10x32",18:"ms-spimn-img ms-spimn-presence-blocked-10x10x32",19:"ms-spimn-img ms-spimn-presence-busy-10x10x32",20:"ms-spimn-img ms-spimn-presence-busy-oof-10x10x32",21:"ms-spimn-img ms-spimn-presence-donotdisturb-10x10x32"},l.Pages={AllComms:"/sitepages/All%20Communities.aspx"},l.MetadataProperties={TotalOfPeopleVoted:"TotalOfPeopleVoted",IsMultiOption:"IsMultiOption"},l.Widgets={Private:{documents:"Documents",myBlog:"MyBlog",myForums:"MyForums",myWiki:"MyWiki"},Public:{aboutMe:"AboutMe",blogs:"Blogs",communities:"Communities",endorsements:"Endorsements",followers:"UsersFollowers",following:"UsersFollowing",ideas:"Ideas",mediaGallery:"MediaGallery",praises:"Praises",questions:"Questions",wikis:"Wikis"},Configurable:{communities:"Communities",followers:"UsersFollowers",following:"UsersFollowing",praises:"Praises"}},l.CommunityWidgetsOptions={Owners:Object(n.translate)("Owners"),Tags:Object(n.translate)("Tags"),Latest:Object(n.translate)("Latest"),Highlighted:Object(n.translate)("Highlighted"),Popular:Object(n.translate)("Popular")},l.GroupTypeText={Community:Object(n.translate)("Community"),CorporateSite:Object(n.translate)("Corporate Site"),IdeasCampaign:Object(n.translate)("Ideas Campaign"),KnowledgeCenter:Object(n.translate)("Knowledge Center"),StandAloneWiki:Object(n.translate)("Wiki"),StandAloneBlog:Object(n.translate)("Blog"),StandAloneForum:Object(n.translate)("Forum")},e.default=l},711:function(t,e,i){"use strict";e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=document.createElement(t);return e.length&&e.forEach((function(t){i.setAttribute(t.name,t.value)})),document.body.appendChild(i),i}},712:function(t,e,i){"use strict";var n=i(595);i.d(e,"isEscKey",(function(){return n.isEscKey})),i.d(e,"isEnterKey",(function(){return n.isEnterKey})),i.d(e,"KEYS",(function(){return n.KEYS}))},72:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(10),l=i(13),c=i(2),u=i(2411),d=i.n(u),h=i(12),f=i(7),p=i(8),m=i(18),g=i(46),v=i(30),b=i(15),y=i(17),C=i(5);function w(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?w(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var x=l.default.extend({template:d.a,classes:{feedHeaderIcon:"icon--plus-stroke-circle",aggregatedHeaderIcon:"icon--aggregated-header-title",isDisabled:"is-disabled"},mode:f.default.Feeds.Modes.PAGINATED,events:{"click .js-order":"order","click .js-newpost":"showShareBox","click .js-newsection":"showNewSection","click .js-gotoPage":"gotoPage","click .js-prevPage":"prevPage","click .js-nextPage":"nextPage","click .js-alert-close":"reset","click .js-view-more":"more","click .js-view-loadmore":"loadMore"},tabItems:[],initialize:function(t){this.options=t,this.communityId=this.options.communityId,this.hideNewItem=this.options.hideNewItem||!1,this.hideTabs=this.options.hideTabs||!1,this.hideHeader=this.options.hideHeader||!1,this.headerClasses=this.options.headerClasses,this.title=this.options.title,this.mode=this.options.mode||this.mode,this.baseMode=this.options.mode||this.mode,this.isPaginated=this.mode===f.default.Feeds.Modes.PAGINATED,this.icon=this.options.icon||(this.isPaginated?this.classes.feedHeaderIcon:this.classes.aggregatedHeaderIcon),this.enableDropDown=this.options.enableDropDown||!1,this.tabItems=this.options.tabItems,this.dropdownItems=this.options.dropdownItems,this.newItemText=this.options.newItemText||Object(c.translate)("new page"),this.newSectionText=this.options.newSectionText,this.disableExternalFilters=this.options.disableExternalFilters,this.goBackText=this.options.goBackText||Object(c.translate)("View less"),this.feedTemplate=this.options.feedTemplate,this.hideContainerHeader=this.options.hideContainerHeader||!1,this.showSnippetFeed=t.showSnippetFeed||!1,this.disableInitialLoad=t.disableInitialLoad||!1,this.hideDotDotDot=t.hideDotDotDot||!1,this.templateFeedManager=t.templateFeedManager||this.template,this.sectionAttributeName=this.options.sectionAttributeName||"Section",this.orderedBy=t.orderedBy||"InformationalDateTime",this.desc=t.desc||!1,this.orderBy=t.orderBy||"created",this.type=t.type||"",this.feedType=t.type,this.templateItem=this.options.templateItem,this.collection=this.options.collection,this.take=this.options.take,this.itemsPerPage=this.options.itemsPerPage,this.collectionOptions=this.options.collectionOptions,this.titleLines=this.options.titleLines,this.renderedViews={},this.start=this.options.start||0,this.toolFeed=t.toolFeed,this.notLoadDataOnInit=t.notLoadDataOnInit,this.queryString=C.default.getQueryString(),this.tagFilterTab=this.options.tagFilterTab||"Created",this.initializeShareBox(),this.disableExternalFilters||(h.default.subscribe("feed","filter",this.setFilter.bind(this)),h.default.subscribe("tagcloud","filter",this.setFilterByHashtag.bind(this)),h.default.subscribe("search","filter",this.setFilterSearch.bind(this)),h.default.subscribe("metadata","filter",this.setFilterMetadata.bind(this))),this.applyDecorators(),h.default.subscribe("ReportAbuse","report",this.reportAbuse.bind(this))},onShareboxDialogClose:function(){this.renderFeed()},applyDecorators:function(){var t=this;this.options.decorators&&this.options.decorators.length&&this.options.decorators.forEach((function(e){new e(t).initializeDecorator()}))},initializeShareBox:function(){this.items=this.options.items},setElement:function(t){x.__super__.setElement.call(this,t),this.renderedViews=[]},render:function(){this.startLoading(),this.hideNewItem=this.hideNewItem||p.default.isToolReadOnly(this.toolFeed)&&!beezyCurrentGroup.IsCurrentUserWebAdmin;var t={tabItems:this.tabItems,newItemText:this.newItemText,newSectionText:this.newSectionText,hideNewItem:this.hideNewItem,hideTabs:this.hideTabs,hideHeader:this.hideHeader,headerClasses:this.headerClasses,title:this.title,isPaginated:this.isPaginated,icon:this.icon,enableDropDown:this.enableDropDown,isStandalone:p.default.isStandAloneGroup(),hideContainerHeader:this.hideContainerHeader,enableTextSearch:this.options.collection.textSearch,ariaLabelNavigation:Object(c.translate)(this.options.ariaLabelNavigation)};return this.$el.html(this.templateFeedManager(t)),"links-knowledgecenter"===beezyContext.CurrentPageKey&&this.$el.addClass("remove-links-kc"),this.enableDropDown&&(this.renderDropdown(this.$(".js-dropdown")),this._select.on("change",this._onChangeSelect.bind(this))),this.moreFeedBtn=this.$el.find(".js-view-loadmore"),this.renderFeed(),this},getItemView:function(t){return this.tabItems.find((function(e){return e.id===t}))},existsView:function(t){return this.renderedViews.find((function(e){return e.id===t}))},getTabFromOrderBy:function(){return this.$el.find("[data-id=".concat(this.orderBy,"]"))},renderFeed:function(){this.createFeedView(),this.queryString.skill&&this.setFilterByHashtag(this.queryString.skill),this._changeTab(this.getTabFromOrderBy()),this.feed.render()},showShareBox:function(t){var e=this;if(t.preventDefault(),b.default.isReadOnly())return y.default.showReadOnlyModal();Promise.all([i.e(0),i.e(172)]).then(i.bind(null,1211)).then((function(t){var i=t.default;e.sharebox=i({getItems:function(){return e.items},callbackClose:e.onShareboxDialogClose})}))},showTabs:function(t){this.$(".js-order").toggle(t)},showNewSection:function(){if(b.default.isReadOnly())return y.default.showReadOnlyModal();this.feed.newSection()},showHeaderOptions:function(t){this.$(".js-feed-header").toggle(t)},setFilter:function(t){this.feed.setFilter(t)},setFilterByHashtag:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(this.feed.tree)this.changeOrder(r()(this.$el.find("[data-order=Created]")),!1),this.feed.setFilterByHashtag(t,null,n);else{if(this.mode=f.default.Feeds.Modes.PAGINATED,this.setPagination(!0),this.$el.find("[data-id=".concat(this.orderBy,"]")).length>0)return this._changeTab(r()(this.$el.find("[data-id=".concat(this.orderBy,"]")))),this.feed.collection.setOrder(this.tagFilterTab.toLowerCase()),this.trigger("filtering"),this.feed.setFilterByHashtag(t,i,n),this.trigger("filtered"),void this._scrollToTop();this.prerender(this.feed),this.trigger("filtering"),this.feed.setFilterByHashtag(t,i,n),this.trigger("filtered")}},setFilterSearch:function(t,e,i){this.mode=e,this.mode===f.default.Feeds.Modes.PAGINATED&&this.setPagination(!0),this.prerender(this.feed),this.feed.setFilterSearch(t,i),this.trigger("filteredsearch"),this.startLoading(this.$el.find(".js-aggregated-header").get(0))},setFilterMetadata:function(t){this.mode=f.default.Feeds.Modes.PAGINATED,this.setPagination(!0),this.prerender(this.feed),this.feed.setFilterMetadata(t),this.trigger("filtering"),this.startLoading(this.$el.find(".js-aggregated-header").get(0)),this.trigger("filtered")},removeFilter:function(){this.mode=this.baseMode,this.baseMode===f.default.Feeds.Modes.PAGINATED&&this.setPagination(!0),this.prerender(this.feed),this.trigger("removeFilter")},addEventsToNewFeedView:function(){var t=this;this.feed.on("removeFilter",this.removeFilter.bind(this)),this.feed.on("loading",(function(e){t.trigger("loading",e)})),this.feed.on("failed",(function(e){if(t.stopLoading(),t.feed._render(),a.default.StatusCodes.UNKNOWN_OR_CANCELED!==e.status){var i=e&&e.statusCode?"".concat(e.statusCode||"",":").concat(e.status||"","\n").concat(e.message):Object(c.translate)("Failed request. Please, if the problem continues contact your administrator");console.error(i)}})),this.feed.on("loaded",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.isPaginated?t.$(".js-footer-view-more").show():t.$(".js-footer-view-more").hide(),t.baseMode===f.default.Feeds.Modes.PAGINATED?t.$(".js-view-more").hide():t.$(".js-view-more").text(t.isPaginated?t.goBackText:Object(c.translate)("View more")),t.moreFeedBtn&&t.moreFeedBtn[this.collection.hasMoreItems?"show":"hide"](),t.trigger("loaded",T({collection:t.feed?t.feed.collection:[]},e)),t.stopLoading(),t.stopLoading(t.$el.find(".js-aggregated-header").get(0)),t.emptyState?t.feed.hasItems&&t.feed.hasItems()||t.feed.collection.length||t.feed.collection.filtered?t.removeEmptyState():t.renderEmptyState():t.removeEmptyState()})),this.feed.on("noItemsLoaded",(function(e){t.trigger("noItemsLoaded",e)})),this.feed.on("selected",(function(e){t.trigger("selected",e)})),this.feed.on("filtered",(function(e){t.trigger("filtered",e)}))},createFeedView:function(){var t=this;if(this.renderedViews[this.orderBy])this.feed=this.renderedViews[this.orderBy],this.prerender(this.feed);else{var e=this.getItemView(this.orderBy);null!=e&&e.view?(this.feed=new e.view({el:this.$(".js-feed-container"),collection:this.collection,collectionOptions:e.optionsCollection,communityId:this.communityId,desc:this.desc,emptyState:e.emptyState?e.emptyState:null,emptyStateDOM:e.emptyStateDOM,feedType:this.feedType,grouptype:e.grouptype||"",hasLink:e.hasLink||!1,hideNewItem:this.options.hideNewItem,isPaginated:this.isPaginated,itemsPerPage:this.itemsPerPage,mode:this.mode,noTools:this.options.noTools||!1,notLoadDataOnInit:this.notLoadDataOnInit,orderBy:this.orderedBy,sectionAttributeName:this.sectionAttributeName,sectionModel:this.options.sectionModel,showEmptyState:e.showEmptyState||!1,showSnippetFeed:this.showSnippetFeed,start:this.start,status:e.status||"",take:this.take,template:this.feedTemplate,templateItem:this.templateItem,titleLines:this.titleLines,type:this.type,hideDotDotDot:this.hideDotDotDot||!1}),this.addEventsToNewFeedView(),this.renderedViews[this.orderBy]=this.feed):null!=e&&e.isLink&&null!=e&&e.redirectUrl&&m.default.redirectToUrl(e.redirectUrl)}this.on("loaded",(function(){"tree"===t.orderBy&&t.feed.tree.maxNodesCollapse&&t.feed.tree.nodesCount>t.feed.tree.maxNodesCollapse&&!1===t.feed.tree.collapsed&&(t.feed.tree.$container.tree("setOption","slide",!1),t.feed.expandCollapse(),t.feed.tree.$container.tree("setOption","slide",!0))}))},updateFeedView:function(){},changeOrder:function(t,e){var i=this._getTabOptions(t);t.hasClass("is-selected")?this.reset():(this._changeTab(t),this._changeFeed(i),"function"==typeof this.feed.removeFilter&&this.feed.removeFilter(),e&&this._setupOrder(t,i))},order:function(t){t.preventDefault(),r()(t.currentTarget).hasClass(this.classes.isDisabled)||this.changeOrder(r()(t.currentTarget),!0)},refresh:function(){this.startLoading(this.$el.find(".js-aggregated-header").get(0)),this.feed.collection.reset(),this.feed.clearHtml&&this.feed.clearHtml(),this.createFeedView(),this.feed.refresh()},reset:function(t){this.mode=f.default.Feeds.Modes.SHOWMORE,this.setPagination(!1),this.prerender(this.feed);var e={stop:!1};this.trigger("reset",e),e.stop||this.feed.reset(t)},resetPagination:function(){this.setPagination(!1)},more:function(t){this.trigger("paginated"),t.preventDefault(),this.mode=this.isPaginated?f.default.Feeds.Modes.PAGINATED:f.default.Feeds.Modes.SHOWMORE,this.setPagination(!this.isPaginated),this.isPaginated?this.$el.addClass("is-paginated"):this.$el.removeClass("is-paginated"),this.startLoading(this.$el.find(".js-aggregated-header").get(0)),this.renderFeed()},loadMore:function(t){this.trigger("loadmore"),t.preventDefault(),this.feed.isLoadMore=!0,this.renderFeed()},reportAbuse:function(){m.default.redirectToUrl(g.default.getGroupUrl())},setPagination:function(t){this.isPaginated=t,this.$(".js-view-more").text(this.isPaginated?this.goBackText:Object(c.translate)("View more"))},gotoPage:function(t){t.preventDefault();var e=Number(r()(t.currentTarget).text());this.feed.collection.gotoPage(e).then(this.feed._render).then(this._scrollToTop)},prevPage:function(t){t.preventDefault(),this.feed.collection.prevPage().then(this.feed._render).then(this._scrollToTop)},nextPage:function(t){t.preventDefault(),this.feed.collection.nextPage().then(this.feed._render).then(this._scrollToTop)},renderDropdown:function(t){return this._select=r()('<select id="options"/>'),this.addSelectOptions(this.dropdownItems),t.append(this._select),this},addSelectOptions:function(t){t.forEach(this.addSelectOption,this)},addSelectOption:function(t){var e=r()("<option />").val(t.Id).text(t.Title);this._select.append(e)},prerender:function(t){t.orderBy=this.orderedBy,t.type=this.type,t.titleLines=this.titleLines,t.mode=this.mode,t.isPaginated=this.isPaginated,this.moreFeedBtn&&this.moreFeedBtn.hide()},_onChangeSelect:function(){var t=this.$el.find("#options").val();this.feed.collection.changeDates(t).then(this.feed._render)},_changeTab:function(t){this.$(".js-order").removeClass("is-selected"),this.$(".js-order a").attr("aria-selected",!1),t.addClass("is-selected"),t.find("a").attr("aria-selected",!0),this.trigger("tabChanged",t)},_changeFeed:function(t){this.orderBy=t.id,this.createFeedView(),this.feed.collection.reset(),this.updateFeedView()},_setupOrder:function(t,e){e.type?(this.feed.setType(e.type),h.default.publish("feed","type",e.type)):("assigned"===e.order&&this.feed.collection.setUser(beezyCurrentUser),this.feed.setOrder(t,this.orderBy),h.default.publish("feed","order",this.orderBy)),this.orderedBy=this.orderBy},_getTabOptions:function(t){return{type:t.data("type"),order:t.data("order"),id:t.data("id")}},_hasTaps:function(){return this.$(".js-order").length>0},_cancelNextRefresh:function(){var t=this;this.feed.on("loading",(function e(i){t.feed.off("loading",e),i.cancel=!0}))},_getTab:function(t){return this.$('.js-order[data-id="'.concat(t,'"]'))},renderEmptyState:function(){this.$(".js-empty-state").show()},removeEmptyState:function(){this.$(".js-empty-state").hide()},hideTab:function(){this.$el.hide()},showTab:function(){this.$el.show()},_scrollToTop:function(){Object(v.sharePointItems)().content.animate({scrollTop:0},400)}});e.default=x},73:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(46),s=i(18),r=i(3),a=i.n(r),l=i(4),c=i.n(l),u=i(10),d=i(12),h=i(303);window.noop=function(){};var f={};f.Business={},f.util={},f.PeopleWorkingWith,f.Views={Mixins:{},Attachments:{}},f.Models={},f.Collections={},f.currentPage="",f.embeddedLinks={},f.WebParts={},f.Helpers={},Date.prototype.toISOString||function(){function t(t){var e=String(t);return 1===e.length&&(e="0".concat(e)),e}Date.prototype.toISOString=function(){return"".concat(this.getUTCFullYear(),"-").concat(t(this.getUTCMonth()+1),"-").concat(t(this.getUTCDate()),"T").concat(t(this.getUTCHours()),":").concat(t(this.getUTCMinutes()),":").concat(t(this.getUTCSeconds()),".").concat(String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5),"Z")}}(),c.a.browser.webkit&&c()(document).ready((function(){function t(){void 0!==window._spBodyOnLoadWrapper?void 0===window._spBodyOnloadCalled&&window._spBodyOnLoadWrapper():setTimeout(t,10)}t()})),"undefined"==typeof _spBodyOnLoadFunctionNames&&(window._spBodyOnLoadFunctionNames=[],window.onload=function(){a.a.each(_spBodyOnLoadFunctionNames,(function(t){window[t].call()}))}),f.GetPeopleWorkingWith=function(t){var e="".concat(n.default.getApiUrlv2(),"/Users/Current/WorkingWith");return u.default.getJSONHeader(e,{}).then((function(e){f.PeopleWorkingWith=e,t(e)}))},d.default.subscribe("quickprofile","show-latest-activity",(function(t,e){window.Wall?window.Wall.ByUser(t,e):s.default.redirectToUrl("".concat(beezySettings.BaseSiteCollectionUrl,"?user=").concat(t,"&fullname=").concat(e))})),d.default.subscribe("microtag","show-latest-activity",(function(t){if(function(t){var e=!1;return"channelTag"===t.get("TagType")&&(e=!0),e}(t))s.default.redirectToUrl("".concat(o.default.getGroupUrl(),"/SitePages/Channel.aspx?ChannelId=").concat(t.get("Id")));else if(function(t){var e=!1;return"topicTag"===t.get("TagType")&&(e=!0),e}(t))s.default.redirectToUrl("".concat(o.default.getGroupUrl(),"/SitePages/Topic.aspx?topicId=").concat(t.get("Id")));else{var e=t.get("Name").toLowerCase();window.Wall?window.Wall.ByHashtag(e):beezyCurrentGroup?("ideascampaign"!==beezyContext.CurrentPageKey&&"ideascampaignimpactheader"!==beezyContext.CurrentPageKey&&"impact"!==beezyContext.CurrentPageKey||s.default.redirectToUrl("".concat(n.default.getSiteHost()+beezyCurrentGroup.Url,"?tag=").concat(e)),h.default.isCurrentPageStory()?s.default.redirectToUrl("".concat(n.default.getSiteHost()+n.default.getEditorialModule().Url,"/SitePages/Editorial Tag.aspx?Hashtag=").concat(encodeURIComponent(t.get("Name")))):s.default.redirectToUrl("".concat(n.default.getSiteHost()+beezyCurrentGroup.Url,"?hashtag=").concat(e))):"ideascampaign"===beezyContext.CurrentPageKey||"ideascampaignimpactheader"===beezyContext.CurrentPageKey||"impact"===beezyContext.CurrentPageKey?s.default.redirectToUrl("".concat(beezySettings.BaseSiteCollectionUrl,"?tag=").concat(e)):s.default.redirectToUrl("".concat(beezySettings.BaseSiteCollectionUrl,"?hashtag=").concat(e))}})),e.default=f},731:function(t,e,i){"use strict";e.default={ARROW_DOWN:"ArrowDown",ARROW_UP:"ArrowUp",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",ENTER:"Enter",ESC:"Esc",ESCAPE:"Escape",SPACE:" ",TAB:"Tab"}},749:function(t,e,i){"use strict";i.d(e,"dateDefaultFormat",(function(){return n})),i.d(e,"timeDefaultFormat",(function(){return o})),i.d(e,"monthsName",(function(){return a})),i.d(e,"weekdaysName",(function(){return l})),i.d(e,"tooltipTimeAgoFormat",(function(){return r})),i.d(e,"monthDayYear",(function(){return s}));var n="d MMM yyyy",o="HH:mm",s="MMMM dd, yyyy",r="dd MMM yyyy HH:mm (z)",a=["January","February","March","April","May","June","July","August","September","October","November","December"],l=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]},76:function(t,e,i){"use strict";var n=i(2100);i.d(e,"getCurrentGroupLocalEntity",(function(){return n.default}));var o=i(2101);i.d(e,"getCurrentGroupDefaultLanguage",(function(){return o.default}));var s=i(2102);i.d(e,"getCurrentGroupUrl",(function(){return s.default}));var r=i(2103);i.d(e,"getCurrentGroupId",(function(){return r.default}))},768:function(t,e,i){"use strict";i.d(e,"createFocusTrap",(function(){return h}));var n=i(11),o=i.n(n),s=i(1);function r(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,l=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){l=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(l)throw s}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var l=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","object","embed",'[tabindex="0"]',"[contenteditable]"],c=function(t){return Array.from(t.querySelectorAll(l.reduce((function(t,e){return t+(t.length?", ":"")+e}),"")))},u=function(t,e){var i,n;t&&e.some((function(e){return e===document.querySelector(t)}))?null==(n=e[e.findIndex((function(e){return e===document.querySelector(t)}))])||n.focus():null===(i=e[0])||void 0===i||i.focus()},d=function(t){return function(e){var i=t.length&&t[0],n=t.length&&t[t.length-1],o=document.activeElement===i,s=document.activeElement===n;"Tab"===e.key&&(e.shiftKey&&o&&(e.preventDefault(),n.focus()),!e.shiftKey&&s&&(e.preventDefault(),i.focus()))}},h=function(t){var e=t.element,i=t.elementToFocus,n=t.active;if(void 0===n||n){var o=c(e);u(i,o);var s=d(o);e.addEventListener("keydown",s)}};e.default=function(t){var e=t.element,i=t.elementToFocus,n=t.active,a=void 0===n||n,l=t.withObserve,h=void 0!==l&&l,f=Object(s.useState)(),p=o()(f,2),m=p[0],g=p[1];Object(s.useEffect)((function(){a&&e&&g(c(e))}),[a,e]),Object(s.useEffect)((function(){if(a&&h&&e){var t=new MutationObserver((function(t){var i,n=r(t);try{for(n.s();!(i=n.n()).done;){if("childList"===i.value.type){var o=c(e);(null==o?void 0:o.length)!==(null==m?void 0:m.length)&&g(o)}}}catch(t){n.e(t)}finally{n.f()}}));return t.observe(e,{attributes:!0,childList:!0,subtree:!0}),function(){return t.disconnect()}}}),[a,e,null==m?void 0:m.length,h]),Object(s.useEffect)((function(){if(a&&e&&m){u(i,m);var t=d(m);return e.addEventListener("keydown",t),function(){e.removeEventListener("keydown",t)}}}),[m,e,a,i])}},773:function(t,e,i){"use strict";i.r(e);var n=i(57),o=i(1864),s=i(2),r=i(47),a=function(t,e){e||(e={});var i=Object(s.translate)("People who like this post");e.title||(e.title=i);var l=new o.default({el:r.default.createDialogContainer("modal-likers")});l.on("close",(function(){c.hide()}));var c=new n.default(l,{buttons:[]});return(a=function(t,e){l.setUsers(t),l.setTitle(e&&e.title||i),l.render(),c.show()})(t,e)};e.default=a},774:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(5),r=i(26),a=i(10);function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var u=r.default.extend({initialize:function(t,e){this.activity=e.activity,this.comment=e.comment,this.user=e.user},url:function(){return"".concat(s.default.getApiUrlv2(),"/Activities/Report")},report:function(){var t={User:this.user};return this.activity?t.Activity=this.activity:this.comment&&(t.Comment=this.comment),a.default.postJSON(this.url(),c(c({},this.toJSON()),t))}});e.default=u},775:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(13),l=i(20),c=i(861),u=i.n(c),d=a.default.extend({template:u.a,buttons:[],title:"",events:{},initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=t,this._dialog=this.options.dialog,this._registerButtons()},render:function(){var t={title:this.title,buttons:this.buttons};return this.$el.html(this.template(t)),this.$container=this.$(".js-container"),this.$body=this.$(".js-body"),this.renderBody(),this},renderBody:function(){},cancel:function(){this.trigger("cancel")},resetButtons:function(){o.a.each(this.buttons,this.resetButton,this)},resetButton:function(t){var e=this.$(".js-".concat(t.id));e[t.hidden?"hide":"show"](),l.default[t.disabled?"disable":"enable"](e)},_registerButtons:function(){o.a.each(this.buttons,this._addButtonEvent,this)},_addButtonEvent:function(t){var e=t.id;this.events["click .js-".concat(e)]=this[e]?e:r.a.noop}});e.default=d},78:function(t,e,i){"use strict";i.r(e);var n=i(5),o=i(18),s=i(7),r=i(10),a={changeUserLanguage:function(t){r.default.put("".concat(n.default.getApiUrlv2(),"/Users/Current/Language"),JSON.stringify(t)).then((function(){location.reload(!0)}))},showUserProfilePage:function(t){o.default.redirectToUrl(t)},setPersonalSpace:function(t){t.PersonalSpace=n.default.getProfileUrl()+t.Id},getGlobalModules:function(t,e){return null==t?void 0:t.filter((function(t){return t.LocalEntity[e]&&(t.IsCurrentUserMember||t.IsCurrentUserWebAdmin)?t:null}))},getEditorialSettingsHash:function(t){var e=t.SitesModuleEnabled,i=t.AudiencesModuleEnabled,n=t.HeroModuleEnabled,o=t.NavigationModuleEnabled,r=t.AppsModuleEnabled,a=t.DiscoveryCardsModuleEnabled,l=s.default.ManageSettingsHashes,c=l.orgStructure,u=l.audiences,d=l.hero;return[{key:c,value:e},{key:u,value:i},{key:l.navigation,value:o},{key:d,value:n},{key:l.allapps,value:r},{key:l.discoveryCards,value:a}].find((function(t){return!0===t.value}))}};window.ShowUserProfilePage=a.showUserProfilePage,e.default=a},79:function(t,e,i){"use strict";i.r(e);var n=i(27),o=i.n(n),s=i(3),r=i.n(s),a=i(19),l=i.n(a),c=i(10),u=o.a.Collection.extend({pages:1,currentPage:1,itemsPerPage:20,currentData:{},load:function(t){var e=l.a.defer(),i=this;return this.groupId=t&&t.groupId,void 0!==t&&r.a.extend(this.currentData,t),l.a.all([this.getCount(),this.firstPage()]).then((function(t){i.processNumberOfPages(t[0]),e.resolve(t[1])}),(function(t){e.reject({statusCode:t.status,status:t.statusText,message:t.responseText})})),e.promise},refresh:function(t){var e=l.a.defer(),i=this;return void 0!==t&&r.a.extend(this.currentData,t),l.a.all([this.getCount(),this.gotoPage(this.currentPage)]).then((function(t){i.processNumberOfPages(t[0]),i.currentPage>i.pages&&i.pages>0?i.gotoPage(i.pages).then((function(){return e.resolve(t[1])})):e.resolve(t[1])}),(function(t){e.reject({statusCode:t.status,status:t.statusText,message:t.responseText})})),e.promise},processNumberOfPages:function(t){this.total=Number(t),this.pages=Math.ceil(this.total/this.itemsPerPage)},reload:function(){return this.firstPage()},getCount:function(){var t="function"==typeof this.url?this.url():this.url;if(!t)throw new Error("url is missing");return c.default.get("".concat(t,"/Count?_=").concat(String(Date.now())),this.currentData)},getPaginationData:function(t){return{skip:(t-1)*this.itemsPerPage,take:this.itemsPerPage,userId:this.userId}},gotoPage:function(t){var e=r.a.extend({},this.currentData,r.a.omit(this.getPaginationData(t),(function(t){return null==t||""===t})));return this.currentPage=t,this.fetch({data:e})},nextPage:function(){var t=this.currentPage+1;if(t>this.pages)throw new Error("You are already at the last page");return this.gotoPage(t)},prevPage:function(){var t=this.currentPage-1;if(t<1)throw new Error("You are already at the first page");return this.gotoPage(t)},firstPage:function(){return this.gotoPage(1)},lastPage:function(){return this.gotoPage(this.pages)}});e.default=u},791:function(t,e,i){"use strict";i.r(e);var n=i(1),o=i.n(n),s=i(1930),r=i(13),a=i(50),l=i.n(a),c=i(34),u=i(652),d=i(16),h=i(412);var f,p=(f=null,function(){return f||(f=Object(s.dataSource)())}),m=r.default.extend({initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options=t,!this.options.reactComponent)throw new Error("reactView: props.reactComponent can not be null.");this.options.props=this.options.props||{},this.options.isStateless=void 0===this.options.isStateless||this.options.isStateless,this.component=null,this.dataSource=p(),this.providerOptions={translations:window.i18n,theme:{},dataSource:this.dataSource},this.apolloProviderOptions={client:Object(h.getApolloClient)()}},setComponent:function(t){var e=this.overrideComponent(t);this.component=e},overrideComponent:function(t){var e=this;if(!this.options.reactComponent.prototype.overrides)return t;var i=t;return Object.keys(this.options.reactComponent.prototype.overrides).forEach((function(t){i[t]=e.options.reactComponent.prototype.overrides[t]})),i},getDataSource:function(){return this.dataSource},getComponent:function(){return this.options.isLazy?(t=this.options.reactComponent,e=Object(n.lazy)(t),function(t){return o.a.createElement(n.Suspense,{fallback:o.a.createElement("div",null)},o.a.createElement(e,t))}):this.options.reactComponent;var t,e},render:function(){var t=this;this.options.isStateless||(this.options.props.ref=function(e){t.setComponent(e)});var e=this.getComponent();return this.reactView=o.a.createElement(c.StyleSheetManager,{disableCSSOMInjection:u.default.isIE},o.a.createElement(d.ApolloProvider,{client:this.apolloProviderOptions.client},o.a.createElement(s.BeezyProvider,this.providerOptions,o.a.createElement(e,this.options.props)))),l.a.unmountComponentAtNode(this.el),l.a.render(this.reactView,this.el),this.reactView}});m.getDataSource=function(){return p()},e.default=m},8:function(t,e,i){"use strict";i.r(e);var n=i(98),o=i.n(n),s=i(3),r=i.n(s),a=i(7),l=i(5),c={getCurrentGroup:function(){return window.beezyCurrentGroup},getCurrentGroupTitle:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Title)&&void 0!==t?t:""},getCurrentGroupType:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Type)&&void 0!==t?t:""},getGroupServiceV2Url:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.GroupServiceV2Url)&&void 0!==t?t:""},getCommunityServiceV2Url:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.CommunityServiceV2Url)&&void 0!==t?t:""},isStandAloneGroup:function(){var t,e=null===(t=this.getCurrentGroup())||void 0===t?void 0:t.Type;return e===a.default.Type.STANDALONE_BLOG||e===a.default.Type.STANDALONE_WIKI||e===a.default.Type.STANDALONE_QUESTIONS||e===a.default.Type.STANDALONE_FORUM||e===a.default.Type.IDEAS_CAMPAIGN},isKnowledgeCenter:function(){var t;return"KnowledgeCenter"===(null===(t=this.getCurrentGroup())||void 0===t?void 0:t.Type)},isModuleGroup:function(){var t;return(null===(t=this.getCurrentGroup())||void 0===t?void 0:t.Type)===a.default.Type.EDITORIALMODULE},isGroupDisabled:function(t){var e=t||this.getCurrentGroup();if(!e)return!1;if(e.IsActive){if(e.IsCurrentUserWebAdmin)return!1;if("EditorialModule"===e.Type||"CorporateModule"===e.Type||"CorporateSite"===e.Type)return!1;if(e.IsModerated)return beezyCurrentUser&&(!e.IsCurrentUserMember||!e.IsActive);if(e.IsPublic)return!beezySettings.PublicCommunitiesOpen&&!e.IsCurrentUserMember}return!e.IsActive},getTool:function(t){var e=this.getCurrentGroup();return this.existToolsGroup()&&e&&e.Tools.find((function(e){return e.Type===t}))},isFoldersEnabled:function(){if(l.default.isFoldersEnabled()){var t=this.getTool(a.default.Tool.DOCUMENT),e=t&&t.Configuration&&JSON.parse(t.Configuration);return e&&e.FoldersEnabled}return!1},isToolEnabled:function(t){var e=!1;if(t===a.default.Tool.POST||t===a.default.Tool.KNOWLEDGE)return!0;if(r.a.find(l.default.getDisabledTools(),(function(e){return t===e})))return!1;var i=this.getCurrentGroup();return!i||"all"===t||(i&&i.Tools&&(e=null!=r.a.find(i.Tools,(function(e){return e.Type===t&&e.Active}))),e)},isToolReadOnly:function(t,e){var i=e||this.getCurrentGroup(),n=!1;return i&&i.Tools&&(n=null!=r.a.find(i.Tools,(function(e){return e.Type===t&&e.ReadOnly}))),n},isUserAGroupAdministrator:function(t){var e,i=null===(e=window.beezyCurrentUser)||void 0===e?void 0:e.Id,n=t?t.Administrators:this.getCurrentGroup().Administrators;if(!n)return!1;var o=!1;return r.a.each(n,(function(t){t.Id===i&&(o=!0)})),o},getPageLayout:function(){var t=this.getCurrentGroup();if(t)return r.a.find(t.Pages,(function(t){return t.Name===window.beezyContext.CurrentPageKey}))},isGroupOwner:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsCurrentUserWebAdmin)&&void 0!==t&&t},isGroupMember:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsCurrentUserMember)&&void 0!==t&&t},canWriteFolders:function(){return this.isModerated()&&!this.isToolReadOnly(a.default.Tool.DOCUMENT)?this.isGroupMember():!this.isToolReadOnly(a.default.Tool.DOCUMENT)},getGroupId:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.GroupId)&&void 0!==t?t:void 0},getGroupLocalEntity:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.LocalEntity)&&void 0!==t?t:void 0},getGroupType:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Type)&&void 0!==t?t:void 0},isModerated:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsModerated)&&void 0!==t&&t},isPublic:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsPublic)&&void 0!==t&&t},isDiscoverable:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsDiscoverable)&&void 0!==t&&t},getPages:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Pages)&&void 0!==t?t:[]},isCurrentUserWebAdmin:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsCurrentUserWebAdmin)&&void 0!==t&&t},isCurrentUserSpeaker:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsCurrentUserSpeaker)&&void 0!==t&&t},isCurrentUserMember:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsCurrentUserMember)&&void 0!==t&&t},isActive:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.IsActive)&&void 0!==t&&t},getUrl:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Url)&&void 0!==t?t:""},getCreatedDate:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Created)&&void 0!==t?t:null},getNavigationLinks:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.NavigationLinks)&&void 0!==t?t:null},getSiteCollectionUrl:function(){var t=this.getCurrentGroup();return null!==t&&null!==t.SiteCollection?t.SiteCollection.SiteCollectionUrl:l.default.getBaseSiteCollection()},isScoped:function(){var t=this.getCurrentGroup();return null!==t?"EditorialModule"===t.Type||"CorporateModule"===t.Type||"CorporateSite"===t.Type:null},getGroupTimezone:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Region)&&void 0!==t?t:l.default.getTimezoneDefault()},existToolsGroup:function(){var t=this.getCurrentGroup();return null!==t&&o()(t.Tools)&&t.Tools.length},getToolsGroup:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Tools)&&void 0!==t?t:void 0},areTermsRequired:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.TermsRequired)&&void 0!==t&&t},getMembersCount:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.MembersCount)&&void 0!==t?t:0},getDescription:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Description)&&void 0!==t?t:""},getTags:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Tags)&&void 0!==t?t:[]},getAdministrators:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Administrators)&&void 0!==t?t:[]},getSessionStartLocal:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.SessionStartLocal)&&void 0!==t?t:""},getSessionEndLocal:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.SessionEndLocal)&&void 0!==t?t:""},getSessionStart:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.SessionStart)&&void 0!==t?t:""},getSessionEnd:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.SessionEnd)&&void 0!==t?t:""},getSpeakers:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.Speakers)&&void 0!==t?t:""},isConvertedGroup:function(){var t;return null===(t=this.getCurrentGroup())||void 0===t?void 0:t.ConvertedBeezyGroup},getKCServiceV2Url:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.KnowledgeCenterServiceV2Url)&&void 0!==t&&t},isCurrentUserEditor:function(){return this.isGroupOwner()},isCurrentUserGuestWriter:function(){return beezySettings.CorporateModule&&beezySettings.CorporateModule.IsCurrentUserGuestWriter},isCurrentUserWriter:function(){return beezySettings.CorporateModule&&beezySettings.CorporateModule.IsCurrentUserMember},isEnableAccessLiteral:function(){return beezySettings.EnableAccessLiteral},hasParentGroup:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.HasParentGroup)&&void 0!==t&&t},isInsideGroup:function(){return this.getCurrentGroup()},hasRelatedGroups:function(){var t,e;return null!==(t=null===(e=this.getCurrentGroup())||void 0===e?void 0:e.HasRelatedGroups)&&void 0!==t&&t},getAplicationTitle:function(){return beezySettings.ApplicationTitle}};e.default=c},80:function(t,e,i){"use strict";i.r(e);var n=i(98),o=i.n(n),s=i(3),r=i.n(s);e.default={isEqual:function(t,e,i){var n=t||[],s=e||[];if(0===n.length&&0===s.length)return!0;if(n.length!==s.length)return!1;for(var a=function(t,e){var o=n[t]||null;if(!r.a.find(s,(function(t){var e=t||null;return!(null===o&&null!==e||null!==o&&null===e)&&(i?i(o,e):void 0!==o.Id&&void 0!==e.Id?o.Id===e.Id:o===e)})))return{v:!1}},l=0,c=s.length;l<c;l++){var u=a(l);if("object"===o()(u))return u.v}return!0},move:function(t,e,i){return t.splice(i,0,t.splice(e,1)[0]),t},findIndex:function(t,e){var i=0,n=!1;return t&&t.length?(r.a.find(t,(function(t){return i++,n=e(t)})),n?i-1:-1):-1},findWhere:function(t,e){return t.find((function(t){return Object.keys(e).every((function(i){return t[i]===e[i]}))}))},sortBy:function(t,e){return e.sort((function(e,i){return e[t]<i[t]?-1:e[t]>i[t]?1:0}))},without:function(t,e){return t.filter((function(t){return t!==e}))}}},809:function(t,e,i){"use strict";var n=i(1998);e.default=n.default},811:function(t,e,i){"use strict";var n=i(1),o=i.n(n),s=i(0),r=i.n(s),a=i(44),l=i(525),c=i(32),u=i(404),d=i(21),h=i(1003),f=i(1008);var p=function(t){var e=t.dataTest,i=t.disabled,n=t.extraClasses,s=t.hasTooltip,r=t.id,p=t.loading,m=t.onClick,g=t.selected,v=t.selectedEntity,b=t.title,y=t.tooltipTitle,C=t.typeIcon,w=function(){return o.a.createElement(a.default,{extraClasses:{button:g?Object(d.unionClassNames)(f.default["list__item--clickable--selected"],n.buttonListItem,n.selected):Object(d.unionClassNames)(f.default["list__item--clickable"],n.buttonListItem)},category:"plain",onClick:m,disabled:i,data:{test:e},role:"tab","aria-controls":"contextualsearch-content-".concat(v),id:"contextualsearch-tabitem-".concat(v),"aria-selected":g,value:b},o.a.createElement(o.a.Fragment,null,p?o.a.createElement(l.C,{size:"small",extraClasses:{circular:f.default["loading--position"]}}):C?o.a.createElement(c.I,{typeIcon:C,extraClasses:{icon:Object(d.unionClassNames)(f.default.icon,n.icon)}}):null,b))};return o.a.createElement(h.default,{id:r,role:"presentation",extraClasses:{listitem:n.listitem}},s?o.a.createElement(u.default,{title:y,anchorOrigin:{horizontal:"middle",vertical:"top"},targetOrigin:{horizontal:"middle",vertical:"bottom"},extraClasses:{tooltipSpan:f.default["tooltip__span--width"]}},w()):w())};p.propTypes={id:r.a.string,disabled:r.a.bool,extraClasses:r.a.shape({listitem:r.a.string,buttonListItem:r.a.string,selected:r.a.string,icon:r.a.string}),hasTooltip:r.a.bool,loading:r.a.bool,onClick:r.a.func.isRequired,title:r.a.string,typeIcon:r.a.string,dataTest:r.a.string,selected:r.a.bool,selectedEntity:r.a.string,tooltipTitle:r.a.string},p.defaultProps={disabled:!1,extraClasses:{listitem:"",buttonListItem:"",selected:"",badge:"",icon:""},hasTooltip:!1,loading:!1,title:"",id:"",dataTest:"",selected:!1,tooltipTitle:""},e.default=p},84:function(t,e,i){"use strict";var n=i(3),o=i.n(n),s=i(4),r=i.n(s),a=i(2),l=i(36),c=i(20),u=i(1034),d=i.n(u),h=i(49),f=0,p=l.default.extend({dom:{INPUT:".js-input",CHARS_LEFT:".js-characters-left",SIZE:".js-size",literalError:".js-error-title"},inputTextClasses:{isHidden:"hidden",isVisible:"visible"},type:"input-text",size:25,template:d.a,events:function(){var t={},e=this.dom.INPUT;return t["focus ".concat(e)]="showCharactersLeft",t["blur ".concat(e)]="checkAllValidations",t["keypress ".concat(e)]="onInputKeypress",t["keyup ".concat(e)]="onInputKeyup",t["paste ".concat(e)]="onPaste",t["cut ".concat(e)]="onInputKeypress",t},initialize:function(t){var e;this.excludedFromValidation=t.excludedFromValidation||!1,p.__super__.initialize.call(this,t),t.size&&(this.size=t.size),this.context={id:this.type+(e=+new Date,(f+=1)+e),size:this.size,showTitle:t.showTitle,title:t.title||Object(a.translate)("Title"),description:t.description,placeholder:t.placeholder||Object(a.translate)("Type title here..."),classesInput:t.classesInput||"",disabled:t.disabled||!1,includeCheck:t.includeCheck||!1,inputType:t.inputType,showSize:t.showSize||!1,descriptionBefore:t.descriptionBefore||"",descriptionAfter:t.descriptionAfter||"",isModal:t.isModal||!1,hasValidationMessage:t.hasValidationMessage,showScroll:t.showScroll||!1,hasContainer:t.hasContainer||!1,containerClass:t.containerClass||"",showHideErrorWithClasses:t.showHideErrorWithClasses||!1}},render:function(){this.$el.append(this.template(this.context));var t=this.focusItem=this.$input=this.$(this.dom.INPUT);if(this.containerError=this.$el.find(this.dom.literalError),this.$charactersLeft=this.$(this.dom.CHARS_LEFT),this.$size=this.$(this.dom.SIZE),/msie|trident/i.test(navigator.userAgent)&&Number(r.a.browser.version)>=10&&"TEXTAREA"===t.prop("tagName")){t.html("");var e=t.attr("placeholder");t.removeAttr("placeholder"),t.attr("placeholder",e)}return this.trigger("onRendered"),this},getValue:function(){return this.$input?o.a.str.trim(this.$input.val()):""},setValue:function(t){this.$input.val(h.default.compactNewLines(t)),this.updateCharactersLeft()},_hideError:function(){this.options.showHideErrorWithClasses?(this.containerError.removeClass(this.inputTextClasses.isVisible),this.containerError.addClass(this.inputTextClasses.isHidden)):this.containerError.hide()},_showError:function(){this.options.showHideErrorWithClasses?(this.containerError.removeClass(this.inputTextClasses.isHidden),this.containerError.addClass(this.inputTextClasses.isVisible)):this.containerError.show()},setError:function(t){this.containerError=this.$el.find(this.dom.literalError),this.$input.addClass(this.classes.error),this.containerError&&this.containerError.length&&(this.containerError.html(t),this._showError())},unsetError:function(){this.$input.removeClass(this.classes.error),this.containerError&&this.containerError.length&&(this.containerError.html(),this._hideError())},attachError:function(){return this.$input},showCharactersLeft:function(){this.$charactersLeft.css("visibility","visible"),this.trigger("onFocus")},hideCharactersLeft:function(){this.$charactersLeft.css("visibility","hidden")},checkAllValidations:function(){return this.hideCharactersLeft(),this.trigger("onBlur"),p.__super__.checkAllValidations.call(this)},updateCharactersLeft:function(){this.$size.text(this.charactersLeft())},charactersLeft:function(){return this.size-this.$input.val().length},onPaste:function(){var t=this;setTimeout((function(){t.charactersLeft()<=0&&t.$input.val(t.$input.val().substring(0,t.size)),t.updateCharactersLeft()}),0)},onInputKeypress:function(t){this.charactersLeft()<=0&&t.preventDefault(),this.updateCharactersLeft(),this.trigger("change",t)},onInputKeyup:function(t){this.charactersLeft()&&this.updateCharactersLeft(),this.validationStarted&&this.checkValidations(),this.trigger("change",t)},getJSON:function(){return this.getValue()},enable:function(){c.default.enable(this.$input)},disable:function(){c.default.disable(this.$input)}});e.default=p},88:function(t,e,i){"use strict";var n=i(1488);i.d(e,"addAssertiveMessage",(function(){return n.default}));var o=i(2201);i.d(e,"writeI18nAssertiveMessage",(function(){return o.default}))},889:function(t,e,i){"use strict";i.r(e),i.d(e,"PollOptions",(function(){return l})),i.d(e,"PollMultiOptions",(function(){return c}));var n=i(27),o=i.n(n),s=i(1569),r=i(5),a=i(10),l=o.a.Collection.extend({model:s.default,initialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.votedOption=null,this.isMultiOption=!1,this.activityId=e.activityId},url:function(){return"".concat(r.default.getApiUrlv2(),"/Activities/").concat(this.activityId,"/Comments")},vote:function(t){this.getVotedOption()&&this.getVotedOption().unvote(),this.votedOption=this.at(t),this.votedOption.vote()},getVotedOption:function(){return null===this.votedOption&&(this.votedOption=this.find((function(t){return t.isVoted()}))),this.votedOption},getVotedOptionIndex:function(){return this.indexOf(this.getVotedOption())},isAlreadyVoted:function(){return!!this.getVotedOption()}}),c=o.a.Collection.extend({model:s.default,initialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isMultiOption=!0,this.activityId=e.activityId},url:function(){return"".concat(r.default.getApiUrlv2(),"/Activities/").concat(this.activityId,"/Comments")},sendVotesUrl:function(){return"".concat(r.default.getApiUrlv2(),"/Polls/").concat(this.activityId,"/Vote")},addVote:function(t){this.at(t).vote()},removeVote:function(t){this.at(t).unvote()},getVotedOptions:function(){return this.filter((function(t){return t.isVoted()}))},getVotedOptionsIndexes:function(){var t=this;return this.getVotedOptions().map((function(e){return t.indexOf(e)}))},getVotedOptionsDTO:function(){return this.getVotedOptions().map((function(t){return{ParentId:t.id}}))},isAlreadyVoted:function(){return!!this.find((function(t){return t.isVoted()}))},vote:function(){return a.default.putJSON("".concat(this.sendVotesUrl()),this.getVotedOptionsDTO())}})},89:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s=i(3),r=i.n(s),a=i(116),l=i(117),c=i(1753),u=i(20),d=i(7),h=i(2),f=i(53),p=i(88),m=a.default.extend({classes:{input:"",container:"autocomplete bz-webpart",top:"autocomplete--top",bottom:"autocomplete--bottom",list:"",item:"autocomplete__item"},dom:{classContainer:"js-autocomplete"},init:function(){this.threshold=this.options.threshold||3,this._valueSelector=this.options.valueSelector||"value",this.zIndex=this.options.zIndex||99999,this.options.throttle=this.options.throttle||500,this.role=this.options.role||"",this.listId="autocomplete-".concat((new Date).getTime()),this.options.bindInput?this._bindInput(this.options.bindInput):this._createInput(),this._configureInput(),this._configureDropdown(),"function"==typeof this.options.searchAdapter&&(this.searchAdapter=r.a.throttle(this.options.searchAdapter,this.options.throttle)),this.adapterOptions=this.options.adapterOptions||{},this.setItems=r.a.bind(this.setItems,this),this.listInsertItems=this.options.listInsertItems,this.excludeItems=this.options.excludeItems,this.keyParameter=this.options.keyParameter},_createInput:function(){this.input=o()('<input type="text" role="combobox" aria-autocomplete="list" autocomplete="off" aria-expanded="false" aria-owns="'.concat(this.listId,'" />')).addClass(this.classes.input),this.role&&this.input.attr("role",this.role),this.el.append(this.input)},_bindInput:function(){this.input=this.options.bindInput},_configureInput:function(){var t=this;this.setInput(this.input),this.options.placeholderText&&this.setPlaceholder(this.options.placeholderText),this.options.inputTitle&&this.input.attr("title",this.options.inputTitle),this.inputLength=0,this.onkeyup=r.a.bind(this.onkeyup,this),this.onchangeInput=r.a.bind(this.onchangeInput,this),this.input.on("keydown",(function(t){13===t.keyCode&&t.preventDefault()})),this.input.on("keyup",this.onkeyup),this.input.on("change",this.onchangeInput),this.input.on("focusin",this.onfocusinInput),this.input.focusin((function(){t.emit("focusin")}))},_configureDropdown:function(){var t=this,e=this.dropdown=new c.default({items:this.options.items,template:this.options.template,input:this.input,classes:{container:this.classes.container,top:this.classes.top,bottom:this.classes.bottom,list:this.classes.list,item:this.classes.item},classContainer:this.dom.classContainer,zIndex:this.zIndex,itemsWindowSize:this.options.itemsWindowSize,showDelay:d.default.dropDefaultDelayShow,hideDelay:d.default.autoCompleteDelayHide,positionDefault:{vertical:d.default.DropVerticalPosition.BOTTOM,horizontal:d.default.DropPosition.RIGHT},insideSidebar:this.options.insideSidebar,insideOtherDrop:this.options.insideOtherDrop,listAriaAttrs:'role="list" id="'.concat(this.listId,'"'),itemAriaAttrs:'role="option" aria-selected="false"'});this.dropdown.render(),e.on("select",this.onselectitem,this),e.on("itemfocus",this.onItemFocus,this),e.on("keydown",this.onselectitem,this),e.on("show",(function(){return t.input.attr("aria-expanded",!0)})),e.on("hide",(function(){return t.input.attr("aria-expanded",!1)})),e.bindTo(this.options.bindDropdown||this.input),e.once("visible",(function(){e.el.css("width",e.$bound.outerWidth())}),this)},searchAdapter:function(){},setItems:function(t){var e=this,i=this;if(this.options.maxResultsDisplay&&t.length>this.options.maxResultsDisplay)this.emit("maxResults");else{var n=this.isValidResult(t),o=this.getValue();if(this.listInsertItems&&this.listInsertItems.getItems&&this.keyParameter||this.excludeItems)if(this.listInsertItems){var s=this.listInsertItems.getItems().concat(this.excludeItems),a=r.a.difference(r.a.pluck(t,this.keyParameter),r.a.pluck(s,this.keyParameter));t=r.a.filter(t,(function(t){return a.indexOf(t[i.keyParameter])>=0}))}else this.excludeItems&&(t=t.filter((function(t){return!e.excludeItems.some((function(i){return i[e.keyParameter]===t[e.keyParameter]}))})));if(this.lastSearch=t||[],this.dropdown.render(),this.dropdown.reset(this.lastSearch),this.lastSearch.length){this.options.allowNewItems||this.selectFirst(),this.dropdown.show();var l=Object(f.sprintf)({string:Object(h.translate)("%itemsCount results available"),replacements:[this.lastSearch.length],pattern:/%itemsCount/gi});Object(p.addAssertiveMessage)(l)}else this.dropdown.hide();this.emit(n?"valid":"invalid",o)}},selectFirst:function(){this.dropdown.selectFirst(),this.itemSelected=!0},_contains:function(t){return t&&t.length&&t[0][this._valueSelector].toLowerCase().indexOf(this.getValue().toLowerCase())>-1},isValidResult:function(t){return r.a.indexOf(r.a.each(r.a.pluck(t,this._valueSelector),(function(t){return t.toLowerCase()})),this.getValue().toLowerCase())>-1},onkeyup:function(t){var e=this,i=this.getValue(),n=this.dropdown.getSelectedItem(),o=null!==n,s=13===t.keyCode,r=function(t){var e=Object(f.sprintf)({string:Object(h.translate)("%autocompleteItem selected"),replacements:[t],pattern:/%autocompleteItem/gi});Object(p.addAssertiveMessage)(e)};if(this.options.allowNewItems&&s&&!o){var a=this.dropdown.find((function(t){return t[e._valueSelector]&&t[e._valueSelector]===i}));return this.emit("selectitem",i,a),this.dropdown.hide(),void r(i)}if(s&&o){var l=n[this._valueSelector];return this.emit("selectitem",l,n),this.dropdown.hide(),void r(l)}if(27===t.keyCode&&!this.dropdown.hidden)return t.stopPropagation(),this.dropdown.hide(),void this.setValue("");i.length!==this.inputLength&&(this.emit("inputchanged",i),this.inputLength=i.length,i.length>=this.threshold?(this.dropdown.reset([]),this.searchAdapter(i,this.setItems,this.adapterOptions)):this.dropdown.hide(),this.itemSelected=!1)},onchangeInput:function(){this.emit("change")},_isEqual:function(t){return t[this._valueSelector].toLowerCase()===this.getValue().toLowerCase()},onItemFocus:function(t){if(t){var e=t[this._valueSelector];Object(p.addAssertiveMessage)(e)}},onselectitem:function(t){if(this.options.allowNewItems&&!t)return this.emit("selectitem",this.getValue()),this.itemSelected=!1,void Object(p.addAssertiveMessage)("'".concat(this.getValue,"' selected"));if(t){var e=t[this._valueSelector];this.inputLength=e.length,this.emit("selectitem",e,t),this.itemSelected=!0,Object(p.addAssertiveMessage)("'".concat(e,"' selected"))}},stopSelection:function(){this._stopSelection=!0},getSelectedDataItem:function(){return this.dropdown.find((function(t){return t[this._valueSelector]===this.getValue()}),this)},getValue:function(){return this.input.val()},setValue:function(t){this.input.val(t)},setParametersInFilter:function(t){this.setValue(t);var e=this;this.searchAdapter(t,(function(t){e.setItems(t),e.dropdown.hide()}),this.adapterOptions)},setAdapterOptions:function(t){this.adapterOptions=t.adapterOptions||{}},reset:function(){this.input.val(""),this.dropdown.reset()},dofocus:function(){this.input.focus()},enable:function(){u.default.enable(this.input)},disable:function(){u.default.disable(this.input)},dispose:function(){this.input.off("keyup"),this.dropdown.off("select",this.onselectitem,this),this.dropdown.dispose()}});l.default.mixin(m.prototype),m.configurations={search:{input:"form-search",container:"autocomplete bz-webpart",top:"autocomplete--top",bottom:"autocomplete--bottom",list:"",item:"autocomplete__item"}},e.default=m},9:function(t,e,i){"use strict";var n=i(2177);i.d(e,"getFormattedTranslation",(function(){return n.default}));var o=i(1483);i.d(e,"getTranslation",(function(){return o.default}));var s=i(2180);i.d(e,"getDefaultLCID",(function(){return s.default}))},90:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(3),r=i.n(s),a=i(134),l=i(79),c=i(10),u=i(5),d=i(51);function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var p=l.default.extend({model:a.default.FeedItem,currentData:{start:"",end:"",orderby:"",hashtag:"",type:"",grouptype:"",status:"",filter:"",subtype:"",terms:""},filtered:!1,setOrder:function(t){return void 0!==t&&(this.currentData.orderby=t),this},setGroupType:function(t){return void 0!==t&&(this.currentData.grouptype=t),this},setStatus:function(t){return void 0!==t&&(this.currentData.status=t),this},setType:function(t){return void 0!==t&&(this.currentData.type=t),this},initialize:function(t,e){e=e||{},this.communityId=e.communityId,this.currentData=r.a.extend(this.currentData,e.currentData||{}),this.itemsPerPage=e.itemsPerPage||10,this.feedType=e.feedType,this.userId=e.userId||"",this.grouptype=e.grouptype||"",this.status=e.status||""},url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId)},setPeriod:function(t){var e=null,i=null;t&&(e=new Date(t.getFullYear(),t.getMonth()+1,1),(i=new Date(t.getFullYear(),(t.getMonth()+1)%12+1,1)).setDate(i.getDate()-1)),this.setDateStart(e),this.setDateEnd(i)},setDateStart:function(t){this.start=t&&Object(d.convertDateToDotNet)(t),this.currentData.start=t?Object(d.getFormatedDate)(t):""},setDateEnd:function(t){this.end=t&&Object(d.convertDateToDotNet)(t),this.currentData.end=t?Object(d.getFormatedDate)(t):""},setUser:function(t){this.currentData.userId=t?t.Id:""},setHashtag:function(t){this.currentData.hashtag=t},setFilter:function(t){this.currentData.filter=t},reset:function(){this.setHashtag(""),this.setUser(""),this.setDateStart(""),this.setDateEnd(""),this.setFilter("")}}),m=p.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Questions")}}),g=m.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/CorporateSites/").concat(this.communityId,"/Questions")}}),v=p.extend({model:a.default.ExtendedIdeaFeedItem,currentData:{start:"",end:"",orderby:"",userId:"",hashtag:"",type:"",text:"",grouptype:""},initialize:function(t,e){e=e||{},v.__super__.initialize.call(this,t,e),this.skip=e.skip||0,this.take=e.take||3,this.hashtag=e.hashtag||"",this.start=e.currentData.start||0,this.end=e.end||0,this.orderby=e.currentData.orderby||"",this.currentData=r.a.extend(this.currentData,e.currentData||{}),this.itemsPerPage=e.itemsPerPage||15,this.text=e.text||"",this.grouptype=e.grouptype||"",this.state=e.state||""},setState:function(t){this.state=t,this.currentData&&(this.currentData.state=t)},url:function(){return"".concat(u.default.getApiUrlv2(),"/IdeasCampaigns/").concat(beezyCurrentGroup.GroupId,"/ExtendedIdeas")},fetch:function(t){return t=r.a.extend({data:{skip:this.skip,take:this.take,hashtag:this.hashtag,userId:this.userId,start:this.start,end:this.end,orderby:this.orderby,text:this.text,grouptype:this.grouptype,state:this.state}},t),v.__super__.fetch.call(this,t)},getParameters:function(){return{start:new Date,end:new Date}},getTotalCount:function(){return c.default.get("".concat(this.url(),"/Count"),this.getParameters())}}),b=p.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Ideas")}}),y=p.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/BlogPosts")}}),C=p.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/WikiPages")},getTree:function(){return c.default.getJSON("".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/WikiPages/Tree"))},saveTree:function(t){return c.default.put("".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/WikiPages/Tree"),t)}}),w=p.extend({model:a.default.FilesFeedItem,initialize:function(t,e){w.__super__.initialize.call(this,t,e),this.itemsPerPage=40},url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Files")},fetch:function(t){return t=r.a.extend({data:{take:this.currentData.take,hashtag:this.currentData.hashtag,userId:this.currentData.userId,start:this.currentData.start,end:this.currentData.end,orderby:this.currentData.orderby,type:this.currentData.type}},t),p.__super__.fetch.call(this,t)}}),T=w.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/CorporateSites/").concat(this.communityId,"/Files")}}),x=w.extend({model:a.default.DirectoryFilesFeedItem,defaultUrl:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Directory")},filterUrl:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Files")},url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Directory")},parse:function(t){return t.map((function(t){return t.Attachment?f(f({},t),{},{DirectoryContentId:t.Id,DirectoryContentType:t.Type},t.Attachment):f(f({},t),{},{DirectoryContentId:t.Id})}))}}),O=p.extend({model:a.default.PollFeedItem,url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Polls")}}),S=p.extend({model:a.default.LinkFeedItem,url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Links")}}),I=p.extend({model:a.default.CalendarFeedItem,url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Events")}}),A=p.extend({url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Discussions")}}),k=p.extend({model:a.default.TaskFeedItem,url:function(){return"".concat(u.default.getApiUrlv2(),"/Communities/").concat(this.communityId,"/Tasks")},fetch:function(t){return t=r.a.extend({data:{take:this.currentData.take,hashtag:this.currentData.hashtag,userId:this.currentData.userId,start:this.currentData.start,end:this.currentData.end,orderby:this.currentData.orderby}},t),p.__super__.fetch.call(this,t)}});e.default={Feed:p,BlogFeed:y,WikiFeed:C,FilesFeed:w,FilesFeedCorporateSites:T,DirectoryFeed:x,IdeasFeed:b,QuestionsFeed:m,QuestionsFeedCorporateSites:g,PollFeed:O,LinkFeed:S,CalendarFeed:I,ForumFeed:A,TasksFeed:k,ExtendedIdeasFeed:v}},95:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(10),u=i(5),d=i(7),h=i(38),f=i(2001),p=i(2383),m=i(955),g=i(2384),v=i.n(g);function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var C=m.default.extend({className:"js-quickprofile",template:v.a,dom:{fullProfile:".js-full-profile-react"},initialize:function(t){this.options=t,this.initializeDrop(t.elementBound,t.elementKeyboard),this.options.popoverOptions||(this.options.popoverOptions={}),this.options.popoverOptions.className||(this.options.popoverOptions.classNames="popover-quickprofile"),this.options.showDelay||(this.options.showDelay=400)},render:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ready:!1},i=e.ready;i||(this.renderQuickProfile=!0),this.$el.html(this.template(l.a.extend(this.model.toJSON(),this.options,{isIE:r.a.browser.msie})));var n=this.model,o=this.$el.find(this.dom.fullProfile),s=u.default.getProfileUrl()+this.model.get("Id");return h.default.renderComponent(o,f.default,{profile:n,urlProfile:s,getBackgroundPicture:p.default,hide:function(){t.hide()},onMouseEnter:function(){t.show()}}),this},getExtendedProfile:function(t){var e="".concat(u.default.getBaseWebUrl()+beezySettings.ApiServiceV2Url,"/Users/").concat(t,"/Extended");return c.default.getJSON(e)},getExtendedProperties:function(){return this._setExtendedProperties()},_setExtendedProperties:function(){var t=this;return new Promise((function(e){t.getExtendedProfile(t.model.get("Id")).then((function(i){t.model.attributes=y(y({},t.model.attributes),i),t.getExtendedProfile=function(){return new Promise((function(e){e(t.model.attributes)}))},e(),t.renderQuickProfile&&t.render({ready:!0})}))}))}});C.create=function(t,e,i,n,o){return new C(l.a.extend({model:n,showDelay:d.default.quickProfileDelay,elementBound:t,elementKeyboard:e,parent:i},o||{}))},e.default=C},954:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(5),r=i(26),a=r.default.extend({url:function(){return"".concat(s.default.getApiUrlv2(),"/Activities/").concat(this.id,"/Comment")}}),l=r.default.extend({url:function(){return"".concat(s.default.getApiUrlv2(),"/Comments")},initialize:function(){this.onSuccess=o.a.bind(this.onSuccess,this),this.onError=o.a.bind(this.onError,this)},create:function(t,e){this.save({ActivityId:t,Message:e},{success:this.onSuccess,error:this.onError})},onSuccess:function(t){this.trigger("create",t)},onError:function(){this.trigger("error")}}),c=a.extend({initialize:function(t){c.__super__.initialize.call(this,t)},url:function(){return"".concat(s.default.getApiUrlv2(),"/Comments/").concat(this.get("Id"))}});e.default={Comment:a,RawComment:l,SingleComment:c}},955:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(4),r=i.n(s),a=i(3),l=i.n(a),c=i(1929),u=i.n(c),d=i(311),h=i(2),f=i(13),p=i(106),m=i(7),g=i(15),v=i(17),b=i(2021);function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var C=function(){return window.matchMedia("(max-width: ".concat(b.MAX_WIDTH_FOR_HIDING_POPOVERS,"px)")).matches},w=f.default.extend({classes:{position:"popover--",isLoading:"is-loading",primary:"btn--primary"},dom:{classContainer:"js-beezy-popupcard"},hideInResponsive:!0,initializeDrop:function(t,e){this.elementBound=t,this.elementKeyboard=e,this.show=l.a.bind(this.show,this),this.hide=l.a.bind(this.hide,this),this.bindTo(this.elementBound,this.elementKeyboard)},createDrop:function(){var t=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({animated:!0,fixed:!0,triangle:!1,focusTrap:!1,verticalPosition:m.default.DropVerticalPosition.TOP,position:m.default.DropPosition.CENTER,parent:this.options.parent&&1===this.options.parent.length?this.options.parent:this.elementBound},this.options.popoverOptions||{});this.popover=new d.default(t)},renderDrop:function(){this.popover.inject(this.render().$el),this.bindEvents()},bindEvents:function(){},getData:function(){return this.getExtendedProperties()},getExtendedProperties:function(){var t=r.a.Deferred();return t.resolve(),t},show:function(t){var e,i=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model&&(this.model.get("IsReadOnly")||!1===this.model.get("IsActive"))||this.hideInResponsive&&(!this.hideInResponsive||C())||(this.shouldHide=!1,u()((function(){var e;i.shouldHide||(i.popover||(i.createDrop(),i.renderDrop()),i.popover.show(),!i.isLoading&&(null==t||null===(e=t.target)||void 0===e||e.nodeName,1)&&(i.isLoading=!0,i.getData().then((function(){i.isLoading=!1}))))}),n&&null!==(e=this.options.showDelay)&&void 0!==e?e:0)())},hide:function(){var t=this;this.shouldHide=!0,this.popover&&u()((function(){t.shouldHide&&t.popover.hide()}),50)()},bindTo:function(t,e){var i,n=this;(null===(i=this.options.bindEvents)||void 0===i||i)&&(t instanceof r.a||(t=r()(t)),r()(t).on("mouseenter",this.show),r()(t).on("mouseleave",this.hide),e&&r()(e).on("keyup keypress",(function(t){if(" "===t.key||"Spacebar"===t.key)return t.preventDefault(),t.stopPropagation(),n.show(void 0,!1),!1})))},initializeButtonFollow:function(){this.buttonFollow&&this.buttonFollow.dispose(),this.buttonFollow=new p.default({el:r()("<button/>"),html:Object(h.translate)("Follow"),classes:{container:"btn btn--small js-button-action"},events:{click:l.a.bind(this.onClickFollowButton,this)}})},getExtendedModel:function(){this.model.getExtended().then(l.a.bind(this._setExtendedProperties,this))},showFollowButton:function(t){this.$(this.dom.follow).removeClass(this.classes.hidden);switch(t.isCollegue){case!0:this.setButtonUnFollow();break;case!1:this.setButtonFollow()}},setButtonUnFollow:function(){this.action="unfollow",this.buttonFollow.$el.removeClass(this.classes.primary),this.buttonFollow.toggleSuccess(Object(h.translate)("Unfollow"))},setButtonFollow:function(){this.action="follow",this.buttonFollow.$el.addClass(this.classes.primary),this.buttonFollow.toggleSuccess(Object(h.translate)("Follow"))},onClickFollowButton:function(t){if(t.preventDefault(),t.stopPropagation(),this.buttonFollow.disable(),g.default.isReadOnly())return v.default.showReadOnlyModal();this.buttonFollow.toggleLoading(),"follow"===this.action?this.follow():this.unFollow()}});e.default=w},956:function(t,e,i){"use strict";i.r(e);var n=i(24),o=i.n(n),s=i(18),r=i(30),a=i(5),l=i(3),c=i.n(l),u=i(19),d=i.n(u),h=i(2),f=i(13),p=i(7),m=i(1262),g=i(957);function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}var b={ACTIVITYANSWER:Object(h.translate)("Edit answer"),ACTIVITYCOMMENT:Object(h.translate)("Edit comment"),COMMENT:Object(h.translate)("Edit update"),PRAISE:Object(h.translate)("Edit praise"),POLL:Object(h.translate)("Edit poll")},y=f.default.extend({initialize:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options=e,this.options.model){var i=this.options.model.get("Type"),n=this.options.model._type;i===p.default.Type.POST||i===p.default.Type.POLL||i===p.default.Type.PRAISES||n===p.default.Type.ACTIVITY_COMMENT||n===p.default.Type.ACTIVITY_ANSWER?this.prepareShareBoxDialog():i===p.default.Type.CALENDAR?Object(g.default)(e.model.id,(function(){t.getModelByItem(t.options.model,p.default.Type.CALENDAR).then((function(e){t.trigger("success",e)}))})):this.redirectEdit(i)}},prepareShareBoxDialog:function(){var t=this,e=this.getType(this.options.model);this.getItems(e).then((function(n){n&&Promise.all([i.e(0),i.e(172)]).then(i.bind(null,1211)).then((function(i){(0,i.default)({getItems:function(){return n},showCrossButton:!0,dialogClass:"edit__form-dialog",dialogPosition:{my:"center",at:"center",of:window},type:e.toUpperCase(),context:{showModalTitle:!0,titleModal:b[e.toUpperCase()]},hasEvent:!1,modalShareboxClass:"modal--sharebox-update",disableWrapper:!0,partialOptions:t.options.partialOptions||{},callbackSuccess:function(e){t.trigger("success",e)},onClose:t.options.onClose})}))}))},getItems:function(t){var e=d.a.defer(),i=p.default.ViewByType[t.toUpperCase()];if(!i)return e.resolve(!1);var n=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){o()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},p.default.Tools()[i]),s={};return this.getModelByItem(this.model,t).then((function(t){return s[i]=c.a.extend(n,{tooltip:"",model:t,isUpdate:!0}),e.resolve(s)})),e.promise},getModelByItem:function(t,e){return new m.default({Id:t.id,Type:e}).fetch()},getType:function(t){return!t.get("ActivityId")||t._type!==p.default.Type.ACTIVITY_COMMENT&&t._type!==p.default.Type.ACTIVITY_ANSWER?t.get("Type")&&t.get("Type"):t._type&&t._type},redirectEdit:function(t){var e=this.model.toJSON(),i=this.model.get("RelatedItem");switch(t){case"task":s.default.redirectToUrl("".concat(e.Group.Url,"/Tasks/EditForm.aspx?ID=").concat(i.ItemId,"&Source=").concat(e.Group.Url,"/Tasks"));break;case"calendar":s.default.redirectToUrl("".concat(e.Group.Url+p.default.CalendarEditFormUrl+i.ItemId,"&Source=").concat(e.Group.Url,"/SitePages/Calendar%20Detail.aspx?ActivityId=").concat(e.Id));break;case"corporatepage":s.default.redirectToUrl("".concat(a.default.getBaseSiteHost()).concat(a.default.getCorporateModule().Url).concat(p.default.Corporate.editPageUrl,"/").concat(e.Id));break;default:var n="".concat(i.Url,"?ControlMode=Edit&DisplayMode=Design");SP.SOD.executeFunc("sp.js","SP.ClientContext",(function(){Object(r.checkOutPage)(n,i.ListGuid,i.Url,e.Group.Url,e.Group.SiteCollection.SiteCollectionUrl)}))}}});e.default=y},957:function(t,e,i){"use strict";i.r(e);var n=i(38),o=i(711);e.default=function(t,e,s){var r=document.getElementById("modal-edit");r||(r=Object(o.default)("div",[{name:"id",value:"modal-edit"}])),i.e(55).then(i.bind(null,3722)).then((function(i){var o=i.default;n.default.renderComponent(r,o,{eventId:t,intervals:15,onSuccess:e,onClose:function(){n.default.unMountComponent(document.getElementById("modal-edit"))},onReturnFocus:s})}))}},960:function(t,e,i){"use strict";i.r(e);var n=i(969),o=n.default.extend({initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.parentActivity&&t.parentActivity.context&&t.parentActivity.context.tools||{};o.__super__.initialize.call(this,t),this.configTools({comment:!1,share:!1,bookmark:!1,remove:!this.options.locked,tag:!1,like:e.like})}}),s=n.default.extend({tagName:"div",className:"",initialize:function(t){o.__super__.initialize.call(this,t),this.configTools({comment:!1,share:!1,bookmark:!1,remove:!this.options.locked,tag:!1})}});e.default={Answer:o,AnswerDiv:s}},961:function(t,e,i){"use strict";i.r(e);var n=i(3),o=i.n(n),s=i(150),r=i(133),a=i(2393),l=i.n(a),c=i(2),u=i(78),d=i(5),h=i(37),f=s.default.extend({tagName:function(){return"div"},className:"activity announcement ns-effect-bouncyflip ns-attached",template:l.a,texts:{confirmDelete:"This announcement will be permanently deleted, OK?"},events:{"click [data-region=close]":"clear","click .js-owner-name":"showProfile"},initialize:function(t){f.__super__.initialize.apply(this,t),this.dom=o.a.extend({},this.dom,{messageContainer:".activity-comment"})},render:function(){f.__super__.render.call(this);var t=this.$el,e=this.context,i=this.getTextToTooltip;return t.css("visibility","hidden"),t.find(".js-time-ago").timeago(!0),t.find(".js-regular-timeago").timeago(!1),Object(r.default)(this.$(".js-content"),{lines:5,ellipsis:"...",showMore:!0,expandText:Object(c.translate)("Show more"),collapseText:Object(c.translate)("Show less"),after:function(){t.removeClass("ns-hide"),setTimeout((function(){t.css("visibility","visible"),t.addClass("ns-show")}),0),new h.default({el:t.find(".js-time-ago"),text:i(e)})}}),this},dispose:function(){var t=this;this.$el.removeClass("ns-show"),setTimeout((function(){t.$el.addClass("ns-hide")}),0);f.__super__.dispose.call(t)},showProfile:function(t){if(t.preventDefault(),t.stopPropagation(),!this.model.get("Owner").IsReadOnly){var e=d.default.getProfileUrl()+this.model.get("Owner").Id;u.default.showUserProfilePage(e)}},clear:function(){window.confirm(Object(c.translate)(this.texts.confirmDelete))&&this.destroyActivity()}});e.default=f},962:function(t,e,i){"use strict";i.r(e);e.default=function(t){if(!t.prototype.getPaginationData)throw new Error("textSearchDecorator: collection must inherit from paginated collection");return t.prototype.__url=t.prototype.url,t.prototype.__setFilter=t.prototype.setFilter||function(){},t.prototype.__getPaginationData=t.prototype.getPaginationData,t.prototype.__reset=t.prototype.reset||function(){},t.prototype.url=function(){return this.isTextSearch()?"".concat(this.__url(),"/TextSearch"):this.__url()},t.prototype.setFilter=function(t){this.text=t.text,this.currentData.text=this.text,this.filtered=!0,this.__setFilter(t)},t.prototype.getPaginationData=function(t){this.currentData&&(this.currentData.take=this.itemsPerPage);var e=this.__getPaginationData(t);return e.text=this.text,e},t.prototype.reset=function(t){this.resetTextSearch(),t||this.__reset(!0)},t.prototype.resetTextSearch=function(){this.text="",this.currentData.text="",this.filtered=!1},t.prototype.isTextSearch=function(){return this.text&&(!this.currentData||!this.currentData.hashtag&&!this.currentData.userId)},t.prototype.resetOthers=function(){this.setGroupType&&this.setGroupType(""),this.setOrder&&this.setOrder(""),this.setHashtag&&this.setHashtag(""),this.setUser&&this.setUser("")},t.textSearch=!0,t}},968:function(t,e,i){"use strict";i.r(e);var n=i(4),o=i.n(n),s={isCommentOwnerSpeaker:function(t){if(beezyCurrentGroup){var e=!1;return o.a.grep(beezyCurrentGroup.Speakers,(function(i){i.Id===t.Id&&(e=!0)})),e}},isCommentOwnerModerator:function(t){if(beezyCurrentGroup){var e=!1;return o.a.grep(beezyCurrentGroup.Administrators,(function(i){i.Id===t.Id&&(e=!0)})),e}},isCurrentUserSpeakerOrModerator:function(){if(beezyCurrentGroup){if(beezyCurrentGroup.IsCurrentUserSpeaker)return!0;var t=!1;return o.a.grep(beezyCurrentGroup.Administrators,(function(e){e.Id===beezyCurrentUser.Id&&(t=!0)})),t}}};e.default=s},969:function(t,e,i){"use strict";i.r(e);i(682);var n=i(3),o=i.n(n),s=i(1265),r=i(2387),a=i.n(r),l=s.default.extend({template:a.a,configTools:function(t){t=t||{},this.options.tools=this.options.tools||{},this.options.readOnly?this.context.tools={bookmark:!1,comment:!1,edit:!1,group:!1,like:!1,markAsBestAnswer:!1,pinComment:!1,remove:!1,report:!1,share:!1,tag:!1,timeago:!1,vote:!1}:this.context.tools=o.a.extend({group:this.inGlobalPage,like:!0,markAsBestAnswer:!1,pinComment:this.options.parentActivity&&(this.options.parentActivity.model.get("Owner").Id===beezyCurrentUser.Id||beezyCurrentUser.IsBeezyAdministrator)&&beezySettings.EnablePinnedComments,remove:!0,report:beezySettings.EnableReportAbuse,share:!0,timeago:!0,vote:!1},this.options.tools,this.context.tools,t)},configAfterRenderTools:function(){this.$commentsCount=this.viewRegion("comments-count"),this.$like=this.region("like-a"),this.$(".js-timeago").timeago(!0),this.$(".js-regular-timeago").timeago(!1),!this.model.isQuestion()||this._commentsView.hasAnswer||window.Beezy.Business.isCurrentUserSpeakerOrModerator()?this.viewRegion("comment").length&&(this.viewRegion("comment")[0].style.display=""):this.viewRegion("comment").hide()}});e.default=l},994:function(t,e,i){"use strict";e.default={list:"bz-list--Z2mWpTK",item:"bz-item--Z2mWpTK","container--width":"bz-container--width--Z2mWpTK",input:"bz-input--Z2mWpTK",label:"bz-label--Z2mWpTK",checkbox:"bz-checkbox--Z2mWpTK"}}}]);